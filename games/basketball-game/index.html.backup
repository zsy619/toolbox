<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ç¯®çƒæ¸¸æˆ - æŠ•ç¯®æŒ‘æˆ˜</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', sans-serif;
            background: linear-gradient(135deg, #e17055 0%, #d63031 100%);
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 20px;
        }

        .game-container {
            background: white;
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
            max-width: 900px;
            width: 100%;
        }

        .game-header {
            text-align: center;
            margin-bottom: 30px;
        }

        .game-title {
            font-size: 2.5em;
            font-weight: 700;
            color: #2d3436;
            margin-bottom: 10px;
        }

        .game-subtitle {
            color: #636e72;
            font-size: 1.1em;
        }

        .game-canvas {
            border: 4px solid #2d3436;
            border-radius: 10px;
            display: block;
            margin: 0 auto;
            background: #e17055;
            cursor: crosshair;
        }

        .game-info {
            display: flex;
            justify-content: space-between;
            margin: 20px 0;
            font-weight: bold;
            color: #2d3436;
        }

        .score {
            color: #00b894;
            font-size: 1.2em;
        }

        .shots {
            color: #6c5ce7;
        }

        .time {
            color: #fd79a8;
        }

        .power-bar {
            margin: 15px 0;
            text-align: center;
        }

        .power-bar-label {
            font-weight: bold;
            color: #2d3436;
            margin-bottom: 10px;
        }

        .power-bar-container {
            width: 300px;
            height: 20px;
            background: #ddd;
            border-radius: 10px;
            margin: 0 auto;
            overflow: hidden;
            border: 2px solid #2d3436;
        }

        .power-bar-fill {
            height: 100%;
            background: linear-gradient(90deg, #00b894, #fdcb6e, #e17055);
            width: 0%;
            transition: width 0.1s ease;
        }

        .controls {
            text-align: center;
            margin-top: 20px;
            padding: 20px;
            background: #f8f9fa;
            border-radius: 10px;
        }

        .controls h3 {
            color: #2d3436;
            margin-bottom: 15px;
        }

        .control-item {
            display: inline-block;
            margin: 5px 15px;
            padding: 8px 16px;
            background: #e17055;
            color: white;
            border-radius: 20px;
            font-size: 0.9em;
        }

        .message {
            text-align: center;
            padding: 15px;
            border-radius: 10px;
            margin: 10px 0;
            font-weight: bold;
            display: none;
        }

        .message.show {
            display: block;
        }

        .message.score {
            background: #55efc4;
            color: #2d3436;
        }

        .message.miss {
            background: #fab1a0;
            color: #2d3436;
        }

        .message.game-over {
            background: #fd79a8;
            color: #2d3436;
        }

        .start-button {
            display: block;
            margin: 20px auto;
            padding: 12px 30px;
            background: #e17055;
            color: white;
            border: none;
            border-radius: 25px;
            font-size: 1.1em;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .start-button:hover {
            background: #d63031;
            transform: translateY(-2px);
        }

        @media (max-width: 768px) {
            .game-container {
                padding: 20px;
                margin: 10px;
            }
            
            .game-canvas {
                width: 100%;
                height: auto;
            }

            .game-info {
                flex-wrap: wrap;
                gap: 10px;
                justify-content: center;
            }

            .power-bar-container {
                width: 250px;
            }

            .control-item {
                display: block;
                margin: 5px 0;
            }
        }
    </style>
</head>
<body>
    <div class="game-container">
        <div class="game-header">
            <h1 class="game-title">ğŸ€ ç¯®çƒæ¸¸æˆ</h1>
            <p class="game-subtitle">æŠ•ç¯®æŒ‘æˆ˜ - ç„å‡†ç¯®ç­ï¼ŒæŠ•å‡ºå®Œç¾å¼§çº¿ï¼</p>
        </div>

        <div class="game-info">
            <div class="score">å¾—åˆ†: <span id="score">0</span></div>
            <div class="shots">æŠ•ç¯®: <span id="shots">0</span>/20</div>
            <div class="time">æ—¶é—´: <span id="time">60</span>ç§’</div>
        </div>

        <div class="power-bar">
            <div class="power-bar-label">æŠ•ç¯®åŠ›åº¦</div>
            <div class="power-bar-container">
                <div class="power-bar-fill" id="powerBarFill"></div>
            </div>
        </div>

        <canvas id="gameCanvas" class="game-canvas" width="800" height="600"></canvas>

        <div class="message" id="message"></div>

        <button class="start-button" id="startButton">å¼€å§‹æ¸¸æˆ</button>

        <div class="controls">
            <h3>ğŸ® æ¸¸æˆæ§åˆ¶</h3>
            <div class="control-item">æŒ‰ä½é¼ æ ‡ - è“„åŠ›æŠ•ç¯®</div>
            <div class="control-item">æ¾å¼€é¼ æ ‡ - æŠ•ç¯®</div>
            <div class="control-item">é¼ æ ‡ä½ç½® - æ§åˆ¶æŠ•ç¯®è§’åº¦</div>
        </div>
    </div>

    <script>
        class BasketballGame {
            constructor() {
                this.canvas = document.getElementById('gameCanvas');
                this.ctx = this.canvas.getContext('2d');
                this.canvas.width = 800;
                this.canvas.height = 600;
                
                this.gameState = 'menu';
                this.score = 0;
                this.shots = 0;
                this.maxShots = 20;
                this.timeLeft = 60;
                this.gameTimer = null;
                
                this.mouse = { x: 0, y: 0 };
                this.isCharging = false;
                this.chargePower = 0;
                this.maxPower = 100;
                this.chargeSpeed = 2;
                
                this.ball = null;
                this.ballTrail = [];
                this.basket = {
                    x: 650,
                    y: 200,
                    width: 80,
                    height: 15,
                    rimLeft: 650,
                    rimRight: 730,
                    netPoints: []
                };
                
                this.player = {
                    x: 100,
                    y: 450,
                    width: 40,
                    height: 60
                };
                
                this.gravity = 0.4;
                this.initBasket();
                this.bindEvents();
                this.updateUI();
            }

            initBasket() {
                // ç”Ÿæˆç¯®ç½‘çš„ç‚¹
                this.basket.netPoints = [];
                const segments = 8;
                for (let i = 0; i <= segments; i++) {
                    const x = this.basket.rimLeft + (this.basket.width * i / segments);
                    const y = this.basket.y + 15 + Math.sin(i * 0.5) * 30;
                    this.basket.netPoints.push({ x, y });
                }
            }

            bindEvents() {
                document.getElementById('startButton').addEventListener('click', () => {
                    this.startGame();
                });
                
                this.canvas.addEventListener('mousemove', (e) => {
                    const rect = this.canvas.getBoundingClientRect();
                    this.mouse.x = e.clientX - rect.left;
                    this.mouse.y = e.clientY - rect.top;
                });
                
                this.canvas.addEventListener('mousedown', (e) => {
                    if (this.gameState === 'playing' && !this.ball) {
                        this.isCharging = true;
                        this.chargePower = 0;
                    }
                });
                
                this.canvas.addEventListener('mouseup', (e) => {
                    if (this.gameState === 'playing' && this.isCharging && !this.ball) {
                        this.shoot();
                        this.isCharging = false;
                        this.chargePower = 0;
                    }
                });
                
                // å¤„ç†é¼ æ ‡ç¦»å¼€ç”»å¸ƒçš„æƒ…å†µ
                this.canvas.addEventListener('mouseleave', (e) => {
                    if (this.isCharging) {
                        this.shoot();
                        this.isCharging = false;
                        this.chargePower = 0;
                    }
                });
            }

            startGame() {
                this.gameState = 'playing';
                this.score = 0;
                this.shots = 0;
                this.timeLeft = 60;
                this.ball = null;
                this.ballTrail = [];
                this.isCharging = false;
                this.chargePower = 0;
                
                this.updateUI();
                this.hideMessage();
                document.getElementById('startButton').style.display = 'none';
                this.startTimer();
                this.gameLoop();
            }

            startTimer() {
                if (this.gameTimer) {
                    clearInterval(this.gameTimer);
                }
                
                this.gameTimer = setInterval(() => {
                    if (this.gameState === 'playing') {
                        this.timeLeft--;
                        this.updateUI();
                        
                        if (this.timeLeft <= 0 || this.shots >= this.maxShots) {
                            this.endGame();
                        }
                    }
                }, 1000);
            }

            gameLoop() {
                if (this.gameState === 'playing') {
                    this.update();
                    this.draw();
                    requestAnimationFrame(() => this.gameLoop());
                }
            }

            update() {
                // æ›´æ–°è“„åŠ›
                if (this.isCharging) {
                    this.chargePower += this.chargeSpeed;
                    if (this.chargePower > this.maxPower) {
                        this.chargePower = this.maxPower;
                    }
                }
                
                // æ›´æ–°ç¯®çƒ
                if (this.ball) {
                    this.updateBall();
                }
                
                this.updatePowerBar();
            }

            updateBall() {
                // ä¿å­˜è½¨è¿¹
                this.ballTrail.push({ x: this.ball.x, y: this.ball.y });
                if (this.ballTrail.length > 15) {
                    this.ballTrail.shift();
                }
                
                // æ›´æ–°ä½ç½®
                this.ball.x += this.ball.vx;
                this.ball.y += this.ball.vy;
                
                // åº”ç”¨é‡åŠ›
                this.ball.vy += this.gravity;
                
                // æ£€æŸ¥ç¯®ç­ç¢°æ’
                this.checkBasketCollision();
                
                // è¾¹ç•Œæ£€æµ‹
                if (this.ball.x < 0 || this.ball.x > this.canvas.width || 
                    this.ball.y > this.canvas.height) {
                    this.ballMissed();
                }
                
                // åœ°é¢åå¼¹
                if (this.ball.y + this.ball.radius > this.canvas.height - 50) {
                    this.ball.y = this.canvas.height - 50 - this.ball.radius;
                    this.ball.vy *= -0.6;
                    this.ball.vx *= 0.8;
                    
                    // å¦‚æœé€Ÿåº¦å¤ªå°å°±åœæ­¢
                    if (Math.abs(this.ball.vy) < 2 && Math.abs(this.ball.vx) < 1) {
                        this.ballMissed();
                    }
                }
            }

            checkBasketCollision() {
                const ballBottom = this.ball.y + this.ball.radius;
                const ballTop = this.ball.y - this.ball.radius;
                const ballLeft = this.ball.x - this.ball.radius;
                const ballRight = this.ball.x + this.ball.radius;
                
                // æ£€æŸ¥æ˜¯å¦ä»ä¸Šæ–¹è¿›å…¥ç¯®ç­
                if (ballBottom >= this.basket.y && 
                    ballTop <= this.basket.y + this.basket.height &&
                    ballLeft >= this.basket.rimLeft && 
                    ballRight <= this.basket.rimRight &&
                    this.ball.vy > 0) {
                    
                    // å¾—åˆ†
                    this.score += this.calculateScore();
                    this.showMessage('æŠ•ä¸­äº†ï¼+' + this.calculateScore() + 'åˆ†', 'score');
                    this.ballScored();
                }
                
                // ç¯®ç­è¾¹ç¼˜ç¢°æ’
                if (ballBottom >= this.basket.y && 
                    ballTop <= this.basket.y + this.basket.height) {
                    
                    // å·¦è¾¹ç¼˜
                    if (ballRight >= this.basket.rimLeft && 
                        ballLeft <= this.basket.rimLeft + 10) {
                        this.ball.vx = -Math.abs(this.ball.vx) * 0.7;
                        this.ball.x = this.basket.rimLeft - this.ball.radius;
                    }
                    
                    // å³è¾¹ç¼˜
                    if (ballLeft <= this.basket.rimRight && 
                        ballRight >= this.basket.rimRight - 10) {
                        this.ball.vx = Math.abs(this.ball.vx) * 0.7;
                        this.ball.x = this.basket.rimRight + this.ball.radius;
                    }
                }
            }

            calculateScore() {
                // æ ¹æ®è·ç¦»å’Œè§’åº¦è®¡ç®—å¾—åˆ†
                const distance = Math.sqrt(
                    Math.pow(this.player.x - this.basket.x, 2) + 
                    Math.pow(this.player.y - this.basket.y, 2)
                );
                
                if (distance > 400) return 3; // ä¸‰åˆ†çƒ
                if (distance > 200) return 2; // ä¸­æŠ•
                return 1; // è¿‘æŠ•
            }

            shoot() {
                if (this.ball || this.shots >= this.maxShots) return;
                
                this.shots++;
                
                // è®¡ç®—å°„å‡»è§’åº¦å’ŒåŠ›åº¦
                const dx = this.mouse.x - (this.player.x + this.player.width / 2);
                const dy = this.mouse.y - (this.player.y + this.player.height / 2);
                const distance = Math.sqrt(dx * dx + dy * dy);
                
                if (distance === 0) return;
                
                const power = this.chargePower / 100;
                const baseVelocity = 12 + power * 8;
                
                this.ball = {
                    x: this.player.x + this.player.width / 2,
                    y: this.player.y + this.player.height / 2,
                    radius: 12,
                    vx: (dx / distance) * baseVelocity,
                    vy: (dy / distance) * baseVelocity,
                    color: '#e17055'
                };
                
                this.ballTrail = [];
                this.updateUI();
            }

            ballScored() {
                setTimeout(() => {
                    this.ball = null;
                    this.ballTrail = [];
                    this.hideMessage();
                }, 1000);
            }

            ballMissed() {
                this.showMessage('æŠ•ç¯®åäº†ï¼', 'miss');
                setTimeout(() => {
                    this.ball = null;
                    this.ballTrail = [];
                    this.hideMessage();
                }, 1000);
            }

            updatePowerBar() {
                const powerBarFill = document.getElementById('powerBarFill');
                const percentage = (this.chargePower / this.maxPower) * 100;
                powerBarFill.style.width = percentage + '%';
            }

            endGame() {
                this.gameState = 'gameOver';
                if (this.gameTimer) {
                    clearInterval(this.gameTimer);
                }
                
                let resultText = `æ¸¸æˆç»“æŸï¼æœ€ç»ˆå¾—åˆ†ï¼š${this.score}åˆ†`;
                if (this.score >= 40) {
                    resultText += ' - ç¯®çƒé«˜æ‰‹ï¼';
                } else if (this.score >= 20) {
                    resultText += ' - ä¸é”™çš„è¡¨ç°ï¼';
                } else {
                    resultText += ' - ç»§ç»­ç»ƒä¹ ï¼';
                }
                
                this.showMessage(resultText, 'game-over');
                document.getElementById('startButton').style.display = 'block';
                document.getElementById('startButton').textContent = 'é‡æ–°å¼€å§‹';
            }

            draw() {
                // æ¸…ç©ºç”»å¸ƒ
                this.ctx.fillStyle = '#e17055';
                this.ctx.fillRect(0, 0, this.canvas.width, this.canvas.height);
                
                // ç»˜åˆ¶çƒåœº
                this.drawCourt();
                
                // ç»˜åˆ¶ç¯®ç­
                this.drawBasket();
                
                // ç»˜åˆ¶çƒå‘˜
                this.drawPlayer();
                
                // ç»˜åˆ¶ç¯®çƒè½¨è¿¹
                if (this.ballTrail.length > 1) {
                    this.drawBallTrail();
                }
                
                // ç»˜åˆ¶ç¯®çƒ
                if (this.ball) {
                    this.drawBall();
                }
                
                // ç»˜åˆ¶ç„å‡†çº¿
                if (!this.ball && this.gameState === 'playing') {
                    this.drawAimLine();
                }
                
                // ç»˜åˆ¶è“„åŠ›æŒ‡ç¤ºå™¨
                if (this.isCharging) {
                    this.drawChargeIndicator();
                }
            }

            drawCourt() {
                // åœ°é¢
                this.ctx.fillStyle = '#8b4513';
                this.ctx.fillRect(0, this.canvas.height - 50, this.canvas.width, 50);
                
                // çƒåœºçº¿æ¡
                this.ctx.strokeStyle = 'white';
                this.ctx.lineWidth = 3;
                
                // ä¸‰åˆ†çº¿ï¼ˆç®€åŒ–ï¼‰
                this.ctx.beginPath();
                this.ctx.arc(this.basket.x + this.basket.width / 2, this.canvas.height - 50, 300, -Math.PI, 0);
                this.ctx.stroke();
                
                // ç½šçƒçº¿
                this.ctx.beginPath();
                this.ctx.moveTo(this.basket.x - 100, this.canvas.height - 50);
                this.ctx.lineTo(this.basket.x - 100, this.canvas.height - 200);
                this.ctx.stroke();
            }

            drawBasket() {
                // ç¯®æ¿
                this.ctx.fillStyle = '#2d3436';
                this.ctx.fillRect(this.basket.x + 60, this.basket.y - 80, 10, 100);
                
                // ç¯®ç­
                this.ctx.strokeStyle = '#fd79a8';
                this.ctx.lineWidth = 5;
                this.ctx.beginPath();
                this.ctx.moveTo(this.basket.rimLeft, this.basket.y);
                this.ctx.lineTo(this.basket.rimRight, this.basket.y);
                this.ctx.stroke();
                
                // ç¯®ç½‘
                this.ctx.strokeStyle = 'white';
                this.ctx.lineWidth = 2;
                for (let i = 0; i < this.basket.netPoints.length - 1; i++) {
                    this.ctx.beginPath();
                    this.ctx.moveTo(this.basket.netPoints[i].x, this.basket.netPoints[i].y);
                    this.ctx.lineTo(this.basket.netPoints[i + 1].x, this.basket.netPoints[i + 1].y);
                    this.ctx.stroke();
                }
                
                // å‚ç›´ç½‘çº¿
                const netSegments = 6;
                for (let i = 1; i < netSegments; i++) {
                    const x = this.basket.rimLeft + (this.basket.width * i / netSegments);
                    this.ctx.beginPath();
                    this.ctx.moveTo(x, this.basket.y + 15);
                    this.ctx.lineTo(x, this.basket.y + 35);
                    this.ctx.stroke();
                }
            }

            drawPlayer() {
                // çƒå‘˜èº«ä½“
                this.ctx.fillStyle = '#74b9ff';
                this.ctx.fillRect(this.player.x, this.player.y, this.player.width, this.player.height);
                
                // çƒå‘˜å¤´éƒ¨
                this.ctx.fillStyle = '#fdcb6e';
                this.ctx.beginPath();
                this.ctx.arc(this.player.x + this.player.width / 2, this.player.y - 10, 15, 0, Math.PI * 2);
                this.ctx.fill();
                
                // çƒå‘˜æ‰‹è‡‚ï¼ˆæŠ•ç¯®å§¿åŠ¿ï¼‰
                if (this.isCharging) {
                    this.ctx.strokeStyle = '#74b9ff';
                    this.ctx.lineWidth = 4;
                    this.ctx.beginPath();
                    this.ctx.moveTo(this.player.x + this.player.width / 2, this.player.y + 20);
                    this.ctx.lineTo(this.player.x + this.player.width / 2 + 20, this.player.y - 10);
                    this.ctx.stroke();
                }
            }

            drawBallTrail() {
                for (let i = 0; i < this.ballTrail.length; i++) {
                    const alpha = i / this.ballTrail.length;
                    const size = (i / this.ballTrail.length) * this.ball.radius;
                    
                    this.ctx.fillStyle = `rgba(225, 112, 85, ${alpha * 0.6})`;
                    this.ctx.beginPath();
                    this.ctx.arc(this.ballTrail[i].x, this.ballTrail[i].y, size, 0, Math.PI * 2);
                    this.ctx.fill();
                }
            }

            drawBall() {
                // ç¯®çƒä¸»ä½“
                this.ctx.fillStyle = this.ball.color;
                this.ctx.beginPath();
                this.ctx.arc(this.ball.x, this.ball.y, this.ball.radius, 0, Math.PI * 2);
                this.ctx.fill();
                
                // ç¯®çƒçº¿æ¡
                this.ctx.strokeStyle = '#2d3436';
                this.ctx.lineWidth = 2;
                
                // æ°´å¹³çº¿
                this.ctx.beginPath();
                this.ctx.moveTo(this.ball.x - this.ball.radius, this.ball.y);
                this.ctx.lineTo(this.ball.x + this.ball.radius, this.ball.y);
                this.ctx.stroke();
                
                // å‚ç›´çº¿
                this.ctx.beginPath();
                this.ctx.moveTo(this.ball.x, this.ball.y - this.ball.radius);
                this.ctx.lineTo(this.ball.x, this.ball.y + this.ball.radius);
                this.ctx.stroke();
                
                // å¼§çº¿
                this.ctx.beginPath();
                this.ctx.arc(this.ball.x, this.ball.y, this.ball.radius * 0.7, 0, Math.PI);
                this.ctx.stroke();
                
                this.ctx.beginPath();
                this.ctx.arc(this.ball.x, this.ball.y, this.ball.radius * 0.7, Math.PI, Math.PI * 2);
                this.ctx.stroke();
            }

            drawAimLine() {
                this.ctx.strokeStyle = 'rgba(255, 255, 255, 0.5)';
                this.ctx.lineWidth = 2;
                this.ctx.setLineDash([5, 5]);
                
                this.ctx.beginPath();
                this.ctx.moveTo(this.player.x + this.player.width / 2, this.player.y + this.player.height / 2);
                this.ctx.lineTo(this.mouse.x, this.mouse.y);
                this.ctx.stroke();
                
                this.ctx.setLineDash([]);
            }

            drawChargeIndicator() {
                const centerX = this.player.x + this.player.width / 2;
                const centerY = this.player.y - 40;
                const radius = 20;
                const percentage = this.chargePower / this.maxPower;
                
                // èƒŒæ™¯åœ†
                this.ctx.strokeStyle = 'rgba(255, 255, 255, 0.3)';
                this.ctx.lineWidth = 4;
                this.ctx.beginPath();
                this.ctx.arc(centerX, centerY, radius, 0, Math.PI * 2);
                this.ctx.stroke();
                
                // è“„åŠ›åœ†
                this.ctx.strokeStyle = percentage > 0.8 ? '#e17055' : '#00b894';
                this.ctx.lineWidth = 4;
                this.ctx.beginPath();
                this.ctx.arc(centerX, centerY, radius, -Math.PI / 2, -Math.PI / 2 + Math.PI * 2 * percentage);
                this.ctx.stroke();
            }

            updateUI() {
                document.getElementById('score').textContent = this.score;
                document.getElementById('shots').textContent = this.shots;
                document.getElementById('time').textContent = this.timeLeft;
            }

            showMessage(text, type) {
                const message = document.getElementById('message');
                message.textContent = text;
                message.className = `message ${type} show`;
            }

            hideMessage() {
                const message = document.getElementById('message');
                message.classList.remove('show');
            }
        }

        // å¯åŠ¨æ¸¸æˆ
        window.addEventListener('load', () => {
            new BasketballGame();
        });
    </script>
</body>
</html>