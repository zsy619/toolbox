<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Â§ßÂØåÁøÅ - Âú∞‰∫ßÁ≠ñÁï•Ê∏∏Êàè</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 20px;
        }

        .game-container {
            background: white;
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
            max-width: 900px;
            width: 100%;
        }

        .game-header {
            text-align: center;
            margin-bottom: 30px;
        }

        .game-title {
            font-size: 2.5em;
            font-weight: 700;
            color: #2c3e50;
            margin-bottom: 10px;
        }

        .game-subtitle {
            color: #7f8c8d;
            font-size: 1.1em;
        }

        .board {
            width: 600px;
            height: 600px;
            border: 4px solid #2c3e50;
            position: relative;
            margin: 0 auto 30px;
            background: #ecf0f1;
        }

        .property {
            position: absolute;
            background: white;
            border: 2px solid #34495e;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            font-size: 10px;
            font-weight: bold;
            color: #2c3e50;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .property:hover {
            background: #f8f9fa;
            transform: scale(1.05);
        }

        /* Ê£ãÁõòÂ∏ÉÂ±Ä */
        .property-0 { width: 80px; height: 80px; bottom: 0; right: 0; } /* Ëµ∑ÁÇπ */
        .property-1 { width: 60px; height: 80px; bottom: 0; right: 80px; }
        .property-2 { width: 60px; height: 80px; bottom: 0; right: 140px; }
        .property-3 { width: 60px; height: 80px; bottom: 0; right: 200px; }
        .property-4 { width: 60px; height: 80px; bottom: 0; right: 260px; }
        .property-5 { width: 60px; height: 80px; bottom: 0; right: 320px; }
        .property-6 { width: 60px; height: 80px; bottom: 0; right: 380px; }
        .property-7 { width: 60px; height: 80px; bottom: 0; right: 440px; }
        .property-8 { width: 60px; height: 80px; bottom: 0; right: 500px; }
        .property-9 { width: 80px; height: 80px; bottom: 0; left: 0; } /* ÁõëÁã± */
        
        .property-10 { width: 80px; height: 60px; left: 0; bottom: 80px; }
        .property-11 { width: 80px; height: 60px; left: 0; bottom: 140px; }
        .property-12 { width: 80px; height: 60px; left: 0; bottom: 200px; }
        .property-13 { width: 80px; height: 60px; left: 0; bottom: 260px; }
        .property-14 { width: 80px; height: 60px; left: 0; bottom: 320px; }
        .property-15 { width: 80px; height: 60px; left: 0; bottom: 380px; }
        .property-16 { width: 80px; height: 60px; left: 0; bottom: 440px; }
        .property-17 { width: 80px; height: 60px; left: 0; bottom: 500px; }
        .property-18 { width: 80px; height: 80px; top: 0; left: 0; } /* ÂÖçË¥πÂÅúËΩ¶ */
        
        .property-19 { width: 60px; height: 80px; top: 0; left: 80px; }
        .property-20 { width: 60px; height: 80px; top: 0; left: 140px; }
        .property-21 { width: 60px; height: 80px; top: 0; left: 200px; }
        .property-22 { width: 60px; height: 80px; top: 0; left: 260px; }
        .property-23 { width: 60px; height: 80px; top: 0; left: 320px; }
        .property-24 { width: 60px; height: 80px; top: 0; left: 380px; }
        .property-25 { width: 60px; height: 80px; top: 0; left: 440px; }
        .property-26 { width: 60px; height: 80px; top: 0; left: 500px; }
        .property-27 { width: 80px; height: 80px; top: 0; right: 0; } /* ËøõÁõëÁã± */
        
        .property-28 { width: 80px; height: 60px; right: 0; top: 80px; }
        .property-29 { width: 80px; height: 60px; right: 0; top: 140px; }
        .property-30 { width: 80px; height: 60px; right: 0; top: 200px; }
        .property-31 { width: 80px; height: 60px; right: 0; top: 260px; }
        .property-32 { width: 80px; height: 60px; right: 0; top: 320px; }
        .property-33 { width: 80px; height: 60px; right: 0; top: 380px; }
        .property-34 { width: 80px; height: 60px; right: 0; top: 440px; }
        .property-35 { width: 80px; height: 60px; right: 0; top: 500px; }

        .player {
            position: absolute;
            width: 20px;
            height: 20px;
            border-radius: 50%;
            z-index: 10;
            transition: all 0.5s ease;
            border: 2px solid white;
            box-shadow: 0 2px 4px rgba(0,0,0,0.3);
        }

        .player-1 { background: #e74c3c; }
        .player-2 { background: #3498db; }
        .player-3 { background: #2ecc71; }
        .player-4 { background: #f39c12; }

        .game-info {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 20px;
        }

        .player-info {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 10px;
            border: 2px solid #dee2e6;
        }

        .player-info.current {
            border-color: #007bff;
            background: #e3f2fd;
        }

        .player-name {
            font-weight: bold;
            color: #2c3e50;
            margin-bottom: 5px;
        }

        .player-money {
            color: #27ae60;
            font-size: 1.1em;
            font-weight: bold;
        }

        .game-controls {
            text-align: center;
            margin-bottom: 20px;
        }

        .btn {
            background: #007bff;
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 8px;
            font-size: 1em;
            font-weight: 600;
            cursor: pointer;
            margin: 0 10px;
            transition: all 0.3s ease;
        }

        .btn:hover {
            background: #0056b3;
            transform: translateY(-2px);
        }

        .btn:disabled {
            background: #6c757d;
            cursor: not-allowed;
            transform: none;
        }

        .dice-result {
            display: inline-block;
            background: #fff;
            color: #333;
            padding: 8px 16px;
            border-radius: 8px;
            margin: 0 10px;
            font-weight: bold;
            border: 2px solid #007bff;
        }

        .property-info {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 10px;
            margin-top: 20px;
            border: 2px solid #dee2e6;
        }

        .property-color {
            width: 100%;
            height: 20px;
            margin-bottom: 10px;
            border-radius: 4px;
        }

        .owned {
            opacity: 0.8;
        }

        .house {
            position: absolute;
            width: 8px;
            height: 8px;
            background: #27ae60;
            border-radius: 2px;
            z-index: 5;
        }

        .hotel {
            position: absolute;
            width: 12px;
            height: 8px;
            background: #e74c3c;
            border-radius: 2px;
            z-index: 5;
        }

        @media (max-width: 768px) {
            .board {
                width: 400px;
                height: 400px;
            }
            
            .property {
                font-size: 8px;
            }
            
            .property-0, .property-9, .property-18, .property-27 { 
                width: 53px; height: 53px; 
            }
            
            .property-1, .property-2, .property-3, .property-4, .property-5, .property-6, .property-7, .property-8,
            .property-19, .property-20, .property-21, .property-22, .property-23, .property-24, .property-25, .property-26 { 
                width: 40px; height: 53px; 
            }
            
            .property-10, .property-11, .property-12, .property-13, .property-14, .property-15, .property-16, .property-17,
            .property-28, .property-29, .property-30, .property-31, .property-32, .property-33, .property-34, .property-35 { 
                width: 53px; height: 40px; 
            }

            /* ÈáçÊñ∞ÂÆö‰ΩçÁßªÂä®Á´ØÂ±ûÊÄß */
            .property-1 { right: 53px; }
            .property-2 { right: 93px; }
            .property-3 { right: 133px; }
            .property-4 { right: 173px; }
            .property-5 { right: 213px; }
            .property-6 { right: 253px; }
            .property-7 { right: 293px; }
            .property-8 { right: 333px; }
            
            .property-10 { bottom: 53px; }
            .property-11 { bottom: 93px; }
            .property-12 { bottom: 133px; }
            .property-13 { bottom: 173px; }
            .property-14 { bottom: 213px; }
            .property-15 { bottom: 253px; }
            .property-16 { bottom: 293px; }
            .property-17 { bottom: 333px; }
            
            .property-19 { left: 53px; }
            .property-20 { left: 93px; }
            .property-21 { left: 133px; }
            .property-22 { left: 173px; }
            .property-23 { left: 213px; }
            .property-24 { left: 253px; }
            .property-25 { left: 293px; }
            .property-26 { left: 333px; }
            
            .property-28 { top: 53px; }
            .property-29 { top: 93px; }
            .property-30 { top: 133px; }
            .property-31 { top: 173px; }
            .property-32 { top: 213px; }
            .property-33 { top: 253px; }
            .property-34 { top: 293px; }
            .property-35 { top: 333px; }
        }
    </style>
</head>
<body>
    <div class="game-container">
        <div class="game-header">
            <h1 class="game-title">üè† Â§ßÂØåÁøÅ</h1>
            <p class="game-subtitle">Âú∞‰∫ßÁ≠ñÁï•Ê∏∏Êàè - Êàê‰∏∫ÊúÄÂØåÊúâÁöÑÁé©ÂÆ∂ÔºÅ</p>
        </div>

        <div class="game-info" id="gameInfo"></div>

        <div class="board" id="board"></div>

        <div class="game-controls">
            <button class="btn" id="rollDice">üé≤ Êé∑È™∞Â≠ê</button>
            <span class="dice-result" id="diceResult" style="display: none;"></span>
            <button class="btn" id="buyProperty" style="display: none;">üí∞ Ë¥≠‰π∞Âú∞‰∫ß</button>
            <button class="btn" id="endTurn" style="display: none;">‚úÖ ÁªìÊùüÂõûÂêà</button>
        </div>

        <div class="property-info" id="propertyInfo" style="display: none;"></div>
    </div>

    <script>
        class Monopoly {
            constructor() {
                this.players = [
                    { id: 1, name: 'Áé©ÂÆ∂1', money: 1500, position: 0, properties: [], inJail: false, jailTurns: 0 },
                    { id: 2, name: 'Áé©ÂÆ∂2', money: 1500, position: 0, properties: [], inJail: false, jailTurns: 0 },
                    { id: 3, name: 'Áé©ÂÆ∂3', money: 1500, position: 0, properties: [], inJail: false, jailTurns: 0 },
                    { id: 4, name: 'Áé©ÂÆ∂4', money: 1500, position: 0, properties: [], inJail: false, jailTurns: 0 }
                ];
                this.currentPlayer = 0;
                this.gamePhase = 'roll'; // roll, action, end
                this.lastDiceRoll = 0;
                
                this.properties = this.initProperties();
                this.initBoard();
                this.updateGameInfo();
                this.bindEvents();
            }

            initProperties() {
                return [
                    { id: 0, name: 'Ëµ∑ÁÇπ', type: 'start', price: 0, rent: 0, color: 'none' },
                    { id: 1, name: '‰∏≠Â±±Ë∑Ø', type: 'property', price: 60, rent: 2, color: 'brown', owner: null, houses: 0 },
                    { id: 2, name: 'Á§æÂå∫Âü∫Èáë', type: 'chance', price: 0, rent: 0, color: 'none' },
                    { id: 3, name: 'Âçó‰∫¨Ë∑Ø', type: 'property', price: 60, rent: 4, color: 'brown', owner: null, houses: 0 },
                    { id: 4, name: 'ÊâÄÂæóÁ®é', type: 'tax', price: 200, rent: 0, color: 'none' },
                    { id: 5, name: '‰∏úÁ´ô', type: 'station', price: 200, rent: 25, color: 'station', owner: null },
                    { id: 6, name: '‰∏úÊñπË∑Ø', type: 'property', price: 100, rent: 6, color: 'lightblue', owner: null, houses: 0 },
                    { id: 7, name: 'Êú∫‰ºö', type: 'chance', price: 0, rent: 0, color: 'none' },
                    { id: 8, name: 'Ë•øËóèË∑Ø', type: 'property', price: 100, rent: 6, color: 'lightblue', owner: null, houses: 0 },
                    { id: 9, name: 'ÁõëÁã±', type: 'jail', price: 0, rent: 0, color: 'none' },
                    { id: 10, name: 'Á¶èÂ∑ûË∑Ø', type: 'property', price: 120, rent: 8, color: 'pink', owner: null, houses: 0 },
                    { id: 11, name: 'ÁîµÂäõÂÖ¨Âè∏', type: 'utility', price: 150, rent: 0, color: 'utility', owner: null },
                    { id: 12, name: 'ÂçóÊòåË∑Ø', type: 'property', price: 140, rent: 10, color: 'pink', owner: null, houses: 0 },
                    { id: 13, name: 'ÂõõÂ∑ùË∑Ø', type: 'property', price: 160, rent: 12, color: 'pink', owner: null, houses: 0 },
                    { id: 14, name: 'Ë•øÁ´ô', type: 'station', price: 200, rent: 25, color: 'station', owner: null },
                    { id: 15, name: 'Âåó‰∫¨Ë∑Ø', type: 'property', price: 180, rent: 14, color: 'orange', owner: null, houses: 0 },
                    { id: 16, name: 'Á§æÂå∫Âü∫Èáë', type: 'chance', price: 0, rent: 0, color: 'none' },
                    { id: 17, name: 'Â§©Ê¥•Ë∑Ø', type: 'property', price: 180, rent: 14, color: 'orange', owner: null, houses: 0 },
                    { id: 18, name: 'ÂÖçË¥πÂÅúËΩ¶', type: 'free', price: 0, rent: 0, color: 'none' },
                    { id: 19, name: 'ÊµôÊ±üË∑Ø', type: 'property', price: 220, rent: 18, color: 'red', owner: null, houses: 0 },
                    { id: 20, name: 'Êú∫‰ºö', type: 'chance', price: 0, rent: 0, color: 'none' },
                    { id: 21, name: 'ÊπñÂçóË∑Ø', type: 'property', price: 220, rent: 18, color: 'red', owner: null, houses: 0 },
                    { id: 22, name: 'Âπø‰∏úË∑Ø', type: 'property', price: 240, rent: 20, color: 'red', owner: null, houses: 0 },
                    { id: 23, name: 'ÂçóÁ´ô', type: 'station', price: 200, rent: 25, color: 'station', owner: null },
                    { id: 24, name: 'Ê±üËãèË∑Ø', type: 'property', price: 260, rent: 22, color: 'yellow', owner: null, houses: 0 },
                    { id: 25, name: 'ÂÆâÂæΩË∑Ø', type: 'property', price: 260, rent: 22, color: 'yellow', owner: null, houses: 0 },
                    { id: 26, name: 'Ëá™Êù•Ê∞¥ÂÖ¨Âè∏', type: 'utility', price: 150, rent: 0, color: 'utility', owner: null },
                    { id: 27, name: 'ËøõÁõëÁã±', type: 'gotoJail', price: 0, rent: 0, color: 'none' },
                    { id: 28, name: 'Ê≤≥ÂåóË∑Ø', type: 'property', price: 300, rent: 26, color: 'green', owner: null, houses: 0 },
                    { id: 29, name: 'Ê≤≥ÂçóË∑Ø', type: 'property', price: 300, rent: 26, color: 'green', owner: null, houses: 0 },
                    { id: 30, name: 'Á§æÂå∫Âü∫Èáë', type: 'chance', price: 0, rent: 0, color: 'none' },
                    { id: 31, name: 'ÊπñÂåóË∑Ø', type: 'property', price: 320, rent: 28, color: 'green', owner: null, houses: 0 },
                    { id: 32, name: 'ÂåóÁ´ô', type: 'station', price: 200, rent: 25, color: 'station', owner: null },
                    { id: 33, name: 'Êú∫‰ºö', type: 'chance', price: 0, rent: 0, color: 'none' },
                    { id: 34, name: 'Âè∞ÊπæË∑Ø', type: 'property', price: 350, rent: 35, color: 'darkblue', owner: null, houses: 0 },
                    { id: 35, name: 'È¶ôÊ∏ØË∑Ø', type: 'property', price: 400, rent: 50, color: 'darkblue', owner: null, houses: 0 }
                ];
            }

            initBoard() {
                const board = document.getElementById('board');
                
                // ÂàõÂª∫Âú∞‰∫ßÊ†ºÂ≠ê
                this.properties.forEach((property, index) => {
                    const propertyDiv = document.createElement('div');
                    propertyDiv.className = `property property-${index}`;
                    propertyDiv.innerHTML = `
                        <div style="font-size: 8px; text-align: center; padding: 2px;">
                            ${property.name}
                        </div>
                    `;
                    
                    if (property.color !== 'none') {
                        const colorBar = document.createElement('div');
                        colorBar.style.cssText = `
                            position: absolute;
                            top: 0;
                            left: 0;
                            right: 0;
                            height: 15px;
                            background: ${this.getColorCode(property.color)};
                        `;
                        propertyDiv.appendChild(colorBar);
                    }
                    
                    propertyDiv.addEventListener('click', () => this.showPropertyInfo(property));
                    board.appendChild(propertyDiv);
                });

                // ÂàõÂª∫Áé©ÂÆ∂Ê£ãÂ≠ê
                this.players.forEach((player, index) => {
                    const playerDiv = document.createElement('div');
                    playerDiv.className = `player player-${player.id}`;
                    playerDiv.id = `player-${player.id}`;
                    board.appendChild(playerDiv);
                    this.updatePlayerPosition(player.id, 0);
                });
            }

            getColorCode(color) {
                const colors = {
                    'brown': '#8B4513',
                    'lightblue': '#87CEEB',
                    'pink': '#FF69B4',
                    'orange': '#FFA500',
                    'red': '#FF0000',
                    'yellow': '#FFFF00',
                    'green': '#008000',
                    'darkblue': '#000080',
                    'station': '#000000',
                    'utility': '#708090'
                };
                return colors[color] || '#CCCCCC';
            }

            updatePlayerPosition(playerId, position) {
                const playerElement = document.getElementById(`player-${playerId}`);
                const propertyElement = document.querySelector(`.property-${position}`);
                
                if (playerElement && propertyElement) {
                    const rect = propertyElement.getBoundingClientRect();
                    const boardRect = document.getElementById('board').getBoundingClientRect();
                    
                    const x = rect.left - boardRect.left + (playerId - 1) * 22 + 10;
                    const y = rect.top - boardRect.top + 10;
                    
                    playerElement.style.left = `${x}px`;
                    playerElement.style.top = `${y}px`;
                }
            }

            updateGameInfo() {
                const gameInfo = document.getElementById('gameInfo');
                gameInfo.innerHTML = this.players.map((player, index) => `
                    <div class="player-info ${index === this.currentPlayer ? 'current' : ''}">
                        <div class="player-name">üèÉ ${player.name}</div>
                        <div class="player-money">üí∞ $${player.money}</div>
                        <div style="font-size: 0.9em; color: #666; margin-top: 5px;">
                            Âú∞‰∫ß: ${player.properties.length}‰∏™
                            ${player.inJail ? 'üè¢ Âú®ÁõëÁã±' : ''}
                        </div>
                    </div>
                `).join('');
            }

            bindEvents() {
                document.getElementById('rollDice').addEventListener('click', () => this.rollDice());
                document.getElementById('buyProperty').addEventListener('click', () => this.buyProperty());
                document.getElementById('endTurn').addEventListener('click', () => this.endTurn());
            }

            rollDice() {
                if (this.gamePhase !== 'roll') return;
                
                const currentPlayer = this.players[this.currentPlayer];
                
                if (currentPlayer.inJail) {
                    if (currentPlayer.jailTurns >= 3) {
                        currentPlayer.money -= 50;
                        currentPlayer.inJail = false;
                        currentPlayer.jailTurns = 0;
                        this.showMessage(`${currentPlayer.name} Áº¥Á∫≥$50Âá∫Áã±ÔºÅ`);
                    } else {
                        currentPlayer.jailTurns++;
                        this.showMessage(`${currentPlayer.name} Âú®ÁõëÁã±Á¨¨${currentPlayer.jailTurns}ÂõûÂêà`);
                        this.endTurn();
                        return;
                    }
                }
                
                const dice1 = Math.floor(Math.random() * 6) + 1;
                const dice2 = Math.floor(Math.random() * 6) + 1;
                this.lastDiceRoll = dice1 + dice2;
                
                document.getElementById('diceResult').textContent = `üé≤ ${dice1} + ${dice2} = ${this.lastDiceRoll}`;
                document.getElementById('diceResult').style.display = 'inline-block';
                
                // ÁßªÂä®Áé©ÂÆ∂
                currentPlayer.position = (currentPlayer.position + this.lastDiceRoll) % 36;
                this.updatePlayerPosition(currentPlayer.id, currentPlayer.position);
                
                // ÁªèËøáËµ∑ÁÇπËé∑Âæó$200
                if (currentPlayer.position + this.lastDiceRoll >= 36) {
                    currentPlayer.money += 200;
                    this.showMessage(`${currentPlayer.name} ÁªèËøáËµ∑ÁÇπÔºåËé∑Âæó$200ÔºÅ`);
                }
                
                this.handleLanding();
                this.gamePhase = 'action';
                document.getElementById('rollDice').style.display = 'none';
            }

            handleLanding() {
                const currentPlayer = this.players[this.currentPlayer];
                const property = this.properties[currentPlayer.position];
                
                this.showPropertyInfo(property);
                
                switch (property.type) {
                    case 'property':
                    case 'station':
                    case 'utility':
                        if (property.owner === null) {
                            // ÂèØË¥≠‰π∞
                            document.getElementById('buyProperty').style.display = 'inline-block';
                        } else if (property.owner !== currentPlayer.id) {
                            // ÈúÄË¶ÅÁº¥Á∫≥ÁßüÈáë
                            const rent = this.calculateRent(property);
                            currentPlayer.money -= rent;
                            const owner = this.players.find(p => p.id === property.owner);
                            owner.money += rent;
                            this.showMessage(`${currentPlayer.name} Âêë${owner.name}ÊîØ‰ªòÁßüÈáë$${rent}`);
                        }
                        break;
                        
                    case 'tax':
                        currentPlayer.money -= property.price;
                        this.showMessage(`${currentPlayer.name} Áº¥Á∫≥Á®éË¥π$${property.price}`);
                        break;
                        
                    case 'gotoJail':
                        currentPlayer.position = 9; // ÁõëÁã±‰ΩçÁΩÆ
                        currentPlayer.inJail = true;
                        currentPlayer.jailTurns = 0;
                        this.updatePlayerPosition(currentPlayer.id, 9);
                        this.showMessage(`${currentPlayer.name} Ë¢´ÊäìËøõÁõëÁã±ÔºÅ`);
                        break;
                        
                    case 'chance':
                        this.drawChanceCard();
                        break;
                        
                    case 'start':
                        currentPlayer.money += 200;
                        this.showMessage(`${currentPlayer.name} Âà∞ËææËµ∑ÁÇπÔºåËé∑Âæó$200ÔºÅ`);
                        break;
                }
                
                document.getElementById('endTurn').style.display = 'inline-block';
            }

            calculateRent(property) {
                if (property.type === 'utility') {
                    return this.lastDiceRoll * 4;
                }
                return property.rent + (property.houses || 0) * 50;
            }

            drawChanceCard() {
                const currentPlayer = this.players[this.currentPlayer];
                const cards = [
                    { text: 'Ëé∑ÂæóÈì∂Ë°åËÇ°ÊÅØ$50', money: 50 },
                    { text: 'Áº¥Á∫≥ÊàøÂ±ã‰øÆÁêÜË¥π$25', money: -25 },
                    { text: '‰∏≠Â•ñËé∑Âæó$100', money: 100 },
                    { text: 'Áº¥Á∫≥ÁΩöÊ¨æ$50', money: -50 },
                    { text: 'ÂâçËøõÂà∞Ëµ∑ÁÇπ', position: 0, passStart: true },
                    { text: 'ÂêéÈÄÄ3Ê†º', move: -3 }
                ];
                
                const card = cards[Math.floor(Math.random() * cards.length)];
                
                if (card.money) {
                    currentPlayer.money += card.money;
                }
                
                if (card.position !== undefined) {
                    if (card.passStart && currentPlayer.position > card.position) {
                        currentPlayer.money += 200;
                    }
                    currentPlayer.position = card.position;
                    this.updatePlayerPosition(currentPlayer.id, currentPlayer.position);
                }
                
                if (card.move) {
                    currentPlayer.position = Math.max(0, currentPlayer.position + card.move);
                    this.updatePlayerPosition(currentPlayer.id, currentPlayer.position);
                }
                
                this.showMessage(`${currentPlayer.name} ÊäΩÂà∞: ${card.text}`);
            }

            buyProperty() {
                const currentPlayer = this.players[this.currentPlayer];
                const property = this.properties[currentPlayer.position];
                
                if (currentPlayer.money >= property.price) {
                    currentPlayer.money -= property.price;
                    currentPlayer.properties.push(property.id);
                    property.owner = currentPlayer.id;
                    
                    // Ê†áËÆ∞‰∏∫Â∑≤Êã•Êúâ
                    const propertyElement = document.querySelector(`.property-${currentPlayer.position}`);
                    propertyElement.classList.add('owned');
                    propertyElement.style.borderColor = this.getPlayerColor(currentPlayer.id);
                    
                    this.showMessage(`${currentPlayer.name} Ë¥≠‰π∞‰∫Ü${property.name}ÔºÅ`);
                    document.getElementById('buyProperty').style.display = 'none';
                } else {
                    this.showMessage(`${currentPlayer.name} ËµÑÈáë‰∏çË∂≥ÔºÅ`);
                }
            }

            getPlayerColor(playerId) {
                const colors = ['#e74c3c', '#3498db', '#2ecc71', '#f39c12'];
                return colors[playerId - 1];
            }

            endTurn() {
                this.gamePhase = 'roll';
                this.currentPlayer = (this.currentPlayer + 1) % this.players.length;
                
                document.getElementById('rollDice').style.display = 'inline-block';
                document.getElementById('buyProperty').style.display = 'none';
                document.getElementById('endTurn').style.display = 'none';
                document.getElementById('diceResult').style.display = 'none';
                document.getElementById('propertyInfo').style.display = 'none';
                
                this.updateGameInfo();
                
                // Ê£ÄÊü•ÊòØÂê¶ÊúâÁé©ÂÆ∂Á†¥‰∫ß
                this.checkBankruptcy();
            }

            checkBankruptcy() {
                const activePlayers = this.players.filter(p => p.money >= 0);
                if (activePlayers.length === 1) {
                    this.showMessage(`üéâ Ê∏∏ÊàèÁªìÊùüÔºÅ${activePlayers[0].name} Ëé∑ËÉúÔºÅ`);
                    document.getElementById('rollDice').disabled = true;
                }
            }

            showPropertyInfo(property) {
                const propertyInfo = document.getElementById('propertyInfo');
                const owner = property.owner ? this.players.find(p => p.id === property.owner) : null;
                
                propertyInfo.innerHTML = `
                    <h3>üìç ${property.name}</h3>
                    ${property.color !== 'none' ? `<div class="property-color" style="background: ${this.getColorCode(property.color)};"></div>` : ''}
                    <p><strong>Á±ªÂûã:</strong> ${this.getPropertyTypeText(property.type)}</p>
                    ${property.price > 0 ? `<p><strong>‰ª∑Ê†º:</strong> $${property.price}</p>` : ''}
                    ${property.rent > 0 ? `<p><strong>ÁßüÈáë:</strong> $${property.rent}</p>` : ''}
                    ${owner ? `<p><strong>Êã•ÊúâËÄÖ:</strong> ${owner.name}</p>` : ''}
                    ${property.houses > 0 ? `<p><strong>ÊàøÂ±ã:</strong> ${property.houses}Ê†ã</p>` : ''}
                `;
                propertyInfo.style.display = 'block';
            }

            getPropertyTypeText(type) {
                const types = {
                    'property': 'Âú∞‰∫ß',
                    'station': 'ËΩ¶Á´ô',
                    'utility': 'ÂÖ¨Áî®‰∫ã‰∏ö',
                    'start': 'Ëµ∑ÁÇπ',
                    'jail': 'ÁõëÁã±',
                    'free': 'ÂÖçË¥πÂÅúËΩ¶',
                    'gotoJail': 'ËøõÁõëÁã±',
                    'tax': 'Á®éÊî∂',
                    'chance': 'Êú∫‰ºö/Á§æÂå∫Âü∫Èáë'
                };
                return types[type] || 'Êú™Áü•';
            }

            showMessage(message) {
                // ÁÆÄÂçïÁöÑÊ∂àÊÅØÊòæÁ§∫ÔºåÂèØ‰ª•Êâ©Â±ï‰∏∫Êõ¥Â•ΩÁöÑUI
                console.log(message);
                // ÂèØ‰ª•Ê∑ªÂä†‰∏Ä‰∏™Ê∂àÊÅØÊòæÁ§∫Âå∫Âüü
            }
        }

        // ÂêØÂä®Ê∏∏Êàè
        window.addEventListener('load', () => {
            new Monopoly();
        });
    </script>
</body>
</html>