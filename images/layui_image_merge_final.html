<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- SEO优化信息 -->
    <title>专业级在线图片拼图工具 - 免费多图合并 | 支持2-15张图片拼接</title>
    <meta name="description" content="专业的在线图片拼图工具，支持2-15张图片自由拼接合并。提供多种布局模式、自定义尺寸比例、图片缩放功能。免费使用，无需注册，支持JPG、PNG、WebP格式导出。">
    <meta name="keywords" content="图片拼图,图片合并,在线拼图,多图合并,照片拼接,图片编辑,免费拼图工具">
    <meta name="author" content="专业工具箱">
    <meta name="robots" content="index, follow">
    <!-- Open Graph / Facebook -->
    <meta property="og:type" content="website">
    <meta property="og:url" content="">
    <meta property="og:title" content="专业级在线图片拼图工具 - 免费多图合并">
    <meta property="og:description" content="支持2-15张图片自由拼接，多种布局模式，自定义尺寸比例，专业的在线图片拼图工具">
    <meta property="og:image" content="">
    <!-- Twitter -->
    <meta property="twitter:card" content="summary_large_image">
    <meta property="twitter:url" content="">
    <meta property="twitter:title" content="专业级在线图片拼图工具">
    <meta property="twitter:description" content="免费的多图合并拼接工具，支持多种布局和导出格式">
    <meta property="twitter:image" content="">
    <!-- Canonical URL -->
    <link rel="canonical" href="">
    <!-- 外部资源 -->
    <link rel="stylesheet" href="../assets/css/layui.min.css">
    <link rel="stylesheet" href="../assets/css/fontawesome.min.css">
    <!-- 结构化数据 -->
    <script type="application/ld+json">
    {
        "@context": "https://schema.org",
        "@type": "WebApplication",
        "name": "专业级图片拼图工具",
        "description": "免费的在线图片拼图合并工具，支持2-15张图片拼接",
        "url": "",
        "applicationCategory": "PhotographyApplication",
        "operatingSystem": "Web Browser",
        "offers": {
            "@type": "Offer",
            "price": "0",
            "priceCurrency": "CNY"
        },
        "featureList": [
            "多图拼接合并",
            "自定义布局",
            "图片缩放调整",
            "多种导出格式",
            "响应式设计"
        ]
    }
    </script>
    <style>
        :root {
            /* 参考排列3页面的扁平化配色方案 */
            --primary: #e67e22;
            --primary-light: #eb984e;
            --primary-dark: #d35400;
            --secondary: #3498db;
            --accent: #2ecc71;
            --success: #27ae60;
            --warning: #f39c12;
            --error: #e74c3c;
            --info: #3498db;
            --text-primary: #2c3e50;
            --text-secondary: #7f8c8d;
            --text-disabled: #bdc3c7;
            --border: #e0e0e0;
            --border-light: #f8f9fa;
            --bg-white: #ffffff;
            --bg-light: #f8f9fa;
            --bg-gray: #ecf0f1;
            /* 移除所有阴影效果 */
            --shadow-none: none;
            /* 扁平化圆角设计 */
            --radius-none: 0;
            --radius-sm: 2px;
            --radius-md: 4px;
            --radius-lg: 6px;
            /* 简化过渡效果 */
            --transition: all 0.2s ease;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            background: var(--bg-light);
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', sans-serif;
            color: var(--text-primary);
            line-height: 1.5;
            min-height: 100vh;
            font-size: 14px;
        }

        /* 扁平化头部 */
        .header {
            background: var(--bg-white);
            border-bottom: 1px solid var(--border);
            box-shadow: var(--shadow-none);
            position: sticky;
            top: 0;
            z-index: 1000;
        }

        .header-content {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px 24px;
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        .logo {
            display: flex;
            align-items: center;
            gap: 12px;
            font-size: 20px;
            font-weight: 500;
            color: var(--text-primary);
        }

        .logo i {
            font-size: 20px;
            color: var(--primary);
        }

        .header-actions {
            display: flex;
            gap: 12px;
        }

        /* 颜色选择器样式 */
        .color-picker-group {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .color-picker-label {
            font-size: 12px;
            color: var(--text-secondary);
            white-space: nowrap;
        }

        .color-options {
            display: flex;
            gap: 4px;
        }

        .color-option {
            width: 24px;
            height: 24px;
            border-radius: 50%;
            border: 2px solid var(--border);
            cursor: pointer;
            transition: var(--transition);
            box-shadow: var(--shadow-none);
            background: none;
            outline: none;
        }

        .color-option:hover {
            transform: scale(1.1);
            border-color: var(--text-primary);
        }

        .color-option.active {
            border-color: var(--text-primary);
            box-shadow: 0 0 0 3px rgba(0, 0, 0, 0.1);
        }

        .btn-flat {
            border: 1px solid var(--border);
            background: var(--bg-white);
            color: var(--text-primary);
            padding: 8px 16px;
            border-radius: var(--radius-none);
            font-size: 14px;
            font-weight: 400;
            cursor: pointer;
            transition: var(--transition);
            display: inline-flex;
            align-items: center;
            gap: 6px;
        }

        .btn-flat:hover {
            border-color: var(--primary);
            background: var(--primary);
            color: var(--bg-white);
        }

        /* 主容器 - 调整为全宽布局 */
        .main-container {
            max-width: 100%;
            margin: 24px auto;
            padding: 0 20px;
        }

        .content-wrapper {
            background: var(--bg-white);
            border-radius: var(--radius-none);
            box-shadow: var(--shadow-none);
            border: 1px solid var(--border);
            overflow: hidden;
            min-height: calc(100vh - 100px);
        }

        /* 左侧布局面板 - 浮动拖拽面板 */
        .layout-panel {
            width: 350px;
            background: var(--bg-white);
            border: 1px solid var(--border);
            border-radius: var(--radius-none);
            box-shadow: var(--shadow-none);
            padding: 20px 16px;
            overflow-y: auto;
            position: fixed;
            top: 150px;
            /* 默认top为150px */
            left: 20px;
            height: calc(100vh - 200px - 40px);
            /* preview-container高度减去40px */
            min-height: 400px;
            /* 调整最小高度 */
            z-index: 1000;
            transition: var(--transition);
            cursor: move;
        }

        .layout-panel.collapsed {
            transform: translateX(-100%);
            opacity: 0;
            pointer-events: none;
        }

        .layout-panel.dragging {
            cursor: grabbing;
            user-select: none;
            box-shadow: var(--shadow-none);
            border: 2px solid var(--primary);
            transition: none;
            /* 拖拽时禁用过渡动画 */
            will-change: transform;
            /* 启用硬件加速 */
        }

        .panel-header {
            display: flex;
            align-items: center;
            gap: 8px;
            margin-bottom: 16px;
            padding: 12px;
            background: var(--bg-light);
            border-radius: var(--radius-none);
            border: 1px solid var(--border-light);
            cursor: move;
            position: relative;
        }

        .panel-header:hover {
            background: var(--bg-gray);
            border-color: var(--primary);
        }

        .panel-header::after {
            content: '⋮⋮';
            position: absolute;
            right: 8px;
            top: 50%;
            transform: translateY(-50%);
            color: var(--text-disabled);
            font-size: 12px;
            line-height: 1;
            letter-spacing: -2px;
        }

        .panel-header i {
            color: var(--primary);
            font-size: 16px;
        }

        .panel-header h3 {
            font-size: 16px;
            font-weight: 500;
            color: var(--text-primary);
            margin: 0;
        }

        .layout-category {
            margin-bottom: 12px;
        }

        .category-header {
            background: var(--bg-white);
            border: 1px solid var(--border-light);
            border-radius: var(--radius-none);
            padding: 10px 12px;
            margin-bottom: 8px;
            cursor: pointer;
            transition: var(--transition);
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        .category-header:hover {
            border-color: var(--primary);
            box-shadow: var(--shadow-none);
            background: var(--bg-light);
        }

        .category-title {
            display: flex;
            align-items: center;
            gap: 6px;
            font-size: 14px;
            font-weight: 500;
            color: var(--text-primary);
        }

        .category-title i {
            color: var(--primary);
            font-size: 14px;
        }

        .category-arrow {
            color: var(--text-disabled);
            font-size: 10px;
            transition: var(--transition);
        }

        .category-header.expanded .category-arrow {
            transform: rotate(90deg);
        }

        .layout-content {
            display: block;
        }

        .layout-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 8px;
            padding: 0 4px;
        }

        .layout-item {
            background: var(--bg-white);
            border: 1px solid var(--border-light);
            border-radius: var(--radius-none);
            padding: 12px 8px;
            cursor: pointer;
            transition: var(--transition);
            text-align: center;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .layout-item:hover {
            border-color: var(--primary);
            box-shadow: var(--shadow-none);
            background: var(--bg-light);
        }

        .layout-item.active {
            border-color: var(--primary);
            background: rgba(230, 126, 34, 0.1);
            box-shadow: var(--shadow-none);
        }

        .layout-preview {
            width: 80px;
            height: 80px;
            margin: 0;
            display: grid;
            gap: 2px;
            border-radius: 2px;
            overflow: hidden;
            position: relative;
        }

        .layout-cell {
            background: var(--primary);
            opacity: 0.5;
            min-height: 10px;
            min-width: 10px;
            border-radius: var(--radius-none);
            transition: var(--transition);
        }

        /* 扁平化布局预览优化 */
        .layout-preview {
            background: #f8f9fa;
            border: 1px solid var(--border-light);
            border-radius: var(--radius-none);
            padding: 3px;
        }

        /* 布局项悬停效果 */
        .layout-item:hover .layout-preview .layout-cell {
            opacity: 0.8;
            transform: scale(0.98);
        }

        /* 中间预览区域 - 全宽布局 */
        .preview-panel {
            width: 100%;
            height: 100%;
            padding: 24px;
            display: flex;
            flex-direction: column;
            background: var(--bg-white);
        }

        .preview-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 16px;
            border-bottom: 1px solid var(--border-light);
            flex-shrink: 0;
        }

        .header-actions {
            display: flex;
            gap: 16px;
            align-items: center;
        }

        .panel-toggle {
            background: var(--bg-white);
            border: 1px solid var(--border);
            border-radius: var(--radius-none);
            padding: 6px 8px;
            cursor: pointer;
            transition: var(--transition);
            display: flex;
            align-items: center;
            gap: 4px;
            font-size: 12px;
            color: var(--text-secondary);
        }

        .panel-toggle:hover {
            border-color: var(--primary);
            color: var(--primary);
        }

        .panel-toggle i {
            font-size: 12px;
        }

        .image-counter {
            background: var(--secondary);
            color: white;
            padding: 4px 10px;
            border-radius: var(--radius-none);
            font-size: 11px;
            font-weight: 500;
        }

        .preview-container {
            flex: 1;
            background: var(--bg-light);
            border: 1px dashed var(--border);
            border-radius: var(--radius-none);
            padding: 20px;
            display: flex;
            justify-content: center;
            align-items: center;
            position: relative;
            min-height: calc(100vh - 230px);
            max-height: calc(100vh - 200px);
            overflow: auto;
            transition: var(--transition);
        }

        .preview-wrapper {
            position: relative;
            display: flex;
            justify-content: center;
            align-items: center;
            min-width: 100%;
            min-height: 100%;
        }

        .preview-canvas {
            position: relative;
            background: var(--bg-white);
            border: 2px solid var(--border);
            border-radius: var(--radius-none);
            box-shadow: var(--shadow-none);
            overflow: visible;
            flex-shrink: 0;
        }

        /* 可调整大小的画布 */
        .resizable-canvas {
            user-select: none;
        }

        .resizable-canvas:hover .resize-handles {
            opacity: 1;
        }

        /* 拖拽手柄容器 */
        .resize-handles {
            position: absolute;
            top: -4px;
            left: -4px;
            right: -4px;
            bottom: -4px;
            opacity: 0;
            transition: opacity 0.2s ease;
            pointer-events: none;
        }

        .resize-handles.active {
            opacity: 1;
        }

        /* 拖拽手柄基础样式 */
        .resize-handle {
            position: absolute;
            pointer-events: auto;
            background: var(--primary);
            border: 1px solid var(--bg-white);
            transition: all 0.2s ease;
        }

        .resize-handle:hover {
            background: var(--primary-dark);
            transform: scale(1.2);
        }

        /* 四角手柄 */
        .resize-handle.corner {
            width: 8px;
            height: 8px;
            border-radius: 50%;
        }

        .resize-handle.corner.nw {
            top: 0;
            left: 0;
            cursor: nw-resize;
        }

        .resize-handle.corner.ne {
            top: 0;
            right: 0;
            cursor: ne-resize;
        }

        .resize-handle.corner.sw {
            bottom: 0;
            left: 0;
            cursor: sw-resize;
        }

        .resize-handle.corner.se {
            bottom: 0;
            right: 0;
            cursor: se-resize;
        }

        /* 边缘手柄 */
        .resize-handle.edge {
            background: var(--primary);
            border-radius: 2px;
        }

        .resize-handle.edge.n,
        .resize-handle.edge.s {
            width: 20px;
            height: 4px;
            left: 50%;
            transform: translateX(-50%);
        }

        .resize-handle.edge.n {
            top: 0;
            cursor: n-resize;
        }

        .resize-handle.edge.s {
            bottom: 0;
            cursor: s-resize;
        }

        .resize-handle.edge.w,
        .resize-handle.edge.e {
            width: 4px;
            height: 20px;
            top: 50%;
            transform: translateY(-50%);
        }

        .resize-handle.edge.w {
            left: 0;
            cursor: w-resize;
        }

        .resize-handle.edge.e {
            right: 0;
            cursor: e-resize;
        }

        /* 辅助线容器 */
        .canvas-guides {
            position: fixed;
            top: 0;
            left: 0;
            width: 100vw;
            height: 100vh;
            pointer-events: none;
            z-index: 1001;
            opacity: 0;
            transition: opacity 0.2s ease;
        }

        .canvas-guides.active {
            opacity: 1;
        }

        /* 辅助线 */
        .guide-line {
            position: absolute;
            background: var(--primary);
            opacity: 0.6;
        }

        .guide-h {
            width: 100%;
            height: 1px;
            top: 0;
        }

        .guide-v {
            height: 100%;
            width: 1px;
            left: 0;
        }

        .guide-center-h,
        .guide-center-v {
            position: absolute;
            background: var(--accent);
            opacity: 0.8;
        }

        .guide-center-h {
            width: 100%;
            height: 1px;
            top: 50%;
        }

        .guide-center-v {
            height: 100%;
            width: 1px;
            left: 50%;
        }

        /* 网格背景 */
        .canvas-grid {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            opacity: 0;
            transition: opacity 0.2s ease;
            pointer-events: none;
            background-image: 
                linear-gradient(rgba(0,0,0,0.1) 1px, transparent 1px),
                linear-gradient(90deg, rgba(0,0,0,0.1) 1px, transparent 1px);
            background-size: 20px 20px;
        }

        .canvas-grid.active {
            opacity: 1;
        }

        .preview-container.drag-over {
            border-color: var(--primary);
            background: rgba(230, 126, 34, 0.04);
        }

        .preview-grid {
            width: 100%;
            height: 100%;
            display: grid;
            gap: 10px;
        }

        .grid-cell {
            position: relative;
            background: var(--bg-white);
            border: 1px dashed var(--border);
            border-radius: var(--radius-none);
            overflow: visible;
            display: flex;
            justify-content: center;
            align-items: center;
            cursor: pointer;
            transition: var(--transition);
            min-height: 100px;
        }

        /* 网格单元调整手柄 */
        .grid-cell .cell-resize-handles {
            position: absolute;
            top: -2px;
            left: -2px;
            right: -2px;
            bottom: -2px;
            opacity: 0;
            transition: opacity 0.2s ease;
            pointer-events: none;
            z-index: 10;
        }

        .grid-cell:hover .cell-resize-handles,
        .grid-cell.resizing .cell-resize-handles {
            opacity: 1;
        }

        .cell-resize-handle {
            position: absolute;
            background: var(--primary);
            pointer-events: auto;
            transition: all 0.2s ease;
            border: 1px solid var(--bg-white);
        }

        .cell-resize-handle:hover {
            background: var(--primary-dark);
            transform: scale(1.1);
        }

        /* 网格拖拽虚线 */
        .grid-divider-line {
            position: absolute;
            z-index: 15;
            opacity: 0;
            transition: all 0.15s cubic-bezier(0.4, 0, 0.2, 1);
            pointer-events: auto;
            will-change: transform, opacity;
        }
        
        .grid-divider-line.active {
            opacity: 1;
        }
        
        .grid-divider-line.vertical {
            width: 12px;
            height: 100%;
            background: linear-gradient(to right, 
                transparent 3px, 
                var(--primary-rgba-10) 3px, 
                var(--primary-rgba-30) 4px, 
                var(--primary-rgba-60) 5px, 
                var(--primary-rgba-60) 7px, 
                var(--primary-rgba-30) 8px, 
                var(--primary-rgba-10) 9px, 
                transparent 9px);
            border-left: 1px solid var(--primary-rgba-40);
            border-right: 1px solid var(--primary-rgba-40);
            cursor: ew-resize;
            transform: translateX(-6px);
            box-shadow: 0 0 0 1px rgba(255, 255, 255, 0.3);
        }
        
        .grid-divider-line.horizontal {
            width: 100%;
            height: 12px;
            background: linear-gradient(to bottom, 
                transparent 3px, 
                var(--primary-rgba-10) 3px, 
                var(--primary-rgba-30) 4px, 
                var(--primary-rgba-60) 5px, 
                var(--primary-rgba-60) 7px, 
                var(--primary-rgba-30) 8px, 
                var(--primary-rgba-10) 9px, 
                transparent 9px);
            border-top: 1px solid var(--primary-rgba-40);
            border-bottom: 1px solid var(--primary-rgba-40);
            cursor: ns-resize;
            transform: translateY(-6px);
            box-shadow: 0 0 0 1px rgba(255, 255, 255, 0.3);
        }
        
        .grid-divider-line:hover {
            opacity: 1 !important;
            background-color: var(--primary-rgba-20);
            transform: scale(1.1) translateX(-6px);
        }
        
        .grid-divider-line.horizontal:hover {
            transform: scale(1.1) translateY(-6px);
        }
        
        .grid-divider-line.dragging {
            background-color: var(--primary-rgba-70) !important;
            opacity: 1 !important;
            transform: scale(1.2) translateX(-6px);
            box-shadow: 0 0 8px var(--primary-rgba-40), 0 0 0 2px rgba(255, 255, 255, 0.8);
            transition: none;
        }
        
        .grid-divider-line.horizontal.dragging {
            transform: scale(1.2) translateY(-6px);
        }
        
        /* 只在鼠标悬停在网格区域时显示拖拽线 */
        .preview-grid:hover .grid-divider-line {
            opacity: 0.4;
        }
        
        .preview-grid:hover .grid-divider-line:hover {
            opacity: 1;
        }
        
        /* 拖拽时的预览效果 */
        .preview-grid.dragging-divider {
            transition: all 0.1s ease-out;
        }
        
        .preview-grid.dragging-divider .grid-cell {
            transition: all 0.1s ease-out;
        }
        
        /* 拖拽指示器 */
        .drag-indicator {
            position: absolute;
            z-index: 20;
            pointer-events: none;
            background: rgba(230, 126, 34, 0.1);
            border: 2px dashed rgba(230, 126, 34, 0.8);
            opacity: 0;
            transition: opacity 0.1s ease;
        }
        
        .drag-indicator.active {
            opacity: 1;
        }

        /* 右边缘调整手柄 */
        .cell-resize-handle.right {
            width: 4px;
            height: 60%;
            right: 0;
            top: 20%;
            cursor: e-resize;
            border-radius: 2px 0 0 2px;
        }

        /* 底部边缘调整手柄 */
        .cell-resize-handle.bottom {
            width: 60%;
            height: 4px;
            bottom: 0;
            left: 20%;
            cursor: s-resize;
            border-radius: 2px 2px 0 0;
        }

        /* 右下角调整手柄 */
        .cell-resize-handle.corner {
            width: 8px;
            height: 8px;
            bottom: 0;
            right: 0;
            cursor: se-resize;
            border-radius: 50% 0 0 0;
            background: var(--accent);
        }

        /* 网格分割线 */
        .grid-divider {
            position: absolute;
            background: var(--primary);
            opacity: 0;
            transition: opacity 0.2s ease;
            z-index: 15;
        }

        .grid-divider:hover,
        .grid-divider.active {
            opacity: 0.8;
        }

        .grid-divider.vertical {
            width: 4px;
            height: 100%;
            cursor: col-resize;
            top: 0;
        }

        .grid-divider.horizontal {
            width: 100%;
            height: 4px;
            cursor: row-resize;
            left: 0;
        }

        /* 调整时的视觉反馈 */
        .grid-cell.resizing {
            border-color: var(--primary);
            box-shadow: 0 0 0 2px rgba(230, 126, 34, 0.2);
        }

        .preview-grid.adjusting {
            pointer-events: none;
        }

        .preview-grid.adjusting .grid-cell.resizing {
            pointer-events: auto;
        }

        .grid-cell:hover {
            border-color: var(--primary);
            box-shadow: var(--shadow-none);
            background: var(--bg-light);
        }

        .grid-cell.has-image {
            border-style: solid;
            border-color: var(--accent);
        }

        .grid-cell img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            border-radius: var(--radius-none);
        }

        .upload-hint {
            text-align: center;
            color: var(--text-disabled);
            padding: 16px;
        }

        .upload-hint i {
            font-size: 28px;
            margin-bottom: 6px;
            display: block;
            color: var(--text-disabled);
        }

        /* 图片操作工具栏 - 扁平化 */
        .image-tools {
            position: absolute;
            top: 6px;
            right: 6px;
            display: flex;
            gap: 2px;
            opacity: 0;
            transition: var(--transition);
            z-index: 20;
            pointer-events: auto;
        }

        .grid-cell:hover .image-tools {
            opacity: 1;
        }

        .tool-btn {
            width: 24px;
            height: 24px;
            border-radius: var(--radius-none);
            border: 1px solid var(--border);
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 10px;
            transition: var(--transition);
            background: var(--bg-white);
            color: var(--text-secondary);
            box-shadow: var(--shadow-none);
            position: relative;
            z-index: 21;
            pointer-events: auto;
        }

        .tool-btn:hover {
            background: var(--bg-light);
            color: var(--text-primary);
            border-color: var(--primary);
        }

        .tool-btn.danger {
            color: var(--error);
        }

        .tool-btn.danger:hover {
            background: var(--error);
            color: white;
        }

        .cell-index {
            position: absolute;
            bottom: 6px;
            left: 6px;
            background: rgba(0, 0, 0, 0.6);
            color: white;
            width: 20px;
            height: 20px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 10px;
            font-weight: 600;
        }

        /* 右侧属性面板 - 浮动拖拽面板 */
        .properties-panel {
            width: 350px;
            background: var(--bg-white);
            border: 1px solid var(--border);
            border-radius: var(--radius-none);
            box-shadow: var(--shadow-none);
            padding: 20px 16px;
            overflow-y: auto;
            position: fixed;
            top: 150px;
            /* 默认top为150px */
            right: 20px;
            height: calc(100vh - 200px - 40px);
            /* preview-container高度减去40px */
            min-height: 400px;
            /* 调整最小高度 */
            z-index: 1000;
            transition: var(--transition);
            cursor: move;
        }

        .properties-panel.collapsed {
            transform: translateX(100%);
            opacity: 0;
            pointer-events: none;
        }

        .properties-panel.dragging {
            cursor: grabbing;
            user-select: none;
            box-shadow: var(--shadow-none);
            border: 2px solid var(--primary);
            transition: none;
            /* 拖拽时禁用过渡动画 */
            will-change: transform;
            /* 启用硬件加速 */
        }

        .property-section {
            background: var(--bg-white);
            border-radius: var(--radius-sm);
            padding: 14px;
            margin-bottom: 12px;
            border: 1px solid var(--border-light);
        }

        .section-title {
            font-size: 14px;
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: 12px;
            display: flex;
            align-items: center;
            gap: 6px;
            cursor: move;
            padding: 8px 0;
            border-radius: var(--radius-sm);
            transition: var(--transition);
        }

        .section-title:hover {
            background: var(--bg-light);
            color: var(--primary);
        }

        .section-title i {
            color: var(--primary);
            font-size: 14px;
        }

        .form-item {
            margin-bottom: 12px;
        }

        .form-label {
            display: block;
            margin-bottom: 6px;
            font-size: 12px;
            font-weight: 500;
            color: var(--text-primary);
        }

        .form-input {
            width: 100%;
            padding: 6px 10px;
            border: 1px solid var(--border);
            border-radius: var(--radius-sm);
            font-size: 12px;
            transition: var(--transition);
            background: var(--bg-white);
        }

        .form-input:focus {
            border-color: var(--primary);
            box-shadow: 0 0 0 1px rgba(230, 126, 34, 0.1);
            outline: none;
        }

        .size-group {
            display: flex;
            gap: 6px;
            align-items: center;
        }

        .slider-group {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .slider-value {
            min-width: 50px;
            text-align: center;
            background: var(--bg-light);
            padding: 4px 6px;
            border-radius: var(--radius-sm);
            font-size: 10px;
            color: var(--text-secondary);
            border: 1px solid var(--border-light);
        }

        .ratio-buttons {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 4px;
        }

        .ratio-btn {
            padding: 6px 2px;
            border: 1px solid var(--border);
            background: var(--bg-white);
            border-radius: var(--radius-none);
            font-size: 10px;
            cursor: pointer;
            transition: var(--transition);
            text-align: center;
        }

        .ratio-btn:hover {
            border-color: var(--primary);
            background: var(--primary);
            color: white;
        }

        .ratio-btn.active {
            background: var(--primary);
            border-color: var(--primary);
            color: white;
        }

        /* 多媒体尺寸按钮样式 */
        .media-size-buttons {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 6px;
            margin-top: 8px;
        }

        .media-btn {
            padding: 8px 6px;
            border: 1px solid var(--border);
            background: var(--bg-white);
            border-radius: var(--radius-sm);
            font-size: 11px;
            cursor: pointer;
            transition: var(--transition);
            text-align: center;
            color: var(--text-primary);
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .media-btn:hover {
            border-color: var(--primary);
            background: var(--bg-light);
            color: var(--primary);
            transform: translateY(-1px);
        }

        .media-btn.active {
            background: var(--primary);
            border-color: var(--primary);
            color: white;
            box-shadow: 0 2px 4px rgba(230, 126, 34, 0.3);
        }

        .btn-large {
            padding: 12px 24px;
            font-size: 14px;
            border-radius: var(--radius-none);
            min-width: 100px;
            transition: var(--transition);
            border: 1px solid var(--border);
        }

        .btn-small {
            padding: 8px 16px;
            font-size: 12px;
            border-radius: var(--radius-none);
            min-width: 80px;
            transition: var(--transition);
            border: 1px solid var(--border);
        }

        .btn-primary {
            background: var(--primary);
            border: 1px solid var(--primary);
            color: white;
            border-radius: var(--radius-none);
        }

        .btn-primary:hover {
            background: var(--primary-dark);
            border-color: var(--primary-dark);
        }
        
        .btn-secondary {
            background: var(--accent);
            border: 1px solid var(--accent);
            color: white;
            border-radius: var(--radius-none);
        }

        .btn-secondary:hover {
            background: var(--success);
            border-color: var(--success);
        }

        /* 全屏预览模态框 */
        .fullscreen-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.95);
            z-index: 9999;
            display: none;
            justify-content: center;
            align-items: center;
            backdrop-filter: none;
        }

        .fullscreen-content {
            position: relative;
            max-width: 95%;
            max-height: 95%;
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        .fullscreen-toolbar {
            position: absolute;
            top: 16px;
            right: 16px;
            display: flex;
            gap: 8px;
            z-index: 10;
        }

        .fullscreen-btn {
            width: 40px;
            height: 40px;
            border-radius: var(--radius-none);
            border: 1px solid var(--border);
            background: var(--bg-white);
            color: var(--text-primary);
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 16px;
            transition: var(--transition);
            box-shadow: var(--shadow-none);
        }

        .fullscreen-btn:hover {
            background: var(--bg-light);
            border-color: var(--primary);
        }

        .fullscreen-image {
            max-width: 100%;
            max-height: 100%;
            border-radius: var(--radius-none);
            box-shadow: var(--shadow-none);
            transition: transform 0.3s ease;
        }

        .fullscreen-info {
            position: absolute;
            bottom: 16px;
            left: 50%;
            transform: translateX(-50%);
            background: rgba(255, 255, 255, 0.9);
            padding: 8px 16px;
            border-radius: var(--radius-lg);
            font-size: 12px;
            color: var(--text-primary);
            box-shadow: var(--shadow-md);
        }

        /* 加载动画 */
        .loading-overlay {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(255, 255, 255, 0.9);
            display: none;
            justify-content: center;
            align-items: center;
            border-radius: var(--radius-md);
            backdrop-filter: blur(4px);
        }

        .loading-overlay.show {
            display: flex;
        }

        .loading-spinner {
            width: 32px;
            height: 32px;
            border: 2px solid var(--border-light);
            border-top: 2px solid var(--primary);
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            0% {
                transform: rotate(0deg);
            }

            100% {
                transform: rotate(360deg);
            }
        }

        /* 预设布局样式 */
        .layout-2-1 {
            grid-template-columns: 1fr 1fr;
        }

        .layout-2-2 {
            grid-template-rows: 1fr 1fr;
        }

        .layout-3-1 {
            grid-template-columns: repeat(3, 1fr);
        }

        .layout-3-2 {
            grid-template-rows: repeat(3, 1fr);
        }

        .layout-3-3 {
            grid-template-columns: 2fr 1fr;
            grid-template-rows: 1fr 1fr;
        }

        .layout-3-4 {
            grid-template-columns: 1fr 2fr;
            grid-template-rows: 1fr 1fr;
        }

        .layout-3-5 {
            grid-template-columns: 1fr 1fr;
            grid-template-rows: 2fr 1fr;
        }

        .layout-3-6 {
            grid-template-columns: 1fr 1fr;
            grid-template-rows: 1fr 2fr;
        }

        .layout-3-7 {
            grid-template-columns: 1fr 1fr;
            grid-template-rows: 1fr 1fr;
        }

        .layout-3-8 {
            grid-template-columns: 1fr 1fr;
            grid-template-rows: 1fr 1fr;
        }

        .layout-3-9 {
            grid-template-columns: 1fr 1fr;
            grid-template-rows: 1fr 1fr;
        }

        .layout-3-10 {
            grid-template-columns: 1fr 1fr;
            grid-template-rows: 1fr 1fr;
        }

        .layout-3-11 {
            grid-template-columns: 1fr 1fr;
            grid-template-rows: 2fr 1fr;
        }

        .layout-3-12 {
            grid-template-columns: 2fr 1fr;
            grid-template-rows: 2fr 1fr;
        }

        .layout-4-1 {
            grid-template-columns: repeat(2, 1fr);
            grid-template-rows: repeat(2, 1fr);
        }

        .layout-4-2 {
            grid-template-columns: repeat(4, 1fr);
            grid-template-rows: 1fr;
        }

        .layout-4-3 {
            grid-template-columns: 1fr;
            grid-template-rows: repeat(4, 1fr);
        }

        .layout-4-4 {
            grid-template-columns: 1fr 1fr 1fr;
            grid-template-rows: 1fr 1fr;
        }

        .layout-4-5 {
            grid-template-columns: 1fr 1fr 1fr;
            grid-template-rows: 1fr 1fr;
        }

        .layout-4-6 {
            grid-template-columns: 1fr 1fr;
            grid-template-rows: 1fr 1fr 1fr;
        }

        .layout-4-7 {
            grid-template-columns: 1fr 1fr;
            grid-template-rows: 1fr 1fr 1fr;
        }

        .layout-4-8 {
            grid-template-columns: repeat(3, 1fr);
            grid-template-rows: repeat(3, 1fr);
        }

        .layout-4-9 {
            grid-template-columns: 1fr 1fr 1fr;
            grid-template-rows: 1fr 1fr 1fr;
        }

        .layout-4-10 {
            grid-template-columns: 1fr 1fr;
            grid-template-rows: 1fr 1fr 1fr;
        }

        .layout-4-11 {
            grid-template-columns: 1fr 1fr 1fr;
            grid-template-rows: 1fr 1fr;
        }

        .layout-4-12 {
            grid-template-columns: 1fr 1fr;
            grid-template-rows: 1fr 1fr 1fr;
        }

        .layout-5-1 {
            grid-template-columns: repeat(5, 1fr);
            grid-template-rows: 1fr;
        }

        .layout-5-2 {
            grid-template-columns: 1fr;
            grid-template-rows: repeat(5, 1fr);
        }

        .layout-5-3 {
            grid-template-columns: repeat(2, 1fr);
            grid-template-rows: repeat(3, 1fr);
        }

        .layout-5-4 {
            grid-template-columns: 1fr 1fr;
            grid-template-rows: 1fr 1fr 1fr;
        }

        .layout-5-5 {
            grid-template-columns: 1fr 1fr;
            grid-template-rows: 1fr 1fr 1fr;
        }

        .layout-5-6 {
            grid-template-columns: 1fr 1fr;
            grid-template-rows: 1fr 1fr 1fr;
        }

        .layout-5-7 {
            grid-template-columns: 1fr 1fr 1fr;
            grid-template-rows: 1fr 1fr 1fr;
        }

        .layout-5-8 {
            grid-template-columns: 1fr 1fr 1fr;
            grid-template-rows: 1fr 1fr 1fr;
        }

        .layout-5-9 {
            grid-template-columns: 1fr 1fr 1fr;
            grid-template-rows: 1fr 1fr 1fr;
        }

        .layout-5-10 {
            grid-template-columns: 1fr 1fr 1fr;
            grid-template-rows: 1fr 1fr 1fr;
        }

        .layout-5-11 {
            grid-template-columns: 1fr 1fr 1fr;
            grid-template-rows: 1fr 1fr 1fr;
        }

        .layout-5-12 {
            grid-template-columns: 1fr 1fr 1fr;
            grid-template-rows: 1fr 1fr 1fr;
        }

        .layout-5-13 {
            grid-template-columns: 1fr 1fr 1fr;
            grid-template-rows: 1fr 1fr 1fr;
        }

        .layout-5-14 {
            grid-template-columns: 1fr 1fr 1fr;
            grid-template-rows: 1fr 1fr 1fr;
        }

        .layout-5-15 {
            grid-template-columns: 1fr 1fr 1fr;
            grid-template-rows: 1fr 1fr 1fr;
        }

        .layout-6-1 {
            grid-template-columns: repeat(3, 1fr);
            grid-template-rows: repeat(2, 1fr);
        }

        .layout-6-2,
        .preview-grid.layout-6-2 {
            grid-template-columns: repeat(3, 1fr);
            grid-template-rows: repeat(3, 1fr);
        }

        .layout-6-3,
        .preview-grid.layout-6-3 {
            grid-template-columns: repeat(3, 1fr);
            grid-template-rows: repeat(3, 1fr);
        }

        .layout-6-4 {
            grid-template-columns: repeat(3, 1fr);
            grid-template-rows: repeat(3, 1fr);
        }

        .layout-6-5 {
            grid-template-columns: repeat(3, 1fr);
            grid-template-rows: repeat(3, 1fr);
        }

        .layout-6-6 {
            grid-template-columns: repeat(3, 1fr);
            grid-template-rows: repeat(3, 1fr);
        }

        .layout-6-7 {
            grid-template-columns: repeat(3, 1fr);
            grid-template-rows: repeat(3, 1fr);
        }

        .layout-6-8 {
            grid-template-columns: repeat(3, 1fr);
            grid-template-rows: repeat(3, 1fr);
        }

        .layout-6-9 {
            grid-template-columns: repeat(3, 1fr);
            grid-template-rows: repeat(2, 1fr);
        }

        .layout-6-10 {
            grid-template-columns: repeat(3, 1fr);
            grid-template-rows: repeat(3, 1fr);
        }

        .layout-6-11,
        .preview-grid.layout-6-11 {
            grid-template-columns: repeat(2, 1fr);
            grid-template-rows: repeat(3, 1fr);
        }

        .layout-6-12 {
            grid-template-columns: repeat(3, 1fr);
            grid-template-rows: repeat(3, 1fr);
        }

        .layout-7-1 {
            grid-template-columns: repeat(12, 1fr);
            grid-template-rows: repeat(12, 1fr);
        }

        .layout-7-2 {
            grid-template-columns: repeat(4, 1fr);
            grid-template-rows: repeat(3, 1fr);
        }

        .layout-7-3 {
            grid-template-columns: repeat(4, 1fr);
            grid-template-rows: repeat(3, 1fr);
        }

        .layout-7-4 {
            grid-template-columns: repeat(3, 1fr);
            grid-template-rows: repeat(3, 1fr);
        }

        .layout-7-5 {
            grid-template-columns: repeat(3, 1fr);
            grid-template-rows: repeat(3, 1fr);
        }

        .layout-7-6 {
            grid-template-columns: repeat(6, 1fr);
            grid-template-rows: repeat(3, 1fr);
        }

        .layout-7-7 {
            grid-template-columns: repeat(3, 1fr);
            grid-template-rows: repeat(3, 1fr);
        }

        .layout-7-8 {
            grid-template-columns: repeat(3, 1fr);
            grid-template-rows: repeat(4, 1fr);
        }

        .layout-7-9 {
            grid-template-columns: repeat(4, 1fr);
            grid-template-rows: repeat(3, 1fr);
        }

        .layout-7-10 {
            grid-template-columns: repeat(5, 1fr);
            grid-template-rows: repeat(4, 1fr);
        }

        .layout-7-11 {
            grid-template-columns: repeat(4, 1fr);
            grid-template-rows: repeat(4, 1fr);
        }

        .layout-7-12 {
            grid-template-columns: repeat(4, 1fr);
            grid-template-rows: repeat(4, 1fr);
        }

        .layout-7-13 {
            grid-template-columns: repeat(6, 1fr);
            grid-template-rows: repeat(4, 1fr);
        }

        .layout-7-14 {
            grid-template-columns: repeat(3, 1fr);
            grid-template-rows: repeat(3, 1fr);
        }

        .layout-7-15 {
            grid-template-columns: repeat(3, 1fr);
            grid-template-rows: repeat(3, 1fr);
        }

        .layout-7-16 {
            grid-template-columns: repeat(12, 1fr);
            grid-template-rows: repeat(12, 1fr);
        }

        .layout-7-17 {
            grid-template-columns: repeat(12, 1fr);
            grid-template-rows: repeat(12, 1fr);
        }

        .layout-7-18 {
            grid-template-columns: repeat(12, 1fr);
            grid-template-rows: repeat(12, 1fr);
        }

        .layout-8-1 {
            grid-template-columns: repeat(4, 1fr);
            grid-template-rows: repeat(2, 1fr);
        }

        .layout-8-2 {
            grid-template-columns: repeat(2, 1fr);
            grid-template-rows: repeat(4, 1fr);
        }

        .layout-8-3 {
            grid-template-columns: repeat(8, 1fr);
            grid-template-rows: repeat(1, 1fr);
        }

        .layout-8-4 {
            grid-template-columns: repeat(4, 1fr);
            grid-template-rows: repeat(4, 1fr);
        }

        .layout-8-5 {
            grid-template-columns: repeat(4, 1fr);
            grid-template-rows: repeat(4, 1fr);
        }

        .layout-8-6 {
            grid-template-columns: repeat(4, 1fr);
            grid-template-rows: repeat(4, 1fr);
        }

        .layout-8-7 {
            grid-template-columns: repeat(4, 1fr);
            grid-template-rows: repeat(4, 1fr);
        }

        .layout-8-8 {
            grid-template-columns: repeat(4, 1fr);
            grid-template-rows: repeat(4, 1fr);
        }

        .layout-8-9 {
            grid-template-columns: repeat(4, 1fr);
            grid-template-rows: repeat(4, 1fr);
        }

        .layout-8-10 {
            grid-template-columns: repeat(12, 1fr);
            grid-template-rows: repeat(12, 1fr);
        }

        .layout-8-11 {
            grid-template-columns: repeat(6, 1fr);
            grid-template-rows: repeat(6, 1fr);
        }

        .layout-8-12 {
            grid-template-columns: repeat(6, 1fr);
            grid-template-rows: repeat(6, 1fr);
        }

        .layout-8-13 {
            grid-template-columns: repeat(4, 1fr);
            grid-template-rows: repeat(4, 1fr);
        }

        .layout-8-14 {
            grid-template-columns: repeat(4, 1fr);
            grid-template-rows: repeat(4, 1fr);
        }

        .layout-8-15 {
            grid-template-columns: repeat(12, 1fr);
            grid-template-rows: repeat(14, 1fr);
        }

        .layout-8-16 {
            grid-template-columns: repeat(6, 1fr);
            grid-template-rows: repeat(6, 1fr);
        }

        .layout-8-17 {
            grid-template-columns: repeat(4, 1fr);
            grid-template-rows: repeat(6, 1fr);
        }

        .layout-8-18 {
            grid-template-columns: repeat(4, 1fr);
            grid-template-rows: repeat(4, 1fr);
        }

        .layout-8-19 {
            grid-template-columns: repeat(4, 1fr);
            grid-template-rows: repeat(3, 1fr);
        }

        .layout-8-20 {
            grid-template-columns: repeat(3, 1fr);
            grid-template-rows: repeat(4, 1fr);
        }

        .layout-8-21 {
            grid-template-columns: repeat(4, 1fr);
            grid-template-rows: repeat(5, 1fr);
        }

        .layout-8-22 {
            grid-template-columns: repeat(5, 1fr);
            grid-template-rows: repeat(4, 1fr);
        }

        .layout-9-1 {
            grid-template-columns: repeat(3, 1fr);
            grid-template-rows: repeat(3, 1fr);
        }

        .layout-9-2 {
            grid-template-columns: repeat(4, 1fr);
            grid-template-rows: repeat(4, 1fr);
        }

        .layout-9-3 {
            grid-template-columns: repeat(4, 1fr);
            grid-template-rows: repeat(4, 1fr);
        }

        .layout-9-4 {
            grid-template-columns: repeat(4, 1fr);
            grid-template-rows: repeat(4, 1fr);
        }

        .layout-9-5 {
            grid-template-columns: repeat(4, 1fr);
            grid-template-rows: repeat(4, 1fr);
        }

        .layout-9-6 {
            grid-template-columns: repeat(4, 1fr);
            grid-template-rows: repeat(4, 1fr);
        }

        .layout-9-7 {
            grid-template-columns: repeat(4, 1fr);
            grid-template-rows: repeat(5, 1fr);
        }

        .layout-9-8 {
            grid-template-columns: repeat(6, 1fr);
            grid-template-rows: repeat(6, 1fr);
        }

        .layout-9-9 {
            grid-template-columns: repeat(12, 1fr);
            grid-template-rows: repeat(12, 1fr);
        }

        .layout-9-10 {
            grid-template-columns: repeat(12, 1fr);
            grid-template-rows: repeat(12, 1fr);
        }

        .layout-9-11 {
            grid-template-columns: repeat(12, 1fr);
            grid-template-rows: repeat(12, 1fr);
        }

        .layout-9-12 {
            grid-template-columns: repeat(4, 1fr);
            grid-template-rows: repeat(4, 1fr);
        }

        .layout-9-13 {
            grid-template-columns: repeat(6, 1fr);
            grid-template-rows: repeat(6, 1fr);
        }

        .layout-9-14 {
            grid-template-columns: repeat(6, 1fr);
            grid-template-rows: repeat(6, 1fr);
        }

        .layout-9-15 {
            grid-template-columns: repeat(6, 1fr);
            grid-template-rows: repeat(6, 1fr);
        }

        .layout-10-1 {
            grid-template-columns: repeat(5, 1fr);
            grid-template-rows: repeat(5, 1fr);
        }

        .layout-10-2 {
            grid-template-columns: repeat(12, 1fr);
            grid-template-rows: repeat(12, 1fr);
        }

        .layout-10-3 {
            grid-template-columns: repeat(12, 1fr);
            grid-template-rows: repeat(12, 1fr);
        }

        .layout-10-4 {
            grid-template-columns: repeat(4, 1fr);
            grid-template-rows: repeat(4, 1fr);
        }

        .layout-10-5 {
            grid-template-columns: repeat(8, 1fr);
            grid-template-rows: repeat(8, 1fr);
        }

        .layout-10-6 {
            grid-template-columns: repeat(4, 1fr);
            grid-template-rows: repeat(4, 1fr);
        }

        .layout-10-7 {
            grid-template-columns: repeat(6, 1fr);
            grid-template-rows: repeat(6, 1fr);
        }

        .layout-10-8 {
            grid-template-columns: repeat(12, 1fr);
            grid-template-rows: repeat(12, 1fr);
        }

        .layout-10-9 {
            grid-template-columns: repeat(4, 1fr);
            grid-template-rows: repeat(4, 1fr);
        }

        .layout-10-10 {
            grid-template-columns: repeat(12, 1fr);
            grid-template-rows: repeat(12, 1fr);
        }

        .layout-10-11 {
            grid-template-columns: repeat(8, 1fr);
            grid-template-rows: repeat(8, 1fr);
        }

        .layout-11-1 {
            grid-template-columns: repeat(4, 1fr);
            grid-template-rows: repeat(4, 1fr);
        }

        .layout-11-2 {
            grid-template-columns: repeat(12, 1fr);
            grid-template-rows: repeat(12, 1fr);
        }

        .layout-11-3 {
            grid-template-columns: repeat(4, 1fr);
            grid-template-rows: repeat(4, 1fr);
        }

        .layout-11-4 {
            grid-template-columns: repeat(15, 1fr);
            grid-template-rows: repeat(15, 1fr);
        }

        .layout-11-5 {
            grid-template-columns: repeat(15, 1fr);
            grid-template-rows: repeat(15, 1fr);
        }

        .layout-11-6 {
            grid-template-columns: repeat(15, 1fr);
            grid-template-rows: repeat(15, 1fr);
        }

        .layout-12-1 {
            grid-template-columns: repeat(6, 1fr);
            grid-template-rows: repeat(6, 1fr);
        }

        .layout-12-2 {
            grid-template-columns: repeat(6, 1fr);
            grid-template-rows: repeat(6, 1fr);
        }

        .layout-12-3 {
            grid-template-columns: repeat(12, 1fr);
            grid-template-rows: repeat(12, 1fr);
        }

        .layout-12-4 {
            grid-template-columns: repeat(4, 1fr);
            grid-template-rows: repeat(3, 1fr);
        }

        .layout-12-5 {
            grid-template-columns: repeat(3, 1fr);
            grid-template-rows: repeat(4, 1fr);
        }

        .layout-13-1 {
            grid-template-columns: repeat(4, 1fr);
            grid-template-rows: repeat(4, 1fr);
        }

        .layout-13-2 {
            grid-template-columns: repeat(4, 1fr);
            grid-template-rows: repeat(4, 1fr);
        }

        .layout-13-3 {
            grid-template-columns: repeat(4, 1fr);
            grid-template-rows: repeat(4, 1fr);
        }

        .layout-13-4 {
            grid-template-columns: repeat(4, 1fr);
            grid-template-rows: repeat(4, 1fr);
        }

        .layout-13-5 {
            grid-template-columns: repeat(4, 1fr);
            grid-template-rows: repeat(4, 1fr);
        }

        .layout-14-1 {
            grid-template-columns: repeat(4, 1fr);
            grid-template-rows: repeat(4, 1fr);
        }

        .layout-14-2 {
            grid-template-columns: repeat(2, 1fr);
            grid-template-rows: repeat(7, 1fr);
        }

        .layout-14-3 {
            grid-template-columns: repeat(4, 1fr);
            grid-template-rows: repeat(4, 1fr);
        }

        .layout-15-1 {
            grid-template-columns: repeat(4, 1fr);
            grid-template-rows: repeat(4, 1fr);
        }

        .layout-15-2 {
            grid-template-columns: repeat(4, 1fr);
            grid-template-rows: repeat(4, 1fr);
        }

        .layout-15-3 {
            grid-template-columns: repeat(4, 1fr);
            grid-template-rows: repeat(4, 1fr);
        }

        .layout-15-4 {
            grid-template-columns: repeat(4, 1fr);
            grid-template-rows: repeat(4, 1fr);
        }

        .layout-15-5 {
            grid-template-columns: repeat(3, 1fr);
            grid-template-rows: repeat(5, 1fr);
        }

        .layout-15-6 {
            grid-template-columns: repeat(5, 1fr);
            grid-template-rows: repeat(3, 1fr);
        }

        .layout-15-7 {
            grid-template-columns: repeat(4, 1fr);
            grid-template-rows: repeat(4, 1fr);
        }

        .layout-15-8 {
            grid-template-columns: repeat(4, 1fr);
            grid-template-rows: repeat(4, 1fr);
        }

        .layout-15-9 {
            grid-template-columns: repeat(4, 1fr);
            grid-template-rows: repeat(4, 1fr);
        }

        .layout-16-1 {
            grid-template-columns: repeat(4, 1fr);
            grid-template-rows: repeat(4, 1fr);
        }

        /* 响应式设计 */
        @media (max-width: 1200px) {

            .layout-panel,
            .properties-panel {
                width: 90vw;
                max-width: 300px;
                height: 60vh;
                max-height: 500px;
            }

            .layout-panel {
                left: 5vw;
            }

            .properties-panel {
                right: 5vw;
            }
        }

        @media (max-width: 768px) {
            .layout-grid {
                grid-template-columns: repeat(2, 1fr);
            }

            .main-container {
                padding: 0 12px;
            }

            .layout-panel,
            .properties-panel {
                width: 95vw;
                left: 2.5vw !important;
                right: 2.5vw !important;
                height: 70vh;
                max-height: 400px;
            }

            .ratio-buttons {
                grid-template-columns: repeat(2, 1fr);
            }

            .media-size-buttons {
                grid-template-columns: 1fr;
            }

            .media-btn {
                font-size: 10px;
                padding: 6px 4px;
            }
        }
    </style>
</head>

<body>
    <!-- 头部 -->
    <header class="header">
        <div class="header-content">
            <div class="logo">
                <i class="fas fa-puzzle-piece"></i>
                专业级图片拼图工具
            </div>
            <div class="header-actions">
                <div class="color-picker-group">
                    <div class="color-options">
                        <button class="color-option active" data-color="orange" style="background-color: #e67e22;" title="橙色主题"></button>
                        <button class="color-option" data-color="blue" style="background-color: #3498db;" title="蓝色主题"></button>
                        <button class="color-option" data-color="green" style="background-color: #27ae60;" title="绿色主题"></button>
                        <button class="color-option" data-color="purple" style="background-color: #9b59b6;" title="紫色主题"></button>
                        <button class="color-option" data-color="red" style="background-color: #e74c3c;" title="红色主题"></button>
                        <button class="color-option" data-color="yellow" style="background-color: #f1c40f;" title="黄色主题"></button>
                        <button class="color-option" data-color="contrast-dark" style="background-color: #2c3e50;" title="深色对比主题"></button>
                        <button class="color-option" data-color="contrast-light" style="background-color: #ecf0f1;" title="浅色对比主题"></button>
                    </div>
                </div>
            </div>
        </div>
    </header>
    <!-- 主容器 -->
    <main class="main-container">
        <div class="content-wrapper">
            <!-- 中间预览区域 -->
            <section class="preview-panel">
                <div class="preview-header">
                    <div style="display: flex; align-items: center; gap: 12px;">
                        <button class="panel-toggle" id="leftPanelToggle" title="切换左侧面板">
                            <i class="fas fa-bars"></i> 布局
                        </button>
                        <button class="panel-toggle" id="rightPanelToggle" title="切换右侧面板">
                            <i class="fas fa-cogs"></i> 设置
                        </button>
                    </div>
                    <!-- 居中的操作按钮 -->
                    <div class="header-actions">
                        <button class="btn-flat btn-small" id="resetBtn">
                            <i class="fas fa-redo"></i> 重置
                        </button>
                        <button class="btn-primary btn-small" id="mergeBtn">
                            <i class="fas fa-magic"></i> 开始合并
                        </button>
                        <button class="btn-flat btn-large" id="downloadBtn" style="display: none;">
                            <i class="fas fa-download"></i> 下载图片
                        </button>
                    </div>
                    <div class="image-counter">
                        已选择 <span id="imageCount">0</span> 张图片
                    </div>
                </div>
                <div class="preview-container" id="previewContainer">
                    <div class="preview-grid layout-2-1" id="previewGrid">
                        <div class="grid-cell" data-index="0">
                            <div class="upload-hint">
                                <i class="fas fa-cloud-upload-alt"></i>
                                <div>点击上传图片</div>
                                <div style="font-size: 11px; margin-top: 4px;">或拖拽到此处</div>
                            </div>
                            <div class="cell-index">1</div>
                        </div>
                        <div class="grid-cell" data-index="1">
                            <div class="upload-hint">
                                <i class="fas fa-cloud-upload-alt"></i>
                                <div>点击上传图片</div>
                                <div style="font-size: 11px; margin-top: 4px;">或拖拽到此处</div>
                            </div>
                            <div class="cell-index">2</div>
                        </div>
                    </div>
                    <div class="loading-overlay" id="loadingOverlay">
                        <div class="loading-spinner"></div>
                    </div>
                </div>
            </section>
        </div>
    </main>
    <!-- 左侧浮动布局面板 -->
    <aside class="layout-panel">
        <div class="panel-header">
            <i class="fas fa-th"></i>
            <h3>拼图布局</h3>
        </div>
        <!-- 2图布局 -->
        <div class="layout-category">
            <div class="category-header expanded" data-target="layout-2">
                <div class="category-title">
                    <i class="fas fa-images"></i> 2图布局
                </div>
                <i class="fas fa-chevron-right category-arrow"></i>
            </div>
            <div class="layout-content" id="layout-2">
                <div class="layout-grid">
                    <div class="layout-item active" data-layout="2-1" data-count="2">
                        <div class="layout-preview layout-2-1">
                            <div class="layout-cell"></div>
                            <div class="layout-cell"></div>
                        </div>
                    </div>
                    <div class="layout-item" data-layout="2-2" data-count="2">
                        <div class="layout-preview layout-2-2">
                            <div class="layout-cell"></div>
                            <div class="layout-cell"></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <!-- 3图布局 -->
        <div class="layout-category">
            <div class="category-header expanded" data-target="layout-3">
                <div class="category-title">
                    <i class="fas fa-images"></i> 3图布局
                </div>
                <i class="fas fa-chevron-right category-arrow"></i>
            </div>
            <div class="layout-content" id="layout-3">
                <div class="layout-grid">
                    <div class="layout-item" data-layout="3-1" data-count="3">
                        <div class="layout-preview layout-3-1">
                            <div class="layout-cell"></div>
                            <div class="layout-cell"></div>
                            <div class="layout-cell"></div>
                        </div>
                    </div>
                    <div class="layout-item" data-layout="3-2" data-count="3">
                        <div class="layout-preview layout-3-2">
                            <div class="layout-cell"></div>
                            <div class="layout-cell"></div>
                            <div class="layout-cell"></div>
                        </div>
                    </div>
                    <div class="layout-item" data-layout="3-3" data-count="3">
                        <div class="layout-preview layout-3-3">
                            <div class="layout-cell" style="grid-row: span 2;"></div>
                            <div class="layout-cell"></div>
                            <div class="layout-cell"></div>
                        </div>
                    </div>
                    <div class="layout-item" data-layout="3-4" data-count="3">
                        <div class="layout-preview layout-3-4">
                            <div class="layout-cell"></div>
                            <div class="layout-cell" style="grid-row: span 2; grid-column: 2;"></div>
                            <div class="layout-cell"></div>
                        </div>
                    </div>
                    <div class="layout-item" data-layout="3-5" data-count="3">
                        <div class="layout-preview layout-3-5">
                            <div class="layout-cell" style="grid-column: span 2;"></div>
                            <div class="layout-cell"></div>
                            <div class="layout-cell"></div>
                        </div>
                    </div>
                    <div class="layout-item" data-layout="3-6" data-count="3">
                        <div class="layout-preview layout-3-6">
                            <div class="layout-cell"></div>
                            <div class="layout-cell"></div>
                            <div class="layout-cell" style="grid-column: span 2;"></div>
                        </div>
                    </div>
                    <div class="layout-item" data-layout="3-7" data-count="3">
                        <div class="layout-preview layout-3-7">
                            <div class="layout-cell" style="grid-column: span 2;"></div>
                            <div class="layout-cell"></div>
                            <div class="layout-cell"></div>
                        </div>
                    </div>
                    <div class="layout-item" data-layout="3-8" data-count="3">
                        <div class="layout-preview layout-3-8">
                            <div class="layout-cell"></div>
                            <div class="layout-cell"></div>
                            <div class="layout-cell" style="grid-column: span 2;"></div>
                        </div>
                    </div>
                    <div class="layout-item" data-layout="3-9" data-count="3">
                        <div class="layout-preview layout-3-9">
                            <div class="layout-cell" style="grid-row: span 2;"></div>
                            <div class="layout-cell"></div>
                            <div class="layout-cell"></div>
                        </div>
                    </div>
                    <div class="layout-item" data-layout="3-10" data-count="3">
                        <div class="layout-preview layout-3-10">
                            <div class="layout-cell"></div>
                            <div class="layout-cell" style="grid-row: span 2; grid-column: 2;"></div>
                            <div class="layout-cell"></div>
                        </div>
                    </div>
                    <div class="layout-item" data-layout="3-11" data-count="3">
                        <div class="layout-preview layout-3-11">
                            <div class="layout-cell" style="grid-column: span 2;"></div>
                            <div class="layout-cell"></div>
                            <div class="layout-cell"></div>
                        </div>
                    </div>
                    <div class="layout-item" data-layout="3-12" data-count="3">
                        <div class="layout-preview layout-3-12">
                            <div class="layout-cell" style="grid-column: span 2; grid-row: span 2;"></div>
                            <div class="layout-cell"></div>
                            <div class="layout-cell"></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <!-- 4图布局 -->
        <div class="layout-category">
            <div class="category-header expanded" data-target="layout-4">
                <div class="category-title">
                    <i class="fas fa-images"></i> 4图布局
                </div>
                <i class="fas fa-chevron-right category-arrow"></i>
            </div>
            <div class="layout-content" id="layout-4">
                <div class="layout-grid">
                    <div class="layout-item" data-layout="4-1" data-count="4">
                        <div class="layout-preview layout-4-1">
                            <div class="layout-cell"></div>
                            <div class="layout-cell"></div>
                            <div class="layout-cell"></div>
                            <div class="layout-cell"></div>
                        </div>
                    </div>
                    <div class="layout-item" data-layout="4-2" data-count="4">
                        <div class="layout-preview layout-4-2">
                            <div class="layout-cell"></div>
                            <div class="layout-cell"></div>
                            <div class="layout-cell"></div>
                            <div class="layout-cell"></div>
                        </div>
                    </div>
                    <div class="layout-item" data-layout="4-3" data-count="4">
                        <div class="layout-preview layout-4-3">
                            <div class="layout-cell"></div>
                            <div class="layout-cell"></div>
                            <div class="layout-cell"></div>
                            <div class="layout-cell"></div>
                        </div>
                    </div>
                    <div class="layout-item" data-layout="4-4" data-count="4">
                        <div class="layout-preview layout-4-4">
                            <div class="layout-cell" style="grid-column: span 3;"></div>
                            <div class="layout-cell"></div>
                            <div class="layout-cell"></div>
                            <div class="layout-cell"></div>
                        </div>
                    </div>
                    <div class="layout-item" data-layout="4-5" data-count="4">
                        <div class="layout-preview layout-4-5">
                            <div class="layout-cell"></div>
                            <div class="layout-cell"></div>
                            <div class="layout-cell"></div>
                            <div class="layout-cell" style="grid-column: span 3;"></div>
                        </div>
                    </div>
                    <div class="layout-item" data-layout="4-6" data-count="4">
                        <div class="layout-preview layout-4-6">
                            <div class="layout-cell" style="grid-row: span 3;"></div>
                            <div class="layout-cell"></div>
                            <div class="layout-cell"></div>
                            <div class="layout-cell"></div>
                        </div>
                    </div>
                    <div class="layout-item" data-layout="4-7" data-count="4">
                        <div class="layout-preview layout-4-7">
                            <div class="layout-cell"></div>
                            <div class="layout-cell" style="grid-row: span 3; grid-column: 2;"></div>
                            <div class="layout-cell"></div>
                            <div class="layout-cell"></div>
                        </div>
                    </div>
                    <div class="layout-item" data-layout="4-8" data-count="4">
                        <div class="layout-preview layout-4-8">
                            <div class="layout-cell" style="grid-column: 1 / 3; grid-row: 1 / 3;"></div>
                            <div class="layout-cell" style="grid-column: 3; grid-row: 1 / 3;"></div>
                            <div class="layout-cell" style="grid-column: 1 / 3; grid-row: 3;"></div>
                            <div class="layout-cell" style="grid-column: 3; grid-row: 3;"></div>
                        </div>
                    </div>
                    <div class="layout-item" data-layout="4-9" data-count="4">
                        <div class="layout-preview layout-4-9">
                            <div class="layout-cell" style="grid-column: 1; grid-row: 1 / 3;"></div>
                            <div class="layout-cell" style="grid-column: 2 / 4; grid-row: 1 / 3;"></div>
                            <div class="layout-cell" style="grid-column: 1; grid-row: 3;"></div>
                            <div class="layout-cell" style="grid-column: 2 / 4; grid-row: 3;"></div>
                        </div>
                    </div>
                    <div class="layout-item" data-layout="4-10" data-count="4">
                        <div class="layout-preview layout-4-10">
                            <div class="layout-cell" style="grid-column: span 2;"></div>
                            <div class="layout-cell"></div>
                            <div class="layout-cell"></div>
                            <div class="layout-cell" style="grid-column: span 2;"></div>
                        </div>
                    </div>
                    <div class="layout-item" data-layout="4-11" data-count="4">
                        <div class="layout-preview layout-4-11">
                            <div class="layout-cell" style="grid-row: span 2;"></div>
                            <div class="layout-cell"></div>
                            <div class="layout-cell" style="grid-row: span 2;"></div>
                            <div class="layout-cell"></div>
                        </div>
                    </div>
                    <div class="layout-item" data-layout="4-12" data-count="4">
                        <div class="layout-preview layout-4-12">
                            <div class="layout-cell"></div>
                            <div class="layout-cell" style="grid-row: span 2;"></div>
                            <div class="layout-cell" style="grid-row: span 2;"></div>
                            <div class="layout-cell"></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <!-- 5图布局 -->
        <div class="layout-category">
            <div class="category-header expanded" data-target="layout-5">
                <div class="category-title">
                    <i class="fas fa-images"></i> 5图布局
                </div>
                <i class="fas fa-chevron-right category-arrow"></i>
            </div>
            <div class="layout-content" id="layout-5">
                <div class="layout-grid">
                    <div class="layout-item" data-layout="5-1" data-count="5">
                        <div class="layout-preview layout-5-1">
                            <div class="layout-cell"></div>
                            <div class="layout-cell"></div>
                            <div class="layout-cell"></div>
                            <div class="layout-cell"></div>
                            <div class="layout-cell"></div>
                        </div>
                    </div>
                    <div class="layout-item" data-layout="5-2" data-count="5">
                        <div class="layout-preview layout-5-2">
                            <div class="layout-cell"></div>
                            <div class="layout-cell"></div>
                            <div class="layout-cell"></div>
                            <div class="layout-cell"></div>
                            <div class="layout-cell"></div>
                        </div>
                    </div>
                    <div class="layout-item" data-layout="5-3" data-count="5">
                        <div class="layout-preview layout-5-3">
                            <div class="layout-cell" style="grid-column: span 2;"></div>
                            <div class="layout-cell"></div>
                            <div class="layout-cell"></div>
                            <div class="layout-cell"></div>
                            <div class="layout-cell"></div>
                        </div>
                    </div>
                    <div class="layout-item" data-layout="5-4" data-count="5">
                        <div class="layout-preview layout-5-4">
                            <div class="layout-cell" style="grid-column: span 2;"></div>
                            <div class="layout-cell"></div>
                            <div class="layout-cell"></div>
                            <div class="layout-cell"></div>
                            <div class="layout-cell"></div>
                        </div>
                    </div>
                    <div class="layout-item" data-layout="5-5" data-count="5">
                        <div class="layout-preview layout-5-5">
                            <div class="layout-cell"></div>
                            <div class="layout-cell"></div>
                            <div class="layout-cell"></div>
                            <div class="layout-cell"></div>
                            <div class="layout-cell" style="grid-column: span 2;"></div>
                        </div>
                    </div>
                    <div class="layout-item" data-layout="5-6" data-count="5">
                        <div class="layout-preview layout-5-6">
                            <div class="layout-cell" style="grid-row: span 2;"></div>
                            <div class="layout-cell"></div>
                            <div class="layout-cell"></div>
                            <div class="layout-cell"></div>
                            <div class="layout-cell"></div>
                        </div>
                    </div>
                    <div class="layout-item" data-layout="5-7" data-count="5">
                        <div class="layout-preview layout-5-7">
                            <div class="layout-cell" style="grid-column: 1 / 3; grid-row: 1;"></div>
                            <div class="layout-cell" style="grid-column: 3; grid-row: 1 / 3;"></div>
                            <div class="layout-cell" style="grid-column: 2; grid-row: 2;"></div>
                            <div class="layout-cell" style="grid-column: 1; grid-row: 2 / 4;"></div>
                            <div class="layout-cell" style="grid-column: 2 / 4; grid-row: 3;"></div>
                        </div>
                    </div>
                    <div class="layout-item" data-layout="5-8" data-count="5">
                        <div class="layout-preview layout-5-8">
                            <div class="layout-cell" style="grid-column: 1; grid-row: 1;"></div>
                            <div class="layout-cell" style="grid-column: 1; grid-row: 2;"></div>
                            <div class="layout-cell" style="grid-column: 1; grid-row: 3;"></div>
                            <div class="layout-cell" style="grid-column: 2 / 4; grid-row: 1;"></div>
                            <div class="layout-cell" style="grid-column: 2 / 4; grid-row: 2 / 4;"></div>
                        </div>
                    </div>
                    <div class="layout-item" data-layout="5-9" data-count="5">
                        <div class="layout-preview layout-5-9">
                            <div class="layout-cell" style="grid-column: 1; grid-row: 1 / 4;"></div>
                            <div class="layout-cell" style="grid-column: 2; grid-row: 1;"></div>
                            <div class="layout-cell" style="grid-column: 2; grid-row: 2;"></div>
                            <div class="layout-cell" style="grid-column: 2; grid-row: 3;"></div>
                            <div class="layout-cell" style="grid-column: 3; grid-row: 1 / 4;"></div>
                        </div>
                    </div>
                    <div class="layout-item" data-layout="5-10" data-count="5">
                        <div class="layout-preview layout-5-10">
                            <div class="layout-cell" style="grid-column: 1 / 4; grid-row: 1;"></div>
                            <div class="layout-cell" style="grid-column: 1; grid-row: 2;"></div>
                            <div class="layout-cell" style="grid-column: 2; grid-row: 2;"></div>
                            <div class="layout-cell" style="grid-column: 3; grid-row: 2;"></div>
                            <div class="layout-cell" style="grid-column: 1 / 4; grid-row: 3;"></div>
                        </div>
                    </div>
                    <div class="layout-item" data-layout="5-11" data-count="5">
                        <div class="layout-preview layout-5-11">
                            <div class="layout-cell" style="grid-column: 1 / 4; grid-row: 1;"></div>
                            <div class="layout-cell" style="grid-column: 1 / 4; grid-row: 2;"></div>
                            <div class="layout-cell" style="grid-column: 1; grid-row: 3;"></div>
                            <div class="layout-cell" style="grid-column: 2; grid-row: 3;"></div>
                            <div class="layout-cell" style="grid-column: 3; grid-row: 3;"></div>
                        </div>
                    </div>
                    <div class="layout-item" data-layout="5-12" data-count="5">
                        <div class="layout-preview layout-5-12">
                            <div class="layout-cell" style="grid-column: 1 / 3; grid-row: 1 / 3;"></div>
                            <div class="layout-cell" style="grid-column: 3; grid-row: 1;"></div>
                            <div class="layout-cell" style="grid-column: 3; grid-row: 2;"></div>
                            <div class="layout-cell" style="grid-column: 1; grid-row: 3;"></div>
                            <div class="layout-cell" style="grid-column: 2 / 4; grid-row: 3;"></div>
                        </div>
                    </div>
                    <div class="layout-item" data-layout="5-13" data-count="5">
                        <div class="layout-preview layout-5-13">
                            <div class="layout-cell" style="grid-column: 1; grid-row: 1;"></div>
                            <div class="layout-cell" style="grid-column: 2 / 4; grid-row: 1 / 3;"></div>
                            <div class="layout-cell" style="grid-column: 1; grid-row: 2;"></div>
                            <div class="layout-cell" style="grid-column: 1; grid-row: 3;"></div>
                            <div class="layout-cell" style="grid-column: 2 / 4; grid-row: 3;"></div>
                        </div>
                    </div>
                    <div class="layout-item" data-layout="5-14" data-count="5">
                        <div class="layout-preview layout-5-14">
                            <div class="layout-cell" style="grid-column: 1; grid-row: 1;"></div>
                            <div class="layout-cell" style="grid-column: 2; grid-row: 1;"></div>
                            <div class="layout-cell" style="grid-column: 3; grid-row: 1;"></div>
                            <div class="layout-cell" style="grid-column: 1 / 3; grid-row: 2 / 4;"></div>
                            <div class="layout-cell" style="grid-column: 3; grid-row: 2 / 4;"></div>
                        </div>
                    </div>
                    <div class="layout-item" data-layout="5-15" data-count="5">
                        <div class="layout-preview layout-5-15">
                            <div class="layout-cell" style="grid-column: 1; grid-row: 1;"></div>
                            <div class="layout-cell" style="grid-column: 2; grid-row: 1;"></div>
                            <div class="layout-cell" style="grid-column: 3; grid-row: 1;"></div>
                            <div class="layout-cell" style="grid-column: 1; grid-row: 2 / 4;"></div>
                            <div class="layout-cell" style="grid-column: 2 / 4; grid-row: 2 / 4;"></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <!-- 6图布局 -->
        <div class="layout-category">
            <div class="category-header expanded" data-target="layout-6">
                <div class="category-title">
                    <i class="fas fa-images"></i> 6图布局
                </div>
                <i class="fas fa-chevron-right category-arrow"></i>
            </div>
            <div class="layout-content" id="layout-6">
                <div class="layout-grid">
                    <!-- 布局1：两行三列 (6个区域，3×2网格) -->
                    <div class="layout-item" data-layout="6-1" data-count="6">
                        <div class="layout-preview layout-6-1">
                            <div class="layout-cell" style="grid-column: 1; grid-row: 1;"></div>
                            <div class="layout-cell" style="grid-column: 2; grid-row: 1;"></div>
                            <div class="layout-cell" style="grid-column: 3; grid-row: 1;"></div>
                            <div class="layout-cell" style="grid-column: 1; grid-row: 2;"></div>
                            <div class="layout-cell" style="grid-column: 2; grid-row: 2;"></div>
                            <div class="layout-cell" style="grid-column: 3; grid-row: 2;"></div>
                        </div>
                    </div>
                    <!-- 布局2：左竖右错 (6个区域，3×3网格) -->
                    <div class="layout-item" data-layout="6-2" data-count="6">
                        <div class="layout-preview layout-6-2">
                            <div class="layout-cell" style="grid-column: 1; grid-row: 1 / 4;"></div>
                            <div class="layout-cell" style="grid-column: 2; grid-row: 1;"></div>
                            <div class="layout-cell" style="grid-column: 3; grid-row: 1;"></div>
                            <div class="layout-cell" style="grid-column: 2 / 4; grid-row: 2;"></div>
                            <div class="layout-cell" style="grid-column: 2; grid-row: 3;"></div>
                            <div class="layout-cell" style="grid-column: 3; grid-row: 3;"></div>
                        </div>
                    </div>
                    <!-- 布局3：左整列中上单下双右三行 (6个区域) -->
                    <div class="layout-item" data-layout="6-3" data-count="6">
                        <div class="layout-preview layout-6-3">
                            <div class="layout-cell" style="grid-column: 1; grid-row: 1 / 4;"></div>
                            <div class="layout-cell" style="grid-column: 2; grid-row: 1;"></div>
                            <div class="layout-cell" style="grid-column: 2; grid-row: 2 / 4;"></div>
                            <div class="layout-cell" style="grid-column: 3; grid-row: 1;"></div>
                            <div class="layout-cell" style="grid-column: 3; grid-row: 2;"></div>
                            <div class="layout-cell" style="grid-column: 3; grid-row: 3;"></div>
                        </div>
                    </div>
                    <!-- 布局4：两竖夹心 (6个区域，3×3网格) -->
                    <div class="layout-item" data-layout="6-4" data-count="6">
                        <div class="layout-preview layout-6-4">
                            <div class="layout-cell" style="grid-column: 1; grid-row: 1 / 3;"></div>
                            <div class="layout-cell" style="grid-column: 1; grid-row: 3;"></div>
                            <div class="layout-cell" style="grid-column: 2; grid-row: 1;"></div>
                            <div class="layout-cell" style="grid-column: 2; grid-row: 2;"></div>
                            <div class="layout-cell" style="grid-column: 2; grid-row: 3;"></div>
                            <div class="layout-cell" style="grid-column: 3; grid-row: 1 / 4;"></div>
                        </div>
                    </div>
                    <!-- 布局5：左上单下双中三行右整列 (6个区域) -->
                    <div class="layout-item" data-layout="6-5" data-count="6">
                        <div class="layout-preview layout-6-5">
                            <div class="layout-cell" style="grid-column: 1; grid-row: 1;"></div>
                            <div class="layout-cell" style="grid-column: 1; grid-row: 2 / 4;"></div>
                            <div class="layout-cell" style="grid-column: 2; grid-row: 1;"></div>
                            <div class="layout-cell" style="grid-column: 2; grid-row: 2;"></div>
                            <div class="layout-cell" style="grid-column: 2; grid-row: 3;"></div>
                            <div class="layout-cell" style="grid-column: 3; grid-row: 1 / 4;"></div>
                        </div>
                    </div>
                    <!-- 布局6：左三行中上双下单右整列 (6个区域) -->
                    <div class="layout-item" data-layout="6-6" data-count="6">
                        <div class="layout-preview layout-6-6">
                            <div class="layout-cell" style="grid-column: 1; grid-row: 1;"></div>
                            <div class="layout-cell" style="grid-column: 1; grid-row: 2;"></div>
                            <div class="layout-cell" style="grid-column: 1; grid-row: 3;"></div>
                            <div class="layout-cell" style="grid-column: 2; grid-row: 1 / 3;"></div>
                            <div class="layout-cell" style="grid-column: 2; grid-row: 3;"></div>
                            <div class="layout-cell" style="grid-column: 3; grid-row: 1 / 4;"></div>
                        </div>
                    </div>
                    <!-- 布局7：左竖中错 (6个区域，3×3网格) -->
                    <div class="layout-item" data-layout="6-7" data-count="6">
                        <div class="layout-preview layout-6-7">
                            <div class="layout-cell" style="grid-column: 1; grid-row: 1 / 4;"></div>
                            <div class="layout-cell" style="grid-column: 2; grid-row: 1;"></div>
                            <div class="layout-cell" style="grid-column: 2; grid-row: 2 / 4;"></div>
                            <div class="layout-cell" style="grid-column: 3; grid-row: 1;"></div>
                            <div class="layout-cell" style="grid-column: 3; grid-row: 2;"></div>
                            <div class="layout-cell" style="grid-column: 3; grid-row: 3;"></div>
                        </div>
                    </div>
                    <!-- 布局8：三竖分段 (6个区域，3×3网格) -->
                    <div class="layout-item" data-layout="6-8" data-count="6">
                        <div class="layout-preview layout-6-8">
                            <div class="layout-cell" style="grid-column: 1; grid-row: 1;"></div>
                            <div class="layout-cell" style="grid-column: 1; grid-row: 2 / 4;"></div>
                            <div class="layout-cell" style="grid-column: 2; grid-row: 1 / 3;"></div>
                            <div class="layout-cell" style="grid-column: 2; grid-row: 3;"></div>
                            <div class="layout-cell" style="grid-column: 3; grid-row: 1;"></div>
                            <div class="layout-cell" style="grid-column: 3; grid-row: 2 / 4;"></div>
                        </div>
                    </div>
                    <!-- 布局9：两横四竖 (6个区域，3×3网格) -->
                    <div class="layout-item" data-layout="6-9" data-count="6">
                        <div class="layout-preview layout-6-9">
                            <div class="layout-cell" style="grid-column: 1 / 3; grid-row: 1;"></div>
                            <div class="layout-cell" style="grid-column: 3; grid-row: 1;"></div>
                            <div class="layout-cell" style="grid-column: 1; grid-row: 2;"></div>
                            <div class="layout-cell" style="grid-column: 2; grid-row: 2;"></div>
                            <div class="layout-cell" style="grid-column: 3; grid-row: 2;"></div>
                            <div class="layout-cell" style="grid-column: 1 / 4; grid-row: 3;"></div>
                        </div>
                    </div>
                    <!-- 布局10：镜像结构 (6个区域，3×3网格) -->
                    <div class="layout-item" data-layout="6-10" data-count="6">
                        <div class="layout-preview layout-6-10">
                            <div class="layout-cell" style="grid-column: 1; grid-row: 1 / 4;"></div>
                            <div class="layout-cell" style="grid-column: 2; grid-row: 1 / 3;"></div>
                            <div class="layout-cell" style="grid-column: 2; grid-row: 3;"></div>
                            <div class="layout-cell" style="grid-column: 3; grid-row: 1;"></div>
                            <div class="layout-cell" style="grid-column: 3; grid-row: 2;"></div>
                            <div class="layout-cell" style="grid-column: 3; grid-row: 3;"></div>
                        </div>
                    </div>
                    <!-- 布局11：三行两列 (6个区域) -->
                    <div class="layout-item" data-layout="6-11" data-count="6">
                        <div class="layout-preview layout-6-11">
                            <div class="layout-cell" style="grid-column: 1; grid-row: 1;"></div>
                            <div class="layout-cell" style="grid-column: 2; grid-row: 1;"></div>
                            <div class="layout-cell" style="grid-column: 1; grid-row: 2;"></div>
                            <div class="layout-cell" style="grid-column: 2; grid-row: 2;"></div>
                            <div class="layout-cell" style="grid-column: 1; grid-row: 3;"></div>
                            <div class="layout-cell" style="grid-column: 2; grid-row: 3;"></div>
                        </div>
                    </div>
                    <!-- 布局12：分层组合 (6个区域，3×3网格) -->
                    <div class="layout-item" data-layout="6-12" data-count="6">
                        <div class="layout-preview layout-6-12">
                            <div class="layout-cell" style="grid-column: 1; grid-row: 1 / 3;"></div>
                            <div class="layout-cell" style="grid-column: 1; grid-row: 3;"></div>
                            <div class="layout-cell" style="grid-column: 2; grid-row: 1;"></div>
                            <div class="layout-cell" style="grid-column: 2; grid-row: 2;"></div>
                            <div class="layout-cell" style="grid-column: 2; grid-row: 3;"></div>
                            <div class="layout-cell" style="grid-column: 3; grid-row: 1 / 4;"></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <!-- 7图布局 -->
        <div class="layout-category">
            <div class="category-header expanded" data-target="layout-7">
                <div class="category-title">
                    <i class="fas fa-images"></i> 7图布局
                </div>
                <i class="fas fa-chevron-right category-arrow"></i>
            </div>
            <div class="layout-content" id="layout-7">
                <div class="layout-grid">
                    <div class="layout-item" data-layout="7-1" data-count="7">
                        <div class="layout-preview layout-7-1">
                            <div class="layout-cell" style="grid-column: 1 / 10; grid-row: 1 / 10;"></div>
                            <div class="layout-cell" style="grid-column: 10 / 13; grid-row: 1 / 5;"></div>
                            <div class="layout-cell" style="grid-column: 10 / 13; grid-row: 5 / 9;"></div>
                            <div class="layout-cell" style="grid-column: 10 / 13; grid-row: 9 / 13;"></div>
                            <div class="layout-cell" style="grid-column: 1 / 4; grid-row: 10 / 13;"></div>
                            <div class="layout-cell" style="grid-column: 4 / 7; grid-row: 10 / 13;"></div>
                            <div class="layout-cell" style="grid-column: 7 / 10; grid-row: 10 / 13;"></div>
                        </div>
                    </div>
                    <div class="layout-item" data-layout="7-2" data-count="7">
                        <div class="layout-preview layout-7-2">
                            <div class="layout-cell" style="grid-column: 1 / 5; grid-row: 1;"></div>
                            <div class="layout-cell" style="grid-column: 1 / 3; grid-row: 2;"></div>
                            <div class="layout-cell" style="grid-column: 3; grid-row: 2;"></div>
                            <div class="layout-cell" style="grid-column: 4; grid-row: 2;"></div>
                            <div class="layout-cell" style="grid-column: 1 / 3; grid-row: 3;"></div>
                            <div class="layout-cell" style="grid-column: 3; grid-row: 3;"></div>
                            <div class="layout-cell" style="grid-column: 4; grid-row: 3;"></div>
                        </div>
                    </div>
                    <div class="layout-item" data-layout="7-3" data-count="7">
                        <div class="layout-preview layout-7-3">
                            <div class="layout-cell" style="grid-column: 1 / 5; grid-row: 1;"></div>
                            <div class="layout-cell" style="grid-column: 1; grid-row: 2;"></div>
                            <div class="layout-cell" style="grid-column: 2; grid-row: 2;"></div>
                            <div class="layout-cell" style="grid-column: 3 / 5; grid-row: 2;"></div>
                            <div class="layout-cell" style="grid-column: 1; grid-row: 3;"></div>
                            <div class="layout-cell" style="grid-column: 2; grid-row: 3;"></div>
                            <div class="layout-cell" style="grid-column: 3 / 5; grid-row: 3;"></div>
                        </div>
                    </div>
                    <div class="layout-item" data-layout="7-4" data-count="7">
                        <div class="layout-preview layout-7-4">
                            <div class="layout-cell" style="grid-column: 1; grid-row: 1 / 4;"></div>
                            <div class="layout-cell" style="grid-column: 2; grid-row: 1;"></div>
                            <div class="layout-cell" style="grid-column: 2; grid-row: 2;"></div>
                            <div class="layout-cell" style="grid-column: 2; grid-row: 3;"></div>
                            <div class="layout-cell" style="grid-column: 3; grid-row: 1;"></div>
                            <div class="layout-cell" style="grid-column: 3; grid-row: 2;"></div>
                            <div class="layout-cell" style="grid-column: 3; grid-row: 3;"></div>
                        </div>
                    </div>
                    <div class="layout-item" data-layout="7-5" data-count="7">
                        <div class="layout-preview layout-7-5">
                            <div class="layout-cell" style="grid-column: 1; grid-row: 1;"></div>
                            <div class="layout-cell" style="grid-column: 2; grid-row: 1;"></div>
                            <div class="layout-cell" style="grid-column: 3; grid-row: 1;"></div>
                            <div class="layout-cell" style="grid-column: 1 / 4; grid-row: 2;"></div>
                            <div class="layout-cell" style="grid-column: 1; grid-row: 3;"></div>
                            <div class="layout-cell" style="grid-column: 2; grid-row: 3;"></div>
                            <div class="layout-cell" style="grid-column: 3; grid-row: 3;"></div>
                        </div>
                    </div>
                    <div class="layout-item" data-layout="7-6" data-count="7">
                        <div class="layout-preview layout-7-6">
                            <div class="layout-cell" style="grid-column: 1 / 4; grid-row: 1;"></div>
                            <div class="layout-cell" style="grid-column: 4 / 7; grid-row: 1;"></div>
                            <div class="layout-cell" style="grid-column: 1 / 3; grid-row: 2;"></div>
                            <div class="layout-cell" style="grid-column: 3 / 5; grid-row: 2;"></div>
                            <div class="layout-cell" style="grid-column: 5 / 7; grid-row: 2;"></div>
                            <div class="layout-cell" style="grid-column: 1 / 4; grid-row: 3;"></div>
                            <div class="layout-cell" style="grid-column: 4 / 7; grid-row: 3;"></div>
                        </div>
                    </div>
                    <div class="layout-item" data-layout="7-7" data-count="7">
                        <div class="layout-preview layout-7-7">
                            <div class="layout-cell" style="grid-column: 1 / 4; grid-row: 1;"></div>
                            <div class="layout-cell" style="grid-column: 1; grid-row: 2;"></div>
                            <div class="layout-cell" style="grid-column: 2; grid-row: 2;"></div>
                            <div class="layout-cell" style="grid-column: 3; grid-row: 2;"></div>
                            <div class="layout-cell" style="grid-column: 1; grid-row: 3;"></div>
                            <div class="layout-cell" style="grid-column: 2; grid-row: 3;"></div>
                            <div class="layout-cell" style="grid-column: 3; grid-row: 3;"></div>
                        </div>
                    </div>
                    <div class="layout-item" data-layout="7-8" data-count="7">
                        <div class="layout-preview layout-7-8">
                            <div class="layout-cell" style="grid-column: 1; grid-row: 1;"></div>
                            <div class="layout-cell" style="grid-column: 2; grid-row: 1;"></div>
                            <div class="layout-cell" style="grid-column: 3; grid-row: 1;"></div>
                            <div class="layout-cell" style="grid-column: 1 / 3; grid-row: 2 / 5;"></div>
                            <div class="layout-cell" style="grid-column: 3; grid-row: 2;"></div>
                            <div class="layout-cell" style="grid-column: 3; grid-row: 3;"></div>
                            <div class="layout-cell" style="grid-column: 3; grid-row: 4;"></div>
                        </div>
                    </div>
                    <div class="layout-item" data-layout="7-9" data-count="7">
                        <div class="layout-preview layout-7-9">
                            <div class="layout-cell" style="grid-column: 1; grid-row: 1;"></div>
                            <div class="layout-cell" style="grid-column: 2; grid-row: 1;"></div>
                            <div class="layout-cell" style="grid-column: 3; grid-row: 1;"></div>
                            <div class="layout-cell" style="grid-column: 4; grid-row: 1;"></div>
                            <div class="layout-cell" style="grid-column: 1; grid-row: 2;"></div>
                            <div class="layout-cell" style="grid-column: 2 / 5; grid-row: 2 / 4;"></div>
                            <div class="layout-cell" style="grid-column: 1; grid-row: 3;"></div>
                        </div>
                    </div>
                    <div class="layout-item" data-layout="7-10" data-count="7">
                        <div class="layout-preview layout-7-10">
                            <div class="layout-cell" style="grid-column: 1 / 5; grid-row: 1 / 3;"></div>
                            <div class="layout-cell" style="grid-column: 5; grid-row: 1;"></div>
                            <div class="layout-cell" style="grid-column: 5; grid-row: 2;"></div>
                            <div class="layout-cell" style="grid-column: 5; grid-row: 3;"></div>
                            <div class="layout-cell" style="grid-column: 5; grid-row: 4;"></div>
                            <div class="layout-cell" style="grid-column: 1 / 3; grid-row: 3 / 5;"></div>
                            <div class="layout-cell" style="grid-column: 3 / 5; grid-row: 3 / 5;"></div>
                        </div>
                    </div>
                    <div class="layout-item" data-layout="7-11" data-count="7">
                        <div class="layout-preview layout-7-11">
                            <div class="layout-cell" style="grid-column: 1 / 3; grid-row: 1 / 3;"></div>
                            <div class="layout-cell" style="grid-column: 3 / 5; grid-row: 1 / 3;"></div>
                            <div class="layout-cell" style="grid-column: 1 / 3; grid-row: 3 / 5;"></div>
                            <div class="layout-cell" style="grid-column: 3; grid-row: 3;"></div>
                            <div class="layout-cell" style="grid-column: 4; grid-row: 3;"></div>
                            <div class="layout-cell" style="grid-column: 3; grid-row: 4;"></div>
                            <div class="layout-cell" style="grid-column: 4; grid-row: 4;"></div>
                        </div>
                    </div>
                    <div class="layout-item" data-layout="7-12" data-count="7">
                        <div class="layout-preview layout-7-12">
                            <div class="layout-cell" style="grid-column: 1 / 3; grid-row: 1 / 3;"></div>
                            <div class="layout-cell" style="grid-column: 3 / 5; grid-row: 1;"></div>
                            <div class="layout-cell" style="grid-column: 3 / 5; grid-row: 2;"></div>
                            <div class="layout-cell" style="grid-column: 3 / 5; grid-row: 3;"></div>
                            <div class="layout-cell" style="grid-column: 3; grid-row: 4;"></div>
                            <div class="layout-cell" style="grid-column: 4; grid-row: 4;"></div>
                            <div class="layout-cell" style="grid-column: 1 / 3; grid-row: 3 / 5;"></div>
                        </div>
                    </div>
                    <div class="layout-item" data-layout="7-13" data-count="7">
                        <div class="layout-preview layout-7-13">
                            <div class="layout-cell" style="grid-column: 1 / 4; grid-row: 1 / 3;"></div>
                            <div class="layout-cell" style="grid-column: 4 / 7; grid-row: 1 / 3;"></div>
                            <div class="layout-cell" style="grid-column: 1 / 3; grid-row: 3;"></div>
                            <div class="layout-cell" style="grid-column: 5 / 7; grid-row: 3;"></div>
                            <div class="layout-cell" style="grid-column: 3 / 5; grid-row: 3 / 5;"></div>
                            <div class="layout-cell" style="grid-column: 1 / 3; grid-row: 4;"></div>
                            <div class="layout-cell" style="grid-column: 5 / 7; grid-row: 4;"></div>
                        </div>
                    </div>
                    <div class="layout-item" data-layout="7-14" data-count="7">
                        <div class="layout-preview layout-7-14">
                            <div class="layout-cell" style="grid-column: 1; grid-row: 1;"></div>
                            <div class="layout-cell" style="grid-column: 2; grid-row: 1;"></div>
                            <div class="layout-cell" style="grid-column: 3; grid-row: 1;"></div>
                            <div class="layout-cell" style="grid-column: 1 / 3; grid-row: 2;"></div>
                            <div class="layout-cell" style="grid-column: 3; grid-row: 2;"></div>
                            <div class="layout-cell" style="grid-column: 1 / 3; grid-row: 3;"></div>
                            <div class="layout-cell" style="grid-column: 3; grid-row: 3;"></div>
                        </div>
                    </div>
                    <div class="layout-item" data-layout="7-15" data-count="7">
                        <div class="layout-preview layout-7-15">
                            <div class="layout-cell" style="grid-column: 1; grid-row: 1;"></div>
                            <div class="layout-cell" style="grid-column: 1; grid-row: 2;"></div>
                            <div class="layout-cell" style="grid-column: 1; grid-row: 3;"></div>
                            <div class="layout-cell" style="grid-column: 2; grid-row: 1;"></div>
                            <div class="layout-cell" style="grid-column: 2; grid-row: 2;"></div>
                            <div class="layout-cell" style="grid-column: 2; grid-row: 3;"></div>
                            <div class="layout-cell" style="grid-column: 3; grid-row: 1 / 4;"></div>
                        </div>
                    </div>
                    <div class="layout-item" data-layout="7-16" data-count="7">
                        <div class="layout-preview layout-7-16">
                            <div class="layout-cell" style="grid-column: 1 / 7; grid-row: 1 / 5;"></div>
                            <div class="layout-cell" style="grid-column: 1 / 7; grid-row: 5 / 9;"></div>
                            <div class="layout-cell" style="grid-column: 1 / 7; grid-row: 9 / 13;"></div>
                            <div class="layout-cell" style="grid-column: 7 / 10; grid-row: 1 / 4;"></div>
                            <div class="layout-cell" style="grid-column: 7 / 10; grid-row: 4 / 7;"></div>
                            <div class="layout-cell" style="grid-column: 10 / 13; grid-row: 1 / 7;"></div>
                            <div class="layout-cell" style="grid-column: 7 / 13; grid-row: 7 / 13;"></div>
                        </div>
                    </div>
                    <div class="layout-item" data-layout="7-17" data-count="7">
                        <div class="layout-preview layout-7-17">
                            <div class="layout-cell" style="grid-column: 1 / 7; grid-row: 1 / 5;"></div>
                            <div class="layout-cell" style="grid-column: 7 / 13; grid-row: 1 / 7;"></div>
                            <div class="layout-cell" style="grid-column: 1 / 4; grid-row: 5 / 9;"></div>
                            <div class="layout-cell" style="grid-column: 4 / 7; grid-row: 5 / 9;"></div>
                            <div class="layout-cell" style="grid-column: 1 / 4; grid-row: 9 / 13;"></div>
                            <div class="layout-cell" style="grid-column: 4 / 7; grid-row: 9 / 13;"></div>
                            <div class="layout-cell" style="grid-column: 7 / 13; grid-row: 7 / 13;"></div>
                        </div>
                    </div>
                    <div class="layout-item" data-layout="7-18" data-count="7">
                        <div class="layout-preview layout-7-18">
                            <div class="layout-cell" style="grid-column: 1 / 5; grid-row: 1 / 4;"></div>
                            <div class="layout-cell" style="grid-column: 1 / 5; grid-row: 4 / 7;"></div>
                            <div class="layout-cell" style="grid-column: 5 / 9; grid-row: 1 / 7;"></div>
                            <div class="layout-cell" style="grid-column: 9 / 13; grid-row: 1 / 7;"></div>
                            <div class="layout-cell" style="grid-column: 1 / 7; grid-row: 7 / 13;"></div>
                            <div class="layout-cell" style="grid-column: 7 / 13; grid-row: 7 / 10;"></div>
                            <div class="layout-cell" style="grid-column: 7 / 13; grid-row: 10 / 13;"></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <!-- 8图布局 -->
        <div class="layout-category">
            <div class="category-header expanded" data-target="layout-8">
                <div class="category-title">
                    <i class="fas fa-images"></i> 8图布局
                </div>
                <i class="fas fa-chevron-right category-arrow"></i>
            </div>
            <div class="layout-content" id="layout-8">
                <div class="layout-grid">
                    <div class="layout-item" data-layout="8-1" data-count="8">
                        <div class="layout-preview layout-8-1">
                            <div class="layout-cell"></div>
                            <div class="layout-cell"></div>
                            <div class="layout-cell"></div>
                            <div class="layout-cell"></div>
                            <div class="layout-cell"></div>
                            <div class="layout-cell"></div>
                            <div class="layout-cell"></div>
                            <div class="layout-cell"></div>
                        </div>
                    </div>
                    <div class="layout-item" data-layout="8-2" data-count="8">
                        <div class="layout-preview layout-8-2">
                            <div class="layout-cell"></div>
                            <div class="layout-cell"></div>
                            <div class="layout-cell"></div>
                            <div class="layout-cell"></div>
                            <div class="layout-cell"></div>
                            <div class="layout-cell"></div>
                            <div class="layout-cell"></div>
                            <div class="layout-cell"></div>
                        </div>
                    </div>
                    <div class="layout-item" data-layout="8-3" data-count="8">
                        <div class="layout-preview layout-8-3">
                            <div class="layout-cell"></div>
                            <div class="layout-cell"></div>
                            <div class="layout-cell"></div>
                            <div class="layout-cell"></div>
                            <div class="layout-cell"></div>
                            <div class="layout-cell"></div>
                            <div class="layout-cell"></div>
                            <div class="layout-cell"></div>
                        </div>
                    </div>
                    <div class="layout-item" data-layout="8-4" data-count="8">
                        <div class="layout-preview layout-8-4" style="display: grid; grid-template-columns: repeat(4, 1fr); grid-template-rows: repeat(4, 1fr); gap: 1px;">
                            <!-- 第1行：图1占3列，图2占1列 -->
                            <div class="layout-cell" style="grid-column: 1 / 4; grid-row: 1;"></div>
                            <div class="layout-cell" style="grid-column: 4; grid-row: 1;"></div>
                            <!-- 第2行：图3占3列，图4占1列 -->
                            <div class="layout-cell" style="grid-column: 1 / 4; grid-row: 2;"></div>
                            <div class="layout-cell" style="grid-column: 4; grid-row: 2;"></div>
                            <!-- 第3行：图5占3列，图6占1列 -->
                            <div class="layout-cell" style="grid-column: 1 / 4; grid-row: 3;"></div>
                            <div class="layout-cell" style="grid-column: 4; grid-row: 3;"></div>
                            <!-- 第4行：图7占3列，图8占1列 -->
                            <div class="layout-cell" style="grid-column: 1 / 4; grid-row: 4;"></div>
                            <div class="layout-cell" style="grid-column: 4; grid-row: 4;"></div>
                        </div>
                    </div>
                    <div class="layout-item" data-layout="8-5" data-count="8">
                        <div class="layout-preview" style="display: grid; grid-template-columns: repeat(4, 1fr); grid-template-rows: repeat(4, 1fr); gap: 1px;">
                            <!-- 图1：第1行，占1行2列 -->
                            <div class="layout-cell" style="grid-column: 1 / 3; grid-row: 1;"></div>
                            <!-- 图2：第1-2行，占1列2行 -->
                            <div class="layout-cell" style="grid-column: 3; grid-row: 1 / 3;"></div>
                            <!-- 图3：第1-2行，占1列2行 -->
                            <div class="layout-cell" style="grid-column: 4; grid-row: 1 / 3;"></div>
                            <!-- 图4：第2行，占1行2列 -->
                            <div class="layout-cell" style="grid-column: 1 / 3; grid-row: 2;"></div>
                            <!-- 图5：第3-4行，占1列2行 -->
                            <div class="layout-cell" style="grid-column: 1; grid-row: 3 / -1;"></div>
                            <!-- 图6：第3-4行，占1列2行 -->
                            <div class="layout-cell" style="grid-column: 2; grid-row: 3 / -1;"></div>
                            <!-- 图7：第3行，占2列1行 -->
                            <div class="layout-cell" style="grid-column: 3 / 5; grid-row: 3;"></div>
                            <!-- 图8：第4行第3-4列，占2列1行 -->
                            <div class="layout-cell" style="grid-column: 3 / 5; grid-row: 4;"></div>
                        </div>
                    </div>
                    <div class="layout-item" data-layout="8-6" data-count="8">
                        <div class="layout-preview" style="display: grid; grid-template-columns: repeat(4, 1fr); grid-template-rows: repeat(4, 1fr); gap: 1px;">
                            <!-- 图1：第1行第1列开始，占3行3列 -->
                            <div class="layout-cell" style="grid-column: 1 / 4; grid-row: 1 / 4;"></div>
                            <!-- 图2：第1行第4列，占1行1列 -->
                            <div class="layout-cell" style="grid-column: 4; grid-row: 1;"></div>
                            <!-- 图3：第2行第4列，占1行1列 -->
                            <div class="layout-cell" style="grid-column: 4; grid-row: 2;"></div>
                            <!-- 图4：第3行第4列，占1行1列 -->
                            <div class="layout-cell" style="grid-column: 4; grid-row: 3;"></div>
                            <!-- 图5：第4行第4列，占1行1列 -->
                            <div class="layout-cell" style="grid-column: 4; grid-row: 4;"></div>
                            <!-- 图6：第4行第1列，占1行1列 -->
                            <div class="layout-cell" style="grid-column: 1; grid-row: 4;"></div>
                            <!-- 图7：第4行第2列，占1行1列 -->
                            <div class="layout-cell" style="grid-column: 2; grid-row: 4;"></div>
                            <!-- 图8：第4行第3列，占1行1列 -->
                            <div class="layout-cell" style="grid-column: 3; grid-row: 4;"></div>
                        </div>
                    </div>
                    <div class="layout-item" data-layout="8-7" data-count="8">
                        <div class="layout-preview" style="display: grid; grid-template-columns: repeat(4, 1fr); grid-template-rows: repeat(4, 1fr); gap: 1px;">
                            <!-- 图1：第1行第1列，占1行1列 -->
                            <div class="layout-cell" style="grid-column: 1; grid-row: 1;"></div>
                            <!-- 图2：第2行第1列，占1行1列 -->
                            <div class="layout-cell" style="grid-column: 1; grid-row: 2;"></div>
                            <!-- 图3：第3行第1列，占1行1列 -->
                            <div class="layout-cell" style="grid-column: 1; grid-row: 3;"></div>
                            <!-- 图4：第4行第1列，占1行1列 -->
                            <div class="layout-cell" style="grid-column: 1; grid-row: 4;"></div>
                            <!-- 图5：第1行第2列开始，占3行3列 -->
                            <div class="layout-cell" style="grid-column: 2 / 5; grid-row: 1 / 4;"></div>
                            <!-- 图6：第4行第2列，占1行1列 -->
                            <div class="layout-cell" style="grid-column: 2; grid-row: 4;"></div>
                            <!-- 图7：第4行第3列，占1行1列 -->
                            <div class="layout-cell" style="grid-column: 3; grid-row: 4;"></div>
                            <!-- 图8：第4行第4列，占1行1列 -->
                            <div class="layout-cell" style="grid-column: 4; grid-row: 4;"></div>
                        </div>
                    </div>
                    <div class="layout-item" data-layout="8-8" data-count="8">
                        <div class="layout-preview" style="display: grid; grid-template-columns: repeat(4, 1fr); grid-template-rows: repeat(4, 1fr); gap: 1px;">
                            <!-- 图1：第1行第1列，占1行1列 -->
                            <div class="layout-cell" style="grid-column: 1; grid-row: 1;"></div>
                            <!-- 图2：第1行第2列，占1行1列 -->
                            <div class="layout-cell" style="grid-column: 2; grid-row: 1;"></div>
                            <!-- 图3：第1行第3列，占1行1列 -->
                            <div class="layout-cell" style="grid-column: 3; grid-row: 1;"></div>
                            <!-- 图4：第1行第4列，占1行1列 -->
                            <div class="layout-cell" style="grid-column: 4; grid-row: 1;"></div>
                            <!-- 图5：第2行第1列，占1行1列 -->
                            <div class="layout-cell" style="grid-column: 1; grid-row: 2;"></div>
                            <!-- 图6：第3行第1列，占1行1列 -->
                            <div class="layout-cell" style="grid-column: 1; grid-row: 3;"></div>
                            <!-- 图7：第4行第1列，占1行1列 -->
                            <div class="layout-cell" style="grid-column: 1; grid-row: 4;"></div>
                            <!-- 图8：第2行第2列开始，占3行3列 -->
                            <div class="layout-cell" style="grid-column: 2 / 5; grid-row: 2 / 5;"></div>
                        </div>
                    </div>
                    <div class="layout-item" data-layout="8-9" data-count="8">
                        <div class="layout-preview" style="display: grid; grid-template-columns: repeat(4, 1fr); grid-template-rows: repeat(4, 1fr); gap: 1px;">
                            <!-- 第1行：图1(1列) + 图2(3列) -->
                            <div class="layout-cell" style="grid-column: 1; grid-row: 1;"></div>
                            <div class="layout-cell" style="grid-column: 2 / 5; grid-row: 1;"></div>
                            <!-- 第2行：图3(3列) + 图4(1列) -->
                            <div class="layout-cell" style="grid-column: 1 / 4; grid-row: 2;"></div>
                            <div class="layout-cell" style="grid-column: 4; grid-row: 2;"></div>
                            <!-- 第3行：图5(1列) + 图6(3列) -->
                            <div class="layout-cell" style="grid-column: 1; grid-row: 3;"></div>
                            <div class="layout-cell" style="grid-column: 2 / 5; grid-row: 3;"></div>
                            <!-- 第4行：图7(3列) + 图8(1列) -->
                            <div class="layout-cell" style="grid-column: 1 / 4; grid-row: 4;"></div>
                            <div class="layout-cell" style="grid-column: 4; grid-row: 4;"></div>
                        </div>
                    </div>
                    <div class="layout-item" data-layout="8-10" data-count="8">
                        <div class="layout-preview layout-8-10">
                            <!-- 第1行：图1(4行6列) + 图2(4行6列) -->
                            <div class="layout-cell" style="grid-column: 1 / 7; grid-row: 1 / 5;"></div>
                            <div class="layout-cell" style="grid-column: 7 / 13; grid-row: 1 / 5;"></div>
                            <!-- 第5行：图3,4,5,6(各占3列4行) -->
                            <div class="layout-cell" style="grid-column: 1 / 4; grid-row: 5 / 9;"></div>
                            <div class="layout-cell" style="grid-column: 4 / 7; grid-row: 5 / 9;"></div>
                            <div class="layout-cell" style="grid-column: 7 / 10; grid-row: 5 / 9;"></div>
                            <div class="layout-cell" style="grid-column: 10 / 13; grid-row: 5 / 9;"></div>
                            <!-- 第9行：图7(4行6列) + 图8(4行6列) -->
                            <div class="layout-cell" style="grid-column: 1 / 7; grid-row: 9 / 13;"></div>
                            <div class="layout-cell" style="grid-column: 7 / 13; grid-row: 9 / 13;"></div>
                        </div>
                    </div>
                    <div class="layout-item" data-layout="8-11" data-count="8">
                        <div class="layout-preview" style="display: grid; grid-template-columns: repeat(6, 1fr); grid-template-rows: repeat(6, 1fr); gap: 1px;">
                            <!-- 第1行：图1,2,3 (各占2列2行) -->
                            <div class="layout-cell" style="grid-column: 1 / 3; grid-row: 1 / 3;"></div>
                            <div class="layout-cell" style="grid-column: 3 / 5; grid-row: 1 / 3;"></div>
                            <div class="layout-cell" style="grid-column: 5 / 7; grid-row: 1 / 3;"></div>
                            <!-- 第3行：图4,5 (各占3列2行) -->
                            <div class="layout-cell" style="grid-column: 1 / 4; grid-row: 3 / 5;"></div>
                            <div class="layout-cell" style="grid-column: 4 / 7; grid-row: 3 / 5;"></div>
                            <!-- 第5行：图6,7,8 (各占2列2行) -->
                            <div class="layout-cell" style="grid-column: 1 / 3; grid-row: 5 / 7;"></div>
                            <div class="layout-cell" style="grid-column: 3 / 5; grid-row: 5 / 7;"></div>
                            <div class="layout-cell" style="grid-column: 5 / 7; grid-row: 5 / 7;"></div>
                        </div>
                    </div>
                    <div class="layout-item" data-layout="8-12" data-count="8">
                        <div class="layout-preview" style="display: grid; grid-template-columns: repeat(6, 1fr); grid-template-rows: repeat(6, 1fr); gap: 1px;">
                            <!-- 第1列：图1,2,3 (各占2列2行) -->
                            <div class="layout-cell" style="grid-column: 1 / 3; grid-row: 1 / 3;"></div>
                            <div class="layout-cell" style="grid-column: 1 / 3; grid-row: 3 / 5;"></div>
                            <div class="layout-cell" style="grid-column: 1 / 3; grid-row: 5 / 7;"></div>
                            <!-- 第3列：图4,5 (各占2列3行) -->
                            <div class="layout-cell" style="grid-column: 3 / 5; grid-row: 1 / 4;"></div>
                            <div class="layout-cell" style="grid-column: 3 / 5; grid-row: 4 / 7;"></div>
                            <!-- 第5列：图6,7,8 (各占2列2行) -->
                            <div class="layout-cell" style="grid-column: 5 / 7; grid-row: 1 / 3;"></div>
                            <div class="layout-cell" style="grid-column: 5 / 7; grid-row: 3 / 5;"></div>
                            <div class="layout-cell" style="grid-column: 5 / 7; grid-row: 5 / 7;"></div>
                        </div>
                    </div>
                    <div class="layout-item" data-layout="8-13" data-count="8">
                        <div class="layout-preview" style="display: grid; grid-template-columns: repeat(4, 1fr); grid-template-rows: repeat(4, 1fr); gap: 1px;">
                            <!-- 第1行：图1(1×1) + 图2(1×2) + 图3(2×2) -->
                            <div class="layout-cell" style="grid-column: 1; grid-row: 1;"></div>
                            <div class="layout-cell" style="grid-column: 2; grid-row: 1 / 3;"></div>
                            <div class="layout-cell" style="grid-column: 3 / 5; grid-row: 1 / 3;"></div>
                            <!-- 第2行第1列：图4(1×1) - 修正位置避免重叠 -->
                            <div class="layout-cell" style="grid-column: 1; grid-row: 2;"></div>
                            <!-- 第3行：图5(2×2) + 图6(1×2) + 图7(1×1) -->
                            <div class="layout-cell" style="grid-column: 1 / 3; grid-row: 3 / 5;"></div>
                            <div class="layout-cell" style="grid-column: 3; grid-row: 3 / 5;"></div>
                            <div class="layout-cell" style="grid-column: 4; grid-row: 3;"></div>
                            <!-- 第4行第4列：图8(1×1) -->
                            <div class="layout-cell" style="grid-column: 4; grid-row: 4;"></div>
                        </div>
                    </div>
                    <div class="layout-item" data-layout="8-14" data-count="8">
                        <div class="layout-preview" style="display: grid; grid-template-columns: repeat(4, 1fr); grid-template-rows: repeat(4, 1fr); gap: 1px;">
                            <!-- 第1列：图1(1×2) + 图2(1×2) -->
                            <div class="layout-cell" style="grid-column: 1; grid-row: 1 / 3;"></div>
                            <div class="layout-cell" style="grid-column: 1; grid-row: 3 / 5;"></div>
                            <!-- 第2列：图3(1×2) + 图4(1×2) -->
                            <div class="layout-cell" style="grid-column: 2; grid-row: 1 / 3;"></div>
                            <div class="layout-cell" style="grid-column: 2; grid-row: 3 / 5;"></div>
                            <!-- 第3-4列：图5,6,7,8 (各占2×1) -->
                            <div class="layout-cell" style="grid-column: 3 / 5; grid-row: 1;"></div>
                            <div class="layout-cell" style="grid-column: 3 / 5; grid-row: 2;"></div>
                            <div class="layout-cell" style="grid-column: 3 / 5; grid-row: 3;"></div>
                            <div class="layout-cell" style="grid-column: 3 / 5; grid-row: 4;"></div>
                        </div>
                    </div>
                    <div class="layout-item" data-layout="8-15" data-count="8">
                        <div class="layout-preview" style="display: grid; grid-template-columns: repeat(12, 1fr); grid-template-rows: repeat(14, 1fr); gap: 1px;">
                            <!-- 第1行：图1,2 (各占6×3) -->
                            <div class="layout-cell" style="grid-column: 1 / 7; grid-row: 1 / 4;"></div>
                            <div class="layout-cell" style="grid-column: 7 / 13; grid-row: 1 / 4;"></div>
                            <!-- 第4行：图3,4,5 (各占4×3) -->
                            <div class="layout-cell" style="grid-column: 1 / 5; grid-row: 4 / 7;"></div>
                            <div class="layout-cell" style="grid-column: 5 / 9; grid-row: 4 / 7;"></div>
                            <div class="layout-cell" style="grid-column: 9 / 13; grid-row: 4 / 7;"></div>
                            <!-- 第7行：图6,7 (各占6×3) -->
                            <div class="layout-cell" style="grid-column: 1 / 7; grid-row: 7 / 10;"></div>
                            <div class="layout-cell" style="grid-column: 7 / 13; grid-row: 7 / 10;"></div>
                            <!-- 第10行：图8 (占12×5) -->
                            <div class="layout-cell" style="grid-column: 1 / 13; grid-row: 10 / 15;"></div>
                        </div>
                    </div>
                    <div class="layout-item" data-layout="8-16" data-count="8">
                        <div class="layout-preview" style="display: grid; grid-template-columns: repeat(6, 1fr); grid-template-rows: repeat(6, 1fr); gap: 1px;">
                            <!-- 第1列：图1,2 (各占2×3) -->
                            <div class="layout-cell" style="grid-column: 1 / 3; grid-row: 1 / 4;"></div>
                            <div class="layout-cell" style="grid-column: 1 / 3; grid-row: 4 / 7;"></div>
                            <!-- 第3列：图3,4,5 (各占2×2) -->
                            <div class="layout-cell" style="grid-column: 3 / 5; grid-row: 1 / 3;"></div>
                            <div class="layout-cell" style="grid-column: 3 / 5; grid-row: 3 / 5;"></div>
                            <div class="layout-cell" style="grid-column: 3 / 5; grid-row: 5 / 7;"></div>
                            <!-- 第5列：图6,7,8 (各占2×2) -->
                            <div class="layout-cell" style="grid-column: 5 / 7; grid-row: 1 / 3;"></div>
                            <div class="layout-cell" style="grid-column: 5 / 7; grid-row: 3 / 5;"></div>
                            <div class="layout-cell" style="grid-column: 5 / 7; grid-row: 5 / 7;"></div>
                        </div>
                    </div>
                    <div class="layout-item" data-layout="8-17" data-count="8">
                        <div class="layout-preview" style="display: grid; grid-template-columns: repeat(4, 1fr); grid-template-rows: repeat(6, 1fr); gap: 1px;">
                            <!-- 第1行：图1,2 (各占2列2行) -->
                            <div class="layout-cell" style="grid-column: 1 / 3; grid-row: 1 / 3;"></div>
                            <div class="layout-cell" style="grid-column: 3 / 5; grid-row: 1 / 3;"></div>
                            <!-- 第2行：图3,4 (各占2列2行) -->
                            <div class="layout-cell" style="grid-column: 1 / 3; grid-row: 3 / 5;"></div>
                            <div class="layout-cell" style="grid-column: 3 / 5; grid-row: 3 / 5;"></div>
                            <!-- 第3行：图5,6,7,8 (各占1列2行) -->
                            <div class="layout-cell" style="grid-column: 1; grid-row: 5 / 7;"></div>
                            <div class="layout-cell" style="grid-column: 2; grid-row: 5 / 7;"></div>
                            <div class="layout-cell" style="grid-column: 3; grid-row: 5 / 7;"></div>
                            <div class="layout-cell" style="grid-column: 4; grid-row: 5 / 7;"></div>
                        </div>
                    </div>
                    <div class="layout-item" data-layout="8-18" data-count="8">
                        <div class="layout-preview layout-8-18" style="display: grid; grid-template-columns: repeat(4, 1fr); grid-template-rows: repeat(4, 1fr); gap: 1px;">
                            <!-- 第1行：图1(2列1行) + 图2(1列2行) + 图3(1列2行) -->
                            <div class="layout-cell" style="grid-column: 1 / 3; grid-row: 1;"></div>
                            <div class="layout-cell" style="grid-column: 3; grid-row: 1 / 3;"></div>
                            <div class="layout-cell" style="grid-column: 4; grid-row: 1 / 3;"></div>
                            <!-- 第2行：图4(2列1行) -->
                            <div class="layout-cell" style="grid-column: 1 / 3; grid-row: 2;"></div>
                            <!-- 第3行：图5(1列2行) + 图6(1列2行) + 图7(2列1行) -->
                            <div class="layout-cell" style="grid-column: 1; grid-row: 3 / 5;"></div>
                            <div class="layout-cell" style="grid-column: 2; grid-row: 3 / 5;"></div>
                            <div class="layout-cell" style="grid-column: 3 / 5; grid-row: 3;"></div>
                            <!-- 第4行第3列：图8(2列1行) -->
                            <div class="layout-cell" style="grid-column: 3 / 5; grid-row: 4;"></div>
                        </div>
                    </div>
                    <div class="layout-item" data-layout="8-19" data-count="8">
                        <div class="layout-preview layout-8-19" style="display: grid; grid-template-columns: repeat(4, 1fr); grid-template-rows: repeat(3, 1fr); gap: 1px;">
                            <!-- 第1列：图1(3行1列) -->
                            <div class="layout-cell" style="grid-column: 1; grid-row: 1 / 4;"></div>
                            <!-- 第2列：图2,3,4(各占1行1列) -->
                            <div class="layout-cell" style="grid-column: 2; grid-row: 1;"></div>
                            <div class="layout-cell" style="grid-column: 2; grid-row: 2;"></div>
                            <div class="layout-cell" style="grid-column: 2; grid-row: 3;"></div>
                            <!-- 第3列：图5,6,7(各占1行1列) -->
                            <div class="layout-cell" style="grid-column: 3; grid-row: 1;"></div>
                            <div class="layout-cell" style="grid-column: 3; grid-row: 2;"></div>
                            <div class="layout-cell" style="grid-column: 3; grid-row: 3;"></div>
                            <!-- 第4列：图8(3行1列) -->
                            <div class="layout-cell" style="grid-column: 4; grid-row: 1 / 4;"></div>
                        </div>
                    </div>
                    <div class="layout-item" data-layout="8-20" data-count="8">
                        <div class="layout-preview layout-8-20" style="display: grid; grid-template-columns: repeat(3, 1fr); grid-template-rows: repeat(4, 1fr); gap: 1px;">
                            <!-- 第1行：图1(3列1行) -->
                            <div class="layout-cell" style="grid-column: 1 / 4; grid-row: 1;"></div>
                            <!-- 第2行：图2,3,4(各占1列1行) -->
                            <div class="layout-cell" style="grid-column: 1; grid-row: 2;"></div>
                            <div class="layout-cell" style="grid-column: 2; grid-row: 2;"></div>
                            <div class="layout-cell" style="grid-column: 3; grid-row: 2;"></div>
                            <!-- 第3行：图5,6,7(各占1列1行) -->
                            <div class="layout-cell" style="grid-column: 1; grid-row: 3;"></div>
                            <div class="layout-cell" style="grid-column: 2; grid-row: 3;"></div>
                            <div class="layout-cell" style="grid-column: 3; grid-row: 3;"></div>
                            <!-- 第4行：图8(3列1行) -->
                            <div class="layout-cell" style="grid-column: 1 / 4; grid-row: 4;"></div>
                        </div>
                    </div>
                    <div class="layout-item" data-layout="8-21" data-count="8">
                        <div class="layout-preview layout-8-21" style="display: grid; grid-template-columns: repeat(4, 1fr); grid-template-rows: repeat(5, 1fr); gap: 1px;">
                            <!-- 第1行：图1(2列2行) + 图2(2列2行) -->
                            <div class="layout-cell" style="grid-column: 1 / 3; grid-row: 1 / 3;"></div>
                            <div class="layout-cell" style="grid-column: 3 / 5; grid-row: 1 / 3;"></div>
                            <!-- 第3行：图3,4,5,6(各占1列1行) -->
                            <div class="layout-cell" style="grid-column: 1; grid-row: 3;"></div>
                            <div class="layout-cell" style="grid-column: 2; grid-row: 3;"></div>
                            <div class="layout-cell" style="grid-column: 3; grid-row: 3;"></div>
                            <div class="layout-cell" style="grid-column: 4; grid-row: 3;"></div>
                            <!-- 第4行：图7(2列2行) + 图8(2列2行) -->
                            <div class="layout-cell" style="grid-column: 1 / 3; grid-row: 4 / 6;"></div>
                            <div class="layout-cell" style="grid-column: 3 / 5; grid-row: 4 / 6;"></div>
                        </div>
                    </div>
                    <div class="layout-item" data-layout="8-22" data-count="8">
                        <div class="layout-preview layout-8-22" style="display: grid; grid-template-columns: repeat(5, 1fr); grid-template-rows: repeat(4, 1fr); gap: 1px;">
                            <!-- 第1列：图1(2列2行) + 图2(2列2行) -->
                            <div class="layout-cell" style="grid-column: 1 / 3; grid-row: 1 / 3;"></div>
                            <div class="layout-cell" style="grid-column: 1 / 3; grid-row: 3 / 5;"></div>
                            <!-- 第3列：图3,4,5,6(各占1列1行) -->
                            <div class="layout-cell" style="grid-column: 3; grid-row: 1;"></div>
                            <div class="layout-cell" style="grid-column: 3; grid-row: 2;"></div>
                            <div class="layout-cell" style="grid-column: 3; grid-row: 3;"></div>
                            <div class="layout-cell" style="grid-column: 3; grid-row: 4;"></div>
                            <!-- 第4列：图7(2列2行) + 图8(2列2行) -->
                            <div class="layout-cell" style="grid-column: 4 / 6; grid-row: 1 / 3;"></div>
                            <div class="layout-cell" style="grid-column: 4 / 6; grid-row: 3 / 5;"></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <!-- 9图布局 -->
        <div class="layout-category">
            <div class="category-header expanded" data-target="layout-9">
                <div class="category-title">
                    <i class="fas fa-images"></i> 9图布局
                </div>
                <i class="fas fa-chevron-right category-arrow"></i>
            </div>
            <div class="layout-content" id="layout-9">
                <div class="layout-grid">
                    <div class="layout-item" data-layout="9-1" data-count="9">
                        <div class="layout-preview layout-9-1">
                            <div class="layout-cell"></div>
                            <div class="layout-cell"></div>
                            <div class="layout-cell"></div>
                            <div class="layout-cell"></div>
                            <div class="layout-cell"></div>
                            <div class="layout-cell"></div>
                            <div class="layout-cell"></div>
                            <div class="layout-cell"></div>
                            <div class="layout-cell"></div>
                        </div>
                    </div>
                    <div class="layout-item" data-layout="9-2" data-count="9">
                        <div class="layout-preview layout-9-2" style="display: grid; grid-template-columns: repeat(4, 1fr); grid-template-rows: repeat(4, 1fr); gap: 1px;">
                            <!-- 第1列：图1,2,3,4(各占1列1行) -->
                            <div class="layout-cell" style="grid-column: 1; grid-row: 1;"></div>
                            <div class="layout-cell" style="grid-column: 1; grid-row: 2;"></div>
                            <div class="layout-cell" style="grid-column: 1; grid-row: 3;"></div>
                            <div class="layout-cell" style="grid-column: 1; grid-row: 4;"></div>
                            <!-- 第2-3列：图5(2列4行) -->
                            <div class="layout-cell" style="grid-column: 2 / 4; grid-row: 1 / 5;"></div>
                            <!-- 第4列：图6,7,8,9(各占1列1行) -->
                            <div class="layout-cell" style="grid-column: 4; grid-row: 1;"></div>
                            <div class="layout-cell" style="grid-column: 4; grid-row: 2;"></div>
                            <div class="layout-cell" style="grid-column: 4; grid-row: 3;"></div>
                            <div class="layout-cell" style="grid-column: 4; grid-row: 4;"></div>
                        </div>
                    </div>
                    <div class="layout-item" data-layout="9-3" data-count="9">
                        <div class="layout-preview layout-9-3" style="display: grid; grid-template-columns: repeat(4, 1fr); grid-template-rows: repeat(4, 1fr); gap: 1px;">
                            <!-- 第1行：图1,2,3,4(各占1列1行) -->
                            <div class="layout-cell" style="grid-column: 1; grid-row: 1;"></div>
                            <div class="layout-cell" style="grid-column: 2; grid-row: 1;"></div>
                            <div class="layout-cell" style="grid-column: 3; grid-row: 1;"></div>
                            <div class="layout-cell" style="grid-column: 4; grid-row: 1;"></div>
                            <!-- 第2-3行：图5(4列2行) -->
                            <div class="layout-cell" style="grid-column: 1 / 5; grid-row: 2 / 4;"></div>
                            <!-- 第4行：图6,7,8,9(各占1列1行) -->
                            <div class="layout-cell" style="grid-column: 1; grid-row: 4;"></div>
                            <div class="layout-cell" style="grid-column: 2; grid-row: 4;"></div>
                            <div class="layout-cell" style="grid-column: 3; grid-row: 4;"></div>
                            <div class="layout-cell" style="grid-column: 4; grid-row: 4;"></div>
                        </div>
                    </div>
                    <div class="layout-item" data-layout="9-4" data-count="9">
                        <div class="layout-preview layout-9-4" style="display: grid; grid-template-columns: repeat(4, 1fr); grid-template-rows: repeat(4, 1fr); gap: 1px;">
                            <!-- 第1行：图1(2列2行) + 图2(1列2行) + 图3(1列2行) -->
                            <div class="layout-cell" style="grid-column: 1 / 3; grid-row: 1 / 3;"></div>
                            <div class="layout-cell" style="grid-column: 3; grid-row: 1 / 3;"></div>
                            <div class="layout-cell" style="grid-column: 4; grid-row: 1 / 3;"></div>
                            <!-- 第3行：图4(2行1列) + 图5(1行1列) + 图6(1行1列) -->
                            <div class="layout-cell" style="grid-column: 1; grid-row: 3 / 5;"></div>
                            <div class="layout-cell" style="grid-column: 2; grid-row: 3;"></div>
                            <div class="layout-cell" style="grid-column: 3; grid-row: 3;"></div>
                            <!-- 第4行：图7(2列1行) + 图8(1列1行) + 图9(1列1行) -->
                            <div class="layout-cell" style="grid-column: 2 / 4; grid-row: 4;"></div>
                            <div class="layout-cell" style="grid-column: 4; grid-row: 3;"></div>
                            <div class="layout-cell" style="grid-column: 4; grid-row: 4;"></div>
                        </div>
                    </div>
                    <div class="layout-item" data-layout="9-5" data-count="9">
                        <div class="layout-preview layout-9-5" style="display: grid; grid-template-columns: repeat(4, 1fr); grid-template-rows: repeat(4, 1fr); gap: 1px;">
                            <!-- 第1-2列：图1(2列4行) -->
                            <div class="layout-cell" style="grid-column: 1 / 3; grid-row: 1 / 5;"></div>
                            <!-- 第3列：图2,3,4,5(各占1列1行) -->
                            <div class="layout-cell" style="grid-column: 3; grid-row: 1;"></div>
                            <div class="layout-cell" style="grid-column: 3; grid-row: 2;"></div>
                            <div class="layout-cell" style="grid-column: 3; grid-row: 3;"></div>
                            <div class="layout-cell" style="grid-column: 3; grid-row: 4;"></div>
                            <!-- 第4列：图6,7,8,9(各占1列1行) -->
                            <div class="layout-cell" style="grid-column: 4; grid-row: 1;"></div>
                            <div class="layout-cell" style="grid-column: 4; grid-row: 2;"></div>
                            <div class="layout-cell" style="grid-column: 4; grid-row: 3;"></div>
                            <div class="layout-cell" style="grid-column: 4; grid-row: 4;"></div>
                        </div>
                    </div>
                    <div class="layout-item" data-layout="9-6" data-count="9">
                        <div class="layout-preview layout-9-6" style="display: grid; grid-template-columns: repeat(4, 1fr); grid-template-rows: repeat(4, 1fr); gap: 1px;">
                            <!-- 第1行：图1(2行4列) -->
                            <div class="layout-cell" style="grid-column: 1 / 5; grid-row: 1 / 3;"></div>
                            <!-- 第3行：图2,3,4,5(各占1列1行) -->
                            <div class="layout-cell" style="grid-column: 1; grid-row: 3;"></div>
                            <div class="layout-cell" style="grid-column: 2; grid-row: 3;"></div>
                            <div class="layout-cell" style="grid-column: 3; grid-row: 3;"></div>
                            <div class="layout-cell" style="grid-column: 4; grid-row: 3;"></div>
                            <!-- 第4行：图6,7,8,9(各占1列1行) -->
                            <div class="layout-cell" style="grid-column: 1; grid-row: 4;"></div>
                            <div class="layout-cell" style="grid-column: 2; grid-row: 4;"></div>
                            <div class="layout-cell" style="grid-column: 3; grid-row: 4;"></div>
                            <div class="layout-cell" style="grid-column: 4; grid-row: 4;"></div>
                        </div>
                    </div>
                    <div class="layout-item" data-layout="9-7" data-count="9">
                        <div class="layout-preview layout-9-7" style="display: grid; grid-template-columns: repeat(4, 1fr); grid-template-rows: repeat(5, 1fr); gap: 1px;">
                            <!-- 第1行：图1,2(各占2列1行) -->
                            <div class="layout-cell" style="grid-column: 1 / 3; grid-row: 1;"></div>
                            <div class="layout-cell" style="grid-column: 3 / 5; grid-row: 1;"></div>
                            <!-- 第2行：图3(1列3行) + 图4(2列3行) + 图5(1列3行) -->
                            <div class="layout-cell" style="grid-column: 1; grid-row: 2 / 5;"></div>
                            <div class="layout-cell" style="grid-column: 2 / 4; grid-row: 2 / 5;"></div>
                            <div class="layout-cell" style="grid-column: 4; grid-row: 2 / 5;"></div>
                            <!-- 第5行：图6,7,8,9(各占1列1行) -->
                            <div class="layout-cell" style="grid-column: 1; grid-row: 5;"></div>
                            <div class="layout-cell" style="grid-column: 2; grid-row: 5;"></div>
                            <div class="layout-cell" style="grid-column: 3; grid-row: 5;"></div>
                            <div class="layout-cell" style="grid-column: 4; grid-row: 5;"></div>
                        </div>
                    </div>
                    <div class="layout-item" data-layout="9-8" data-count="9">
                        <div class="layout-preview layout-9-8" style="display: grid; grid-template-columns: repeat(6, 1fr); grid-template-rows: repeat(6, 1fr); gap: 1px;">
                            <!-- 第1行：图1(2行2列) + 图2(1行1列) + 图3(3行3列) -->
                            <div class="layout-cell" style="grid-column: 1 / 3; grid-row: 1 / 3;"></div>
                            <div class="layout-cell" style="grid-column: 3; grid-row: 1;"></div>
                            <div class="layout-cell" style="grid-column: 4 / 7; grid-row: 1 / 4;"></div>
                            <!-- 第2行第3列：图4(1行1列) -->
                            <div class="layout-cell" style="grid-column: 3; grid-row: 2;"></div>
                            <!-- 第3行：图5,6,7(各占1列1行) -->
                            <div class="layout-cell" style="grid-column: 1; grid-row: 3;"></div>
                            <div class="layout-cell" style="grid-column: 2; grid-row: 3;"></div>
                            <div class="layout-cell" style="grid-column: 3; grid-row: 3;"></div>
                            <!-- 第4行：图8(3列3行) + 图9(3列3行) -->
                            <div class="layout-cell" style="grid-column: 1 / 4; grid-row: 4 / 7;"></div>
                            <div class="layout-cell" style="grid-column: 4 / 7; grid-row: 4 / 7;"></div>
                        </div>
                    </div>
                    <div class="layout-item" data-layout="9-9" data-count="9">
                        <div class="layout-preview layout-9-9" style="display: grid; grid-template-columns: repeat(12, 1fr); grid-template-rows: repeat(12, 1fr); gap: 1px;">
                            <!-- 第1行：4个图形，各占3列4行 -->
                            <div class="layout-cell" style="grid-column: 1 / 4; grid-row: 1 / 5;"></div>
                            <div class="layout-cell" style="grid-column: 4 / 7; grid-row: 1 / 5;"></div>
                            <div class="layout-cell" style="grid-column: 7 / 10; grid-row: 1 / 5;"></div>
                            <div class="layout-cell" style="grid-column: 10 / 13; grid-row: 1 / 5;"></div>
                            <!-- 第5行：4个图形，各占3列4行 -->
                            <div class="layout-cell" style="grid-column: 1 / 4; grid-row: 5 / 9;"></div>
                            <div class="layout-cell" style="grid-column: 4 / 7; grid-row: 5 / 9;"></div>
                            <div class="layout-cell" style="grid-column: 7 / 10; grid-row: 5 / 9;"></div>
                            <div class="layout-cell" style="grid-column: 10 / 13; grid-row: 5 / 9;"></div>
                            <!-- 第10列：1个图形，占4行12列 -->
                            <div class="layout-cell" style="grid-column: 1 / 13; grid-row: 9 / 13;"></div>
                        </div>
                    </div>
                    <div class="layout-item" data-layout="9-10" data-count="9">
                        <div class="layout-preview layout-9-10" style="display: grid; grid-template-columns: repeat(12, 1fr); grid-template-rows: repeat(12, 1fr); gap: 1px;">
                            <!-- 第1行：图1(6列8行) + 图2(3列4行) + 图3(3列4行) -->
                            <div class="layout-cell" style="grid-column: 1 / 7; grid-row: 1 / 9;"></div>
                            <div class="layout-cell" style="grid-column: 7 / 10; grid-row: 1 / 5;"></div>
                            <div class="layout-cell" style="grid-column: 10 / 13; grid-row: 1 / 5;"></div>
                            <!-- 第5行第7列：2个图形，各3列4行 -->
                            <div class="layout-cell" style="grid-column: 7 / 10; grid-row: 5 / 9;"></div>
                            <div class="layout-cell" style="grid-column: 10 / 13; grid-row: 5 / 9;"></div>
                            <!-- 第10列：4个图形，占4行3列 -->
                            <div class="layout-cell" style="grid-column: 1 / 4; grid-row: 9 / 13;"></div>
                            <div class="layout-cell" style="grid-column: 4 / 7; grid-row: 9 / 13;"></div>
                            <div class="layout-cell" style="grid-column: 7 / 10; grid-row: 9 / 13;"></div>
                            <div class="layout-cell" style="grid-column: 10 / 13; grid-row: 9 / 13;"></div>
                        </div>
                    </div>
                    <div class="layout-item" data-layout="9-11" data-count="9">
                        <div class="layout-preview layout-9-11" style="display: grid; grid-template-columns: repeat(12, 1fr); grid-template-rows: repeat(12, 1fr); gap: 1px;">
                            <!-- 第1行：4个图形，各占4行3列 -->
                            <div class="layout-cell" style="grid-column: 1 / 4; grid-row: 1 / 5;"></div>
                            <div class="layout-cell" style="grid-column: 4 / 7; grid-row: 1 / 5;"></div>
                            <div class="layout-cell" style="grid-column: 7 / 10; grid-row: 1 / 5;"></div>
                            <div class="layout-cell" style="grid-column: 10 / 13; grid-row: 1 / 5;"></div>
                            <!-- 第5行：3个图形，第1个占3列4行，第2个占3列4行，第3个占8行6列 -->
                            <div class="layout-cell" style="grid-column: 1 / 4; grid-row: 5 / 9;"></div>
                            <div class="layout-cell" style="grid-column: 4 / 7; grid-row: 5 / 9;"></div>
                            <div class="layout-cell" style="grid-column: 7 / 13; grid-row: 5 / 13;"></div>
                            <!-- 第9行：2个图形，各占3列4行 -->
                            <div class="layout-cell" style="grid-column: 1 / 4; grid-row: 9 / 13;"></div>
                            <div class="layout-cell" style="grid-column: 4 / 7; grid-row: 9 / 13;"></div>
                        </div>
                    </div>
                    <div class="layout-item" data-layout="9-12" data-count="9">
                        <div class="layout-preview layout-9-12" style="display: grid; grid-template-columns: repeat(4, 1fr); grid-template-rows: repeat(4, 1fr); gap: 1px;">
                            <!-- 第1行：4个图形，各占1列 -->
                            <div class="layout-cell" style="grid-column: 1; grid-row: 1;"></div>
                            <div class="layout-cell" style="grid-column: 2; grid-row: 1;"></div>
                            <div class="layout-cell" style="grid-column: 3; grid-row: 1;"></div>
                            <div class="layout-cell" style="grid-column: 4; grid-row: 1;"></div>
                            <!-- 第2行：1个图形，占4列2行 -->
                            <div class="layout-cell" style="grid-column: 1 / 5; grid-row: 2 / 4;"></div>
                            <!-- 第4行：4个图形，各占1列 -->
                            <div class="layout-cell" style="grid-column: 1; grid-row: 4;"></div>
                            <div class="layout-cell" style="grid-column: 2; grid-row: 4;"></div>
                            <div class="layout-cell" style="grid-column: 3; grid-row: 4;"></div>
                            <div class="layout-cell" style="grid-column: 4; grid-row: 4;"></div>
                        </div>
                    </div>
                    <div class="layout-item" data-layout="9-13" data-count="9">
                        <div class="layout-preview layout-9-13" style="display: grid; grid-template-columns: repeat(6, 1fr); grid-template-rows: repeat(6, 1fr); gap: 1px;">
                            <!-- 第1行：2个图形，各占3列3行 -->
                            <div class="layout-cell" style="grid-column: 1 / 4; grid-row: 1 / 4;"></div>
                            <div class="layout-cell" style="grid-column: 4 / 7; grid-row: 1 / 4;"></div>
                            <!-- 第4行第1列：1个图形，占3列3行 -->
                            <div class="layout-cell" style="grid-column: 1 / 4; grid-row: 4 / 7;"></div>
                            <!-- 第4行第4列：1个图形，占2列2行 -->
                            <div class="layout-cell" style="grid-column: 4 / 6; grid-row: 4 / 6;"></div>
                            <!-- 第4行第6列：1个图形，占1列1行 -->
                            <div class="layout-cell" style="grid-column: 6; grid-row: 4;"></div>
                            <!-- 第5行第6列：1个图形，占1列1行 -->
                            <div class="layout-cell" style="grid-column: 6; grid-row: 5;"></div>
                            <!-- 第6行第6列：1个图形，占1列1行 -->
                            <div class="layout-cell" style="grid-column: 6; grid-row: 6;"></div>
                            <!-- 第6行第4列：1个图形，占1列1行 -->
                            <div class="layout-cell" style="grid-column: 4; grid-row: 6;"></div>
                            <!-- 第6行第5列：1个图形，占1列1行 -->
                            <div class="layout-cell" style="grid-column: 5; grid-row: 6;"></div>
                        </div>
                    </div>
                    <div class="layout-item" data-layout="9-14" data-count="9">
                        <div class="layout-preview layout-9-14" style="display: grid; grid-template-columns: repeat(6, 1fr); grid-template-rows: repeat(6, 1fr); gap: 1px;">
                            <!-- 第1列第1行：1个图形，占3列3行 -->
                            <div class="layout-cell" style="grid-column: 1 / 4; grid-row: 1 / 4;"></div>
                            <!-- 第1列第4行：1个图形，占3列3行 -->
                            <div class="layout-cell" style="grid-column: 1 / 4; grid-row: 4 / 7;"></div>
                            <!-- 第1行第4列：1个图形，占2列2行 -->
                            <div class="layout-cell" style="grid-column: 4 / 6; grid-row: 1 / 3;"></div>
                            <!-- 第3行第4列：1个图形，占1列1行 -->
                            <div class="layout-cell" style="grid-column: 4; grid-row: 3;"></div>
                            <!-- 第3行第5列：1个图形，占1列1行 -->
                            <div class="layout-cell" style="grid-column: 5; grid-row: 3;"></div>
                            <!-- 第3行第6列：1个图形，占1列1行 -->
                            <div class="layout-cell" style="grid-column: 6; grid-row: 3;"></div>
                            <!-- 第6列第1行：1个图形，占1列1行 -->
                            <div class="layout-cell" style="grid-column: 6; grid-row: 1;"></div>
                            <!-- 第6列第2行：1个图形，占1列1行 -->
                            <div class="layout-cell" style="grid-column: 6; grid-row: 2;"></div>
                            <!-- 第4行第4列：1个图形，占3列3行 -->
                            <div class="layout-cell" style="grid-column: 4 / 7; grid-row: 4 / 7;"></div>
                        </div>
                    </div>
                    <div class="layout-item" data-layout="9-15" data-count="9">
                        <div class="layout-preview layout-9-15" style="display: grid; grid-template-columns: repeat(6, 1fr); grid-template-rows: repeat(6, 1fr); gap: 1px;">
                            <!-- 第1行第1列：1个图形，占3列3行 -->
                            <div class="layout-cell" style="grid-column: 1 / 4; grid-row: 1 / 4;"></div>
                            <!-- 第1行第4列：1个图形，占3列3行 -->
                            <div class="layout-cell" style="grid-column: 4 / 7; grid-row: 1 / 4;"></div>
                            <!-- 第4行第1列：1个图形，占2列2行 -->
                            <div class="layout-cell" style="grid-column: 1 / 3; grid-row: 4 / 6;"></div>
                            <!-- 第4行第3列：1个图形，占1列1行 -->
                            <div class="layout-cell" style="grid-column: 3; grid-row: 4;"></div>
                            <!-- 第5行第3列：1个图形，占1列1行 -->
                            <div class="layout-cell" style="grid-column: 3; grid-row: 5;"></div>
                            <!-- 第6行第3列：1个图形，占1列1行 -->
                            <div class="layout-cell" style="grid-column: 3; grid-row: 6;"></div>
                            <!-- 第6行第1列：1个图形，占1列1行 -->
                            <div class="layout-cell" style="grid-column: 1; grid-row: 6;"></div>
                            <!-- 第6行第2列：1个图形，占1列1行 -->
                            <div class="layout-cell" style="grid-column: 2; grid-row: 6;"></div>
                            <!-- 第4行第4列：1个图形，占3列3行 -->
                            <div class="layout-cell" style="grid-column: 4 / 7; grid-row: 4 / 7;"></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <!-- 10图布局 -->
        <div class="layout-category">
            <div class="category-header expanded" data-target="layout-10">
                <div class="category-title">
                    <i class="fas fa-images"></i> 10图布局
                </div>
                <i class="fas fa-chevron-right category-arrow"></i>
            </div>
            <div class="layout-content" id="layout-10">
                <div class="layout-grid">
                    <div class="layout-item" data-layout="10-1" data-count="10">
                        <div class="layout-preview layout-10-1" style="display: grid; grid-template-columns: repeat(5, 1fr); grid-template-rows: repeat(5, 1fr); gap: 1px;">
                            <!-- 图1：占4行4列 -->
                            <div class="layout-cell" style="grid-column: 1 / 5; grid-row: 1 / 5;"></div>
                            <!-- 图2-5：第5列前4行，4个图形各占1行 -->
                            <div class="layout-cell" style="grid-column: 5; grid-row: 1;"></div>
                            <div class="layout-cell" style="grid-column: 5; grid-row: 2;"></div>
                            <div class="layout-cell" style="grid-column: 5; grid-row: 3;"></div>
                            <div class="layout-cell" style="grid-column: 5; grid-row: 4;"></div>
                            <!-- 图6-10：第5行，5个图形各占1列 -->
                            <div class="layout-cell" style="grid-column: 1; grid-row: 5;"></div>
                            <div class="layout-cell" style="grid-column: 2; grid-row: 5;"></div>
                            <div class="layout-cell" style="grid-column: 3; grid-row: 5;"></div>
                            <div class="layout-cell" style="grid-column: 4; grid-row: 5;"></div>
                            <div class="layout-cell" style="grid-column: 5; grid-row: 5;"></div>
                        </div>
                    </div>
                    <div class="layout-item" data-layout="10-2" data-count="10">
                        <div class="layout-preview layout-10-2" style="display: grid; grid-template-columns: repeat(12, 1fr); grid-template-rows: repeat(12, 1fr); gap: 1px;">
                            <!-- 第1行：1个图形，占3行12列 -->
                            <div class="layout-cell" style="grid-column: 1 / 13; grid-row: 1 / 4;"></div>
                            <!-- 第4行：3个图形，各占3行4列 -->
                            <div class="layout-cell" style="grid-column: 1 / 5; grid-row: 4 / 7;"></div>
                            <div class="layout-cell" style="grid-column: 5 / 9; grid-row: 4 / 7;"></div>
                            <div class="layout-cell" style="grid-column: 9 / 13; grid-row: 4 / 7;"></div>
                            <!-- 第7行：3个图形，各占3行4列 -->
                            <div class="layout-cell" style="grid-column: 1 / 5; grid-row: 7 / 10;"></div>
                            <div class="layout-cell" style="grid-column: 5 / 9; grid-row: 7 / 10;"></div>
                            <div class="layout-cell" style="grid-column: 9 / 13; grid-row: 7 / 10;"></div>
                            <!-- 第10行：3个图形，各占3行4列 -->
                            <div class="layout-cell" style="grid-column: 1 / 5; grid-row: 10 / 13;"></div>
                            <div class="layout-cell" style="grid-column: 5 / 9; grid-row: 10 / 13;"></div>
                            <div class="layout-cell" style="grid-column: 9 / 13; grid-row: 10 / 13;"></div>
                        </div>
                    </div>
                    <div class="layout-item" data-layout="10-3" data-count="10">
                        <div class="layout-preview layout-10-3" style="display: grid; grid-template-columns: repeat(12, 1fr); grid-template-rows: repeat(12, 1fr); gap: 1px;">
                            <!-- 第1列：1个图形，占3列12行 -->
                            <div class="layout-cell" style="grid-column: 1 / 4; grid-row: 1 / 13;"></div>
                            <!-- 第4列：3个图形，各占3列4行 -->
                            <div class="layout-cell" style="grid-column: 4 / 7; grid-row: 1 / 5;"></div>
                            <div class="layout-cell" style="grid-column: 4 / 7; grid-row: 5 / 9;"></div>
                            <div class="layout-cell" style="grid-column: 4 / 7; grid-row: 9 / 13;"></div>
                            <!-- 第7列：3个图形，各占3列4行 -->
                            <div class="layout-cell" style="grid-column: 7 / 10; grid-row: 1 / 5;"></div>
                            <div class="layout-cell" style="grid-column: 7 / 10; grid-row: 5 / 9;"></div>
                            <div class="layout-cell" style="grid-column: 7 / 10; grid-row: 9 / 13;"></div>
                            <!-- 第10列：3个图形，各占3列4行 -->
                            <div class="layout-cell" style="grid-column: 10 / 13; grid-row: 1 / 5;"></div>
                            <div class="layout-cell" style="grid-column: 10 / 13; grid-row: 5 / 9;"></div>
                            <div class="layout-cell" style="grid-column: 10 / 13; grid-row: 9 / 13;"></div>
                        </div>
                    </div>
                    <div class="layout-item" data-layout="10-4" data-count="10">
                        <div class="layout-preview layout-10-4" style="display: grid; grid-template-columns: repeat(4, 1fr); grid-template-rows: repeat(4, 1fr); gap: 1px;">
                            <!-- 第1行：3个图形，第1个占2列2行，第2个占1列1行，第3个占1列1行 -->
                            <div class="layout-cell" style="grid-column: 1 / 3; grid-row: 1 / 3;"></div>
                            <div class="layout-cell" style="grid-column: 3; grid-row: 1;"></div>
                            <div class="layout-cell" style="grid-column: 4; grid-row: 1;"></div>
                            <!-- 第2行第3列：1个图形，占1行1列 -->
                            <div class="layout-cell" style="grid-column: 3; grid-row: 2;"></div>
                            <!-- 第2行第4列：1个图形，占1行1列 -->
                            <div class="layout-cell" style="grid-column: 4; grid-row: 2;"></div>
                            <!-- 第3行：3个图形，第1个占1列1行，第2个占1列1行，第3个占2列2行 -->
                            <div class="layout-cell" style="grid-column: 1; grid-row: 3;"></div>
                            <div class="layout-cell" style="grid-column: 2; grid-row: 3;"></div>
                            <div class="layout-cell" style="grid-column: 3 / 5; grid-row: 3 / 5;"></div>
                            <!-- 第4行第1列：1个图形，占1行1列 -->
                            <div class="layout-cell" style="grid-column: 1; grid-row: 4;"></div>
                            <!-- 第4行第2列：1个图形，占1行1列 -->
                            <div class="layout-cell" style="grid-column: 2; grid-row: 4;"></div>
                        </div>
                    </div>
                    <div class="layout-item" data-layout="10-5" data-count="10">
                        <div class="layout-preview layout-10-5" style="display: grid; grid-template-columns: repeat(8, 1fr); grid-template-rows: repeat(8, 1fr); gap: 1px;">
                            <!-- 第1列：2个图形，各占4行4列 -->
                            <div class="layout-cell" style="grid-column: 1 / 5; grid-row: 1 / 5;"></div>
                            <div class="layout-cell" style="grid-column: 1 / 5; grid-row: 5 / 9;"></div>
                            <!-- 第1行第5列：2个图形，各占2列2行 -->
                            <div class="layout-cell" style="grid-column: 5 / 7; grid-row: 1 / 3;"></div>
                            <div class="layout-cell" style="grid-column: 7 / 9; grid-row: 1 / 3;"></div>
                            <!-- 第5列第3行：1个图形，占4列4行 -->
                            <div class="layout-cell" style="grid-column: 5 / 9; grid-row: 3 / 7;"></div>
                            <!-- 第5列第7行：4个图形，各占1行1列 -->
                            <div class="layout-cell" style="grid-column: 5; grid-row: 7;"></div>
                            <div class="layout-cell" style="grid-column: 6; grid-row: 7;"></div>
                            <div class="layout-cell" style="grid-column: 7; grid-row: 7;"></div>
                            <div class="layout-cell" style="grid-column: 8; grid-row: 7;"></div>
                            <!-- 第5列第8行：1个图形，占1行4列 -->
                            <div class="layout-cell" style="grid-column: 5 / 9; grid-row: 8;"></div>
                        </div>
                    </div>
                    <div class="layout-item" data-layout="10-6" data-count="10">
                        <div class="layout-preview layout-10-6" style="display: grid; grid-template-columns: repeat(4, 1fr); grid-template-rows: repeat(4, 1fr); gap: 1px;">
                            <!-- 第1行：4个图形，各占1列 -->
                            <div class="layout-cell" style="grid-column: 1; grid-row: 1;"></div>
                            <div class="layout-cell" style="grid-column: 2; grid-row: 1;"></div>
                            <div class="layout-cell" style="grid-column: 3; grid-row: 1;"></div>
                            <div class="layout-cell" style="grid-column: 4; grid-row: 1;"></div>
                            <!-- 第2行：2个图形，各占2列2行 -->
                            <div class="layout-cell" style="grid-column: 1 / 3; grid-row: 2 / 4;"></div>
                            <div class="layout-cell" style="grid-column: 3 / 5; grid-row: 2 / 4;"></div>
                            <!-- 第4行：4个图形，各占1列 -->
                            <div class="layout-cell" style="grid-column: 1; grid-row: 4;"></div>
                            <div class="layout-cell" style="grid-column: 2; grid-row: 4;"></div>
                            <div class="layout-cell" style="grid-column: 3; grid-row: 4;"></div>
                            <div class="layout-cell" style="grid-column: 4; grid-row: 4;"></div>
                        </div>
                    </div>
                    <div class="layout-item" data-layout="10-7" data-count="10">
                        <div class="layout-preview layout-10-7" style="display: grid; grid-template-columns: repeat(6, 1fr); grid-template-rows: repeat(6, 1fr); gap: 1px;">
                            <!-- 第1行：3个图形，第1个占2行2列 -->
                            <div class="layout-cell" style="grid-column: 1 / 3; grid-row: 1 / 3;"></div>
                            <div class="layout-cell" style="grid-column: 3 / 5; grid-row: 1 / 3;"></div>
                            <div class="layout-cell" style="grid-column: 5 / 7; grid-row: 1 / 3;"></div>
                            <!-- 第3行：3个图形，第1个占2行2列，第2个占1行2列，第3个占2行2列 -->
                            <div class="layout-cell" style="grid-column: 1 / 3; grid-row: 3 / 5;"></div>
                            <div class="layout-cell" style="grid-column: 3 / 5; grid-row: 3;"></div>
                            <div class="layout-cell" style="grid-column: 5 / 7; grid-row: 3 / 5;"></div>
                            <!-- 第4行第3列：1个图形，占1行2列 -->
                            <div class="layout-cell" style="grid-column: 3 / 5; grid-row: 4;"></div>
                            <!-- 第5行：3个图形，各占2行2列 -->
                            <div class="layout-cell" style="grid-column: 1 / 3; grid-row: 5 / 7;"></div>
                            <div class="layout-cell" style="grid-column: 3 / 5; grid-row: 5 / 7;"></div>
                            <div class="layout-cell" style="grid-column: 5 / 7; grid-row: 5 / 7;"></div>
                        </div>
                    </div>
                    <div class="layout-item" data-layout="10-8" data-count="10">
                        <div class="layout-preview layout-10-8" style="display: grid; grid-template-columns: repeat(12, 1fr); grid-template-rows: repeat(12, 1fr); gap: 1px;">
                            <!-- 第1行：3个图形，各占3行4列 -->
                            <div class="layout-cell" style="grid-column: 1 / 5; grid-row: 1 / 4;"></div>
                            <div class="layout-cell" style="grid-column: 5 / 9; grid-row: 1 / 4;"></div>
                            <div class="layout-cell" style="grid-column: 9 / 13; grid-row: 1 / 4;"></div>
                            <!-- 第4行：4个图形，各占6行3列 -->
                            <div class="layout-cell" style="grid-column: 1 / 4; grid-row: 4 / 10;"></div>
                            <div class="layout-cell" style="grid-column: 4 / 7; grid-row: 4 / 10;"></div>
                            <div class="layout-cell" style="grid-column: 7 / 10; grid-row: 4 / 10;"></div>
                            <div class="layout-cell" style="grid-column: 10 / 13; grid-row: 4 / 10;"></div>
                            <!-- 第10行：3个图形，各占3行4列 -->
                            <div class="layout-cell" style="grid-column: 1 / 5; grid-row: 10 / 13;"></div>
                            <div class="layout-cell" style="grid-column: 5 / 9; grid-row: 10 / 13;"></div>
                            <div class="layout-cell" style="grid-column: 9 / 13; grid-row: 10 / 13;"></div>
                        </div>
                    </div>
                    <div class="layout-item" data-layout="10-9" data-count="10">
                        <div class="layout-preview layout-10-9" style="display: grid; grid-template-columns: repeat(4, 1fr); grid-template-rows: repeat(4, 1fr); gap: 1px;">
                            <!-- 第1行：4个图形，前3个各占1列，第4个占2行1列 -->
                            <div class="layout-cell" style="grid-column: 1; grid-row: 1;"></div>
                            <div class="layout-cell" style="grid-column: 2; grid-row: 1;"></div>
                            <div class="layout-cell" style="grid-column: 3; grid-row: 1;"></div>
                            <div class="layout-cell" style="grid-column: 4; grid-row: 1 / 3;"></div>
                            <!-- 第2行：3个图形，各占1列 -->
                            <div class="layout-cell" style="grid-column: 1; grid-row: 2;"></div>
                            <div class="layout-cell" style="grid-column: 2; grid-row: 2;"></div>
                            <div class="layout-cell" style="grid-column: 3; grid-row: 2;"></div>
                            <!-- 第3行：2个图形，第1个占2行2列，第2个占1行2列 -->
                            <div class="layout-cell" style="grid-column: 1 / 3; grid-row: 3 / 5;"></div>
                            <div class="layout-cell" style="grid-column: 3 / 5; grid-row: 3;"></div>
                            <!-- 第4行第3列：1个图形，占1行2列 -->
                            <div class="layout-cell" style="grid-column: 3 / 5; grid-row: 4;"></div>
                        </div>
                    </div>
                    <div class="layout-item" data-layout="10-10" data-count="10">
                        <div class="layout-preview layout-10-10" style="display: grid; grid-template-columns: repeat(12, 1fr); grid-template-rows: repeat(12, 1fr); gap: 1px;">
                            <!-- 第1行：2个图形，各占6列4行 -->
                            <div class="layout-cell" style="grid-column: 1 / 7; grid-row: 1 / 5;"></div>
                            <div class="layout-cell" style="grid-column: 7 / 13; grid-row: 1 / 5;"></div>
                            <!-- 第5行：4个图形，各占3列4行 -->
                            <div class="layout-cell" style="grid-column: 1 / 4; grid-row: 5 / 9;"></div>
                            <div class="layout-cell" style="grid-column: 4 / 7; grid-row: 5 / 9;"></div>
                            <div class="layout-cell" style="grid-column: 7 / 10; grid-row: 5 / 9;"></div>
                            <div class="layout-cell" style="grid-column: 10 / 13; grid-row: 5 / 9;"></div>
                            <!-- 第9行：4个图形，各占3列4行 -->
                            <div class="layout-cell" style="grid-column: 1 / 4; grid-row: 9 / 13;"></div>
                            <div class="layout-cell" style="grid-column: 4 / 7; grid-row: 9 / 13;"></div>
                            <div class="layout-cell" style="grid-column: 7 / 10; grid-row: 9 / 13;"></div>
                            <div class="layout-cell" style="grid-column: 10 / 13; grid-row: 9 / 13;"></div>
                        </div>
                    </div>
                    <div class="layout-item" data-layout="10-11" data-count="10">
                        <div class="layout-preview layout-10-11" style="display: grid; grid-template-columns: repeat(8, 1fr); grid-template-rows: repeat(8, 1fr); gap: 1px;">
                            <!-- 第1行：2个图形，各占4列4行 -->
                            <div class="layout-cell" style="grid-column: 1 / 5; grid-row: 1 / 5;"></div>
                            <div class="layout-cell" style="grid-column: 5 / 9; grid-row: 1 / 5;"></div>
                            <!-- 第5行第1列：1个图形，占4列4行 -->
                            <div class="layout-cell" style="grid-column: 1 / 5; grid-row: 5 / 9;"></div>
                            <!-- 第5行第5列：2个图形，占2列2行 -->
                            <div class="layout-cell" style="grid-column: 5 / 7; grid-row: 5 / 7;"></div>
                            <div class="layout-cell" style="grid-column: 7 / 9; grid-row: 5 / 7;"></div>
                            <!-- 第7行第5列：1个图形，占2列2行 -->
                            <div class="layout-cell" style="grid-column: 5 / 7; grid-row: 7 / 9;"></div>
                            <!-- 第7行第6列：2个图形，占1列1行 -->
                            <div class="layout-cell" style="grid-column: 7; grid-row: 7;"></div>
                            <div class="layout-cell" style="grid-column: 8; grid-row: 7;"></div>
                            <!-- 第8行第6列：2个图形，占1列1行 -->
                            <div class="layout-cell" style="grid-column: 7; grid-row: 8;"></div>
                            <div class="layout-cell" style="grid-column: 8; grid-row: 8;"></div>
                        </div>
                    </div>
                </div>
            </div>
            <!-- 11图布局 -->
            <div class="layout-category">
                <div class="category-header expanded" data-target="layout-11">
                    <div class="category-title">
                        <i class="fas fa-images"></i> 11图布局
                    </div>
                    <i class="fas fa-chevron-right category-arrow"></i>
                </div>
                <div class="layout-content" id="layout-11">
                    <div class="layout-grid">
                    <!-- 11-1布局：4行4列，左中右对称布局 -->
                    <div class="layout-item" data-layout="11-1" data-count="11">
                        <div class="layout-preview layout-11-1" style="display: grid; grid-template-columns: repeat(4, 1fr); grid-template-rows: repeat(4, 1fr); gap: 1px;">
                            <!-- 第1列：4个图形，各占1行 -->
                            <div class="layout-cell" style="grid-column: 1; grid-row: 1;"></div>
                            <div class="layout-cell" style="grid-column: 1; grid-row: 2;"></div>
                            <div class="layout-cell" style="grid-column: 1; grid-row: 3;"></div>
                            <div class="layout-cell" style="grid-column: 1; grid-row: 4;"></div>
                            <!-- 第2列：3个图形，第1个占1行2列，第2个占2行2列，第3个占1行2列 -->
                            <div class="layout-cell" style="grid-column: 2 / 4; grid-row: 1;"></div>
                            <div class="layout-cell" style="grid-column: 2 / 4; grid-row: 2 / 4;"></div>
                            <div class="layout-cell" style="grid-column: 2 / 4; grid-row: 4;"></div>
                            <!-- 第4列：4个图形，各占1行 -->
                            <div class="layout-cell" style="grid-column: 4; grid-row: 1;"></div>
                            <div class="layout-cell" style="grid-column: 4; grid-row: 2;"></div>
                            <div class="layout-cell" style="grid-column: 4; grid-row: 3;"></div>
                            <div class="layout-cell" style="grid-column: 4; grid-row: 4;"></div>
                        </div>
                    </div>
                    <!-- 11-2布局：12行12列，上下分层递减布局 -->
                    <div class="layout-item" data-layout="11-2" data-count="11">
                        <div class="layout-preview layout-11-2" style="display: grid; grid-template-columns: repeat(12, 1fr); grid-template-rows: repeat(12, 1fr); gap: 1px;">
                            <!-- 第1行：2个图形，各占3行6列 -->
                            <div class="layout-cell" style="grid-column: 1 / 7; grid-row: 1 / 4;"></div>
                            <div class="layout-cell" style="grid-column: 7 / 13; grid-row: 1 / 4;"></div>
                            <!-- 第4行：3个图形，各占3行4列 -->
                            <div class="layout-cell" style="grid-column: 1 / 5; grid-row: 4 / 7;"></div>
                            <div class="layout-cell" style="grid-column: 5 / 9; grid-row: 4 / 7;"></div>
                            <div class="layout-cell" style="grid-column: 9 / 13; grid-row: 4 / 7;"></div>
                            <!-- 第7行：3个图形，各占3行4列 -->
                            <div class="layout-cell" style="grid-column: 1 / 5; grid-row: 7 / 10;"></div>
                            <div class="layout-cell" style="grid-column: 5 / 9; grid-row: 7 / 10;"></div>
                            <div class="layout-cell" style="grid-column: 9 / 13; grid-row: 7 / 10;"></div>
                            <!-- 第10行：3个图形，各占3行4列 -->
                            <div class="layout-cell" style="grid-column: 1 / 5; grid-row: 10 / 13;"></div>
                            <div class="layout-cell" style="grid-column: 5 / 9; grid-row: 10 / 13;"></div>
                            <div class="layout-cell" style="grid-column: 9 / 13; grid-row: 10 / 13;"></div>
                        </div>
                    </div>
                    <!-- 11-3布局：4行4列，上下规整中间突出布局 -->
                    <div class="layout-item" data-layout="11-3" data-count="11">
                        <div class="layout-preview layout-11-3" style="display: grid; grid-template-columns: repeat(4, 1fr); grid-template-rows: repeat(4, 1fr); gap: 1px;">
                            <!-- 第1行：4个图形，各占1行1列 -->
                            <div class="layout-cell" style="grid-column: 1; grid-row: 1;"></div>
                            <div class="layout-cell" style="grid-column: 2; grid-row: 1;"></div>
                            <div class="layout-cell" style="grid-column: 3; grid-row: 1;"></div>
                            <div class="layout-cell" style="grid-column: 4; grid-row: 1;"></div>
                            <!-- 第2行：3个图形，第1个占2行1列，第2个占2行2列，第3个占2行1列 -->
                            <div class="layout-cell" style="grid-column: 1; grid-row: 2 / 4;"></div>
                            <div class="layout-cell" style="grid-column: 2 / 4; grid-row: 2 / 4;"></div>
                            <div class="layout-cell" style="grid-column: 4; grid-row: 2 / 4;"></div>
                            <!-- 第4行：4个图形，各占1行1列 -->
                            <div class="layout-cell" style="grid-column: 1; grid-row: 4;"></div>
                            <div class="layout-cell" style="grid-column: 2; grid-row: 4;"></div>
                            <div class="layout-cell" style="grid-column: 3; grid-row: 4;"></div>
                            <div class="layout-cell" style="grid-column: 4; grid-row: 4;"></div>
                        </div>
                    </div>
                    <!-- 11-4布局：15行15列，上大下小布局 -->
                    <div class="layout-item" data-layout="11-4" data-count="11">
                        <div class="layout-preview layout-11-4" style="display: grid; grid-template-columns: repeat(15, 1fr); grid-template-rows: repeat(15, 1fr); gap: 1px;">
                            <!-- 第1行：1个图形，占15列5行 -->
                            <div class="layout-cell" style="grid-column: 1 / 16; grid-row: 1 / 6;"></div>
                            <!-- 第6行：5个图形，各占3列5行 -->
                            <div class="layout-cell" style="grid-column: 1 / 4; grid-row: 6 / 11;"></div>
                            <div class="layout-cell" style="grid-column: 4 / 7; grid-row: 6 / 11;"></div>
                            <div class="layout-cell" style="grid-column: 7 / 10; grid-row: 6 / 11;"></div>
                            <div class="layout-cell" style="grid-column: 10 / 13; grid-row: 6 / 11;"></div>
                            <div class="layout-cell" style="grid-column: 13 / 16; grid-row: 6 / 11;"></div>
                            <!-- 第11行：5个图形，各占3列5行 -->
                            <div class="layout-cell" style="grid-column: 1 / 4; grid-row: 11 / 16;"></div>
                            <div class="layout-cell" style="grid-column: 4 / 7; grid-row: 11 / 16;"></div>
                            <div class="layout-cell" style="grid-column: 7 / 10; grid-row: 11 / 16;"></div>
                            <div class="layout-cell" style="grid-column: 10 / 13; grid-row: 11 / 16;"></div>
                            <div class="layout-cell" style="grid-column: 13 / 16; grid-row: 11 / 16;"></div>
                        </div>
                    </div>
                    <!-- 11-5布局：15行15列，上小中大下小布局 -->
                    <div class="layout-item" data-layout="11-5" data-count="11">
                        <div class="layout-preview layout-11-5" style="display: grid; grid-template-columns: repeat(15, 1fr); grid-template-rows: repeat(15, 1fr); gap: 1px;">
                            <!-- 第1行：5个图形，各占3列5行 -->
                            <div class="layout-cell" style="grid-column: 1 / 4; grid-row: 1 / 6;"></div>
                            <div class="layout-cell" style="grid-column: 4 / 7; grid-row: 1 / 6;"></div>
                            <div class="layout-cell" style="grid-column: 7 / 10; grid-row: 1 / 6;"></div>
                            <div class="layout-cell" style="grid-column: 10 / 13; grid-row: 1 / 6;"></div>
                            <div class="layout-cell" style="grid-column: 13 / 16; grid-row: 1 / 6;"></div>
                            <!-- 第6行：1个图形，占15列5行 -->
                            <div class="layout-cell" style="grid-column: 1 / 16; grid-row: 6 / 11;"></div>
                            <!-- 第11行：5个图形，各占3列5行 -->
                            <div class="layout-cell" style="grid-column: 1 / 4; grid-row: 11 / 16;"></div>
                            <div class="layout-cell" style="grid-column: 4 / 7; grid-row: 11 / 16;"></div>
                            <div class="layout-cell" style="grid-column: 7 / 10; grid-row: 11 / 16;"></div>
                            <div class="layout-cell" style="grid-column: 10 / 13; grid-row: 11 / 16;"></div>
                            <div class="layout-cell" style="grid-column: 13 / 16; grid-row: 11 / 16;"></div>
                        </div>
                    </div>
                    <!-- 11-6布局：15行15列，上中小下大布局 -->
                    <div class="layout-item" data-layout="11-6" data-count="11">
                        <div class="layout-preview layout-11-6" style="display: grid; grid-template-columns: repeat(15, 1fr); grid-template-rows: repeat(15, 1fr); gap: 1px;">
                            <!-- 第1行：5个图形，各占3列5行 -->
                            <div class="layout-cell" style="grid-column: 1 / 4; grid-row: 1 / 6;"></div>
                            <div class="layout-cell" style="grid-column: 4 / 7; grid-row: 1 / 6;"></div>
                            <div class="layout-cell" style="grid-column: 7 / 10; grid-row: 1 / 6;"></div>
                            <div class="layout-cell" style="grid-column: 10 / 13; grid-row: 1 / 6;"></div>
                            <div class="layout-cell" style="grid-column: 13 / 16; grid-row: 1 / 6;"></div>
                            <!-- 第6行：5个图形，各占3列5行 -->
                            <div class="layout-cell" style="grid-column: 1 / 4; grid-row: 6 / 11;"></div>
                            <div class="layout-cell" style="grid-column: 4 / 7; grid-row: 6 / 11;"></div>
                            <div class="layout-cell" style="grid-column: 7 / 10; grid-row: 6 / 11;"></div>
                            <div class="layout-cell" style="grid-column: 10 / 13; grid-row: 6 / 11;"></div>
                            <div class="layout-cell" style="grid-column: 13 / 16; grid-row: 6 / 11;"></div>
                            <!-- 第11行：1个图形，占15列5行 -->
                            <div class="layout-cell" style="grid-column: 1 / 16; grid-row: 11 / 16;"></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
            <!-- 12图布局 -->
            <div class="layout-category">
                <div class="category-header expanded" data-target="layout-12">
                    <div class="category-title">
                        <i class="fas fa-images"></i> 12图布局
                    </div>
                    <i class="fas fa-chevron-right category-arrow"></i>
                </div>
                <div class="layout-content" id="layout-12">
                    <div class="layout-grid">
                    <!-- 12-1布局：6行6列，左右对称布局 -->
                    <div class="layout-item" data-layout="12-1" data-count="12">
                        <div class="layout-preview layout-12-1" style="display: grid; grid-template-columns: repeat(6, 1fr); grid-template-rows: repeat(6, 1fr); gap: 1px;">
                            <!-- 第1列：6个图形，各占1行3列 -->
                            <div class="layout-cell" style="grid-column: 1 / 4; grid-row: 1;"></div>
                            <div class="layout-cell" style="grid-column: 1 / 4; grid-row: 2;"></div>
                            <div class="layout-cell" style="grid-column: 1 / 4; grid-row: 3;"></div>
                            <div class="layout-cell" style="grid-column: 1 / 4; grid-row: 4;"></div>
                            <div class="layout-cell" style="grid-column: 1 / 4; grid-row: 5;"></div>
                            <div class="layout-cell" style="grid-column: 1 / 4; grid-row: 6;"></div>
                            <!-- 第4列：6个图形，各占1行3列 -->
                            <div class="layout-cell" style="grid-column: 4 / 7; grid-row: 1;"></div>
                            <div class="layout-cell" style="grid-column: 4 / 7; grid-row: 2;"></div>
                            <div class="layout-cell" style="grid-column: 4 / 7; grid-row: 3;"></div>
                            <div class="layout-cell" style="grid-column: 4 / 7; grid-row: 4;"></div>
                            <div class="layout-cell" style="grid-column: 4 / 7; grid-row: 5;"></div>
                            <div class="layout-cell" style="grid-column: 4 / 7; grid-row: 6;"></div>
                        </div>
                    </div>
                    <!-- 12-2布局：6行6列，大图+边框布局 -->
                    <div class="layout-item" data-layout="12-2" data-count="12">
                        <div class="layout-preview layout-12-2" style="display: grid; grid-template-columns: repeat(6, 1fr); grid-template-rows: repeat(6, 1fr); gap: 1px;">
                            <!-- 第1列第1行：1个图形，占5行5列 -->
                            <div class="layout-cell" style="grid-column: 1 / 6; grid-row: 1 / 6;"></div>
                            <!-- 第6列：6个图形，占1行 -->
                            <div class="layout-cell" style="grid-column: 6; grid-row: 1;"></div>
                            <div class="layout-cell" style="grid-column: 6; grid-row: 2;"></div>
                            <div class="layout-cell" style="grid-column: 6; grid-row: 3;"></div>
                            <div class="layout-cell" style="grid-column: 6; grid-row: 4;"></div>
                            <div class="layout-cell" style="grid-column: 6; grid-row: 5;"></div>
                            <div class="layout-cell" style="grid-column: 6; grid-row: 6;"></div>
                            <!-- 第6行：5个图形，各占1列 -->
                            <div class="layout-cell" style="grid-column: 1; grid-row: 6;"></div>
                            <div class="layout-cell" style="grid-column: 2; grid-row: 6;"></div>
                            <div class="layout-cell" style="grid-column: 3; grid-row: 6;"></div>
                            <div class="layout-cell" style="grid-column: 4; grid-row: 6;"></div>
                            <div class="layout-cell" style="grid-column: 5; grid-row: 6;"></div>
                        </div>
                    </div>
                    <!-- 12-3布局：12行12列，复杂组合布局 -->
                    <div class="layout-item" data-layout="12-3" data-count="12">
                        <div class="layout-preview layout-12-3" style="display: grid; grid-template-columns: repeat(12, 1fr); grid-template-rows: repeat(12, 1fr); gap: 1px;">
                            <!-- 第1列：3个图形，各占4行3列 -->
                            <div class="layout-cell" style="grid-column: 1 / 4; grid-row: 1 / 5;"></div>
                            <div class="layout-cell" style="grid-column: 1 / 4; grid-row: 5 / 9;"></div>
                            <div class="layout-cell" style="grid-column: 1 / 4; grid-row: 9 / 13;"></div>
                            <!-- 第1行第4列：3个图形，各占3行3列 -->
                            <div class="layout-cell" style="grid-column: 4 / 7; grid-row: 1 / 4;"></div>
                            <div class="layout-cell" style="grid-column: 7 / 10; grid-row: 1 / 4;"></div>
                            <div class="layout-cell" style="grid-column: 10 / 13; grid-row: 1 / 4;"></div>
                            <!-- 第4行第4列：3个图形，各占3行3列 -->
                            <div class="layout-cell" style="grid-column: 4 / 7; grid-row: 4 / 7;"></div>
                            <div class="layout-cell" style="grid-column: 7 / 10; grid-row: 4 / 7;"></div>
                            <div class="layout-cell" style="grid-column: 10 / 13; grid-row: 4 / 7;"></div>
                            <!-- 第7行第4列：2个图形，第1个占6行6列，第2个占3行3列 -->
                            <div class="layout-cell" style="grid-column: 4 / 10; grid-row: 7 / 13;"></div>
                            <div class="layout-cell" style="grid-column: 10 / 13; grid-row: 7 / 10;"></div>
                            <!-- 第10行第10列：1个图形，占3行3列 -->
                            <div class="layout-cell" style="grid-column: 10 / 13; grid-row: 10 / 13;"></div>
                        </div>
                    </div>
                    <!-- 12-4布局：3行4列，简单网格 -->
                    <div class="layout-item" data-layout="12-4" data-count="12">
                        <div class="layout-preview layout-12-4" style="display: grid; grid-template-columns: repeat(4, 1fr); grid-template-rows: repeat(3, 1fr); gap: 1px;">
                            <!-- 第1行：4个图形 -->
                            <div class="layout-cell" style="grid-column: 1; grid-row: 1;"></div>
                            <div class="layout-cell" style="grid-column: 2; grid-row: 1;"></div>
                            <div class="layout-cell" style="grid-column: 3; grid-row: 1;"></div>
                            <div class="layout-cell" style="grid-column: 4; grid-row: 1;"></div>
                            <!-- 第2行：4个图形 -->
                            <div class="layout-cell" style="grid-column: 1; grid-row: 2;"></div>
                            <div class="layout-cell" style="grid-column: 2; grid-row: 2;"></div>
                            <div class="layout-cell" style="grid-column: 3; grid-row: 2;"></div>
                            <div class="layout-cell" style="grid-column: 4; grid-row: 2;"></div>
                            <!-- 第3行：4个图形 -->
                            <div class="layout-cell" style="grid-column: 1; grid-row: 3;"></div>
                            <div class="layout-cell" style="grid-column: 2; grid-row: 3;"></div>
                            <div class="layout-cell" style="grid-column: 3; grid-row: 3;"></div>
                            <div class="layout-cell" style="grid-column: 4; grid-row: 3;"></div>
                        </div>
                    </div>
                    <!-- 12-5布局：4行3列，简单网格 -->
                    <div class="layout-item" data-layout="12-5" data-count="12">
                        <div class="layout-preview layout-12-5" style="display: grid; grid-template-columns: repeat(3, 1fr); grid-template-rows: repeat(4, 1fr); gap: 1px;">
                            <!-- 第1行：3个图形 -->
                            <div class="layout-cell" style="grid-column: 1; grid-row: 1;"></div>
                            <div class="layout-cell" style="grid-column: 2; grid-row: 1;"></div>
                            <div class="layout-cell" style="grid-column: 3; grid-row: 1;"></div>
                            <!-- 第2行：3个图形 -->
                            <div class="layout-cell" style="grid-column: 1; grid-row: 2;"></div>
                            <div class="layout-cell" style="grid-column: 2; grid-row: 2;"></div>
                            <div class="layout-cell" style="grid-column: 3; grid-row: 2;"></div>
                            <!-- 第3行：3个图形 -->
                            <div class="layout-cell" style="grid-column: 1; grid-row: 3;"></div>
                            <div class="layout-cell" style="grid-column: 2; grid-row: 3;"></div>
                            <div class="layout-cell" style="grid-column: 3; grid-row: 3;"></div>
                            <!-- 第4行：3个图形 -->
                            <div class="layout-cell" style="grid-column: 1; grid-row: 4;"></div>
                            <div class="layout-cell" style="grid-column: 2; grid-row: 4;"></div>
                            <div class="layout-cell" style="grid-column: 3; grid-row: 4;"></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
            <!-- 13图布局 -->
            <div class="layout-category">
                <div class="category-header expanded" data-target="layout-13">
                    <div class="category-title">
                        <i class="fas fa-images"></i> 13图布局
                    </div>
                    <i class="fas fa-chevron-right category-arrow"></i>
                </div>
                <div class="layout-content" id="layout-13">
                    <div class="layout-grid">
                    <!-- 13-1布局：4行4列，左右对称+中间组合 -->
                    <div class="layout-item" data-layout="13-1" data-count="13">
                        <div class="layout-preview layout-13-1" style="display: grid; grid-template-columns: repeat(4, 1fr); grid-template-rows: repeat(4, 1fr); gap: 1px;">
                            <!-- 第1列：4个图形，各占1行 -->
                            <div class="layout-cell" style="grid-column: 1; grid-row: 1;"></div>
                            <div class="layout-cell" style="grid-column: 1; grid-row: 2;"></div>
                            <div class="layout-cell" style="grid-column: 1; grid-row: 3;"></div>
                            <div class="layout-cell" style="grid-column: 1; grid-row: 4;"></div>
                            <!-- 第4列：4个图形，各占1行 -->
                            <div class="layout-cell" style="grid-column: 4; grid-row: 1;"></div>
                            <div class="layout-cell" style="grid-column: 4; grid-row: 2;"></div>
                            <div class="layout-cell" style="grid-column: 4; grid-row: 3;"></div>
                            <div class="layout-cell" style="grid-column: 4; grid-row: 4;"></div>
                            <!-- 第1行第2列：2个图形，各占1列 -->
                            <div class="layout-cell" style="grid-column: 2; grid-row: 1;"></div>
                            <div class="layout-cell" style="grid-column: 3; grid-row: 1;"></div>
                            <!-- 第2行第2列：1个图形，占2行2列 -->
                            <div class="layout-cell" style="grid-column: 2 / 4; grid-row: 2 / 4;"></div>
                            <!-- 第4行第2列：2个图形，各占1列 -->
                            <div class="layout-cell" style="grid-column: 2; grid-row: 4;"></div>
                            <div class="layout-cell" style="grid-column: 3; grid-row: 4;"></div>
                        </div>
                    </div>
                    <!-- 13-2布局：4行4列，左上大图+右侧双列 -->
                    <div class="layout-item" data-layout="13-2" data-count="13">
                        <div class="layout-preview layout-13-2" style="display: grid; grid-template-columns: repeat(4, 1fr); grid-template-rows: repeat(4, 1fr); gap: 1px;">
                            <!-- 第1列：3个图形，第1个占2行2列，第2个占1行，第3个占1行 -->
                            <div class="layout-cell" style="grid-column: 1 / 3; grid-row: 1 / 3;"></div>
                            <div class="layout-cell" style="grid-column: 1; grid-row: 3;"></div>
                            <div class="layout-cell" style="grid-column: 1; grid-row: 4;"></div>
                            <!-- 第3列：4个图形，各占1行 -->
                            <div class="layout-cell" style="grid-column: 3; grid-row: 1;"></div>
                            <div class="layout-cell" style="grid-column: 3; grid-row: 2;"></div>
                            <div class="layout-cell" style="grid-column: 3; grid-row: 3;"></div>
                            <div class="layout-cell" style="grid-column: 3; grid-row: 4;"></div>
                            <!-- 第4列：4个图形，各占1行 -->
                            <div class="layout-cell" style="grid-column: 4; grid-row: 1;"></div>
                            <div class="layout-cell" style="grid-column: 4; grid-row: 2;"></div>
                            <div class="layout-cell" style="grid-column: 4; grid-row: 3;"></div>
                            <div class="layout-cell" style="grid-column: 4; grid-row: 4;"></div>
                            <!-- 第3行：2个图形，各占1列 -->
                            <div class="layout-cell" style="grid-column: 2; grid-row: 3;"></div>
                            <!-- 第4行：2个图形，各占1列 -->
                            <div class="layout-cell" style="grid-column: 2; grid-row: 4;"></div>
                        </div>
                    </div>
                    <!-- 13-3布局：4行4列，上中下逐渐减少+右下大图 -->
                    <div class="layout-item" data-layout="13-3" data-count="13">
                        <div class="layout-preview layout-13-3" style="display: grid; grid-template-columns: repeat(4, 1fr); grid-template-rows: repeat(4, 1fr); gap: 1px;">
                            <!-- 第1行：4个图形，各占1列 -->
                            <div class="layout-cell" style="grid-column: 1; grid-row: 1;"></div>
                            <div class="layout-cell" style="grid-column: 2; grid-row: 1;"></div>
                            <div class="layout-cell" style="grid-column: 3; grid-row: 1;"></div>
                            <div class="layout-cell" style="grid-column: 4; grid-row: 1;"></div>
                            <!-- 第2行：4个图形，各占1列 -->
                            <div class="layout-cell" style="grid-column: 1; grid-row: 2;"></div>
                            <div class="layout-cell" style="grid-column: 2; grid-row: 2;"></div>
                            <div class="layout-cell" style="grid-column: 3; grid-row: 2;"></div>
                            <div class="layout-cell" style="grid-column: 4; grid-row: 2;"></div>
                            <!-- 第3行：3个图形，第1个图形占1列，第2个图形占1列，第3个图形占2列2行 -->
                            <div class="layout-cell" style="grid-column: 1; grid-row: 3;"></div>
                            <div class="layout-cell" style="grid-column: 2; grid-row: 3;"></div>
                            <div class="layout-cell" style="grid-column: 3 / 5; grid-row: 3 / 5;"></div>
                            <!-- 第4行：2个图形，各占1列 -->
                            <div class="layout-cell" style="grid-column: 1; grid-row: 4;"></div>
                            <div class="layout-cell" style="grid-column: 2; grid-row: 4;"></div>
                        </div>
                    </div>
                    <!-- 13-4布局：4行4列，第3行第1列图形占2行2列，左下大图+右下4小图 -->
                    <div class="layout-item" data-layout="13-4" data-count="13">
                        <div class="layout-preview layout-13-4" style="display: grid; grid-template-columns: repeat(4, 1fr); grid-template-rows: repeat(4, 1fr); gap: 1px;">
                            <!-- 第1行：4个图形，各占1列 -->
                            <div class="layout-cell" style="grid-column: 1; grid-row: 1;"></div>
                            <div class="layout-cell" style="grid-column: 2; grid-row: 1;"></div>
                            <div class="layout-cell" style="grid-column: 3; grid-row: 1;"></div>
                            <div class="layout-cell" style="grid-column: 4; grid-row: 1;"></div>
                            <!-- 第2行：4个图形，各占1列 -->
                            <div class="layout-cell" style="grid-column: 1; grid-row: 2;"></div>
                            <div class="layout-cell" style="grid-column: 2; grid-row: 2;"></div>
                            <div class="layout-cell" style="grid-column: 3; grid-row: 2;"></div>
                            <div class="layout-cell" style="grid-column: 4; grid-row: 2;"></div>
                            <!-- 第3行第1列：1个图形，占2行2列 -->
                            <div class="layout-cell" style="grid-column: 1 / 3; grid-row: 3 / 5;"></div>
                            <!-- 第3行第3列：2个图形，各占1列 -->
                            <div class="layout-cell" style="grid-column: 3; grid-row: 3;"></div>
                            <div class="layout-cell" style="grid-column: 4; grid-row: 3;"></div>
                            <!-- 第4行第3列：2个图形，各占1列 -->
                            <div class="layout-cell" style="grid-column: 3; grid-row: 4;"></div>
                            <div class="layout-cell" style="grid-column: 4; grid-row: 4;"></div>
                        </div>
                    </div>
                    <!-- 13-5布局：4行4列，第1行第3列图形占2行2列，右上大图+左侧4小图+下方8图 -->
                    <div class="layout-item" data-layout="13-5" data-count="13">
                        <div class="layout-preview layout-13-5" style="display: grid; grid-template-columns: repeat(4, 1fr); grid-template-rows: repeat(4, 1fr); gap: 1px;">
                            <!-- 第1行第3列：1个图形，占2行2列 -->
                            <div class="layout-cell" style="grid-column: 3 / 5; grid-row: 1 / 3;"></div>
                            <!-- 第1行第1列：2个图形，各占1列 -->
                            <div class="layout-cell" style="grid-column: 1; grid-row: 1;"></div>
                            <div class="layout-cell" style="grid-column: 2; grid-row: 1;"></div>
                            <!-- 第2行第1列：2个图形，各占1列 -->
                            <div class="layout-cell" style="grid-column: 1; grid-row: 2;"></div>
                            <div class="layout-cell" style="grid-column: 2; grid-row: 2;"></div>
                            <!-- 第3行：4个图形，各占1列 -->
                            <div class="layout-cell" style="grid-column: 1; grid-row: 3;"></div>
                            <div class="layout-cell" style="grid-column: 2; grid-row: 3;"></div>
                            <div class="layout-cell" style="grid-column: 3; grid-row: 3;"></div>
                            <div class="layout-cell" style="grid-column: 4; grid-row: 3;"></div>
                            <!-- 第4行：4个图形，各占1列 -->
                            <div class="layout-cell" style="grid-column: 1; grid-row: 4;"></div>
                            <div class="layout-cell" style="grid-column: 2; grid-row: 4;"></div>
                            <div class="layout-cell" style="grid-column: 3; grid-row: 4;"></div>
                            <div class="layout-cell" style="grid-column: 4; grid-row: 4;"></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
            <!-- 14图布局 -->
            <div class="layout-category">
                <div class="category-header expanded" data-target="layout-14">
                    <div class="category-title">
                        <i class="fas fa-images"></i> 14图布局
                    </div>
                    <i class="fas fa-chevron-right category-arrow"></i>
                </div>
                <div class="layout-content" id="layout-14">
                    <div class="layout-grid">
                    <!-- 14-1布局：4行4列，上下满中间宽窄 -->
                    <div class="layout-item" data-layout="14-1" data-count="14">
                        <div class="layout-preview layout-14-1" style="display: grid; grid-template-columns: repeat(4, 1fr); grid-template-rows: repeat(4, 1fr); gap: 1px;">
                            <!-- 第1行：4个图形，各占1列 -->
                            <div class="layout-cell" style="grid-column: 1; grid-row: 1;"></div>
                            <div class="layout-cell" style="grid-column: 2; grid-row: 1;"></div>
                            <div class="layout-cell" style="grid-column: 3; grid-row: 1;"></div>
                            <div class="layout-cell" style="grid-column: 4; grid-row: 1;"></div>
                            <!-- 第2行：3个图形，第1个占1列，第2个占2列，第3个占1列 -->
                            <div class="layout-cell" style="grid-column: 1; grid-row: 2;"></div>
                            <div class="layout-cell" style="grid-column: 2 / 4; grid-row: 2;"></div>
                            <div class="layout-cell" style="grid-column: 4; grid-row: 2;"></div>
                            <!-- 第3行：3个图形，第1个占1列，第2个占2列，第3个占1列 -->
                            <div class="layout-cell" style="grid-column: 1; grid-row: 3;"></div>
                            <div class="layout-cell" style="grid-column: 2 / 4; grid-row: 3;"></div>
                            <div class="layout-cell" style="grid-column: 4; grid-row: 3;"></div>
                            <!-- 第4行：4个图形，各占1列 -->
                            <div class="layout-cell" style="grid-column: 1; grid-row: 4;"></div>
                            <div class="layout-cell" style="grid-column: 2; grid-row: 4;"></div>
                            <div class="layout-cell" style="grid-column: 3; grid-row: 4;"></div>
                            <div class="layout-cell" style="grid-column: 4; grid-row: 4;"></div>
                        </div>
                    </div>
                    <!-- 14-2布局：7行2列，左右对称简单网格 -->
                    <div class="layout-item" data-layout="14-2" data-count="14">
                        <div class="layout-preview layout-14-2" style="display: grid; grid-template-columns: repeat(2, 1fr); grid-template-rows: repeat(7, 1fr); gap: 1px;">
                            <!-- 第1列：7个图形，各占1行 -->
                            <div class="layout-cell" style="grid-column: 1; grid-row: 1;"></div>
                            <div class="layout-cell" style="grid-column: 1; grid-row: 2;"></div>
                            <div class="layout-cell" style="grid-column: 1; grid-row: 3;"></div>
                            <div class="layout-cell" style="grid-column: 1; grid-row: 4;"></div>
                            <div class="layout-cell" style="grid-column: 1; grid-row: 5;"></div>
                            <div class="layout-cell" style="grid-column: 1; grid-row: 6;"></div>
                            <div class="layout-cell" style="grid-column: 1; grid-row: 7;"></div>
                            <!-- 第2列：7个图形，各占1行 -->
                            <div class="layout-cell" style="grid-column: 2; grid-row: 1;"></div>
                            <div class="layout-cell" style="grid-column: 2; grid-row: 2;"></div>
                            <div class="layout-cell" style="grid-column: 2; grid-row: 3;"></div>
                            <div class="layout-cell" style="grid-column: 2; grid-row: 4;"></div>
                            <div class="layout-cell" style="grid-column: 2; grid-row: 5;"></div>
                            <div class="layout-cell" style="grid-column: 2; grid-row: 6;"></div>
                            <div class="layout-cell" style="grid-column: 2; grid-row: 7;"></div>
                        </div>
                    </div>
                    <!-- 14-3布局：4行4列，中间两列高图+角落填充 -->
                    <div class="layout-item" data-layout="14-3" data-count="14">
                        <div class="layout-preview layout-14-3" style="display: grid; grid-template-columns: repeat(4, 1fr); grid-template-rows: repeat(4, 1fr); gap: 1px;">
                            <!-- 第1行：4个图形，各占1列 -->
                            <div class="layout-cell" style="grid-column: 1; grid-row: 1;"></div>
                            <div class="layout-cell" style="grid-column: 2; grid-row: 1;"></div>
                            <div class="layout-cell" style="grid-column: 3; grid-row: 1;"></div>
                            <div class="layout-cell" style="grid-column: 4; grid-row: 1;"></div>
                            <!-- 第2行：4个图形，第1个图形占1列，第2个图形占1列2行，第3个图形占1列2行，第4个图形占1列 -->
                            <div class="layout-cell" style="grid-column: 1; grid-row: 2;"></div>
                            <div class="layout-cell" style="grid-column: 2; grid-row: 2 / 4;"></div>
                            <div class="layout-cell" style="grid-column: 3; grid-row: 2 / 4;"></div>
                            <div class="layout-cell" style="grid-column: 4; grid-row: 2;"></div>
                            <!-- 第3行第1列：1个图形，占1行1列 -->
                            <div class="layout-cell" style="grid-column: 1; grid-row: 3;"></div>
                            <!-- 第3行第4列：1个图形，占1行1列 -->
                            <div class="layout-cell" style="grid-column: 4; grid-row: 3;"></div>
                            <!-- 第4行：4个图形，各占1列 -->
                            <div class="layout-cell" style="grid-column: 1; grid-row: 4;"></div>
                            <div class="layout-cell" style="grid-column: 2; grid-row: 4;"></div>
                            <div class="layout-cell" style="grid-column: 3; grid-row: 4;"></div>
                            <div class="layout-cell" style="grid-column: 4; grid-row: 4;"></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
            <!-- 15图布局 -->
            <div class="layout-category">
                <div class="category-header expanded" data-target="layout-15">
                    <div class="category-title">
                        <i class="fas fa-images"></i> 15图布局
                    </div>
                    <i class="fas fa-chevron-right category-arrow"></i>
                </div>
                <div class="layout-content" id="layout-15">
                    <div class="layout-grid">
                    <!-- 15-1布局：4行4列，第1行中间2列大图 -->
                    <div class="layout-item" data-layout="15-1" data-count="15">
                        <div class="layout-preview layout-15-1" style="display: grid; grid-template-columns: repeat(4, 1fr); grid-template-rows: repeat(4, 1fr); gap: 1px;">
                            <!-- 第1行：3个图形，第1个占1行1列，第2个占1行2列，第3个占1行1列 -->
                            <div class="layout-cell" style="grid-column: 1; grid-row: 1;"></div>
                            <div class="layout-cell" style="grid-column: 2 / 4; grid-row: 1;"></div>
                            <div class="layout-cell" style="grid-column: 4; grid-row: 1;"></div>
                            <!-- 第2行：4个图形，各占1行1列 -->
                            <div class="layout-cell" style="grid-column: 1; grid-row: 2;"></div>
                            <div class="layout-cell" style="grid-column: 2; grid-row: 2;"></div>
                            <div class="layout-cell" style="grid-column: 3; grid-row: 2;"></div>
                            <div class="layout-cell" style="grid-column: 4; grid-row: 2;"></div>
                            <!-- 第3行：4个图形，各占1行1列 -->
                            <div class="layout-cell" style="grid-column: 1; grid-row: 3;"></div>
                            <div class="layout-cell" style="grid-column: 2; grid-row: 3;"></div>
                            <div class="layout-cell" style="grid-column: 3; grid-row: 3;"></div>
                            <div class="layout-cell" style="grid-column: 4; grid-row: 3;"></div>
                            <!-- 第4行：4个图形，各占1行1列 -->
                            <div class="layout-cell" style="grid-column: 1; grid-row: 4;"></div>
                            <div class="layout-cell" style="grid-column: 2; grid-row: 4;"></div>
                            <div class="layout-cell" style="grid-column: 3; grid-row: 4;"></div>
                            <div class="layout-cell" style="grid-column: 4; grid-row: 4;"></div>
                        </div>
                    </div>
                    <!-- 15-2布局：4行4列，第2行中间2列大图 -->
                    <div class="layout-item" data-layout="15-2" data-count="15">
                        <div class="layout-preview layout-15-2" style="display: grid; grid-template-columns: repeat(4, 1fr); grid-template-rows: repeat(4, 1fr); gap: 1px;">
                            <!-- 第1行：4个图形，各占1行1列 -->
                            <div class="layout-cell" style="grid-column: 1; grid-row: 1;"></div>
                            <div class="layout-cell" style="grid-column: 2; grid-row: 1;"></div>
                            <div class="layout-cell" style="grid-column: 3; grid-row: 1;"></div>
                            <div class="layout-cell" style="grid-column: 4; grid-row: 1;"></div>
                            <!-- 第2行：3个图形，第1个占1行1列，第2个占1行2列，第3个占1行1列 -->
                            <div class="layout-cell" style="grid-column: 1; grid-row: 2;"></div>
                            <div class="layout-cell" style="grid-column: 2 / 4; grid-row: 2;"></div>
                            <div class="layout-cell" style="grid-column: 4; grid-row: 2;"></div>
                            <!-- 第3行：4个图形，各占1行1列 -->
                            <div class="layout-cell" style="grid-column: 1; grid-row: 3;"></div>
                            <div class="layout-cell" style="grid-column: 2; grid-row: 3;"></div>
                            <div class="layout-cell" style="grid-column: 3; grid-row: 3;"></div>
                            <div class="layout-cell" style="grid-column: 4; grid-row: 3;"></div>
                            <!-- 第4行：4个图形，各占1行1列 -->
                            <div class="layout-cell" style="grid-column: 1; grid-row: 4;"></div>
                            <div class="layout-cell" style="grid-column: 2; grid-row: 4;"></div>
                            <div class="layout-cell" style="grid-column: 3; grid-row: 4;"></div>
                            <div class="layout-cell" style="grid-column: 4; grid-row: 4;"></div>
                        </div>
                    </div>
                    <!-- 15-3布局：4行4列，第3行中间2列大图 -->
                    <div class="layout-item" data-layout="15-3" data-count="15">
                        <div class="layout-preview layout-15-3" style="display: grid; grid-template-columns: repeat(4, 1fr); grid-template-rows: repeat(4, 1fr); gap: 1px;">
                            <!-- 第1行：4个图形，各占1行1列 -->
                            <div class="layout-cell" style="grid-column: 1; grid-row: 1;"></div>
                            <div class="layout-cell" style="grid-column: 2; grid-row: 1;"></div>
                            <div class="layout-cell" style="grid-column: 3; grid-row: 1;"></div>
                            <div class="layout-cell" style="grid-column: 4; grid-row: 1;"></div>
                            <!-- 第2行：4个图形，各占1行1列 -->
                            <div class="layout-cell" style="grid-column: 1; grid-row: 2;"></div>
                            <div class="layout-cell" style="grid-column: 2; grid-row: 2;"></div>
                            <div class="layout-cell" style="grid-column: 3; grid-row: 2;"></div>
                            <div class="layout-cell" style="grid-column: 4; grid-row: 2;"></div>
                            <!-- 第3行：3个图形，第1个占1行1列，第2个占1行2列，第3个占1行1列 -->
                            <div class="layout-cell" style="grid-column: 1; grid-row: 3;"></div>
                            <div class="layout-cell" style="grid-column: 2 / 4; grid-row: 3;"></div>
                            <div class="layout-cell" style="grid-column: 4; grid-row: 3;"></div>
                            <!-- 第4行：4个图形，各占1行1列 -->
                            <div class="layout-cell" style="grid-column: 1; grid-row: 4;"></div>
                            <div class="layout-cell" style="grid-column: 2; grid-row: 4;"></div>
                            <div class="layout-cell" style="grid-column: 3; grid-row: 4;"></div>
                            <div class="layout-cell" style="grid-column: 4; grid-row: 4;"></div>
                        </div>
                    </div>
                    <!-- 15-4布局：4行4列，第4行中间2列大图 -->
                    <div class="layout-item" data-layout="15-4" data-count="15">
                        <div class="layout-preview layout-15-4" style="display: grid; grid-template-columns: repeat(4, 1fr); grid-template-rows: repeat(4, 1fr); gap: 1px;">
                            <!-- 第1行：4个图形，各占1行1列 -->
                            <div class="layout-cell" style="grid-column: 1; grid-row: 1;"></div>
                            <div class="layout-cell" style="grid-column: 2; grid-row: 1;"></div>
                            <div class="layout-cell" style="grid-column: 3; grid-row: 1;"></div>
                            <div class="layout-cell" style="grid-column: 4; grid-row: 1;"></div>
                            <!-- 第2行：4个图形，各占1行1列 -->
                            <div class="layout-cell" style="grid-column: 1; grid-row: 2;"></div>
                            <div class="layout-cell" style="grid-column: 2; grid-row: 2;"></div>
                            <div class="layout-cell" style="grid-column: 3; grid-row: 2;"></div>
                            <div class="layout-cell" style="grid-column: 4; grid-row: 2;"></div>
                            <!-- 第3行：4个图形，各占1行1列 -->
                            <div class="layout-cell" style="grid-column: 1; grid-row: 3;"></div>
                            <div class="layout-cell" style="grid-column: 2; grid-row: 3;"></div>
                            <div class="layout-cell" style="grid-column: 3; grid-row: 3;"></div>
                            <div class="layout-cell" style="grid-column: 4; grid-row: 3;"></div>
                            <!-- 第4行：3个图形，第1个占1行1列，第2个占1行2列，第3个占1行1列 -->
                            <div class="layout-cell" style="grid-column: 1; grid-row: 4;"></div>
                            <div class="layout-cell" style="grid-column: 2 / 4; grid-row: 4;"></div>
                            <div class="layout-cell" style="grid-column: 4; grid-row: 4;"></div>
                        </div>
                    </div>
                    <!-- 15-5布局：5行3列，简单竖向网格 -->
                    <div class="layout-item" data-layout="15-5" data-count="15">
                        <div class="layout-preview layout-15-5" style="display: grid; grid-template-columns: repeat(3, 1fr); grid-template-rows: repeat(5, 1fr); gap: 1px;">
                            <!-- 第1列：5个图形，各占1行1列 -->
                            <div class="layout-cell" style="grid-column: 1; grid-row: 1;"></div>
                            <div class="layout-cell" style="grid-column: 1; grid-row: 2;"></div>
                            <div class="layout-cell" style="grid-column: 1; grid-row: 3;"></div>
                            <div class="layout-cell" style="grid-column: 1; grid-row: 4;"></div>
                            <div class="layout-cell" style="grid-column: 1; grid-row: 5;"></div>
                            <!-- 第2列：5个图形，各占1行1列 -->
                            <div class="layout-cell" style="grid-column: 2; grid-row: 1;"></div>
                            <div class="layout-cell" style="grid-column: 2; grid-row: 2;"></div>
                            <div class="layout-cell" style="grid-column: 2; grid-row: 3;"></div>
                            <div class="layout-cell" style="grid-column: 2; grid-row: 4;"></div>
                            <div class="layout-cell" style="grid-column: 2; grid-row: 5;"></div>
                            <!-- 第3列：5个图形，各占1行1列 -->
                            <div class="layout-cell" style="grid-column: 3; grid-row: 1;"></div>
                            <div class="layout-cell" style="grid-column: 3; grid-row: 2;"></div>
                            <div class="layout-cell" style="grid-column: 3; grid-row: 3;"></div>
                            <div class="layout-cell" style="grid-column: 3; grid-row: 4;"></div>
                            <div class="layout-cell" style="grid-column: 3; grid-row: 5;"></div>
                        </div>
                    </div>
                    <!-- 15-6布局：3行5列，简单横向网格 -->
                    <div class="layout-item" data-layout="15-6" data-count="15">
                        <div class="layout-preview layout-15-6" style="display: grid; grid-template-columns: repeat(5, 1fr); grid-template-rows: repeat(3, 1fr); gap: 1px;">
                            <!-- 第1行：5个图形，各占1行1列 -->
                            <div class="layout-cell" style="grid-column: 1; grid-row: 1;"></div>
                            <div class="layout-cell" style="grid-column: 2; grid-row: 1;"></div>
                            <div class="layout-cell" style="grid-column: 3; grid-row: 1;"></div>
                            <div class="layout-cell" style="grid-column: 4; grid-row: 1;"></div>
                            <div class="layout-cell" style="grid-column: 5; grid-row: 1;"></div>
                            <!-- 第2行：5个图形，各占1行1列 -->
                            <div class="layout-cell" style="grid-column: 1; grid-row: 2;"></div>
                            <div class="layout-cell" style="grid-column: 2; grid-row: 2;"></div>
                            <div class="layout-cell" style="grid-column: 3; grid-row: 2;"></div>
                            <div class="layout-cell" style="grid-column: 4; grid-row: 2;"></div>
                            <div class="layout-cell" style="grid-column: 5; grid-row: 2;"></div>
                            <!-- 第3行：5个图形，各占1行1列 -->
                            <div class="layout-cell" style="grid-column: 1; grid-row: 3;"></div>
                            <div class="layout-cell" style="grid-column: 2; grid-row: 3;"></div>
                            <div class="layout-cell" style="grid-column: 3; grid-row: 3;"></div>
                            <div class="layout-cell" style="grid-column: 4; grid-row: 3;"></div>
                            <div class="layout-cell" style="grid-column: 5; grid-row: 3;"></div>
                        </div>
                    </div>
                    <!-- 15-7布局：4行4列，第2行右侧2列大图 -->
                    <div class="layout-item" data-layout="15-7" data-count="15">
                        <div class="layout-preview layout-15-7" style="display: grid; grid-template-columns: repeat(4, 1fr); grid-template-rows: repeat(4, 1fr); gap: 1px;">
                            <!-- 第1行：4个图形，各占1行1列 -->
                            <div class="layout-cell" style="grid-column: 1; grid-row: 1;"></div>
                            <div class="layout-cell" style="grid-column: 2; grid-row: 1;"></div>
                            <div class="layout-cell" style="grid-column: 3; grid-row: 1;"></div>
                            <div class="layout-cell" style="grid-column: 4; grid-row: 1;"></div>
                            <!-- 第2行：3个图形，第1个占1行1列，第2个占1行1列，第3个占1行2列 -->
                            <div class="layout-cell" style="grid-column: 1; grid-row: 2;"></div>
                            <div class="layout-cell" style="grid-column: 2; grid-row: 2;"></div>
                            <div class="layout-cell" style="grid-column: 3 / 5; grid-row: 2;"></div>
                            <!-- 第3行：4个图形，各占1行1列 -->
                            <div class="layout-cell" style="grid-column: 1; grid-row: 3;"></div>
                            <div class="layout-cell" style="grid-column: 2; grid-row: 3;"></div>
                            <div class="layout-cell" style="grid-column: 3; grid-row: 3;"></div>
                            <div class="layout-cell" style="grid-column: 4; grid-row: 3;"></div>
                            <!-- 第4行：4个图形，各占1行1列 -->
                            <div class="layout-cell" style="grid-column: 1; grid-row: 4;"></div>
                            <div class="layout-cell" style="grid-column: 2; grid-row: 4;"></div>
                            <div class="layout-cell" style="grid-column: 3; grid-row: 4;"></div>
                            <div class="layout-cell" style="grid-column: 4; grid-row: 4;"></div>
                        </div>
                    </div>
                    <!-- 15-8布局：4行4列，第3行右侧2列大图 -->
                    <div class="layout-item" data-layout="15-8" data-count="15">
                        <div class="layout-preview layout-15-8" style="display: grid; grid-template-columns: repeat(4, 1fr); grid-template-rows: repeat(4, 1fr); gap: 1px;">
                            <!-- 第1行：4个图形，各占1行1列 -->
                            <div class="layout-cell" style="grid-column: 1; grid-row: 1;"></div>
                            <div class="layout-cell" style="grid-column: 2; grid-row: 1;"></div>
                            <div class="layout-cell" style="grid-column: 3; grid-row: 1;"></div>
                            <div class="layout-cell" style="grid-column: 4; grid-row: 1;"></div>
                            <!-- 第2行：4个图形，各占1行1列 -->
                            <div class="layout-cell" style="grid-column: 1; grid-row: 2;"></div>
                            <div class="layout-cell" style="grid-column: 2; grid-row: 2;"></div>
                            <div class="layout-cell" style="grid-column: 3; grid-row: 2;"></div>
                            <div class="layout-cell" style="grid-column: 4; grid-row: 2;"></div>
                            <!-- 第3行：3个图形，第1个占1行1列，第2个占1行1列，第3个占1行2列 -->
                            <div class="layout-cell" style="grid-column: 1; grid-row: 3;"></div>
                            <div class="layout-cell" style="grid-column: 2; grid-row: 3;"></div>
                            <div class="layout-cell" style="grid-column: 3 / 5; grid-row: 3;"></div>
                            <!-- 第4行：4个图形，各占1行1列 -->
                            <div class="layout-cell" style="grid-column: 1; grid-row: 4;"></div>
                            <div class="layout-cell" style="grid-column: 2; grid-row: 4;"></div>
                            <div class="layout-cell" style="grid-column: 3; grid-row: 4;"></div>
                            <div class="layout-cell" style="grid-column: 4; grid-row: 4;"></div>
                        </div>
                    </div>
                    <!-- 15-9布局：4行4列，第4行右侧2列大图 -->
                    <div class="layout-item" data-layout="15-9" data-count="15">
                        <div class="layout-preview layout-15-9" style="display: grid; grid-template-columns: repeat(4, 1fr); grid-template-rows: repeat(4, 1fr); gap: 1px;">
                            <!-- 第1行：4个图形，各占1行1列 -->
                            <div class="layout-cell" style="grid-column: 1; grid-row: 1;"></div>
                            <div class="layout-cell" style="grid-column: 2; grid-row: 1;"></div>
                            <div class="layout-cell" style="grid-column: 3; grid-row: 1;"></div>
                            <div class="layout-cell" style="grid-column: 4; grid-row: 1;"></div>
                            <!-- 第2行：4个图形，各占1行1列 -->
                            <div class="layout-cell" style="grid-column: 1; grid-row: 2;"></div>
                            <div class="layout-cell" style="grid-column: 2; grid-row: 2;"></div>
                            <div class="layout-cell" style="grid-column: 3; grid-row: 2;"></div>
                            <div class="layout-cell" style="grid-column: 4; grid-row: 2;"></div>
                            <!-- 第3行：4个图形，各占1行1列 -->
                            <div class="layout-cell" style="grid-column: 1; grid-row: 3;"></div>
                            <div class="layout-cell" style="grid-column: 2; grid-row: 3;"></div>
                            <div class="layout-cell" style="grid-column: 3; grid-row: 3;"></div>
                            <div class="layout-cell" style="grid-column: 4; grid-row: 3;"></div>
                            <!-- 第4行：3个图形，第1个占1行1列，第2个占1行1列，第3个占1行2列 -->
                            <div class="layout-cell" style="grid-column: 1; grid-row: 4;"></div>
                            <div class="layout-cell" style="grid-column: 2; grid-row: 4;"></div>
                            <div class="layout-cell" style="grid-column: 3 / 5; grid-row: 4;"></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
            <!-- 16图布局 -->
            <div class="layout-category">
                <div class="category-header expanded" data-target="layout-16">
                    <div class="category-title">
                        <i class="fas fa-images"></i> 16图布局
                    </div>
                    <i class="fas fa-chevron-right category-arrow"></i>
                </div>
                <div class="layout-content" id="layout-16">
                    <div class="layout-grid">
                    <!-- 16-1布局：4行4列，简单网格 -->
                    <div class="layout-item" data-layout="16-1" data-count="16">
                        <div class="layout-preview layout-16-1">
                            <!-- 第1行：4个图形 -->
                            <div class="layout-cell" style="grid-column: 1; grid-row: 1;"></div>
                            <div class="layout-cell" style="grid-column: 2; grid-row: 1;"></div>
                            <div class="layout-cell" style="grid-column: 3; grid-row: 1;"></div>
                            <div class="layout-cell" style="grid-column: 4; grid-row: 1;"></div>
                            <!-- 第2行：4个图形 -->
                            <div class="layout-cell" style="grid-column: 1; grid-row: 2;"></div>
                            <div class="layout-cell" style="grid-column: 2; grid-row: 2;"></div>
                            <div class="layout-cell" style="grid-column: 3; grid-row: 2;"></div>
                            <div class="layout-cell" style="grid-column: 4; grid-row: 2;"></div>
                            <!-- 第3行：4个图形 -->
                            <div class="layout-cell" style="grid-column: 1; grid-row: 3;"></div>
                            <div class="layout-cell" style="grid-column: 2; grid-row: 3;"></div>
                            <div class="layout-cell" style="grid-column: 3; grid-row: 3;"></div>
                            <div class="layout-cell" style="grid-column: 4; grid-row: 3;"></div>
                            <!-- 第4行：4个图形 -->
                            <div class="layout-cell" style="grid-column: 1; grid-row: 4;"></div>
                            <div class="layout-cell" style="grid-column: 2; grid-row: 4;"></div>
                            <div class="layout-cell" style="grid-column: 3; grid-row: 4;"></div>
                            <div class="layout-cell" style="grid-column: 4; grid-row: 4;"></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    </aside>
    <!-- 右侧属性设置 -->
    <aside class="properties-panel">
        <div class="panel-header">
            <i class="fas fa-cog"></i>
            <h3>画布设置</h3>
        </div>
        
        <!-- 输出尺寸分组 -->
        <div class="layout-category">
            <div class="category-header expanded" data-target="output-size">
                <div class="category-title">
                    <i class="fas fa-expand-arrows-alt"></i> 输出尺寸
                </div>
                <i class="fas fa-chevron-right category-arrow"></i>
            </div>
            <div class="layout-content" id="output-size">
                <div class="form-item">
                    <label class="form-label">输出尺寸</label>
                    <div class="size-group">
                        <input type="number" class="form-input" id="canvasWidth" value="1200" placeholder="宽度">
                        <span style="color: var(--text-disabled); font-size: 12px;">×</span>
                        <input type="number" class="form-input" id="canvasHeight" value="800" placeholder="高度">
                    </div>
                </div>
                <div class="form-item">
                    <label class="form-label">多媒体尺寸</label>
                    <div class="media-size-buttons">
                        <button class="media-btn" data-width="1080" data-height="1920">抖音竖屏</button>
                        <button class="media-btn" data-width="1920" data-height="1080">抖音横屏</button>
                        <button class="media-btn" data-width="1080" data-height="1920">视频号竖屏</button>
                        <button class="media-btn" data-width="1080" data-height="1080">视频号方形</button>
                        <button class="media-btn" data-width="1080" data-height="1350">小红书竖图</button>
                        <button class="media-btn" data-width="1080" data-height="1080">小红书方图</button>
                        <button class="media-btn" data-width="1920" data-height="1080">B站横屏</button>
                        <button class="media-btn" data-width="1080" data-height="1920">B站竖屏</button>
                        <button class="media-btn" data-width="1200" data-height="1200">微博方图</button>
                        <button class="media-btn" data-width="1080" data-height="1920">快手竖屏</button>
                        <button class="media-btn" data-width="1125" data-height="2436">iPhone X</button>
                        <button class="media-btn" data-width="1080" data-height="2340">安卓通用</button>
                    </div>
                </div>
                <div class="form-item">
                    <label class="form-label">宽高比例</label>
                    <div class="ratio-buttons">
                        <button class="ratio-btn active" data-ratio="16:9">16:9</button>
                        <button class="ratio-btn" data-ratio="4:3">4:3</button>
                        <button class="ratio-btn" data-ratio="1:1">1:1</button>
                        <button class="ratio-btn" data-ratio="9:16">9:16</button>
                        <button class="ratio-btn" data-ratio="3:4">3:4</button>
                        <button class="ratio-btn" data-ratio="3:2">3:2</button>
                        <button class="ratio-btn" data-ratio="16:10">16:10</button>
                        <button class="ratio-btn" data-ratio="2.39:1">2.39:1</button>
                        <button class="ratio-btn" data-ratio="free">自由</button>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- 图像样式分组 -->
        <div class="layout-category">
            <div class="category-header expanded" data-target="image-style">
                <div class="category-title">
                    <i class="fas fa-image"></i> 图像样式
                </div>
                <i class="fas fa-chevron-right category-arrow"></i>
            </div>
            <div class="layout-content" id="image-style">
                <div class="form-item">
                    <label class="form-label">图片间距</label>
                    <div class="slider-group">
                        <input type="range" class="form-input" id="imageSpacing" min="0" max="50" value="10" style="flex: 1;">
                        <span class="slider-value" id="spacingValue">10px</span>
                    </div>
                </div>
                <div class="form-item">
                    <label class="form-label">圆角半径</label>
                    <div class="slider-group">
                        <input type="range" class="form-input" id="imageRadius" min="0" max="50" value="0" style="flex: 1;">
                        <span class="slider-value" id="radiusValue">0px</span>
                    </div>
                </div>
                <div class="form-item">
                    <label class="form-label">背景颜色</label>
                    <input type="color" class="form-input" id="bgColor" value="#ffffff">
                </div>
            </div>
        </div>
        
        <!-- 画布辅助功能 -->
        <div class="layout-category">
            <div class="category-header expanded" data-target="canvas-assist">
                <div class="category-title">
                    <i class="fas fa-tools"></i> 画布辅助
                </div>
                <i class="fas fa-chevron-right category-arrow"></i>
            </div>
            <div class="layout-content" id="canvas-assist">
                <div class="form-item">
                    <label class="form-label">辅助功能</label>
                    <div class="ratio-buttons">
                        <button class="ratio-btn" id="toggleGrid">显示网格</button>
                        <button class="ratio-btn" id="toggleGuides">显示辅助线</button>
                        <button class="ratio-btn" id="lockAspectRatio">锁定比例</button>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- 导出设置 -->
        <div class="layout-category">
            <div class="category-header expanded" data-target="export-settings">
                <div class="category-title">
                    <i class="fas fa-download"></i> 导出设置
                </div>
                <i class="fas fa-chevron-right category-arrow"></i>
            </div>
            <div class="layout-content" id="export-settings">
                <div class="form-item">
                    <label class="form-label">图片格式</label>
                    <select class="form-input" id="outputFormat">
                        <option value="image/jpeg">JPEG (高压缩)</option>
                        <option value="image/png">PNG (支持透明)</option>
                        <option value="image/webp">WebP (高质量)</option>
                    </select>
                </div>
                <div class="form-item">
                    <label class="form-label">图片质量</label>
                    <div class="slider-group">
                        <input type="range" class="form-input" id="imageQuality" min="0.1" max="1" step="0.1" value="0.9" style="flex: 1;">
                        <span class="slider-value" id="qualityValue">90%</span>
                    </div>
                </div>
            </div>
        </div>
    </aside>
    </div>
    </main>
    <!-- 全屏预览模态框 -->
    <div class="fullscreen-modal" id="fullscreenModal">
        <div class="fullscreen-content">
            <div class="fullscreen-toolbar">
                <button class="fullscreen-btn" id="zoomInBtn" title="放大">
                    <i class="fas fa-search-plus"></i>
                </button>
                <button class="fullscreen-btn" id="zoomOutBtn" title="缩小">
                    <i class="fas fa-search-minus"></i>
                </button>
                <button class="fullscreen-btn" id="resetZoomBtn" title="重置">
                    <i class="fas fa-expand-arrows-alt"></i>
                </button>
                <button class="fullscreen-btn" id="downloadFullBtn" title="下载">
                    <i class="fas fa-download"></i>
                </button>
                <button class="fullscreen-btn" id="closeFullBtn" title="关闭">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <img id="fullscreenImage" class="fullscreen-image" alt="合并结果">
            <div class="fullscreen-info" id="fullscreenInfo">
                点击工具栏进行缩放操作
            </div>
        </div>
    </div>
    <input type="file" id="fileInput" multiple accept="image/*" style="display: none;">
    <script src="../assets/js/layui.min.js"></script>
    <script>
        layui.use(['layer', 'form', 'element', 'upload', 'slider', 'util'], function () { });
        // 应用程序状态
        let currentLayout = '2-1';
        let currentCount = 2;
        let uploadedImages = [];
        let mergedImageData = null;
        let zoomLevel = 1;
        let hasManualAdjustment = false; // 记录是否有手动调整
        let savedGridState = null; // 保存的网格状态

        // 画布调整大小状态
        let isResizing = false;
        let resizeDirection = '';
        let startX = 0;
        let startY = 0;
        let startWidth = 0;
        let startHeight = 0;
        let aspectRatioLocked = false;
        let initialAspectRatio = 1;
        let gridVisible = false;
        let guidesVisible = false;

        // 网格单元调整状态
        let isCellResizing = false;
        let resizingCell = null;
        let cellResizeDirection = '';
        let cellStartX = 0;
        let cellStartY = 0;
        let cellStartRect = null;
        let gridColumnsInfo = [];
        let gridRowsInfo = [];
        let cellResizeEnabled = true; // 默认开启单元调整

        // 初始化
        document.addEventListener('DOMContentLoaded', function () {
            initializeApp();
        });

        // 颜色主题定义
        const colorThemes = {
            orange: {
                primary: '#e67e22',
                primaryLight: '#eb984e',
                primaryDark: '#d35400',
                secondary: '#3498db',
                accent: '#2ecc71'
            },
            blue: {
                primary: '#3498db',
                primaryLight: '#5dade2',
                primaryDark: '#2980b9',
                secondary: '#2ecc71',
                accent: '#e67e22'
            },
            green: {
                primary: '#27ae60',
                primaryLight: '#2ecc71',
                primaryDark: '#1e8449',
                secondary: '#3498db',
                accent: '#e67e22'
            },
            purple: {
                primary: '#9b59b6',
                primaryLight: '#bb8fce',
                primaryDark: '#7d3c98',
                secondary: '#3498db',
                accent: '#2ecc71'
            },
            red: {
                primary: '#e74c3c',
                primaryLight: '#ec7063',
                primaryDark: '#c0392b',
                secondary: '#3498db',
                accent: '#2ecc71'
            },
            yellow: {
                primary: '#f1c40f',
                primaryLight: '#f4d03f',
                primaryDark: '#d4ac0d',
                secondary: '#3498db',
                accent: '#2ecc71'
            },
            'contrast-dark': {
                primary: '#2c3e50',
                primaryLight: '#34495e',
                primaryDark: '#1a252f',
                secondary: '#95a5a6',
                accent: '#ffffff'
            },
            'contrast-light': {
                primary: '#ecf0f1',
                primaryLight: '#ffffff',
                primaryDark: '#bdc3c7',
                secondary: '#7f8c8d',
                accent: '#2c3e50'
            }
        };

        function initializeApp() {
            initEventListeners();
            initColorPicker();
            loadSavedTheme();
            updateSliderValues();
            updatePreviewGrid();
            // 默认展开所有布局
            expandAllLayouts();
            // 确保宽高比例同步
            enforceAspectRatio();
            // 初始化预览尺寸
            setTimeout(updatePreviewSize, 100);
            // 加载面板位置
            setTimeout(() => {
                loadPanelPosition('left');
                loadPanelPosition('right');
            }, 200);
        }

        function initEventListeners() {
            // 侧边栏切换事件
            document.getElementById('leftPanelToggle').addEventListener('click', function () {
                togglePanel('left');
            });

            document.getElementById('rightPanelToggle').addEventListener('click', function () {
                togglePanel('right');
            });

            // 初始化面板拖拽功能
            initPanelDrag();
            
            // 初始化画布调整大小功能
            initCanvasResize();
            
            // 初始化网格单元调整功能
            initCellResize();
            
            // 初始化拖拽虚线功能  
            initDividerDrag();
            
            
            // 比例按钮
            document.querySelectorAll('.ratio-btn').forEach(btn => {
                btn.addEventListener('click', function () {
                    selectRatio(this);
                });
            });

            // 布局分类折叠
            document.querySelectorAll('.category-header').forEach(header => {
                header.addEventListener('click', function () {
                    toggleCategory(this);
                });
            });

            // 布局选择
            document.querySelectorAll('.layout-item').forEach(item => {
                item.addEventListener('click', function () {
                    selectLayout(this);
                });
            });


            // 多媒体尺寸按钮
            document.querySelectorAll('.media-btn').forEach(btn => {
                btn.addEventListener('click', function () {
                    selectMediaSize(this);
                });
            });

            // 尺寸输入框变化事件
            document.getElementById('canvasWidth').addEventListener('input', handleSizeChange);
            document.getElementById('canvasHeight').addEventListener('input', handleSizeChange);

            // 滑块变化
            document.getElementById('imageSpacing').addEventListener('input', updateSliderValues);
            document.getElementById('imageRadius').addEventListener('input', updateSliderValues);
            document.getElementById('imageQuality').addEventListener('input', updateSliderValues);

            // 文件选择
            document.getElementById('fileInput').addEventListener('change', handleFileSelect);

            // 按钮事件
            document.getElementById('mergeBtn').addEventListener('click', mergeImages);
            document.getElementById('resetBtn').addEventListener('click', resetAll);
            document.getElementById('downloadBtn').addEventListener('click', downloadImage);

            // 全屏预览事件
            document.getElementById('zoomInBtn').addEventListener('click', () => zoomImage(1.2));
            document.getElementById('zoomOutBtn').addEventListener('click', () => zoomImage(0.8));
            document.getElementById('resetZoomBtn').addEventListener('click', resetZoom);
            document.getElementById('downloadFullBtn').addEventListener('click', downloadImage);
            document.getElementById('closeFullBtn').addEventListener('click', closeFullscreen);

            // 拖拽事件
            document.addEventListener('dragover', handleDragOver);
            document.addEventListener('drop', handleDrop);

            // 窗口大小改变时更新预览尺寸
            window.addEventListener('resize', debounce(updatePreviewSize, 300));

            // 点击模态框外部关闭
            document.getElementById('fullscreenModal').addEventListener('click', function (e) {
                if (e.target === this) {
                    closeFullscreen();
                }
            });

            // 画布辅助功能按钮
            document.getElementById('toggleGrid').addEventListener('click', toggleGrid);
            document.getElementById('toggleGuides').addEventListener('click', toggleGuides);
            document.getElementById('lockAspectRatio').addEventListener('click', toggleAspectRatioLock);

        }

        // 颜色选择器初始化
        function initColorPicker() {
            const colorOptions = document.querySelectorAll('.color-option');
            colorOptions.forEach(option => {
                option.addEventListener('click', function() {
                    const colorName = this.getAttribute('data-color');
                    switchTheme(colorName);
                    
                    // 更新选中状态
                    colorOptions.forEach(opt => opt.classList.remove('active'));
                    this.classList.add('active');
                });
            });
        }

        // 切换主题
        function switchTheme(colorName) {
            const theme = colorThemes[colorName];
            if (!theme) return;
            
            const root = document.documentElement;
            root.style.setProperty('--primary', theme.primary);
            root.style.setProperty('--primary-light', theme.primaryLight);
            root.style.setProperty('--primary-dark', theme.primaryDark);
            root.style.setProperty('--secondary', theme.secondary);
            root.style.setProperty('--accent', theme.accent);
            
            // 为拖拽线添加RGBA颜色变量
            const primaryColor = theme.primary;
            const rgbMatch = primaryColor.match(/#([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})/i);
            if (rgbMatch) {
                const r = parseInt(rgbMatch[1], 16);
                const g = parseInt(rgbMatch[2], 16);
                const b = parseInt(rgbMatch[3], 16);
                
                root.style.setProperty('--primary-rgba-10', `rgba(${r}, ${g}, ${b}, 0.1)`);
                root.style.setProperty('--primary-rgba-20', `rgba(${r}, ${g}, ${b}, 0.2)`);
                root.style.setProperty('--primary-rgba-30', `rgba(${r}, ${g}, ${b}, 0.3)`);
                root.style.setProperty('--primary-rgba-40', `rgba(${r}, ${g}, ${b}, 0.4)`);
                root.style.setProperty('--primary-rgba-60', `rgba(${r}, ${g}, ${b}, 0.6)`);
                root.style.setProperty('--primary-rgba-70', `rgba(${r}, ${g}, ${b}, 0.7)`);
            }
            
            // 保存当前主题到localStorage
            localStorage.setItem('selectedTheme', colorName);
        }

        // 加载保存的主题
        function loadSavedTheme() {
            const savedTheme = localStorage.getItem('selectedTheme') || 'orange';
            switchTheme(savedTheme);
            
            // 更新UI选中状态
            const colorOptions = document.querySelectorAll('.color-option');
            colorOptions.forEach(option => {
                option.classList.remove('active');
                if (option.getAttribute('data-color') === savedTheme) {
                    option.classList.add('active');
                }
            });
        }

        function togglePanel(side) {
            const panel = side === 'left' ? document.querySelector('.layout-panel') : document.querySelector('.properties-panel');
            const isCollapsed = panel.classList.contains('collapsed');

            if (isCollapsed) {
                panel.classList.remove('collapsed');
            } else {
                panel.classList.add('collapsed');
            }
        }

        // 面板拖拽功能
        function initPanelDrag() {
            const panels = [
                { element: document.querySelector('.layout-panel'), side: 'left' },
                { element: document.querySelector('.properties-panel'), side: 'right' }
            ];

            panels.forEach(panel => {
                if (panel.element) {
                    makeDraggable(panel.element, panel.side);
                }
            });
        }

        function makeDraggable(element, side) {
            let isDragging = false;
            let startX = 0;
            let startY = 0;
            let initialX = 0;
            let initialY = 0;
            let animationId = null;

            // 拖拽开始
            element.addEventListener('mousedown', function (e) {
                // 只有点击面板头部区域才能拖拽
                if (e.target.closest('.panel-header') || e.target.closest('.section-title')) {
                    isDragging = true;
                    startX = e.clientX;
                    startY = e.clientY;

                    const rect = element.getBoundingClientRect();
                    initialX = rect.left;
                    initialY = rect.top;

                    element.classList.add('dragging');
                    document.body.style.userSelect = 'none';
                    document.body.style.cursor = 'grabbing';

                    e.preventDefault();
                }
            });

            // 拖拽过程 - 使用 requestAnimationFrame 优化
            function updatePosition(e) {
                if (!isDragging) return;

                const deltaX = e.clientX - startX;
                const deltaY = e.clientY - startY;

                let newX = initialX + deltaX;
                let newY = initialY + deltaY;

                // 限制面板在窗口内
                const headerHeight = 150;
                const panelWidth = element.offsetWidth;
                const panelHeight = element.offsetHeight;

                newX = Math.max(0, Math.min(newX, window.innerWidth - panelWidth));
                newY = Math.max(headerHeight, Math.min(newY, window.innerHeight - panelHeight));

                // 使用 transform 代替直接修改 left/top，性能更好
                element.style.transform = `translate(${newX - initialX}px, ${newY - initialY}px)`;
            }

            document.addEventListener('mousemove', function (e) {
                if (!isDragging) return;

                // 取消上一帧的动画
                if (animationId) {
                    cancelAnimationFrame(animationId);
                }

                // 使用 requestAnimationFrame 优化性能
                animationId = requestAnimationFrame(() => updatePosition(e));
            });

            // 拖拽结束
            document.addEventListener('mouseup', function (e) {
                if (isDragging) {
                    isDragging = false;
                    element.classList.remove('dragging');
                    document.body.style.userSelect = '';
                    document.body.style.cursor = '';

                    // 拖拽结束后，将 transform 转换为实际的 left/top 位置
                    const rect = element.getBoundingClientRect();
                    element.style.left = rect.left + 'px';
                    element.style.top = rect.top + 'px';
                    element.style.right = 'auto';
                    element.style.transform = '';

                    // 保存面板位置
                    savePanelPosition(side, element);

                    // 取消动画帧
                    if (animationId) {
                        cancelAnimationFrame(animationId);
                        animationId = null;
                    }
                }
            });
        }

        function savePanelPosition(side, element) {
            const rect = element.getBoundingClientRect();
            const position = {
                left: rect.left,
                top: rect.top
            };

            // 保存到localStorage
            localStorage.setItem(`panel-${side}-position`, JSON.stringify(position));
        }

        function loadPanelPosition(side) {
            const saved = localStorage.getItem(`panel-${side}-position`);
            if (saved) {
                const position = JSON.parse(saved);
                const element = side === 'left' ?
                    document.querySelector('.layout-panel') :
                    document.querySelector('.properties-panel');

                if (element) {
                    element.style.left = position.left + 'px';
                    element.style.top = position.top + 'px';
                    element.style.right = 'auto';
                }
            }
        }

        function expandAllLayouts() {
            document.querySelectorAll('.category-header').forEach(header => {
                header.classList.add('expanded');
                const target = header.dataset.target;
                const content = document.getElementById(target);
                if (content) {
                    content.style.display = 'block';
                }
            });
        }

        function toggleCategory(header) {
            const isExpanded = header.classList.contains('expanded');
            const target = header.dataset.target;
            const content = document.getElementById(target);

            if (isExpanded) {
                header.classList.remove('expanded');
                content.style.display = 'none';
            } else {
                header.classList.add('expanded');
                content.style.display = 'block';
            }
        }

        function selectLayout(item) {
            // 如果用户有手动调整，提示用户选择
            if (hasManualAdjustment) {
                layer.confirm('您已手动调整了网格布局，选择新布局将重置调整。是否继续？', {
                    icon: 3,
                    title: '确认重置布局',
                    btn: ['继续重置', '保持当前']
                }, function (index) {
                    // 用户选择继续重置
                    applyNewLayout(item);
                    layer.close(index);
                }, function () {
                    // 用户选择保持当前布局，仅更新UI状态
                    // 不执行布局重置，保持当前的手动调整
                });
            } else {
                // 没有手动调整，直接应用新布局
                applyNewLayout(item);
            }
        }
        
        function applyNewLayout(item) {
            document.querySelectorAll('.layout-item').forEach(el => el.classList.remove('active'));
            item.classList.add('active');

            currentLayout = item.dataset.layout;
            currentCount = parseInt(item.dataset.count);

            // 清除所有手动调整状态
            clearGridState();

            updatePreviewGrid();
            
            // 🔑 关键修复：布局切换时确保gap与spacing同步
            applySpacingToPreview();
        }


        function selectMediaSize(btn) {
            // 清除所有媒体按钮的激活状态
            document.querySelectorAll('.media-btn').forEach(el => el.classList.remove('active'));
            btn.classList.add('active');

            // 清除比例按钮的激活状态，因为使用了自定义尺寸
            document.querySelectorAll('.ratio-btn').forEach(el => el.classList.remove('active'));

            // 设置为自由比例模式
            const freeBtn = document.querySelector('.ratio-btn[data-ratio="free"]');
            if (freeBtn) {
                freeBtn.classList.add('active');
            }

            // 获取媒体尺寸并设置
            const width = parseInt(btn.dataset.width);
            const height = parseInt(btn.dataset.height);

            document.getElementById('canvasWidth').value = width;
            document.getElementById('canvasHeight').value = height;

            // 立即更新预览尺寸
            updatePreviewSize();
        }


        function handleSizeChange() {
            // 清除媒体按钮的激活状态，因为手动修改了尺寸
            document.querySelectorAll('.media-btn').forEach(el => el.classList.remove('active'));

            // 检查当前选中的比例按钮，如果不是自由模式，则保持比例
            const activeRatio = document.querySelector('.ratio-btn.active');
            if (activeRatio && activeRatio.dataset.ratio !== 'free') {
                enforceAspectRatio();
            }
            // 立即更新预览尺寸以保持同步
            updatePreviewSize();
        }

        function selectRatio(btn) {
            document.querySelectorAll('.ratio-btn').forEach(el => el.classList.remove('active'));
            btn.classList.add('active');

            // 清除媒体按钮的激活状态
            document.querySelectorAll('.media-btn').forEach(el => el.classList.remove('active'));

            const ratio = btn.dataset.ratio;
            updateCanvasSizeByRatio(ratio);
        }

        function updateCanvasSizeByRatio(ratio) {
            const width = document.getElementById('canvasWidth');
            const height = document.getElementById('canvasHeight');

            if (ratio === '16:9') {
                width.value = 1600; height.value = 900;
            } else if (ratio === '4:3') {
                width.value = 1200; height.value = 900;
            } else if (ratio === '1:1') {
                width.value = 1000; height.value = 1000;
            } else if (ratio === '9:16') {
                width.value = 900; height.value = 1600;
            } else if (ratio === '3:4') {
                width.value = 900; height.value = 1200;
            } else if (ratio === '3:2') {
                width.value = 750; height.value = 500;
            } else if (ratio === '16:10') {
                width.value = 1600; height.value = 1000;
            } else if (ratio === '2.39:1') {
                width.value = 1195; height.value = 500;
            }
            // 立即更新预览尺寸以保持同步
            updatePreviewSize();
        }

        function enforceAspectRatio() {
            const activeRatio = document.querySelector('.ratio-btn.active');
            if (!activeRatio || activeRatio.dataset.ratio === 'free') return;

            const ratio = activeRatio.dataset.ratio;
            const width = parseInt(document.getElementById('canvasWidth').value);
            const height = parseInt(document.getElementById('canvasHeight').value);

            if (ratio === '16:9') {
                document.getElementById('canvasHeight').value = Math.round(width * 9 / 16);
            } else if (ratio === '4:3') {
                document.getElementById('canvasHeight').value = Math.round(width * 3 / 4);
            } else if (ratio === '1:1') {
                document.getElementById('canvasHeight').value = width;
            } else if (ratio === '9:16') {
                document.getElementById('canvasHeight').value = Math.round(width * 16 / 9);
            } else if (ratio === '3:4') {
                document.getElementById('canvasHeight').value = Math.round(width * 4 / 3);
            } else if (ratio === '3:2') {
                document.getElementById('canvasHeight').value = Math.round(width * 2 / 3);
            } else if (ratio === '16:10') {
                document.getElementById('canvasHeight').value = Math.round(width * 10 / 16);
            } else if (ratio === '2.39:1') {
                document.getElementById('canvasHeight').value = Math.round(width / 2.39);
            }
        }

        function updateSliderValues() {
            const spacing = document.getElementById('imageSpacing');
            const radius = document.getElementById('imageRadius');
            const quality = document.getElementById('imageQuality');

            document.getElementById('spacingValue').textContent = spacing.value + 'px';
            document.getElementById('radiusValue').textContent = radius.value + 'px';
            document.getElementById('qualityValue').textContent = Math.round(quality.value * 100) + '%';

            applySpacingToPreview();
            applyRadiusToPreview();
            
            // 初始化网格分割线，延迟更久以确保布局已应用
            setTimeout(() => {
                refreshGridInfo(); // 先刷新网格信息
                setTimeout(() => {
                    addGridDividers(); // 再添加分割线
                }, 50);
            }, 150);
        }

        function applySpacingToPreview() {
            const spacing = document.getElementById('imageSpacing').value;
            document.getElementById('previewGrid').style.gap = spacing + 'px';
        }

        function applyRadiusToPreview() {
            const radius = document.getElementById('imageRadius').value;
            const gridCells = document.querySelectorAll('.grid-cell');
            const gridImages = document.querySelectorAll('.grid-cell img');
            
            // 应用圆角到grid-cell容器
            gridCells.forEach(cell => {
                cell.style.borderRadius = radius + 'px';
            });
            
            // 应用圆角到图片本身
            gridImages.forEach(img => {
                img.style.borderRadius = radius + 'px';
            });
        }

        function updatePreviewSize() {
            const canvasWidth = parseInt(document.getElementById('canvasWidth').value) || 1200;
            const canvasHeight = parseInt(document.getElementById('canvasHeight').value) || 800;

            // 获取预览容器
            const container = document.getElementById('previewContainer');

            // 更新预览画布尺寸 - 计算适合的缩放比例
            let previewCanvas = document.getElementById('previewCanvas');
            if (!previewCanvas) {
                // 创建预览画布包装器
                const previewGrid = document.getElementById('previewGrid');
                const wrapper = document.createElement('div');
                wrapper.className = 'preview-wrapper';

                previewCanvas = document.createElement('div');
                previewCanvas.id = 'previewCanvas';
                previewCanvas.className = 'preview-canvas resizable-canvas';

                // 创建拖拽手柄容器
                const resizeHandles = document.createElement('div');
                resizeHandles.className = 'resize-handles';
                resizeHandles.innerHTML = `
                    <!-- 四角手柄 -->
                    <div class="resize-handle corner nw" data-direction="nw"></div>
                    <div class="resize-handle corner ne" data-direction="ne"></div>
                    <div class="resize-handle corner sw" data-direction="sw"></div>
                    <div class="resize-handle corner se" data-direction="se"></div>
                    <!-- 边缘手柄 -->
                    <div class="resize-handle edge n" data-direction="n"></div>
                    <div class="resize-handle edge s" data-direction="s"></div>
                    <div class="resize-handle edge w" data-direction="w"></div>
                    <div class="resize-handle edge e" data-direction="e"></div>
                `;

                // 创建辅助线容器
                const guides = document.createElement('div');
                guides.className = 'canvas-guides';
                guides.innerHTML = `
                    <div class="guide-line guide-h" id="guideH"></div>
                    <div class="guide-line guide-v" id="guideV"></div>
                    <div class="guide-center-h"></div>
                    <div class="guide-center-v"></div>
                `;

                // 创建网格容器
                const grid = document.createElement('div');
                grid.className = 'canvas-grid';

                wrapper.appendChild(previewCanvas);
                previewCanvas.appendChild(previewGrid);
                previewCanvas.appendChild(resizeHandles);
                previewCanvas.appendChild(guides);
                previewCanvas.appendChild(grid);

                container.insertBefore(wrapper, container.firstChild);
            }

            // 计算预览容器的可用空间（考虑滚动条和padding）
            const containerRect = container.getBoundingClientRect();
            const maxWidth = Math.max(400, containerRect.width - 40); // 最小400px宽度
            const maxHeight = Math.max(300, containerRect.height - 40); // 最小300px高度

            // 计算缩放比例以适应容器，但不超过1:1
            const scaleX = maxWidth / canvasWidth;
            const scaleY = maxHeight / canvasHeight;
            const scale = Math.min(scaleX, scaleY, 1);

            const displayWidth = canvasWidth * scale;
            const displayHeight = canvasHeight * scale;

            // 设置预览画布显示尺寸
            previewCanvas.style.width = displayWidth + 'px';
            previewCanvas.style.height = displayHeight + 'px';

            // 存储实际尺寸供其他函数使用
            previewCanvas.dataset.scale = scale;
            previewCanvas.dataset.outputWidth = canvasWidth;
            previewCanvas.dataset.outputHeight = canvasHeight;

            // 更新尺寸信息显示
            updateSizeInfo(canvasWidth, canvasHeight, scale);
        }

        function updateSizeInfo(width, height, scale) {
            let sizeInfo = document.getElementById('sizeInfo');
            if (!sizeInfo) {
                sizeInfo = document.createElement('div');
                sizeInfo.id = 'sizeInfo';
                sizeInfo.style.cssText = `
                    position: absolute;
                    top: 10px;
                    left: 10px;
                    background: rgba(0,0,0,0.8);
                    color: white;
                    padding: 6px 12px;
                    border-radius: 4px;
                    font-size: 12px;
                    z-index: 10;
                    font-family: monospace;
                    box-shadow: 0 2px 8px rgba(0,0,0,0.3);
                `;
                const previewCanvas = document.getElementById('previewCanvas');
                if (previewCanvas) {
                    previewCanvas.appendChild(sizeInfo);
                }
            }

            // 显示尺寸信息
            const displayWidth = Math.round(width * scale);
            const displayHeight = Math.round(height * scale);
            sizeInfo.innerHTML = `
                <div style="font-weight: bold; margin-bottom: 2px;">输出尺寸: ${width}×${height}px</div>
                <div>预览尺寸: ${displayWidth}×${displayHeight}px (${Math.round(scale * 100)}%)</div>
            `;
        }

        // 防抖函数
        function debounce(func, wait) {
            let timeout;
            return function executedFunction(...args) {
                const later = () => {
                    clearTimeout(timeout);
                    func(...args);
                };
                clearTimeout(timeout);
                timeout = setTimeout(later, wait);
            };
        }

        // 画布调整大小功能
        function initCanvasResize() {
            document.addEventListener('mousedown', handleResizeStart);
            document.addEventListener('mousemove', handleResizeMove);
            document.addEventListener('mouseup', handleResizeEnd);
        }

        function handleResizeStart(e) {
            const target = e.target;
            if (!target.classList.contains('resize-handle')) return;

            isResizing = true;
            resizeDirection = target.getAttribute('data-direction');
            
            const previewCanvas = document.getElementById('previewCanvas');
            if (!previewCanvas) return;

            const rect = previewCanvas.getBoundingClientRect();
            startX = e.clientX;
            startY = e.clientY;
            startWidth = parseInt(previewCanvas.dataset.outputWidth) || 1200;
            startHeight = parseInt(previewCanvas.dataset.outputHeight) || 800;
            
            if (aspectRatioLocked) {
                initialAspectRatio = startWidth / startHeight;
            }

            // 显示辅助元素
            const handles = previewCanvas.querySelector('.resize-handles');
            const guides = previewCanvas.querySelector('.canvas-guides');
            if (handles) handles.classList.add('active');
            if (guides && guidesVisible) guides.classList.add('active');

            document.body.style.cursor = target.style.cursor;
            document.body.style.userSelect = 'none';
            e.preventDefault();
        }

        function handleResizeMove(e) {
            if (!isResizing) return;

            const deltaX = e.clientX - startX;
            const deltaY = e.clientY - startY;
            
            let newWidth = startWidth;
            let newHeight = startHeight;

            // 根据拖拽方向计算新尺寸
            switch (resizeDirection) {
                case 'nw':
                    newWidth = startWidth - deltaX;
                    newHeight = startHeight - deltaY;
                    break;
                case 'ne':
                    newWidth = startWidth + deltaX;
                    newHeight = startHeight - deltaY;
                    break;
                case 'sw':
                    newWidth = startWidth - deltaX;
                    newHeight = startHeight + deltaY;
                    break;
                case 'se':
                    newWidth = startWidth + deltaX;
                    newHeight = startHeight + deltaY;
                    break;
                case 'n':
                    newHeight = startHeight - deltaY;
                    break;
                case 's':
                    newHeight = startHeight + deltaY;
                    break;
                case 'w':
                    newWidth = startWidth - deltaX;
                    break;
                case 'e':
                    newWidth = startWidth + deltaX;
                    break;
            }

            // 最小尺寸限制
            newWidth = Math.max(200, newWidth);
            newHeight = Math.max(150, newHeight);
            
            // 最大尺寸限制
            newWidth = Math.min(4000, newWidth);
            newHeight = Math.min(4000, newHeight);

            // 宽高比锁定
            if (aspectRatioLocked) {
                if (resizeDirection.includes('e') || resizeDirection.includes('w')) {
                    newHeight = newWidth / initialAspectRatio;
                } else if (resizeDirection.includes('n') || resizeDirection.includes('s')) {
                    newWidth = newHeight * initialAspectRatio;
                } else {
                    // 对角线拖拽，保持比例
                    const ratioX = newWidth / startWidth;
                    const ratioY = newHeight / startHeight;
                    const ratio = Math.min(ratioX, ratioY);
                    newWidth = startWidth * ratio;
                    newHeight = startHeight * ratio;
                }
            }

            // 网格对齐（10像素对齐）
            if (gridVisible) {
                newWidth = Math.round(newWidth / 10) * 10;
                newHeight = Math.round(newHeight / 10) * 10;
            }

            // 更新画布尺寸
            setCanvasSize(Math.round(newWidth), Math.round(newHeight));
            
            // 更新辅助线
            updateGuides(e.clientX, e.clientY);
        }

        function handleResizeEnd(e) {
            if (!isResizing) return;

            isResizing = false;
            resizeDirection = '';

            // 隐藏辅助元素
            const previewCanvas = document.getElementById('previewCanvas');
            if (previewCanvas) {
                const handles = previewCanvas.querySelector('.resize-handles');
                const guides = previewCanvas.querySelector('.canvas-guides');
                if (handles) handles.classList.remove('active');
                if (guides) guides.classList.remove('active');
            }

            document.body.style.cursor = '';
            document.body.style.userSelect = '';
        }

        function setCanvasSize(width, height) {
            document.getElementById('canvasWidth').value = width;
            document.getElementById('canvasHeight').value = height;
            updatePreviewSize();
        }

        function updateGuides(mouseX, mouseY) {
            if (!guidesVisible) return;
            
            const guides = document.querySelector('.canvas-guides');
            if (!guides) return;

            const guideH = guides.querySelector('.guide-h');
            const guideV = guides.querySelector('.guide-v');
            
            if (guideH) guideH.style.top = mouseY + 'px';
            if (guideV) guideV.style.left = mouseX + 'px';
        }

        // 辅助功能
        function toggleGrid() {
            gridVisible = !gridVisible;
            const grid = document.querySelector('.canvas-grid');
            const btn = document.getElementById('toggleGrid');
            
            if (grid) {
                grid.classList.toggle('active', gridVisible);
            }
            
            btn.classList.toggle('active', gridVisible);
            btn.textContent = gridVisible ? '隐藏网格' : '显示网格';
        }

        function toggleGuides() {
            guidesVisible = !guidesVisible;
            const btn = document.getElementById('toggleGuides');
            
            btn.classList.toggle('active', guidesVisible);
            btn.textContent = guidesVisible ? '隐藏辅助线' : '显示辅助线';
        }

        function toggleAspectRatioLock() {
            aspectRatioLocked = !aspectRatioLocked;
            const btn = document.getElementById('lockAspectRatio');
            
            if (aspectRatioLocked) {
                const width = parseInt(document.getElementById('canvasWidth').value) || 1200;
                const height = parseInt(document.getElementById('canvasHeight').value) || 800;
                initialAspectRatio = width / height;
            }
            
            btn.classList.toggle('active', aspectRatioLocked);
            btn.textContent = aspectRatioLocked ? '解锁比例' : '锁定比例';
        }


        // 网格单元调整大小功能
        function initCellResize() {
            document.addEventListener('mousedown', handleCellResizeStart);
            document.addEventListener('mousemove', handleCellResizeMove);
            document.addEventListener('mouseup', handleCellResizeEnd);
        }

        // 拖拽虚线功能
        let isDividerDragging = false;
        let dragDirection = '';
        let dragIndex = 0;
        let dragStartX = 0;
        let dragStartY = 0;
        let dragAnimationFrame = null;
        let dragIndicator = null;
        let lastDragTime = 0;
        const DRAG_THROTTLE = 8; // 毫秒

        function initDividerDrag() {
            document.addEventListener('mousedown', handleDividerDragStart);
            document.addEventListener('mousemove', handleDividerDragMove);
            document.addEventListener('mouseup', handleDividerDragEnd);
            
            // 创建拖拽指示器
            dragIndicator = document.createElement('div');
            dragIndicator.className = 'drag-indicator';
            document.body.appendChild(dragIndicator);
        }

        function handleDividerDragStart(e) {
            const target = e.target;
            if (!target.classList.contains('grid-divider-line') || !cellResizeEnabled) return;

            isDividerDragging = true;
            dragDirection = target.dataset.direction;
            dragIndex = parseInt(target.dataset.columnIndex || target.dataset.rowIndex);
            dragStartX = e.clientX;
            dragStartY = e.clientY;
            lastDragTime = Date.now();

            target.classList.add('dragging');
            document.body.style.cursor = dragDirection === 'vertical' ? 'ew-resize' : 'ns-resize';
            document.body.style.userSelect = 'none';
            
            // 添加拖拽状态到网格
            const grid = document.getElementById('previewGrid');
            if (grid) {
                grid.classList.add('dragging-divider');
            }
            
            // 显示拖拽指示器
            if (dragIndicator) {
                const gridRect = grid.getBoundingClientRect();
                if (dragDirection === 'vertical') {
                    dragIndicator.style.left = e.clientX - 2 + 'px';
                    dragIndicator.style.top = gridRect.top + 'px';
                    dragIndicator.style.width = '4px';
                    dragIndicator.style.height = gridRect.height + 'px';
                } else {
                    dragIndicator.style.left = gridRect.left + 'px';
                    dragIndicator.style.top = e.clientY - 2 + 'px';
                    dragIndicator.style.width = gridRect.width + 'px';
                    dragIndicator.style.height = '4px';
                }
                dragIndicator.classList.add('active');
            }
            
            e.preventDefault();
            e.stopPropagation();
        }

        function handleDividerDragMove(e) {
            if (!isDividerDragging) return;
            
            // 节流处理
            const currentTime = Date.now();
            if (currentTime - lastDragTime < DRAG_THROTTLE) return;
            lastDragTime = currentTime;
            
            // 取消之前的动画帧
            if (dragAnimationFrame) {
                cancelAnimationFrame(dragAnimationFrame);
            }
            
            // 使用 requestAnimationFrame 优化性能
            dragAnimationFrame = requestAnimationFrame(() => {
                performDividerDrag(e);
            });
        }

        function performDividerDrag(e) {
            const grid = document.getElementById('previewGrid');
            if (!grid) return;

            const gridRect = grid.getBoundingClientRect();
            
            // 更新拖拽指示器位置
            if (dragIndicator) {
                if (dragDirection === 'vertical') {
                    dragIndicator.style.left = e.clientX - 2 + 'px';
                } else {
                    dragIndicator.style.top = e.clientY - 2 + 'px';
                }
            }

            if (dragDirection === 'vertical') {
                // 垂直拖拽 - 调整列宽
                const relativeX = (e.clientX - gridRect.left) / gridRect.width;
                const clampedX = Math.max(0.05, Math.min(0.95, relativeX));
                
                // 计算应该调整的列索引
                const leftColIndex = dragIndex - 1;
                const rightColIndex = dragIndex;
                
                if (leftColIndex >= 0 && rightColIndex < gridColumnsInfo.length) {
                    const totalWidth = gridColumnsInfo.reduce((sum, val) => sum + val, 0);
                    
                    // 调整相邻两列的宽度，保持其他列不变
                    const leftOriginalWidth = gridColumnsInfo[leftColIndex];
                    const rightOriginalWidth = gridColumnsInfo[rightColIndex];
                    const combinedWidth = leftOriginalWidth + rightOriginalWidth;
                    
                    // 计算新的分配比例
                    const leftCumulativeBefore = gridColumnsInfo.slice(0, leftColIndex).reduce((sum, val) => sum + val, 0);
                    const targetLeftWidth = clampedX * totalWidth - leftCumulativeBefore;
                    const newLeftWidth = Math.max(0.1, Math.min(combinedWidth - 0.1, targetLeftWidth));
                    const newRightWidth = Math.max(0.1, combinedWidth - newLeftWidth);
                    
                    // 只有变化超过阈值才更新，减少重绘
                    const leftDiff = Math.abs(gridColumnsInfo[leftColIndex] - newLeftWidth);
                    const rightDiff = Math.abs(gridColumnsInfo[rightColIndex] - newRightWidth);
                    
                    if (leftDiff > 0.01 || rightDiff > 0.01) {
                        // 更新列宽
                        gridColumnsInfo[leftColIndex] = newLeftWidth;
                        gridColumnsInfo[rightColIndex] = newRightWidth;
                        
                        // 标记为手动调整
                        hasManualAdjustment = true;
                        
                        // 应用新的网格模板
                        updateGridTemplateSmooth();
                        
                        // 保存当前网格状态
                        saveGridState();
                        
                        // 更新虚线位置
                        const divider = document.querySelector(`.grid-divider-line[data-column-index="${dragIndex}"]`);
                        if (divider) {
                            const newCumulativeRatio = gridColumnsInfo.slice(0, dragIndex).reduce((sum, val) => sum + val, 0) / totalWidth;
                            divider.style.left = `${newCumulativeRatio * 100}%`;
                        }
                    }
                }
                
            } else if (dragDirection === 'horizontal') {
                // 水平拖拽 - 调整行高
                const relativeY = (e.clientY - gridRect.top) / gridRect.height;
                const clampedY = Math.max(0.05, Math.min(0.95, relativeY));
                
                // 计算应该调整的行索引
                const topRowIndex = dragIndex - 1;
                const bottomRowIndex = dragIndex;
                
                if (topRowIndex >= 0 && bottomRowIndex < gridRowsInfo.length) {
                    const totalHeight = gridRowsInfo.reduce((sum, val) => sum + val, 0);
                    
                    // 调整相邻两行的高度，保持其他行不变
                    const topOriginalHeight = gridRowsInfo[topRowIndex];
                    const bottomOriginalHeight = gridRowsInfo[bottomRowIndex];
                    const combinedHeight = topOriginalHeight + bottomOriginalHeight;
                    
                    // 计算新的分配比例
                    const topCumulativeBefore = gridRowsInfo.slice(0, topRowIndex).reduce((sum, val) => sum + val, 0);
                    const targetTopHeight = clampedY * totalHeight - topCumulativeBefore;
                    const newTopHeight = Math.max(0.1, Math.min(combinedHeight - 0.1, targetTopHeight));
                    const newBottomHeight = Math.max(0.1, combinedHeight - newTopHeight);
                    
                    // 只有变化超过阈值才更新，减少重绘
                    const topDiff = Math.abs(gridRowsInfo[topRowIndex] - newTopHeight);
                    const bottomDiff = Math.abs(gridRowsInfo[bottomRowIndex] - newBottomHeight);
                    
                    if (topDiff > 0.01 || bottomDiff > 0.01) {
                        // 更新行高
                        gridRowsInfo[topRowIndex] = newTopHeight;
                        gridRowsInfo[bottomRowIndex] = newBottomHeight;
                        
                        // 标记为手动调整
                        hasManualAdjustment = true;
                        
                        // 应用新的网格模板
                        updateGridTemplateSmooth();
                        
                        // 保存当前网格状态
                        saveGridState();
                        
                        // 更新虚线位置
                        const divider = document.querySelector(`.grid-divider-line[data-row-index="${dragIndex}"]`);
                        if (divider) {
                            const newCumulativeRatio = gridRowsInfo.slice(0, dragIndex).reduce((sum, val) => sum + val, 0) / totalHeight;
                            divider.style.top = `${newCumulativeRatio * 100}%`;
                        }
                    }
                }
            }
        }

        // 优化的网格模板更新函数，减少重绘
        function updateGridTemplateSmooth() {
            const grid = document.getElementById('previewGrid');
            if (!grid) return;
            
            // 使用 transform 而不是立即改变 grid-template，减少重排
            const columnsTemplate = gridColumnsInfo.map(val => `${val}fr`).join(' ');
            const rowsTemplate = gridRowsInfo.map(val => `${val}fr`).join(' ');
            
            // 批量更新样式
            requestAnimationFrame(() => {
                grid.style.gridTemplateColumns = columnsTemplate;
                grid.style.gridTemplateRows = rowsTemplate;
            });
        }

        function handleDividerDragEnd(e) {
            if (!isDividerDragging) return;

            isDividerDragging = false;
            dragDirection = '';
            dragIndex = 0;

            // 取消任何待处理的动画帧
            if (dragAnimationFrame) {
                cancelAnimationFrame(dragAnimationFrame);
                dragAnimationFrame = null;
            }

            // 清除拖拽状态
            document.querySelectorAll('.grid-divider-line.dragging').forEach(divider => {
                divider.classList.remove('dragging');
            });

            // 移除网格拖拽状态
            const grid = document.getElementById('previewGrid');
            if (grid) {
                grid.classList.remove('dragging-divider');
            }

            // 隐藏拖拽指示器
            if (dragIndicator) {
                dragIndicator.classList.remove('active');
            }

            // 恢复样式
            document.body.style.cursor = '';
            document.body.style.userSelect = '';

            // 触发一次最终的网格更新以确保一致性
            requestAnimationFrame(() => {
                updateGridTemplate();
                // 🔑 关键修复：拖拽结束时确保gap与spacing同步
                applySpacingToPreview();
            });
        }

        function handleCellResizeStart(e) {
            const target = e.target;
            if (!target.classList.contains('cell-resize-handle') || !cellResizeEnabled) return;

            isCellResizing = true;
            cellResizeDirection = target.getAttribute('data-direction');
            const cellIndex = parseInt(target.getAttribute('data-cell-index'));
            resizingCell = document.querySelector(`.grid-cell[data-index="${cellIndex}"]`);
            
            if (!resizingCell) return;

            cellStartX = e.clientX;
            cellStartY = e.clientY;
            cellStartRect = resizingCell.getBoundingClientRect();

            // 获取网格信息
            const grid = document.getElementById('previewGrid');
            const gridStyle = window.getComputedStyle(grid);
            const gridTemplateColumns = gridStyle.gridTemplateColumns;
            const gridTemplateRows = gridStyle.gridTemplateRows;

            // 解析网格列和行信息
            gridColumnsInfo = parseGridTemplate(gridTemplateColumns);
            gridRowsInfo = parseGridTemplate(gridTemplateRows);

            // 添加调整状态
            resizingCell.classList.add('resizing');
            grid.classList.add('adjusting');

            document.body.style.cursor = target.style.cursor;
            document.body.style.userSelect = 'none';
            e.preventDefault();
            e.stopPropagation();
        }

        function handleCellResizeMove(e) {
            if (!isCellResizing || !resizingCell) return;

            const deltaX = e.clientX - cellStartX;
            const deltaY = e.clientY - cellStartY;

            const grid = document.getElementById('previewGrid');
            const gridRect = grid.getBoundingClientRect();
            const gap = 10; // CSS grid gap

            // 计算相对于网格的位置变化
            const relativeX = (e.clientX - gridRect.left) / gridRect.width;
            const relativeY = (e.clientY - gridRect.top) / gridRect.height;

            // 根据拖拽方向调整大小
            if (cellResizeDirection === 'right' || cellResizeDirection === 'corner') {
                // 调整列宽
                adjustGridColumns(relativeX, deltaX);
            }
            
            if (cellResizeDirection === 'bottom' || cellResizeDirection === 'corner') {
                // 调整行高
                adjustGridRows(relativeY, deltaY);
            }

            // 更新网格模板
            updateGridTemplate();
        }

        function handleCellResizeEnd(e) {
            if (!isCellResizing) return;

            isCellResizing = false;
            cellResizeDirection = '';

            if (resizingCell) {
                resizingCell.classList.remove('resizing');
                resizingCell = null;
            }

            const grid = document.getElementById('previewGrid');
            if (grid) {
                grid.classList.remove('adjusting');
            }

            document.body.style.cursor = '';
            document.body.style.userSelect = '';
        }

        function parseGridTemplate(template) {
            // 改进版本：更准确地解析网格模板
            if (!template || template === 'none' || template === 'auto') {
                return [1]; // 默认单列/单行
            }
            
            // 处理复杂的网格模板格式
            const values = template.trim().split(/\s+/).map(value => {
                // 移除可能的空格和特殊字符
                value = value.trim();
                
                if (value.endsWith('fr')) {
                    const num = parseFloat(value);
                    return isNaN(num) ? 1 : num;
                } else if (value.endsWith('px')) {
                    const num = parseFloat(value);
                    return isNaN(num) ? 100 : num; // px值直接返回
                } else if (value === 'auto') {
                    return 1; // auto当作1fr处理
                } else if (value.includes('%')) {
                    const num = parseFloat(value);
                    return isNaN(num) ? 1 : num / 100; // 百分比转换
                } else {
                    const num = parseFloat(value);
                    return isNaN(num) ? 1 : (num || 1); // 纯数字当作fr处理
                }
            }).filter(val => val > 0); // 过滤掉非正数
            
            console.log(`解析网格模板: "${template}" -> [${values.join(', ')}]`);
            
            return values.length > 0 ? values : [1];
        }

        function adjustGridColumns(relativeX, deltaX) {
            // 简化版本：按比例调整列宽
            const columnCount = gridColumnsInfo.length;
            const targetColumn = Math.floor(relativeX * columnCount);
            
            if (targetColumn >= 0 && targetColumn < columnCount) {
                const adjustment = deltaX / 100; // 简化调整量
                gridColumnsInfo[targetColumn] = Math.max(0.5, gridColumnsInfo[targetColumn] + adjustment);
            }
        }

        function adjustGridRows(relativeY, deltaY) {
            // 简化版本：按比例调整行高
            const rowCount = gridRowsInfo.length;
            const targetRow = Math.floor(relativeY * rowCount);
            
            if (targetRow >= 0 && targetRow < rowCount) {
                const adjustment = deltaY / 100; // 简化调整量
                gridRowsInfo[targetRow] = Math.max(0.5, gridRowsInfo[targetRow] + adjustment);
            }
        }

        function updateGridTemplate() {
            const grid = document.getElementById('previewGrid');
            if (!grid) return;

            // 应用新的网格模板
            const columnsTemplate = gridColumnsInfo.map(val => `${val}fr`).join(' ');
            const rowsTemplate = gridRowsInfo.map(val => `${val}fr`).join(' ');

            grid.style.gridTemplateColumns = columnsTemplate;
            grid.style.gridTemplateRows = rowsTemplate;
        }

        // 刷新网格信息（从当前CSS样式读取实际的网格模板）
        function refreshGridInfo() {
            const grid = document.getElementById('previewGrid');
            if (!grid) return;
            
            // 等待CSS应用完成
            setTimeout(() => {
                const gridStyle = window.getComputedStyle(grid);
                const gridTemplateColumns = gridStyle.gridTemplateColumns;
                const gridTemplateRows = gridStyle.gridTemplateRows;
                
                // 解析网格列和行信息
                gridColumnsInfo = parseGridTemplate(gridTemplateColumns);
                gridRowsInfo = parseGridTemplate(gridTemplateRows);
                
                // 网格信息已刷新
            }, 50);
        }

        // 获取布局的实际分割线信息
        function getLayoutDividerInfo(layout) {
            const dividers = {
                vertical: [], // 垂直分割线的位置（百分比）
                horizontal: [] // 水平分割线的位置（百分比）
            };

            switch (layout) {
                // 2图布局
                case '2-1': // 左右分割
                    dividers.vertical = [50];
                    break;
                case '2-2': // 上下分割
                    dividers.horizontal = [50];
                    break;

                // 3图布局
                case '3-1': // 三列
                    dividers.vertical = [33.33, 66.67];
                    break;
                case '3-2': // 三行
                    dividers.horizontal = [33.33, 66.67];
                    break;
                case '3-3': // 左大右小，只有垂直分割
                    dividers.vertical = [66.67];
                    dividers.horizontal = [50]; // 右侧小图间的分割
                    break;
                case '3-4': // 左小右大，只有垂直分割
                    dividers.vertical = [33.33];
                    dividers.horizontal = [50]; // 左侧小图间的分割
                    break;
                case '3-5': // 上大下小，只有水平分割
                    dividers.horizontal = [66.67];
                    dividers.vertical = [50]; // 下侧小图间的分割
                    break;
                case '3-6': // 上小下大，只有水平分割
                    dividers.horizontal = [33.33];
                    dividers.vertical = [50]; // 上侧小图间的分割
                    break;
                case '3-7': // 上一下二，T型
                    dividers.horizontal = [50];
                    dividers.vertical = [50]; // 下侧分割
                    break;
                case '3-8': // 上二下一，倒T型
                    dividers.horizontal = [50];
                    dividers.vertical = [50]; // 上侧分割
                    break;
                case '3-9': // 左一右二，只有垂直分割
                    dividers.vertical = [50];
                    dividers.horizontal = [50]; // 右侧分割
                    break;
                case '3-10': // 左二右一，只有垂直分割
                    dividers.vertical = [50];
                    dividers.horizontal = [50]; // 左侧分割
                    break;
                case '3-11': // T型布局
                    dividers.horizontal = [66.67];
                    dividers.vertical = [50];
                    break;
                case '3-12': // L型布局，只有一条分割线
                    dividers.vertical = [66.67];
                    break;

                // 4图布局
                case '4-1': // 2x2格子
                    dividers.vertical = [50];
                    dividers.horizontal = [50];
                    break;
                case '4-2': // 一行四列
                    dividers.vertical = [25, 50, 75];
                    break;
                case '4-3': // 一列四行
                    dividers.horizontal = [25, 50, 75];
                    break;
                case '4-4': // 上一下三
                    dividers.horizontal = [50];
                    dividers.vertical = [33.33, 66.67]; // 下方三图的分割
                    break;
                case '4-5': // 上三下一
                    dividers.horizontal = [50];
                    dividers.vertical = [33.33, 66.67]; // 上方三图的分割
                    break;
                case '4-6': // 左一右三
                    dividers.vertical = [50];
                    dividers.horizontal = [33.33, 66.67]; // 右侧三图的分割
                    break;
                case '4-7': // 左三右一
                    dividers.vertical = [50];
                    dividers.horizontal = [33.33, 66.67]; // 左侧三图的分割
                    break;
                case '4-8': // 复杂的2x2+边缘布局
                    dividers.vertical = [66.67];
                    dividers.horizontal = [66.67];
                    break;
                case '4-9': // 复杂布局
                    dividers.vertical = [33.33, 66.67];
                    dividers.horizontal = [66.67];
                    break;
                case '4-10': // 三行布局
                    dividers.horizontal = [33.33, 66.67];
                    dividers.vertical = [50]; // 中间行的分割
                    break;
                case '4-11': // 三列布局
                    dividers.vertical = [33.33, 66.67];
                    dividers.horizontal = [50]; // 中间列的分割
                    break;
                case '4-12': // 对称布局
                    dividers.vertical = [50];
                    dividers.horizontal = [33.33, 66.67];
                    break;

                // 5图布局
                case '5-3': // 上跨下小
                    dividers.horizontal = [33.33, 66.67];
                    dividers.vertical = [50]; // 下方分割
                    break;
                case '5-4': // 上一下四
                    dividers.horizontal = [33.33];
                    dividers.vertical = [25, 50, 75]; // 下方四图
                    break;
                case '5-5': // 上四下一
                    dividers.horizontal = [66.67];
                    dividers.vertical = [25, 50, 75]; // 上方四图
                    break;
                case '5-6': // 左一右四
                    dividers.vertical = [33.33];
                    dividers.horizontal = [25, 50, 75]; // 右侧四图
                    break;
                case '5-7': // 复杂九宫格
                    dividers.vertical = [33.33, 66.67];
                    dividers.horizontal = [33.33, 66.67];
                    break;
                case '5-8': // 大图加四
                    dividers.vertical = [33.33, 66.67];
                    dividers.horizontal = [33.33, 66.67];
                    break;
                case '5-9': // 左中右
                    dividers.vertical = [33.33, 66.67];
                    dividers.horizontal = [33.33, 66.67];
                    break;
                case '5-10': // 上下长条
                    dividers.horizontal = [33.33, 66.67];
                    dividers.vertical = [33.33, 66.67]; // 中间三图
                    break;

                // 6图及以上布局 - 使用标准网格
                default:
                    // 对于复杂布局，使用动态计算
                    if (layout.startsWith('6-')) {
                        // 6图大多是3x2或2x3布局
                        dividers.vertical = [33.33, 66.67];
                        dividers.horizontal = [50];
                    } else if (layout.startsWith('7-')) {
                        // 7图布局比较复杂，需要特殊处理
                        dividers.vertical = [25, 50, 75];
                        dividers.horizontal = [33.33, 66.67];
                    } else if (layout.startsWith('8-')) {
                        // 8图大多是4x2或2x4布局
                        dividers.vertical = [25, 50, 75];
                        dividers.horizontal = [50];
                    } else if (layout.startsWith('9-')) {
                        // 9图是3x3布局
                        dividers.vertical = [33.33, 66.67];
                        dividers.horizontal = [33.33, 66.67];
                    } else {
                        // 默认使用CSS Grid计算
                        return null;
                    }
                    break;
            }

            return dividers;
        }

        // 添加网格分割线功能（重写版本）
        function addGridDividers() {
            const grid = document.getElementById('previewGrid');
            if (!grid) return;

            // 清除现有分割线
            document.querySelectorAll('.grid-divider, .grid-divider-line').forEach(divider => divider.remove());

            // 获取当前布局的分割线信息
            const dividerInfo = getLayoutDividerInfo(currentLayout);
            
            if (!dividerInfo) {
                // 使用原有逻辑作为后备方案
                addGridDividersLegacy();
                return;
            }

            // 添加垂直分割线
            dividerInfo.vertical.forEach((position, index) => {
                if (position > 5 && position < 95) {
                    const divider = document.createElement('div');
                    divider.className = 'grid-divider-line vertical';
                    divider.style.left = `${position}%`;
                    divider.dataset.columnIndex = index + 1;
                    divider.dataset.direction = 'vertical';
                    grid.appendChild(divider);
                }
            });

            // 添加水平分割线
            dividerInfo.horizontal.forEach((position, index) => {
                if (position > 5 && position < 95) {
                    const divider = document.createElement('div');
                    divider.className = 'grid-divider-line horizontal';
                    divider.style.top = `${position}%`;
                    divider.dataset.rowIndex = index + 1;
                    divider.dataset.direction = 'horizontal';
                    grid.appendChild(divider);
                }
            });

            // 标记网格显示分割线状态
            if (grid.querySelectorAll('.grid-divider-line').length > 0) {
                grid.classList.add('showing-dividers');
            }
        }

        // 使用当前保存的网格信息添加拖拽线
        function addGridDividersWithCurrentInfo() {
            const grid = document.getElementById('previewGrid');
            if (!grid) return;

            // 清除现有分割线
            document.querySelectorAll('.grid-divider, .grid-divider-line').forEach(divider => divider.remove());

            // 检查网格信息是否存在
            if (!gridColumnsInfo.length || !gridRowsInfo.length) {
                console.warn('网格信息不存在，无法添加拖拽线');
                return;
            }

            const columnCount = gridColumnsInfo.length;
            const rowCount = gridRowsInfo.length;

            console.log('使用保存的网格信息添加拖拽线:', {
                columnsInfo: gridColumnsInfo,
                rowsInfo: gridRowsInfo
            });

            // 只在有多列时显示垂直分割线
            if (columnCount > 1) {
                const totalWidth = gridColumnsInfo.reduce((sum, val) => sum + val, 0);
                let cumulativeWidth = 0;
                
                // 只在列与列之间显示分割线，不在边缘显示
                for (let i = 1; i < columnCount; i++) {
                    cumulativeWidth += gridColumnsInfo[i - 1];
                    const position = (cumulativeWidth / totalWidth) * 100;
                    
                    // 只在合理位置显示分割线（5%-95%之间）
                    if (position > 5 && position < 95) {
                        const divider = document.createElement('div');
                        divider.className = 'grid-divider-line vertical';
                        divider.style.left = `${position}%`;
                        divider.dataset.columnIndex = i;
                        divider.dataset.direction = 'vertical';
                        grid.appendChild(divider);
                        
                        console.log(`添加垂直分割线 ${i}: ${position.toFixed(2)}%`);
                    }
                }
            }

            // 只在有多行时显示水平分割线
            if (rowCount > 1) {
                const totalHeight = gridRowsInfo.reduce((sum, val) => sum + val, 0);
                let cumulativeHeight = 0;
                
                // 只在行与行之间显示分割线，不在边缘显示
                for (let i = 1; i < rowCount; i++) {
                    cumulativeHeight += gridRowsInfo[i - 1];
                    const position = (cumulativeHeight / totalHeight) * 100;
                    
                    // 只在合理位置显示分割线（5%-95%之间）
                    if (position > 5 && position < 95) {
                        const divider = document.createElement('div');
                        divider.className = 'grid-divider-line horizontal';
                        divider.style.top = `${position}%`;
                        divider.dataset.rowIndex = i;
                        divider.dataset.direction = 'horizontal';
                        grid.appendChild(divider);
                        
                        console.log(`添加水平分割线 ${i}: ${position.toFixed(2)}%`);
                    }
                }
            }

            // 标记网格显示分割线状态
            if (grid.querySelectorAll('.grid-divider-line').length > 0) {
                grid.classList.add('showing-dividers');
            }
        }
        
        // 原有的分割线逻辑作为后备方案
        function addGridDividersLegacy() {
            const grid = document.getElementById('previewGrid');
            if (!grid) return;

            // 确保网格信息已加载
            if (!gridColumnsInfo.length || !gridRowsInfo.length) {
                refreshGridInfo();
                // 延迟重试
                setTimeout(addGridDividers, 150);
                return;
            }

            const columnCount = gridColumnsInfo.length;
            const rowCount = gridRowsInfo.length;

            // 只在有多列时显示垂直分割线
            if (columnCount > 1) {
                const totalWidth = gridColumnsInfo.reduce((sum, val) => sum + val, 0);
                let cumulativeWidth = 0;
                
                // 只在列与列之间显示分割线，不在边缘显示
                for (let i = 1; i < columnCount; i++) {
                    cumulativeWidth += gridColumnsInfo[i - 1];
                    const position = (cumulativeWidth / totalWidth) * 100;
                    
                    // 只在合理位置显示分割线（5%-95%之间）
                    if (position > 5 && position < 95) {
                        const divider = document.createElement('div');
                        divider.className = 'grid-divider-line vertical';
                        divider.style.left = `${position}%`;
                        divider.dataset.columnIndex = i;
                        divider.dataset.direction = 'vertical';
                        grid.appendChild(divider);
                    }
                }
            }

            // 只在有多行时显示水平分割线
            if (rowCount > 1) {
                const totalHeight = gridRowsInfo.reduce((sum, val) => sum + val, 0);
                let cumulativeHeight = 0;
                
                // 只在行与行之间显示分割线，不在边缘显示
                for (let i = 1; i < rowCount; i++) {
                    cumulativeHeight += gridRowsInfo[i - 1];
                    const position = (cumulativeHeight / totalHeight) * 100;
                    
                    // 只在合理位置显示分割线（5%-95%之间）
                    if (position > 5 && position < 95) {
                        const divider = document.createElement('div');
                        divider.className = 'grid-divider-line horizontal';
                        divider.style.top = `${position}%`;
                        divider.dataset.rowIndex = i;
                        divider.dataset.direction = 'horizontal';
                        grid.appendChild(divider);
                    }
                }
            }

            // 标记网格显示分割线状态
            if (grid.querySelectorAll('.grid-divider-line').length > 0) {
                grid.classList.add('showing-dividers');
            }
        }


        function updatePreviewGrid() {
            const grid = document.getElementById('previewGrid');
            grid.className = `preview-grid layout-${currentLayout}`;
            
            // 如果没有手动调整，清除网格内容并重置样式
            if (!hasManualAdjustment) {
                grid.innerHTML = '';
                grid.style.gridTemplateColumns = '';
                grid.style.gridTemplateRows = '';
            } else {
                // 有手动调整时，只清除内容，保留网格样式
                grid.innerHTML = '';
                console.log('保留手动调整的网格状态');
            }

            // 所有布局都使用标准的图片数量
            const actualCount = currentCount;

            for (let i = 0; i < actualCount; i++) {
                const cell = createGridCell(i);

                // 为特殊布局添加样式
                if (currentLayout === '3-3' && i === 0) {
                    // 3-3布局：左大右小，第一个元素跨越两行
                    cell.style.gridRow = 'span 2';
                } else if (currentLayout === '3-4' && i === 1) {
                    // 3-4布局：左小右大，第二个元素（右侧大图）跨越两行并位于第2列
                    cell.style.gridRow = 'span 2';
                    cell.style.gridColumn = '2';
                } else if (currentLayout === '3-5' && i === 0) {
                    // 3-5布局：上大下小，第一个元素跨越两列
                    cell.style.gridColumn = 'span 2';
                } else if (currentLayout === '3-6' && i === 2) {
                    // 3-6布局：上小下大，第三个元素跨越两列
                    cell.style.gridColumn = 'span 2';
                } else if (currentLayout === '3-7' && i === 0) {
                    // 3-7布局：上一下二，第一个元素跨越两列
                    cell.style.gridColumn = 'span 2';
                } else if (currentLayout === '3-8' && i === 2) {
                    // 3-8布局：上二下一，第三个元素跨越两列
                    cell.style.gridColumn = 'span 2';
                } else if (currentLayout === '3-9' && i === 0) {
                    // 3-9布局：左一右二，第一个元素跨越两行
                    cell.style.gridRow = 'span 2';
                } else if (currentLayout === '3-10' && i === 1) {
                    // 3-10布局：左二右一，第二个元素（右侧大图）跨越两行并位于第2列
                    cell.style.gridRow = 'span 2';
                    cell.style.gridColumn = '2';
                } else if (currentLayout === '3-11' && i === 0) {
                    // 3-11布局：T型布局，第一个元素跨越两列
                    cell.style.gridColumn = 'span 2';
                } else if (currentLayout === '3-12' && i === 0) {
                    // 3-12布局：L型布局，第一个元素跨越两列两行
                    cell.style.gridColumn = 'span 2';
                    cell.style.gridRow = 'span 2';
                } else if (currentLayout === '4-4' && i === 0) {
                    // 4-4布局：上一下三，第一个元素跨越三列
                    cell.style.gridColumn = 'span 3';
                } else if (currentLayout === '4-5' && i === 3) {
                    // 4-5布局：上三下一，第四个元素跨越三列
                    cell.style.gridColumn = 'span 3';
                } else if (currentLayout === '4-6' && i === 0) {
                    // 4-6布局：左一右三，第一个元素跨越三行
                    cell.style.gridRow = 'span 3';
                } else if (currentLayout === '4-7' && i === 1) {
                    // 4-7布局：左三右一，第二个元素（右侧大图）跨越三行并位于第2列
                    cell.style.gridRow = 'span 3';
                    cell.style.gridColumn = '2';
                } else if (currentLayout === '4-8' && i === 0) {
                    // 4-8布局：左上大图，占据2×2格子（第1-2列，第1-2行）
                    cell.style.gridColumn = '1 / 3';
                    cell.style.gridRow = '1 / 3';
                } else if (currentLayout === '4-8' && i === 1) {
                    // 4-8布局：右上图片，占据1×2格子（第3列，第1-2行）
                    cell.style.gridColumn = '3';
                    cell.style.gridRow = '1 / 3';
                } else if (currentLayout === '4-8' && i === 2) {
                    // 4-8布局：左下图片，占据2×1格子（第1-2列，第3行）
                    cell.style.gridColumn = '1 / 3';
                    cell.style.gridRow = '3';
                } else if (currentLayout === '4-8' && i === 3) {
                    // 4-8布局：右下图片，占据1×1格子（第3列，第3行）
                    cell.style.gridColumn = '3';
                    cell.style.gridRow = '3';
                } else if (currentLayout === '4-9' && i === 0) {
                    // 4-9布局：左上图片，占据1×2格子（第1列，第1-2行）
                    cell.style.gridColumn = '1';
                    cell.style.gridRow = '1 / 3';
                } else if (currentLayout === '4-9' && i === 1) {
                    // 4-9布局：右上大图，占据2×2格子（第2-3列，第1-2行）
                    cell.style.gridColumn = '2 / 4';
                    cell.style.gridRow = '1 / 3';
                } else if (currentLayout === '4-9' && i === 2) {
                    // 4-9布局：左下图片，占据1×1格子（第1列，第3行）
                    cell.style.gridColumn = '1';
                    cell.style.gridRow = '3';
                } else if (currentLayout === '4-9' && i === 3) {
                    // 4-9布局：右下图片，占据2×1格子（第2-3列，第3行）
                    cell.style.gridColumn = '2 / 4';
                    cell.style.gridRow = '3';
                } else if (currentLayout === '4-10' && i === 0) {
                    // 4-10布局：三行布局，第一个元素（第一行）跨越两列
                    cell.style.gridColumn = 'span 2';
                } else if (currentLayout === '4-10' && i === 3) {
                    // 4-10布局：三行布局，第四个元素（第三行）跨越两列
                    cell.style.gridColumn = 'span 2';
                } else if (currentLayout === '4-11' && i === 0) {
                    // 4-11布局：三列布局，第一个元素（左列）跨越两行
                    cell.style.gridRow = 'span 2';
                } else if (currentLayout === '4-11' && i === 2) {
                    // 4-11布局：三列布局，第三个元素（右列）跨越两行
                    cell.style.gridRow = 'span 2';
                } else if (currentLayout === '4-12' && i === 1) {
                    // 4-12布局：左右对称，第二个元素（右上大图）跨越两行
                    cell.style.gridRow = 'span 2';
                } else if (currentLayout === '4-12' && i === 2) {
                    // 4-12布局：左右对称，第三个元素（左下大图）跨越两行
                    cell.style.gridRow = 'span 2';
                } else if (currentLayout === '5-3' && i === 0) {
                    // 5-3布局的第一个元素跨越两列
                    cell.style.gridColumn = 'span 2';
                } else if (currentLayout === '5-4' && i === 0) {
                    // 5-4布局：上一下四，第一个元素跨越两列
                    cell.style.gridColumn = 'span 2';
                } else if (currentLayout === '5-5' && i === 4) {
                    // 5-5布局：上四下一，第五个元素跨越两列
                    cell.style.gridColumn = 'span 2';
                } else if (currentLayout === '5-6' && i === 0) {
                    // 5-6布局：左一右四，第一个元素跨越两行
                    cell.style.gridRow = 'span 2';
                } else if (currentLayout === '5-7' && i === 0) {
                    // 5-7布局：四图一中九宫格，第一个元素（上图）跨第1-2列，第1行
                    cell.style.gridColumn = '1 / 3';
                    cell.style.gridRow = '1';
                } else if (currentLayout === '5-7' && i === 1) {
                    // 5-7布局：四图一中九宫格，第二个元素（右图）跨第1-2行，第3列
                    cell.style.gridColumn = '3';
                    cell.style.gridRow = '1 / 3';
                } else if (currentLayout === '5-7' && i === 2) {
                    // 5-7布局：四图一中九宫格，第三个元素（中心图）第2行第2列
                    cell.style.gridColumn = '2';
                    cell.style.gridRow = '2';
                } else if (currentLayout === '5-7' && i === 3) {
                    // 5-7布局：四图一中九宫格，第四个元素（左图）跨第2-3行，第1列
                    cell.style.gridColumn = '1';
                    cell.style.gridRow = '2 / 4';
                } else if (currentLayout === '5-7' && i === 4) {
                    // 5-7布局：四图一中九宫格，第五个元素（下图）跨第2-3列，第3行
                    cell.style.gridColumn = '2 / 4';
                    cell.style.gridRow = '3';
                } else if (currentLayout === '5-8' && i === 0) {
                    // 5-8布局：大图加四九宫格，第一个元素（左上小图）第1行第1列
                    cell.style.gridColumn = '1';
                    cell.style.gridRow = '1';
                } else if (currentLayout === '5-8' && i === 1) {
                    // 5-8布局：大图加四九宫格，第二个元素（左中小图）第2行第1列
                    cell.style.gridColumn = '1';
                    cell.style.gridRow = '2';
                } else if (currentLayout === '5-8' && i === 2) {
                    // 5-8布局：大图加四九宫格，第三个元素（左下小图）第3行第1列
                    cell.style.gridColumn = '1';
                    cell.style.gridRow = '3';
                } else if (currentLayout === '5-8' && i === 3) {
                    // 5-8布局：大图加四九宫格，第四个元素（上大图）跨第2-3列，第1行
                    cell.style.gridColumn = '2 / 4';
                    cell.style.gridRow = '1';
                } else if (currentLayout === '5-8' && i === 4) {
                    // 5-8布局：大图加四九宫格，第五个元素（下大图）跨第2-3列，第2-3行
                    cell.style.gridColumn = '2 / 4';
                    cell.style.gridRow = '2 / 4';
                } else if (currentLayout === '5-9' && i === 0) {
                    // 5-9布局：九宫格，第一个元素（左图）跨第1-3行，第1列
                    cell.style.gridColumn = '1';
                    cell.style.gridRow = '1 / 4';
                } else if (currentLayout === '5-9' && i === 1) {
                    // 5-9布局：九宫格，第二个元素（中上图）第1行第2列
                    cell.style.gridColumn = '2';
                    cell.style.gridRow = '1';
                } else if (currentLayout === '5-9' && i === 2) {
                    // 5-9布局：九宫格，第三个元素（中中图）第2行第2列
                    cell.style.gridColumn = '2';
                    cell.style.gridRow = '2';
                } else if (currentLayout === '5-9' && i === 3) {
                    // 5-9布局：九宫格，第四个元素（中下图）第3行第2列
                    cell.style.gridColumn = '2';
                    cell.style.gridRow = '3';
                } else if (currentLayout === '5-9' && i === 4) {
                    // 5-9布局：九宫格，第五个元素（右图）跨第1-3行，第3列
                    cell.style.gridColumn = '3';
                    cell.style.gridRow = '1 / 4';
                } else if (currentLayout === '5-10' && i === 0) {
                    // 5-10布局：上下长条，第一个元素（上图）跨第1-3列，第1行
                    cell.style.gridColumn = '1 / 4';
                    cell.style.gridRow = '1';
                } else if (currentLayout === '5-10' && i === 1) {
                    // 5-10布局：上下长条，第二个元素（中左图）第1列第2行
                    cell.style.gridColumn = '1';
                    cell.style.gridRow = '2';
                } else if (currentLayout === '5-10' && i === 2) {
                    // 5-10布局：上下长条，第三个元素（中中图）第2列第2行
                    cell.style.gridColumn = '2';
                    cell.style.gridRow = '2';
                } else if (currentLayout === '5-10' && i === 3) {
                    // 5-10布局：上下长条，第四个元素（中右图）第3列第2行
                    cell.style.gridColumn = '3';
                    cell.style.gridRow = '2';
                } else if (currentLayout === '5-10' && i === 4) {
                    // 5-10布局：上下长条，第五个元素（下图）跨第1-3列，第3行
                    cell.style.gridColumn = '1 / 4';
                    cell.style.gridRow = '3';
                } else if (currentLayout === '5-11' && i === 0) {
                    // 5-11布局：上二下三，第一个元素（上图1）跨第1-3列，第1行
                    cell.style.gridColumn = '1 / 4';
                    cell.style.gridRow = '1';
                } else if (currentLayout === '5-11' && i === 1) {
                    // 5-11布局：上二下三，第二个元素（上图2）跨第1-3列，第2行
                    cell.style.gridColumn = '1 / 4';
                    cell.style.gridRow = '2';
                } else if (currentLayout === '5-11' && i === 2) {
                    // 5-11布局：上二下三，第三个元素（下左图）第1列第3行
                    cell.style.gridColumn = '1';
                    cell.style.gridRow = '3';
                } else if (currentLayout === '5-11' && i === 3) {
                    // 5-11布局：上二下三，第四个元素（下中图）第2列第3行
                    cell.style.gridColumn = '2';
                    cell.style.gridRow = '3';
                } else if (currentLayout === '5-11' && i === 4) {
                    // 5-11布局：上二下三，第五个元素（下右图）第3列第3行
                    cell.style.gridColumn = '3';
                    cell.style.gridRow = '3';
                } else if (currentLayout === '5-12' && i === 0) {
                    // 5-12布局：左上大块，第一个元素（大图）跨第1-2列，第1-2行
                    cell.style.gridColumn = '1 / 3';
                    cell.style.gridRow = '1 / 3';
                } else if (currentLayout === '5-12' && i === 1) {
                    // 5-12布局：左上大块，第二个元素（右上图）第3列第1行
                    cell.style.gridColumn = '3';
                    cell.style.gridRow = '1';
                } else if (currentLayout === '5-12' && i === 2) {
                    // 5-12布局：左上大块，第三个元素（右中图）第3列第2行
                    cell.style.gridColumn = '3';
                    cell.style.gridRow = '2';
                } else if (currentLayout === '5-12' && i === 3) {
                    // 5-12布局：左上大块，第四个元素（下左图）第1列第3行
                    cell.style.gridColumn = '1';
                    cell.style.gridRow = '3';
                } else if (currentLayout === '5-12' && i === 4) {
                    // 5-12布局：左上大块，第五个元素（下右图）跨第2-3列第3行
                    cell.style.gridColumn = '2 / 4';
                    cell.style.gridRow = '3';
                } else if (currentLayout === '5-13' && i === 0) {
                    // 5-13布局：右上大块，第一个元素（左上图）第1列第1行
                    cell.style.gridColumn = '1';
                    cell.style.gridRow = '1';
                } else if (currentLayout === '5-13' && i === 1) {
                    // 5-13布局：右上大块，第二个元素（大图）跨第2-3列，第1-2行
                    cell.style.gridColumn = '2 / 4';
                    cell.style.gridRow = '1 / 3';
                } else if (currentLayout === '5-13' && i === 2) {
                    // 5-13布局：右上大块，第三个元素（左中图）第1列第2行
                    cell.style.gridColumn = '1';
                    cell.style.gridRow = '2';
                } else if (currentLayout === '5-13' && i === 3) {
                    // 5-13布局：右上大块，第四个元素（左下图）第1列第3行
                    cell.style.gridColumn = '1';
                    cell.style.gridRow = '3';
                } else if (currentLayout === '5-13' && i === 4) {
                    // 5-13布局：右上大块，第五个元素（下中图）跨第2-3列，第3行
                    cell.style.gridColumn = '2 / 4';
                    cell.style.gridRow = '3';
                } else if (currentLayout === '5-14' && i === 0) {
                    // 5-14布局：左下大块，第一个元素（上左图）第1列第1行
                    cell.style.gridColumn = '1';
                    cell.style.gridRow = '1';
                } else if (currentLayout === '5-14' && i === 1) {
                    // 5-14布局：左下大块，第二个元素（上中图）第2列第1行
                    cell.style.gridColumn = '2';
                    cell.style.gridRow = '1';
                } else if (currentLayout === '5-14' && i === 2) {
                    // 5-14布局：左下大块，第三个元素（上右图）第3列第1行
                    cell.style.gridColumn = '3';
                    cell.style.gridRow = '1';
                } else if (currentLayout === '5-14' && i === 3) {
                    // 5-14布局：左下大块，第四个元素（大图）跨第1-2列，第2-3行
                    cell.style.gridColumn = '1 / 3';
                    cell.style.gridRow = '2 / 4';
                } else if (currentLayout === '5-14' && i === 4) {
                    // 5-14布局：左下大块，第五个元素（右中图）跨第3列第2-3行
                    cell.style.gridColumn = '3';
                    cell.style.gridRow = '2 / 4';
                } else if (currentLayout === '5-15' && i === 0) {
                    // 5-15布局：右下大块，第一个元素（上左图）第1列第1行
                    cell.style.gridColumn = '1';
                    cell.style.gridRow = '1';
                } else if (currentLayout === '5-15' && i === 1) {
                    // 5-15布局：右下大块，第二个元素（上中图）第2列第1行
                    cell.style.gridColumn = '2';
                    cell.style.gridRow = '1';
                } else if (currentLayout === '5-15' && i === 2) {
                    // 5-15布局：右下大块，第三个元素（上右图）第3列第1行
                    cell.style.gridColumn = '3';
                    cell.style.gridRow = '1';
                } else if (currentLayout === '5-15' && i === 3) {
                    // 5-15布局：右下大块，第四个元素（左中图）跨第1列第2-3行
                    cell.style.gridColumn = '1';
                    cell.style.gridRow = '2 / 4';
                } else if (currentLayout === '5-15' && i === 4) {
                    // 5-15布局：右下大块，第五个元素（大图）跨第2-3列，第2-3行
                    cell.style.gridColumn = '2 / 4';
                    cell.style.gridRow = '2 / 4';
                } else if (currentLayout === '6-1' && i === 0) {
                    // 6-1布局：两侧整列中间分三行，第一个元素（左整列）第1列跨1-3行
                    cell.style.gridColumn = '1';
                    cell.style.gridRow = '1 / 4';
                } else if (currentLayout === '6-1' && i === 1) {
                    // 6-1布局：两侧整列中间分三行，第二个元素（中上）第2列第1行
                    cell.style.gridColumn = '2';
                    cell.style.gridRow = '1';
                } else if (currentLayout === '6-1' && i === 2) {
                    // 6-1布局：两侧整列中间分三行，第三个元素（中中）第2列第2行
                    cell.style.gridColumn = '2';
                    cell.style.gridRow = '2';
                } else if (currentLayout === '6-1' && i === 3) {
                    // 6-1布局：两侧整列中间分三行，第四个元素（中下）第2列第3行
                    cell.style.gridColumn = '2';
                    cell.style.gridRow = '3';
                } else if (currentLayout === '6-1' && i === 4) {
                    // 6-1布局：两侧整列中间分三行，第五个元素（右整列）第3列跨1-3行
                    cell.style.gridColumn = '3';
                    cell.style.gridRow = '1 / 4';
                } else if (currentLayout === '6-2' && i === 0) {
                    // 6-2布局：左竖右错，第一个元素（左竖图）第1列跨1-3行
                    cell.style.gridColumn = '1';
                    cell.style.gridRow = '1 / 4';
                    cell.setAttribute('data-debug', '6-2-0: 1, 1/4');
                } else if (currentLayout === '6-2' && i === 1) {
                    // 6-2布局：左竖右错，第二个元素（右上左图）第2列第1行
                    cell.style.gridColumn = '2';
                    cell.style.gridRow = '1';
                    cell.setAttribute('data-debug', '6-2-1: 2, 1');
                } else if (currentLayout === '6-2' && i === 2) {
                    // 6-2布局：左竖右错，第三个元素（右上右图）第3列第1行
                    cell.style.gridColumn = '3';
                    cell.style.gridRow = '1';
                    cell.setAttribute('data-debug', '6-2-2: 3, 1');
                } else if (currentLayout === '6-2' && i === 3) {
                    // 6-2布局：左竖右错，第四个元素（右中横图）跨第2-3列，第2行
                    cell.style.gridColumn = '2 / 4';
                    cell.style.gridRow = '2';
                    cell.setAttribute('data-debug', '6-2-3: 2/4, 2');
                } else if (currentLayout === '6-2' && i === 4) {
                    // 6-2布局：左竖右错，第五个元素（右下左图）第2列第3行
                    cell.style.gridColumn = '2';
                    cell.style.gridRow = '3';
                    cell.setAttribute('data-debug', '6-2-4: 2, 3');
                } else if (currentLayout === '6-2' && i === 5) {
                    // 6-2布局：左竖右错，第六个元素（右下右图）第3列第3行
                    cell.style.gridColumn = '3';
                    cell.style.gridRow = '3';
                    cell.setAttribute('data-debug', '6-2-5: 3, 3');
                } else if (currentLayout === '6-3' && i === 0) {
                    // 6-3布局：左整列中上单下双右三行，第一个元素（左整列）第1列跨1-3行
                    cell.style.gridColumn = '1';
                    cell.style.gridRow = '1 / 4';
                } else if (currentLayout === '6-3' && i === 1) {
                    // 6-3布局：左整列中上单下双右三行，第二个元素（中上）第2列第1行
                    cell.style.gridColumn = '2';
                    cell.style.gridRow = '1';
                } else if (currentLayout === '6-3' && i === 2) {
                    // 6-3布局：左整列中上单下双右三行，第三个元素（中下双）第2列第2-3行
                    cell.style.gridColumn = '2';
                    cell.style.gridRow = '2 / 4';
                } else if (currentLayout === '6-3' && i === 3) {
                    // 6-3布局：左整列中上单下双右三行，第四个元素（右上）第3列第1行
                    cell.style.gridColumn = '3';
                    cell.style.gridRow = '1';
                } else if (currentLayout === '6-3' && i === 4) {
                    // 6-3布局：左整列中上单下双右三行，第五个元素（右中）第3列第2行
                    cell.style.gridColumn = '3';
                    cell.style.gridRow = '2';
                } else if (currentLayout === '6-3' && i === 5) {
                    // 6-3布局：左整列中上单下双右三行，第六个元素（右下）第3列第3行
                    cell.style.gridColumn = '3';
                    cell.style.gridRow = '3';
                } else if (currentLayout === '6-4' && i === 0) {
                    // 6-4布局：两竖夹心，第一个元素（左上长条 2×1）第1列第1-2行
                    cell.style.gridColumn = '1';
                    cell.style.gridRow = '1 / 3';
                } else if (currentLayout === '6-4' && i === 1) {
                    // 6-4布局：两竖夹心，第二个元素（左下 1×1）第1列第3行
                    cell.style.gridColumn = '1';
                    cell.style.gridRow = '3';
                } else if (currentLayout === '6-4' && i === 2) {
                    // 6-4布局：两竖夹心，第三个元素（中上 1×1）第2列第1行
                    cell.style.gridColumn = '2';
                    cell.style.gridRow = '1';
                } else if (currentLayout === '6-4' && i === 3) {
                    // 6-4布局：两竖夹心，第四个元素（中中 1×1）第2列第2行
                    cell.style.gridColumn = '2';
                    cell.style.gridRow = '2';
                } else if (currentLayout === '6-4' && i === 4) {
                    // 6-4布局：两竖夹心，第五个元素（中下 1×1）第2列第3行
                    cell.style.gridColumn = '2';
                    cell.style.gridRow = '3';
                } else if (currentLayout === '6-4' && i === 5) {
                    // 6-4布局：两竖夹心，第六个元素（右整列 1×3）第3列跨1-3行
                    cell.style.gridColumn = '3';
                    cell.style.gridRow = '1 / 4';
                } else if (currentLayout === '6-5' && i === 0) {
                    // 6-5布局：右长左散，第一个元素（左上 1×1）第1列第1行
                    cell.style.gridColumn = '1';
                    cell.style.gridRow = '1';
                } else if (currentLayout === '6-5' && i === 1) {
                    // 6-5布局：右长左散，第二个元素（左下 2×1）第1列第2-3行
                    cell.style.gridColumn = '1';
                    cell.style.gridRow = '2 / 4';
                } else if (currentLayout === '6-5' && i === 2) {
                    // 6-5布局：右长左散，第三个元素（中上 1×1）第2列第1行
                    cell.style.gridColumn = '2';
                    cell.style.gridRow = '1';
                } else if (currentLayout === '6-5' && i === 3) {
                    // 6-5布局：右长左散，第四个元素（中中 1×1）第2列第2行
                    cell.style.gridColumn = '2';
                    cell.style.gridRow = '2';
                } else if (currentLayout === '6-5' && i === 4) {
                    // 6-5布局：右长左散，第五个元素（中下 1×1）第2列第3行
                    cell.style.gridColumn = '2';
                    cell.style.gridRow = '3';
                } else if (currentLayout === '6-5' && i === 5) {
                    // 6-5布局：右长左散，第六个元素（右整列 1×3）第3列跨1-3行
                    cell.style.gridColumn = '3';
                    cell.style.gridRow = '1 / 4';
                } else if (currentLayout === '6-6' && i === 0) {
                    // 6-6布局：左散右长，第一个元素（左上 1×1）第1列第1行
                    cell.style.gridColumn = '1';
                    cell.style.gridRow = '1';
                } else if (currentLayout === '6-6' && i === 1) {
                    // 6-6布局：左散右长，第二个元素（左中 1×1）第1列第2行
                    cell.style.gridColumn = '1';
                    cell.style.gridRow = '2';
                } else if (currentLayout === '6-6' && i === 2) {
                    // 6-6布局：左散右长，第三个元素（左下 1×1）第1列第3行
                    cell.style.gridColumn = '1';
                    cell.style.gridRow = '3';
                } else if (currentLayout === '6-6' && i === 3) {
                    // 6-6布局：左散右长，第四个元素（中上 2×1）第2列第1-2行
                    cell.style.gridColumn = '2';
                    cell.style.gridRow = '1 / 3';
                } else if (currentLayout === '6-6' && i === 4) {
                    // 6-6布局：左散右长，第五个元素（中下 1×1）第2列第3行
                    cell.style.gridColumn = '2';
                    cell.style.gridRow = '3';
                } else if (currentLayout === '6-6' && i === 5) {
                    // 6-6布局：左散右长，第六个元素（右整列 1×3）第3列跨1-3行
                    cell.style.gridColumn = '3';
                    cell.style.gridRow = '1 / 4';
                } else if (currentLayout === '6-7' && i === 0) {
                    // 6-7布局：左竖中错，第一个元素（左整列 1×3）第1列跨1-3行
                    cell.style.gridColumn = '1';
                    cell.style.gridRow = '1 / 4';
                } else if (currentLayout === '6-7' && i === 1) {
                    // 6-7布局：左竖中错，第二个元素（中上 1×1）第2列第1行
                    cell.style.gridColumn = '2';
                    cell.style.gridRow = '1';
                } else if (currentLayout === '6-7' && i === 2) {
                    // 6-7布局：左竖中错，第三个元素（中下 2×1）第2列第2-3行
                    cell.style.gridColumn = '2';
                    cell.style.gridRow = '2 / 4';
                } else if (currentLayout === '6-7' && i === 3) {
                    // 6-7布局：左竖中错，第四个元素（右上 1×1）第3列第1行
                    cell.style.gridColumn = '3';
                    cell.style.gridRow = '1';
                } else if (currentLayout === '6-7' && i === 4) {
                    // 6-7布局：左竖中错，第五个元素（右中 1×1）第3列第2行
                    cell.style.gridColumn = '3';
                    cell.style.gridRow = '2';
                } else if (currentLayout === '6-7' && i === 5) {
                    // 6-7布局：左竖中错，第六个元素（右下 1×1）第3列第3行
                    cell.style.gridColumn = '3';
                    cell.style.gridRow = '3';
                } else if (currentLayout === '6-8' && i === 0) {
                    // 6-8布局：三竖分段，第一个元素（左上 1×1）第1列第1行
                    cell.style.gridColumn = '1';
                    cell.style.gridRow = '1';
                } else if (currentLayout === '6-8' && i === 1) {
                    // 6-8布局：三竖分段，第二个元素（左下 2×1）第1列第2-3行
                    cell.style.gridColumn = '1';
                    cell.style.gridRow = '2 / 4';
                } else if (currentLayout === '6-8' && i === 2) {
                    // 6-8布局：三竖分段，第三个元素（中上 2×1）第2列第1-2行
                    cell.style.gridColumn = '2';
                    cell.style.gridRow = '1 / 3';
                } else if (currentLayout === '6-8' && i === 3) {
                    // 6-8布局：三竖分段，第四个元素（中下 1×1）第2列第3行
                    cell.style.gridColumn = '2';
                    cell.style.gridRow = '3';
                } else if (currentLayout === '6-8' && i === 4) {
                    // 6-8布局：三竖分段，第五个元素（右上 1×1）第3列第1行
                    cell.style.gridColumn = '3';
                    cell.style.gridRow = '1';
                } else if (currentLayout === '6-8' && i === 5) {
                    // 6-8布局：三竖分段，第六个元素（右下 2×1）第3列第2-3行
                    cell.style.gridColumn = '3';
                    cell.style.gridRow = '2 / 4';
                } else if (currentLayout === '6-9' && i === 0) {
                    // 6-9布局：两横四竖，第一个元素（上方横块）跨两列第1行
                    cell.style.gridColumn = '1 / 3';
                    cell.style.gridRow = '1';
                } else if (currentLayout === '6-9' && i === 1) {
                    // 6-9布局：两横四竖，第二个元素（右上）第3列第1行
                    cell.style.gridColumn = '3';
                    cell.style.gridRow = '1';
                } else if (currentLayout === '6-9' && i === 2) {
                    // 6-9布局：两横四竖，第三个元素（左中）第1列第2行
                    cell.style.gridColumn = '1';
                    cell.style.gridRow = '2';
                } else if (currentLayout === '6-9' && i === 3) {
                    // 6-9布局：两横四竖，第四个元素（中中）第2列第2行
                    cell.style.gridColumn = '2';
                    cell.style.gridRow = '2';
                } else if (currentLayout === '6-9' && i === 4) {
                    // 6-9布局：两横四竖，第五个元素（右中）第3列第2行
                    cell.style.gridColumn = '3';
                    cell.style.gridRow = '2';
                } else if (currentLayout === '6-9' && i === 5) {
                    // 6-9布局：两横四竖，第六个元素（下方横块）跨三列第3行
                    cell.style.gridColumn = '1 / 4';
                    cell.style.gridRow = '3';
                } else if (currentLayout === '6-10' && i === 0) {
                    // 6-10布局：镜像结构，第一个元素（左整列 1×3）第1列跨1-3行
                    cell.style.gridColumn = '1';
                    cell.style.gridRow = '1 / 4';
                } else if (currentLayout === '6-10' && i === 1) {
                    // 6-10布局：镜像结构，第二个元素（中上 2×1）第2列第1-2行
                    cell.style.gridColumn = '2';
                    cell.style.gridRow = '1 / 3';
                } else if (currentLayout === '6-10' && i === 2) {
                    // 6-10布局：镜像结构，第三个元素（中下 1×1）第2列第3行
                    cell.style.gridColumn = '2';
                    cell.style.gridRow = '3';
                } else if (currentLayout === '6-10' && i === 3) {
                    // 6-10布局：镜像结构，第四个元素（右上 1×1）第3列第1行
                    cell.style.gridColumn = '3';
                    cell.style.gridRow = '1';
                } else if (currentLayout === '6-10' && i === 4) {
                    // 6-10布局：镜像结构，第五个元素（右中 1×1）第3列第2行
                    cell.style.gridColumn = '3';
                    cell.style.gridRow = '2';
                } else if (currentLayout === '6-10' && i === 5) {
                    // 6-10布局：镜像结构，第六个元素（右下 1×1）第3列第3行
                    cell.style.gridColumn = '3';
                    cell.style.gridRow = '3';
                } else if (currentLayout === '6-11' && i === 0) {
                    // 6-11布局：三行两列，第一个元素（左上 1×1）第1列第1行
                    cell.style.gridColumn = '1';
                    cell.style.gridRow = '1';
                } else if (currentLayout === '6-11' && i === 1) {
                    // 6-11布局：三行两列，第二个元素（右上 1×1）第2列第1行
                    cell.style.gridColumn = '2';
                    cell.style.gridRow = '1';
                } else if (currentLayout === '6-11' && i === 2) {
                    // 6-11布局：三行两列，第三个元素（左中 1×1）第1列第2行
                    cell.style.gridColumn = '1';
                    cell.style.gridRow = '2';
                } else if (currentLayout === '6-11' && i === 3) {
                    // 6-11布局：三行两列，第四个元素（右中 1×1）第2列第2行
                    cell.style.gridColumn = '2';
                    cell.style.gridRow = '2';
                } else if (currentLayout === '6-11' && i === 4) {
                    // 6-11布局：三行两列，第五个元素（左下 1×1）第1列第3行
                    cell.style.gridColumn = '1';
                    cell.style.gridRow = '3';
                } else if (currentLayout === '6-11' && i === 5) {
                    // 6-11布局：三行两列，第六个元素（右下 1×1）第2列第3行
                    cell.style.gridColumn = '2';
                    cell.style.gridRow = '3';
                } else if (currentLayout === '6-12' && i === 0) {
                    // 6-12布局：分层组合，第一个元素（左上 2×1）第1列第1-2行
                    cell.style.gridColumn = '1';
                    cell.style.gridRow = '1 / 3';
                } else if (currentLayout === '6-12' && i === 1) {
                    // 6-12布局：分层组合，第二个元素（左下 1×1）第1列第3行
                    cell.style.gridColumn = '1';
                    cell.style.gridRow = '3';
                } else if (currentLayout === '6-12' && i === 2) {
                    // 6-12布局：分层组合，第三个元素（中上 1×1）第2列第1行
                    cell.style.gridColumn = '2';
                    cell.style.gridRow = '1';
                } else if (currentLayout === '6-12' && i === 3) {
                    // 6-12布局：分层组合，第四个元素（中中 1×1）第2列第2行
                    cell.style.gridColumn = '2';
                    cell.style.gridRow = '2';
                } else if (currentLayout === '6-12' && i === 4) {
                    // 6-12布局：分层组合，第五个元素（中下 1×1）第2列第3行
                    cell.style.gridColumn = '2';
                    cell.style.gridRow = '3';
                } else if (currentLayout === '6-12' && i === 5) {
                    // 6-12布局：分层组合，第六个元素（右整列 1×3）第3列跨1-3行
                    cell.style.gridColumn = '3';
                    cell.style.gridRow = '1 / 4';
                } else if (currentLayout === '7-1') {
                    // 7-1布局：12×12网格系统，主图9×9，右侧3图各3×4，底部3图各3×4
                    if (i === 0) {
                        // 主图：第1-9列，第1-9行
                        cell.style.gridColumn = '1 / 10';
                        cell.style.gridRow = '1 / 10';
                    } else if (i === 1) {
                        // 右上图：第10-12列，第1-4行
                        cell.style.gridColumn = '10 / 13';
                        cell.style.gridRow = '1 / 5';
                    } else if (i === 2) {
                        // 右中图：第10-12列，第5-8行
                        cell.style.gridColumn = '10 / 13';
                        cell.style.gridRow = '5 / 9';
                    } else if (i === 3) {
                        // 右下图：第10-12列，第9-12行
                        cell.style.gridColumn = '10 / 13';
                        cell.style.gridRow = '9 / 13';
                    } else if (i === 4) {
                        // 底左图：第1-3列，第10-12行
                        cell.style.gridColumn = '1 / 4';
                        cell.style.gridRow = '10 / 13';
                    } else if (i === 5) {
                        // 底中图：第4-6列，第10-12行
                        cell.style.gridColumn = '4 / 7';
                        cell.style.gridRow = '10 / 13';
                    } else if (i === 6) {
                        // 底右图：第7-9列，第10-12行
                        cell.style.gridColumn = '7 / 10';
                        cell.style.gridRow = '10 / 13';
                    }
                } else if (currentLayout === '7-2') {
                    // 7-2布局：4×3网格，顶部大图跨4列，下方第2、3行第1个图占两列
                    if (i === 0) {
                        // 顶部大图，跨4列
                        cell.style.gridColumn = '1 / 5';
                        cell.style.gridRow = '1';
                    } else if (i === 1) {
                        // 第二行第1个图，占2列
                        cell.style.gridColumn = '1 / 3';
                        cell.style.gridRow = '2';
                    } else if (i === 2) {
                        // 第二行第2个图
                        cell.style.gridColumn = '3';
                        cell.style.gridRow = '2';
                    } else if (i === 3) {
                        // 第二行第3个图
                        cell.style.gridColumn = '4';
                        cell.style.gridRow = '2';
                    } else if (i === 4) {
                        // 第三行第1个图，占2列
                        cell.style.gridColumn = '1 / 3';
                        cell.style.gridRow = '3';
                    } else if (i === 5) {
                        // 第三行第2个图
                        cell.style.gridColumn = '3';
                        cell.style.gridRow = '3';
                    } else if (i === 6) {
                        // 第三行第3个图
                        cell.style.gridColumn = '4';
                        cell.style.gridRow = '3';
                    }
                } else if (currentLayout === '7-3') {
                    // 7-3布局：4×3网格，第一行占四列，第二、三行第一、二个图占单列，第三个图占两列
                    if (i === 0) {
                        // 第一行大图，跨4列
                        cell.style.gridColumn = '1 / 5';
                        cell.style.gridRow = '1';
                    } else if (i === 1) {
                        // 第二行第1个图，占第1列
                        cell.style.gridColumn = '1';
                        cell.style.gridRow = '2';
                    } else if (i === 2) {
                        // 第二行第2个图，占第2列
                        cell.style.gridColumn = '2';
                        cell.style.gridRow = '2';
                    } else if (i === 3) {
                        // 第二行第3个图，占2列
                        cell.style.gridColumn = '3 / 5';
                        cell.style.gridRow = '2';
                    } else if (i === 4) {
                        // 第三行第1个图，占第1列
                        cell.style.gridColumn = '1';
                        cell.style.gridRow = '3';
                    } else if (i === 5) {
                        // 第三行第2个图，占第2列
                        cell.style.gridColumn = '2';
                        cell.style.gridRow = '3';
                    } else if (i === 6) {
                        // 第三行第3个图，占2列
                        cell.style.gridColumn = '3 / 5';
                        cell.style.gridRow = '3';
                    }
                } else if (currentLayout === '7-4') {
                    // 7-4布局：3×3网格，第1列占3行，第2、3列各3个图各占1行
                    if (i === 0) {
                        // 第1列大图，占3行
                        cell.style.gridColumn = '1';
                        cell.style.gridRow = '1 / 4';
                    } else if (i === 1) {
                        // 第2列第1个图
                        cell.style.gridColumn = '2';
                        cell.style.gridRow = '1';
                    } else if (i === 2) {
                        // 第2列第2个图
                        cell.style.gridColumn = '2';
                        cell.style.gridRow = '2';
                    } else if (i === 3) {
                        // 第2列第3个图
                        cell.style.gridColumn = '2';
                        cell.style.gridRow = '3';
                    } else if (i === 4) {
                        // 第3列第1个图
                        cell.style.gridColumn = '3';
                        cell.style.gridRow = '1';
                    } else if (i === 5) {
                        // 第3列第2个图
                        cell.style.gridColumn = '3';
                        cell.style.gridRow = '2';
                    } else if (i === 6) {
                        // 第3列第3个图
                        cell.style.gridColumn = '3';
                        cell.style.gridRow = '3';
                    }
                } else if (currentLayout === '7-5') {
                    // 7-5布局：3×3网格，第一行三个图，第二行一个图占三列，第三行三个图
                    if (i >= 0 && i <= 2) {
                        // 第一行三个图，各占一列
                        cell.style.gridColumn = (i + 1).toString();
                        cell.style.gridRow = '1';
                    } else if (i === 3) {
                        // 第二行一个图，占三列
                        cell.style.gridColumn = '1 / 4';
                        cell.style.gridRow = '2';
                    } else if (i >= 4 && i <= 6) {
                        // 第三行三个图，各占一列
                        cell.style.gridColumn = (i - 3).toString();
                        cell.style.gridRow = '3';
                    }
                } else if (currentLayout === '7-6') {
                    // 7-6布局：3行6列，第1行两个图形各占3列，第2行三个图形各占2列，第3行两个图形各占3列
                    if (i === 0) {
                        // 第1行第1个图形，占3列
                        cell.style.gridColumn = '1 / 4';
                        cell.style.gridRow = '1';
                    } else if (i === 1) {
                        // 第1行第2个图形，占3列
                        cell.style.gridColumn = '4 / 7';
                        cell.style.gridRow = '1';
                    } else if (i === 2) {
                        // 第2行第1个图形，占2列
                        cell.style.gridColumn = '1 / 3';
                        cell.style.gridRow = '2';
                    } else if (i === 3) {
                        // 第2行第2个图形，占2列
                        cell.style.gridColumn = '3 / 5';
                        cell.style.gridRow = '2';
                    } else if (i === 4) {
                        // 第2行第3个图形，占2列
                        cell.style.gridColumn = '5 / 7';
                        cell.style.gridRow = '2';
                    } else if (i === 5) {
                        // 第3行第1个图形，占3列
                        cell.style.gridColumn = '1 / 4';
                        cell.style.gridRow = '3';
                    } else if (i === 6) {
                        // 第3行第2个图形，占3列
                        cell.style.gridColumn = '4 / 7';
                        cell.style.gridRow = '3';
                    }
                } else if (currentLayout === '7-7') {
                    // 7-7布局：3×3网格，第1行1个图形占3列，第2行3个图形各占1列，第3行3个图形各占1列
                    if (i === 0) {
                        // 第1行图形，占3列
                        cell.style.gridColumn = '1 / 4';
                        cell.style.gridRow = '1';
                    } else if (i === 1) {
                        // 第2行第1个图形
                        cell.style.gridColumn = '1';
                        cell.style.gridRow = '2';
                    } else if (i === 2) {
                        // 第2行第2个图形
                        cell.style.gridColumn = '2';
                        cell.style.gridRow = '2';
                    } else if (i === 3) {
                        // 第2行第3个图形
                        cell.style.gridColumn = '3';
                        cell.style.gridRow = '2';
                    } else if (i === 4) {
                        // 第3行第1个图形
                        cell.style.gridColumn = '1';
                        cell.style.gridRow = '3';
                    } else if (i === 5) {
                        // 第3行第2个图形
                        cell.style.gridColumn = '2';
                        cell.style.gridRow = '3';
                    } else if (i === 6) {
                        // 第3行第3个图形
                        cell.style.gridColumn = '3';
                        cell.style.gridRow = '3';
                    }
                } else if (currentLayout === '7-8') {
                    // 7-8布局：4×3网格，第1行3个图形各占1列，第2行2个图形(第1个占2列3行，第2个占1列1行)，第3行第3列1图，第4行第2列1图
                    if (i === 0) {
                        // 第1行第1列
                        cell.style.gridColumn = '1';
                        cell.style.gridRow = '1';
                    } else if (i === 1) {
                        // 第1行第2列
                        cell.style.gridColumn = '2';
                        cell.style.gridRow = '1';
                    } else if (i === 2) {
                        // 第1行第3列
                        cell.style.gridColumn = '3';
                        cell.style.gridRow = '1';
                    } else if (i === 3) {
                        // 第2行第1-2列，占2列3行
                        cell.style.gridColumn = '1 / 3';
                        cell.style.gridRow = '2 / 5';
                    } else if (i === 4) {
                        // 第2行第3列
                        cell.style.gridColumn = '3';
                        cell.style.gridRow = '2';
                    } else if (i === 5) {
                        // 第3行第3列
                        cell.style.gridColumn = '3';
                        cell.style.gridRow = '3';
                    } else if (i === 6) {
                        // 第4行第3列
                        cell.style.gridColumn = '3';
                        cell.style.gridRow = '4';
                    }
                } else if (currentLayout === '7-9') {
                    // 7-9布局：3×4网格，第1行4个图形各占1列，第2行2个图形(第1个占1行，第2个占3列2行)，第3行第1列1图
                    if (i === 0) {
                        // 第1行第1列
                        cell.style.gridColumn = '1';
                        cell.style.gridRow = '1';
                    } else if (i === 1) {
                        // 第1行第2列
                        cell.style.gridColumn = '2';
                        cell.style.gridRow = '1';
                    } else if (i === 2) {
                        // 第1行第3列
                        cell.style.gridColumn = '3';
                        cell.style.gridRow = '1';
                    } else if (i === 3) {
                        // 第1行第4列
                        cell.style.gridColumn = '4';
                        cell.style.gridRow = '1';
                    } else if (i === 4) {
                        // 第2行第1列
                        cell.style.gridColumn = '1';
                        cell.style.gridRow = '2';
                    } else if (i === 5) {
                        // 第2行第2-4列，占3列2行
                        cell.style.gridColumn = '2 / 5';
                        cell.style.gridRow = '2 / 4';
                    } else if (i === 6) {
                        // 第3行第1列
                        cell.style.gridColumn = '1';
                        cell.style.gridRow = '3';
                    }
                } else if (currentLayout === '7-10') {
                    // 7-10布局：4行5列，第1行第1列占4列2行，第5列4个图形各占一行，第3行第1列和第3列各占2列2行
                    if (i === 0) {
                        // 第1个图形：占4列2行
                        cell.style.gridColumn = '1 / 5';
                        cell.style.gridRow = '1 / 3';
                    } else if (i === 1) {
                        // 第2个图形：第5列第1行
                        cell.style.gridColumn = '5';
                        cell.style.gridRow = '1';
                    } else if (i === 2) {
                        // 第3个图形：第5列第2行
                        cell.style.gridColumn = '5';
                        cell.style.gridRow = '2';
                    } else if (i === 3) {
                        // 第4个图形：第5列第3行
                        cell.style.gridColumn = '5';
                        cell.style.gridRow = '3';
                    } else if (i === 4) {
                        // 第5个图形：第5列第4行
                        cell.style.gridColumn = '5';
                        cell.style.gridRow = '4';
                    } else if (i === 5) {
                        // 第6个图形：第3行第1列，占2列2行
                        cell.style.gridColumn = '1 / 3';
                        cell.style.gridRow = '3 / 5';
                    } else if (i === 6) {
                        // 第7个图形：第3行第3列，占2列2行
                        cell.style.gridColumn = '3 / 5';
                        cell.style.gridRow = '3 / 5';
                    }
                } else if (currentLayout === '7-11') {
                    // 7-11布局：4行4列，第1行第1列和第3列各占2列2行，第3行第1列占2列2行，第3行第3列和第4列各占1列1行，第4行第3列和第4列各占1列1行
                    if (i === 0) {
                        // 第1行第1列图形，占2列2行
                        cell.style.gridColumn = '1 / 3';
                        cell.style.gridRow = '1 / 3';
                    } else if (i === 1) {
                        // 第1行第3列图形，占2列2行
                        cell.style.gridColumn = '3 / 5';
                        cell.style.gridRow = '1 / 3';
                    } else if (i === 2) {
                        // 第3行第1列图形，占2列2行
                        cell.style.gridColumn = '1 / 3';
                        cell.style.gridRow = '3 / 5';
                    } else if (i === 3) {
                        // 第3行第3列图形，占1列1行
                        cell.style.gridColumn = '3';
                        cell.style.gridRow = '3';
                    } else if (i === 4) {
                        // 第3行第4列图形，占1列1行
                        cell.style.gridColumn = '4';
                        cell.style.gridRow = '3';
                    } else if (i === 5) {
                        // 第4行第3列图形，占1列1行
                        cell.style.gridColumn = '3';
                        cell.style.gridRow = '4';
                    } else if (i === 6) {
                        // 第4行第4列图形，占1列1行
                        cell.style.gridColumn = '4';
                        cell.style.gridRow = '4';
                    }
                } else if (currentLayout === '7-12') {
                    // 7-12布局：4行4列，第1行第1列占2列2行，第1行第3列占2列1行，第2行第3列占2列1行，第3行第3列占2列1行，第4行第3列和第4列各占1列1行，第3行第1列占2列2行
                    if (i === 0) {
                        // 第1行第1列图形，占2列2行
                        cell.style.gridColumn = '1 / 3';
                        cell.style.gridRow = '1 / 3';
                    } else if (i === 1) {
                        // 第1行第3列图形，占2列1行
                        cell.style.gridColumn = '3 / 5';
                        cell.style.gridRow = '1';
                    } else if (i === 2) {
                        // 第2行第3列图形，占2列1行
                        cell.style.gridColumn = '3 / 5';
                        cell.style.gridRow = '2';
                    } else if (i === 3) {
                        // 第3行第3列图形，占2列1行
                        cell.style.gridColumn = '3 / 5';
                        cell.style.gridRow = '3';
                    } else if (i === 4) {
                        // 第4行第3列图形，占1列1行
                        cell.style.gridColumn = '3';
                        cell.style.gridRow = '4';
                    } else if (i === 5) {
                        // 第4行第4列图形，占1列1行
                        cell.style.gridColumn = '4';
                        cell.style.gridRow = '4';
                    } else if (i === 6) {
                        // 第3行第1列图形，占2列2行
                        cell.style.gridColumn = '1 / 3';
                        cell.style.gridRow = '3 / 5';
                    }
                } else if (currentLayout === '7-13') {
                    // 7-13布局：4行6列，第1行第1列和第4列各1个图形占3列2行，第3行第1列和第5列各1个图形占2列1行，第3行第3列1个图形占2列2行，第4行第1列和第5列各1个图形占2列1行
                    if (i === 0) {
                        // 第1行第1列图形，占3列2行
                        cell.style.gridColumn = '1 / 4';
                        cell.style.gridRow = '1 / 3';
                    } else if (i === 1) {
                        // 第1行第4列图形，占3列2行
                        cell.style.gridColumn = '4 / 7';
                        cell.style.gridRow = '1 / 3';
                    } else if (i === 2) {
                        // 第3行第1列图形，占2列1行
                        cell.style.gridColumn = '1 / 3';
                        cell.style.gridRow = '3';
                    } else if (i === 3) {
                        // 第3行第5列图形，占2列1行
                        cell.style.gridColumn = '5 / 7';
                        cell.style.gridRow = '3';
                    } else if (i === 4) {
                        // 第3行第3列图形，占2列2行
                        cell.style.gridColumn = '3 / 5';
                        cell.style.gridRow = '3 / 5';
                    } else if (i === 5) {
                        // 第4行第1列图形，占2列1行
                        cell.style.gridColumn = '1 / 3';
                        cell.style.gridRow = '4';
                    } else if (i === 6) {
                        // 第4行第5列图形，占2列1行
                        cell.style.gridColumn = '5 / 7';
                        cell.style.gridRow = '4';
                    }
                } else if (currentLayout === '7-14') {
                    // 7-14布局：3行3列，第1行3个图形各占1列，第2行第1个图形占2列1行第二个图形占1列1行，第3行第1个图形占2列1行第二个图形占1列1行
                    if (i === 0) {
                        // 第1行第1列图形，占1列1行
                        cell.style.gridColumn = '1';
                        cell.style.gridRow = '1';
                    } else if (i === 1) {
                        // 第1行第2列图形，占1列1行
                        cell.style.gridColumn = '2';
                        cell.style.gridRow = '1';
                    } else if (i === 2) {
                        // 第1行第3列图形，占1列1行
                        cell.style.gridColumn = '3';
                        cell.style.gridRow = '1';
                    } else if (i === 3) {
                        // 第2行第1个图形，占2列1行
                        cell.style.gridColumn = '1 / 3';
                        cell.style.gridRow = '2';
                    } else if (i === 4) {
                        // 第2行第2个图形，占1列1行
                        cell.style.gridColumn = '3';
                        cell.style.gridRow = '2';
                    } else if (i === 5) {
                        // 第3行第1个图形，占2列1行
                        cell.style.gridColumn = '1 / 3';
                        cell.style.gridRow = '3';
                    } else if (i === 6) {
                        // 第3行第2个图形，占1列1行
                        cell.style.gridColumn = '3';
                        cell.style.gridRow = '3';
                    }
                } else if (currentLayout === '7-15') {
                    // 7-15布局：3行3列，第1列3个图形各占1行，第2列3个图形各占1行，第3列1个图形占3行
                    if (i === 0) {
                        // 第1列第1行
                        cell.style.gridColumn = '1';
                        cell.style.gridRow = '1';
                    } else if (i === 1) {
                        // 第1列第2行
                        cell.style.gridColumn = '1';
                        cell.style.gridRow = '2';
                    } else if (i === 2) {
                        // 第1列第3行
                        cell.style.gridColumn = '1';
                        cell.style.gridRow = '3';
                    } else if (i === 3) {
                        // 第2列第1行
                        cell.style.gridColumn = '2';
                        cell.style.gridRow = '1';
                    } else if (i === 4) {
                        // 第2列第2行
                        cell.style.gridColumn = '2';
                        cell.style.gridRow = '2';
                    } else if (i === 5) {
                        // 第2列第3行
                        cell.style.gridColumn = '2';
                        cell.style.gridRow = '3';
                    } else if (i === 6) {
                        // 第3列，占3行
                        cell.style.gridColumn = '3';
                        cell.style.gridRow = '1 / 4';
                    }
                } else if (currentLayout === '7-16') {
                    // 7-16布局：12行12列，第1行第1列占6列4行，第5行第1列占6列4行，第9行第1列占6列4行，第7列第1行占3列3行，第7列第4行占3列3行，第10列第1行占3列6行，第7列第7行占6列6行
                    if (i === 0) {
                        // 第1行第1列图形，占6列4行
                        cell.style.gridColumn = '1 / 7';
                        cell.style.gridRow = '1 / 5';
                    } else if (i === 1) {
                        // 第5行第1列图形，占6列4行
                        cell.style.gridColumn = '1 / 7';
                        cell.style.gridRow = '5 / 9';
                    } else if (i === 2) {
                        // 第9行第1列图形，占6列4行
                        cell.style.gridColumn = '1 / 7';
                        cell.style.gridRow = '9 / 13';
                    } else if (i === 3) {
                        // 第7列第1行图形，占3列3行
                        cell.style.gridColumn = '7 / 10';
                        cell.style.gridRow = '1 / 4';
                    } else if (i === 4) {
                        // 第7列第4行图形，占3列3行
                        cell.style.gridColumn = '7 / 10';
                        cell.style.gridRow = '4 / 7';
                    } else if (i === 5) {
                        // 第10列第1行图形，占3列6行
                        cell.style.gridColumn = '10 / 13';
                        cell.style.gridRow = '1 / 7';
                    } else if (i === 6) {
                        // 第7列第7行图形，占6列6行
                        cell.style.gridColumn = '7 / 13';
                        cell.style.gridRow = '7 / 13';
                    }
                } else if (currentLayout === '7-17') {
                    // 7-17布局：12行12列，第1行第1列占6列4行，第1行第7列占6列6行，第5行第1列占3列4行，第5行第4列占3列4行，第9行第1列占3列4行，第9列第4行占3列4行，第9行第7列占6列6行
                    if (i === 0) {
                        // 第1行第1列图形，占6列4行
                        cell.style.gridColumn = '1 / 7';
                        cell.style.gridRow = '1 / 5';
                    } else if (i === 1) {
                        // 第1行第7列图形，占6列6行
                        cell.style.gridColumn = '7 / 13';
                        cell.style.gridRow = '1 / 7';
                    } else if (i === 2) {
                        // 第5行第1列图形，占3列4行
                        cell.style.gridColumn = '1 / 4';
                        cell.style.gridRow = '5 / 9';
                    } else if (i === 3) {
                        // 第5行第4列图形，占3列4行
                        cell.style.gridColumn = '4 / 7';
                        cell.style.gridRow = '5 / 9';
                    } else if (i === 4) {
                        // 第9行第1列图形，占3列4行
                        cell.style.gridColumn = '1 / 4';
                        cell.style.gridRow = '9 / 13';
                    } else if (i === 5) {
                        // 第9行第4列图形，占3列4行
                        cell.style.gridColumn = '4 / 7';
                        cell.style.gridRow = '9 / 13';
                    } else if (i === 6) {
                        // 第9行第7列图形，占6列6行
                        cell.style.gridColumn = '7 / 13';
                        cell.style.gridRow = '7 / 13';
                    }
                } else if (currentLayout === '7-18') {
                    // 7-18布局：12行12列，第1行第1列占4列3行，第4行第1列占4列3行，第1行第5列占4列6行，第1行第9列占4列6行，第7行第1列占6列6行，第7行第7列占6列3行，第10行第7列占6列3行
                    if (i === 0) {
                        // 第1行第1列图形，占4列3行
                        cell.style.gridColumn = '1 / 5';
                        cell.style.gridRow = '1 / 4';
                    } else if (i === 1) {
                        // 第4行第1列图形，占4列3行
                        cell.style.gridColumn = '1 / 5';
                        cell.style.gridRow = '4 / 7';
                    } else if (i === 2) {
                        // 第1行第5列图形，占4列6行
                        cell.style.gridColumn = '5 / 9';
                        cell.style.gridRow = '1 / 7';
                    } else if (i === 3) {
                        // 第1行第9列图形，占4列6行
                        cell.style.gridColumn = '9 / 13';
                        cell.style.gridRow = '1 / 7';
                    } else if (i === 4) {
                        // 第7行第1列图形，占6列6行
                        cell.style.gridColumn = '1 / 7';
                        cell.style.gridRow = '7 / 13';
                    } else if (i === 5) {
                        // 第7行第7列图形，占6列3行
                        cell.style.gridColumn = '7 / 13';
                        cell.style.gridRow = '7 / 10';
                    } else if (i === 6) {
                        // 第10行第7列图形，占6列3行
                        cell.style.gridColumn = '7 / 13';
                        cell.style.gridRow = '10 / 13';
                    }
                }

                // 8图布局特殊处理
                if (currentLayout === '8-4') {
                    // 8图布局第4方案：4×4网格，每行第1个图占3列，第2个图占1列
                    if (i === 0) {
                        cell.style.gridColumn = '1 / 4';
                        cell.style.gridRow = '1';
                    } else if (i === 1) {
                        cell.style.gridColumn = '4';
                        cell.style.gridRow = '1';
                    } else if (i === 2) {
                        cell.style.gridColumn = '1 / 4';
                        cell.style.gridRow = '2';
                    } else if (i === 3) {
                        cell.style.gridColumn = '4';
                        cell.style.gridRow = '2';
                    } else if (i === 4) {
                        cell.style.gridColumn = '1 / 4';
                        cell.style.gridRow = '3';
                    } else if (i === 5) {
                        cell.style.gridColumn = '4';
                        cell.style.gridRow = '3';
                    } else if (i === 6) {
                        cell.style.gridColumn = '1 / 4';
                        cell.style.gridRow = '4';
                    } else if (i === 7) {
                        cell.style.gridColumn = '4';
                        cell.style.gridRow = '4';
                    }
                } else if (currentLayout === '8-5') {
                    // 8图布局第5方案：4×4网格
                    if (i === 0) {
                        cell.style.gridColumn = '1 / 3';
                        cell.style.gridRow = '1';
                    } else if (i === 1) {
                        cell.style.gridColumn = '3';
                        cell.style.gridRow = '1 / 3';
                    } else if (i === 2) {
                        cell.style.gridColumn = '4';
                        cell.style.gridRow = '1 / 3';
                    } else if (i === 3) {
                        cell.style.gridColumn = '1 / 3';
                        cell.style.gridRow = '2';
                    } else if (i === 4) {
                        cell.style.gridColumn = '1';
                        cell.style.gridRow = '3 / -1';
                    } else if (i === 5) {
                        cell.style.gridColumn = '2';
                        cell.style.gridRow = '3 / -1';
                    } else if (i === 6) {
                        cell.style.gridColumn = '3 / 5';
                        cell.style.gridRow = '3';
                    } else if (i === 7) {
                        cell.style.gridColumn = '3 / 5';
                        cell.style.gridRow = '4';
                    }
                } else if (currentLayout === '8-6') {
                    // 8图布局第6方案：4×4网格
                    if (i === 0) {
                        cell.style.gridColumn = '1 / 4';
                        cell.style.gridRow = '1 / 4';
                    } else if (i === 1) {
                        cell.style.gridColumn = '4';
                        cell.style.gridRow = '1';
                    } else if (i === 2) {
                        cell.style.gridColumn = '4';
                        cell.style.gridRow = '2';
                    } else if (i === 3) {
                        cell.style.gridColumn = '4';
                        cell.style.gridRow = '3';
                    } else if (i === 4) {
                        cell.style.gridColumn = '4';
                        cell.style.gridRow = '4';
                    } else if (i === 5) {
                        cell.style.gridColumn = '1';
                        cell.style.gridRow = '4';
                    } else if (i === 6) {
                        cell.style.gridColumn = '2';
                        cell.style.gridRow = '4';
                    } else if (i === 7) {
                        cell.style.gridColumn = '3';
                        cell.style.gridRow = '4';
                    }
                } else if (currentLayout === '8-7') {
                    // 8图布局第7方案：4×4网格
                    if (i === 0) {
                        cell.style.gridColumn = '1';
                        cell.style.gridRow = '1';
                    } else if (i === 1) {
                        cell.style.gridColumn = '1';
                        cell.style.gridRow = '2';
                    } else if (i === 2) {
                        cell.style.gridColumn = '1';
                        cell.style.gridRow = '3';
                    } else if (i === 3) {
                        cell.style.gridColumn = '1';
                        cell.style.gridRow = '4';
                    } else if (i === 4) {
                        cell.style.gridColumn = '2 / 5';
                        cell.style.gridRow = '1 / 4';
                    } else if (i === 5) {
                        cell.style.gridColumn = '2';
                        cell.style.gridRow = '4';
                    } else if (i === 6) {
                        cell.style.gridColumn = '3';
                        cell.style.gridRow = '4';
                    } else if (i === 7) {
                        cell.style.gridColumn = '4';
                        cell.style.gridRow = '4';
                    }
                } else if (currentLayout === '8-8') {
                    // 8图布局第8方案：4×4网格
                    if (i === 0) {
                        cell.style.gridColumn = '1';
                        cell.style.gridRow = '1';
                    } else if (i === 1) {
                        cell.style.gridColumn = '2';
                        cell.style.gridRow = '1';
                    } else if (i === 2) {
                        cell.style.gridColumn = '3';
                        cell.style.gridRow = '1';
                    } else if (i === 3) {
                        cell.style.gridColumn = '4';
                        cell.style.gridRow = '1';
                    } else if (i === 4) {
                        cell.style.gridColumn = '1';
                        cell.style.gridRow = '2';
                    } else if (i === 5) {
                        cell.style.gridColumn = '1';
                        cell.style.gridRow = '3';
                    } else if (i === 6) {
                        cell.style.gridColumn = '1';
                        cell.style.gridRow = '4';
                    } else if (i === 7) {
                        cell.style.gridColumn = '2 / 5';
                        cell.style.gridRow = '2 / 5';
                    }
                } else if (currentLayout === '8-9') {
                    // 8图布局第9方案：4×4网格，交替布局
                    if (i === 0) {
                        cell.style.gridColumn = '1';
                        cell.style.gridRow = '1';
                    } else if (i === 1) {
                        cell.style.gridColumn = '2 / 5';
                        cell.style.gridRow = '1';
                    } else if (i === 2) {
                        cell.style.gridColumn = '1 / 4';
                        cell.style.gridRow = '2';
                    } else if (i === 3) {
                        cell.style.gridColumn = '4';
                        cell.style.gridRow = '2';
                    } else if (i === 4) {
                        cell.style.gridColumn = '1';
                        cell.style.gridRow = '3';
                    } else if (i === 5) {
                        cell.style.gridColumn = '2 / 5';
                        cell.style.gridRow = '3';
                    } else if (i === 6) {
                        cell.style.gridColumn = '1 / 4';
                        cell.style.gridRow = '4';
                    } else if (i === 7) {
                        cell.style.gridColumn = '4';
                        cell.style.gridRow = '4';
                    }
                } else if (currentLayout === '8-10') {
                    // 8图布局第10方案：12×12网格，复杂结构
                    if (i === 0) {
                        cell.style.gridColumn = '1 / 7';
                        cell.style.gridRow = '1 / 5';
                    } else if (i === 1) {
                        cell.style.gridColumn = '7 / 13';
                        cell.style.gridRow = '1 / 5';
                    } else if (i === 2) {
                        cell.style.gridColumn = '1 / 4';
                        cell.style.gridRow = '5 / 9';
                    } else if (i === 3) {
                        cell.style.gridColumn = '4 / 7';
                        cell.style.gridRow = '5 / 9';
                    } else if (i === 4) {
                        cell.style.gridColumn = '7 / 10';
                        cell.style.gridRow = '5 / 9';
                    } else if (i === 5) {
                        cell.style.gridColumn = '10 / 13';
                        cell.style.gridRow = '5 / 9';
                    } else if (i === 6) {
                        cell.style.gridColumn = '1 / 7';
                        cell.style.gridRow = '9 / 13';
                    } else if (i === 7) {
                        cell.style.gridColumn = '7 / 13';
                        cell.style.gridRow = '9 / 13';
                    }
                } else if (currentLayout === '8-11') {
                    // 8图布局第11方案：6×6网格
                    if (i === 0) {
                        cell.style.gridColumn = '1 / 3';
                        cell.style.gridRow = '1 / 3';
                    } else if (i === 1) {
                        cell.style.gridColumn = '3 / 5';
                        cell.style.gridRow = '1 / 3';
                    } else if (i === 2) {
                        cell.style.gridColumn = '5 / 7';
                        cell.style.gridRow = '1 / 3';
                    } else if (i === 3) {
                        cell.style.gridColumn = '1 / 4';
                        cell.style.gridRow = '3 / 5';
                    } else if (i === 4) {
                        cell.style.gridColumn = '4 / 7';
                        cell.style.gridRow = '3 / 5';
                    } else if (i === 5) {
                        cell.style.gridColumn = '1 / 3';
                        cell.style.gridRow = '5 / 7';
                    } else if (i === 6) {
                        cell.style.gridColumn = '3 / 5';
                        cell.style.gridRow = '5 / 7';
                    } else if (i === 7) {
                        cell.style.gridColumn = '5 / 7';
                        cell.style.gridRow = '5 / 7';
                    }
                } else if (currentLayout === '8-12') {
                    // 8图布局第12方案：6×6网格
                    if (i === 0) {
                        cell.style.gridColumn = '1 / 3';
                        cell.style.gridRow = '1 / 3';
                    } else if (i === 1) {
                        cell.style.gridColumn = '1 / 3';
                        cell.style.gridRow = '3 / 5';
                    } else if (i === 2) {
                        cell.style.gridColumn = '1 / 3';
                        cell.style.gridRow = '5 / 7';
                    } else if (i === 3) {
                        cell.style.gridColumn = '3 / 5';
                        cell.style.gridRow = '1 / 4';
                    } else if (i === 4) {
                        cell.style.gridColumn = '3 / 5';
                        cell.style.gridRow = '4 / 7';
                    } else if (i === 5) {
                        cell.style.gridColumn = '5 / 7';
                        cell.style.gridRow = '1 / 3';
                    } else if (i === 6) {
                        cell.style.gridColumn = '5 / 7';
                        cell.style.gridRow = '3 / 5';
                    } else if (i === 7) {
                        cell.style.gridColumn = '5 / 7';
                        cell.style.gridRow = '5 / 7';
                    }
                } else if (currentLayout === '8-13') {
                    // 8图布局第13方案：4×4网格
                    if (i === 0) {
                        cell.style.gridColumn = '1';
                        cell.style.gridRow = '1';
                    } else if (i === 1) {
                        cell.style.gridColumn = '2';
                        cell.style.gridRow = '1 / 3';
                    } else if (i === 2) {
                        cell.style.gridColumn = '3 / 5';
                        cell.style.gridRow = '1 / 3';
                    } else if (i === 3) {
                        cell.style.gridColumn = '1';
                        cell.style.gridRow = '2';
                    } else if (i === 4) {
                        cell.style.gridColumn = '1 / 3';
                        cell.style.gridRow = '3 / 5';
                    } else if (i === 5) {
                        cell.style.gridColumn = '3';
                        cell.style.gridRow = '3 / 5';
                    } else if (i === 6) {
                        cell.style.gridColumn = '4';
                        cell.style.gridRow = '3';
                    } else if (i === 7) {
                        cell.style.gridColumn = '4';
                        cell.style.gridRow = '4';
                    }
                } else if (currentLayout === '8-14') {
                    // 8图布局第14方案：4×4网格
                    if (i === 0) {
                        cell.style.gridColumn = '1';
                        cell.style.gridRow = '1 / 3';
                    } else if (i === 1) {
                        cell.style.gridColumn = '1';
                        cell.style.gridRow = '3 / 5';
                    } else if (i === 2) {
                        cell.style.gridColumn = '2';
                        cell.style.gridRow = '1 / 3';
                    } else if (i === 3) {
                        cell.style.gridColumn = '2';
                        cell.style.gridRow = '3 / 5';
                    } else if (i === 4) {
                        cell.style.gridColumn = '3 / 5';
                        cell.style.gridRow = '1';
                    } else if (i === 5) {
                        cell.style.gridColumn = '3 / 5';
                        cell.style.gridRow = '2';
                    } else if (i === 6) {
                        cell.style.gridColumn = '3 / 5';
                        cell.style.gridRow = '3';
                    } else if (i === 7) {
                        cell.style.gridColumn = '3 / 5';
                        cell.style.gridRow = '4';
                    }
                } else if (currentLayout === '8-15') {
                    // 8图布局第15方案：12×14网格
                    if (i === 0) {
                        cell.style.gridColumn = '1 / 7';
                        cell.style.gridRow = '1 / 4';
                    } else if (i === 1) {
                        cell.style.gridColumn = '7 / 13';
                        cell.style.gridRow = '1 / 4';
                    } else if (i === 2) {
                        cell.style.gridColumn = '1 / 5';
                        cell.style.gridRow = '4 / 7';
                    } else if (i === 3) {
                        cell.style.gridColumn = '5 / 9';
                        cell.style.gridRow = '4 / 7';
                    } else if (i === 4) {
                        cell.style.gridColumn = '9 / 13';
                        cell.style.gridRow = '4 / 7';
                    } else if (i === 5) {
                        cell.style.gridColumn = '1 / 7';
                        cell.style.gridRow = '7 / 10';
                    } else if (i === 6) {
                        cell.style.gridColumn = '7 / 13';
                        cell.style.gridRow = '7 / 10';
                    } else if (i === 7) {
                        cell.style.gridColumn = '1 / 13';
                        cell.style.gridRow = '10 / 15';
                    }
                } else if (currentLayout === '8-16') {
                    // 8图布局第16方案：6×6网格
                    if (i === 0) {
                        cell.style.gridColumn = '1 / 3';
                        cell.style.gridRow = '1 / 4';
                    } else if (i === 1) {
                        cell.style.gridColumn = '1 / 3';
                        cell.style.gridRow = '4 / 7';
                    } else if (i === 2) {
                        cell.style.gridColumn = '3 / 5';
                        cell.style.gridRow = '1 / 3';
                    } else if (i === 3) {
                        cell.style.gridColumn = '3 / 5';
                        cell.style.gridRow = '3 / 5';
                    } else if (i === 4) {
                        cell.style.gridColumn = '3 / 5';
                        cell.style.gridRow = '5 / 7';
                    } else if (i === 5) {
                        cell.style.gridColumn = '5 / 7';
                        cell.style.gridRow = '1 / 3';
                    } else if (i === 6) {
                        cell.style.gridColumn = '5 / 7';
                        cell.style.gridRow = '3 / 5';
                    } else if (i === 7) {
                        cell.style.gridColumn = '5 / 7';
                        cell.style.gridRow = '5 / 7';
                    }
                } else if (currentLayout === '8-17') {
                    // 8图布局第17方案：4×6网格
                    if (i === 0) {
                        cell.style.gridColumn = '1 / 3';
                        cell.style.gridRow = '1 / 3';
                    } else if (i === 1) {
                        cell.style.gridColumn = '3 / 5';
                        cell.style.gridRow = '1 / 3';
                    } else if (i === 2) {
                        cell.style.gridColumn = '1 / 3';
                        cell.style.gridRow = '3 / 5';
                    } else if (i === 3) {
                        cell.style.gridColumn = '3 / 5';
                        cell.style.gridRow = '3 / 5';
                    } else if (i === 4) {
                        cell.style.gridColumn = '1';
                        cell.style.gridRow = '5 / 7';
                    } else if (i === 5) {
                        cell.style.gridColumn = '2';
                        cell.style.gridRow = '5 / 7';
                    } else if (i === 6) {
                        cell.style.gridColumn = '3';
                        cell.style.gridRow = '5 / 7';
                    } else if (i === 7) {
                        cell.style.gridColumn = '4';
                        cell.style.gridRow = '5 / 7';
                    }
                } else if (currentLayout === '8-18') {
                    // 8图布局第18方案：4×4网格
                    if (i === 0) {
                        cell.style.gridColumn = '1 / 3';
                        cell.style.gridRow = '1';
                    } else if (i === 1) {
                        cell.style.gridColumn = '3';
                        cell.style.gridRow = '1 / 3';
                    } else if (i === 2) {
                        cell.style.gridColumn = '4';
                        cell.style.gridRow = '1 / 3';
                    } else if (i === 3) {
                        cell.style.gridColumn = '1 / 3';
                        cell.style.gridRow = '2';
                    } else if (i === 4) {
                        cell.style.gridColumn = '1';
                        cell.style.gridRow = '3 / 5';
                    } else if (i === 5) {
                        cell.style.gridColumn = '2';
                        cell.style.gridRow = '3 / 5';
                    } else if (i === 6) {
                        cell.style.gridColumn = '3 / 5';
                        cell.style.gridRow = '3';
                    } else if (i === 7) {
                        cell.style.gridColumn = '3 / 5';
                        cell.style.gridRow = '4';
                    }
                } else if (currentLayout === '8-19') {
                    // 8图布局第19方案：4×3网格
                    if (i === 0) {
                        cell.style.gridColumn = '1';
                        cell.style.gridRow = '1 / 4';
                    } else if (i === 1) {
                        cell.style.gridColumn = '2';
                        cell.style.gridRow = '1';
                    } else if (i === 2) {
                        cell.style.gridColumn = '2';
                        cell.style.gridRow = '2';
                    } else if (i === 3) {
                        cell.style.gridColumn = '2';
                        cell.style.gridRow = '3';
                    } else if (i === 4) {
                        cell.style.gridColumn = '3';
                        cell.style.gridRow = '1';
                    } else if (i === 5) {
                        cell.style.gridColumn = '3';
                        cell.style.gridRow = '2';
                    } else if (i === 6) {
                        cell.style.gridColumn = '3';
                        cell.style.gridRow = '3';
                    } else if (i === 7) {
                        cell.style.gridColumn = '4';
                        cell.style.gridRow = '1 / 4';
                    }
                } else if (currentLayout === '8-20') {
                    // 8图布局第20方案：3×4网格
                    if (i === 0) {
                        cell.style.gridColumn = '1 / 4';
                        cell.style.gridRow = '1';
                    } else if (i === 1) {
                        cell.style.gridColumn = '1';
                        cell.style.gridRow = '2';
                    } else if (i === 2) {
                        cell.style.gridColumn = '2';
                        cell.style.gridRow = '2';
                    } else if (i === 3) {
                        cell.style.gridColumn = '3';
                        cell.style.gridRow = '2';
                    } else if (i === 4) {
                        cell.style.gridColumn = '1';
                        cell.style.gridRow = '3';
                    } else if (i === 5) {
                        cell.style.gridColumn = '2';
                        cell.style.gridRow = '3';
                    } else if (i === 6) {
                        cell.style.gridColumn = '3';
                        cell.style.gridRow = '3';
                    } else if (i === 7) {
                        cell.style.gridColumn = '1 / 4';
                        cell.style.gridRow = '4';
                    }
                } else if (currentLayout === '8-21') {
                    // 8图布局第21方案：4×5网格
                    if (i === 0) {
                        cell.style.gridColumn = '1 / 3';
                        cell.style.gridRow = '1 / 3';
                    } else if (i === 1) {
                        cell.style.gridColumn = '3 / 5';
                        cell.style.gridRow = '1 / 3';
                    } else if (i === 2) {
                        cell.style.gridColumn = '1';
                        cell.style.gridRow = '3';
                    } else if (i === 3) {
                        cell.style.gridColumn = '2';
                        cell.style.gridRow = '3';
                    } else if (i === 4) {
                        cell.style.gridColumn = '3';
                        cell.style.gridRow = '3';
                    } else if (i === 5) {
                        cell.style.gridColumn = '4';
                        cell.style.gridRow = '3';
                    } else if (i === 6) {
                        cell.style.gridColumn = '1 / 3';
                        cell.style.gridRow = '4 / 6';
                    } else if (i === 7) {
                        cell.style.gridColumn = '3 / 5';
                        cell.style.gridRow = '4 / 6';
                    }
                } else if (currentLayout === '8-22') {
                    // 8图布局第22方案：5×4网格
                    if (i === 0) {
                        cell.style.gridColumn = '1 / 3';
                        cell.style.gridRow = '1 / 3';
                    } else if (i === 1) {
                        cell.style.gridColumn = '1 / 3';
                        cell.style.gridRow = '3 / 5';
                    } else if (i === 2) {
                        cell.style.gridColumn = '3';
                        cell.style.gridRow = '1';
                    } else if (i === 3) {
                        cell.style.gridColumn = '3';
                        cell.style.gridRow = '2';
                    } else if (i === 4) {
                        cell.style.gridColumn = '3';
                        cell.style.gridRow = '3';
                    } else if (i === 5) {
                        cell.style.gridColumn = '3';
                        cell.style.gridRow = '4';
                    } else if (i === 6) {
                        cell.style.gridColumn = '4 / 6';
                        cell.style.gridRow = '1 / 3';
                    } else if (i === 7) {
                        cell.style.gridColumn = '4 / 6';
                        cell.style.gridRow = '3 / 5';
                    }
                } else if (currentLayout === '9-2') {
                    // 9图布局第2方案：4×4网格
                    if (i === 0) {
                        // 第1列第1行：1个图形，占1列1行
                        cell.style.gridColumn = '1';
                        cell.style.gridRow = '1';
                    } else if (i === 1) {
                        // 第1列第2行：1个图形，占1列1行
                        cell.style.gridColumn = '1';
                        cell.style.gridRow = '2';
                    } else if (i === 2) {
                        // 第1列第3行：1个图形，占1列1行
                        cell.style.gridColumn = '1';
                        cell.style.gridRow = '3';
                    } else if (i === 3) {
                        // 第1列第4行：1个图形，占1列1行
                        cell.style.gridColumn = '1';
                        cell.style.gridRow = '4';
                    } else if (i === 4) {
                        // 第2-3列第1-4行：1个图形，占2列4行
                        cell.style.gridColumn = '2 / 4';
                        cell.style.gridRow = '1 / 5';
                    } else if (i === 5) {
                        // 第4列第1行：1个图形，占1列1行
                        cell.style.gridColumn = '4';
                        cell.style.gridRow = '1';
                    } else if (i === 6) {
                        // 第4列第2行：1个图形，占1列1行
                        cell.style.gridColumn = '4';
                        cell.style.gridRow = '2';
                    } else if (i === 7) {
                        // 第4列第3行：1个图形，占1列1行
                        cell.style.gridColumn = '4';
                        cell.style.gridRow = '3';
                    } else if (i === 8) {
                        // 第4列第4行：1个图形，占1列1行
                        cell.style.gridColumn = '4';
                        cell.style.gridRow = '4';
                    }
                } else if (currentLayout === '9-3') {
                    // 9图布局第3方案：4×4网格
                    if (i === 0) {
                        // 第1行第1列：1个图形，占1列1行
                        cell.style.gridColumn = '1';
                        cell.style.gridRow = '1';
                    } else if (i === 1) {
                        // 第1行第2列：1个图形，占1列1行
                        cell.style.gridColumn = '2';
                        cell.style.gridRow = '1';
                    } else if (i === 2) {
                        // 第1行第3列：1个图形，占1列1行
                        cell.style.gridColumn = '3';
                        cell.style.gridRow = '1';
                    } else if (i === 3) {
                        // 第1行第4列：1个图形，占1列1行
                        cell.style.gridColumn = '4';
                        cell.style.gridRow = '1';
                    } else if (i === 4) {
                        // 第2-3行第1-4列：1个图形，占4列2行
                        cell.style.gridColumn = '1 / 5';
                        cell.style.gridRow = '2 / 4';
                    } else if (i === 5) {
                        // 第4行第1列：1个图形，占1列1行
                        cell.style.gridColumn = '1';
                        cell.style.gridRow = '4';
                    } else if (i === 6) {
                        // 第4行第2列：1个图形，占1列1行
                        cell.style.gridColumn = '2';
                        cell.style.gridRow = '4';
                    } else if (i === 7) {
                        // 第4行第3列：1个图形，占1列1行
                        cell.style.gridColumn = '3';
                        cell.style.gridRow = '4';
                    } else if (i === 8) {
                        // 第4行第4列：1个图形，占1列1行
                        cell.style.gridColumn = '4';
                        cell.style.gridRow = '4';
                    }
                } else if (currentLayout === '9-4') {
                    // 9图布局第4方案：4×4网格
                    if (i === 0) {
                        // 第1行第1列：1个图形，占2列2行
                        cell.style.gridColumn = '1 / 3';
                        cell.style.gridRow = '1 / 3';
                    } else if (i === 1) {
                        // 第1行第3列：1个图形，占1列2行
                        cell.style.gridColumn = '3';
                        cell.style.gridRow = '1 / 3';
                    } else if (i === 2) {
                        // 第1行第4列：1个图形，占1列2行
                        cell.style.gridColumn = '4';
                        cell.style.gridRow = '1 / 3';
                    } else if (i === 3) {
                        // 第3行第1列：1个图形，占1列2行
                        cell.style.gridColumn = '1';
                        cell.style.gridRow = '3 / 5';
                    } else if (i === 4) {
                        // 第3行第2列：1个图形，占1列1行
                        cell.style.gridColumn = '2';
                        cell.style.gridRow = '3';
                    } else if (i === 5) {
                        // 第3行第3列：1个图形，占1列1行
                        cell.style.gridColumn = '3';
                        cell.style.gridRow = '3';
                    } else if (i === 6) {
                        // 第4行第2列：1个图形，占2列1行
                        cell.style.gridColumn = '2 / 4';
                        cell.style.gridRow = '4';
                    } else if (i === 7) {
                        // 第3行第4列：1个图形，占1列1行
                        cell.style.gridColumn = '4';
                        cell.style.gridRow = '3';
                    } else if (i === 8) {
                        // 第4行第4列：1个图形，占1列1行
                        cell.style.gridColumn = '4';
                        cell.style.gridRow = '4';
                    }
                } else if (currentLayout === '9-5') {
                    // 9图布局第5方案：4×4网格
                    if (i === 0) {
                        // 第1-2列第1-4行：1个图形，占2列4行
                        cell.style.gridColumn = '1 / 3';
                        cell.style.gridRow = '1 / 5';
                    } else if (i === 1) {
                        // 第3列第1行：1个图形，占1列1行
                        cell.style.gridColumn = '3';
                        cell.style.gridRow = '1';
                    } else if (i === 2) {
                        // 第3列第2行：1个图形，占1列1行
                        cell.style.gridColumn = '3';
                        cell.style.gridRow = '2';
                    } else if (i === 3) {
                        // 第3列第3行：1个图形，占1列1行
                        cell.style.gridColumn = '3';
                        cell.style.gridRow = '3';
                    } else if (i === 4) {
                        // 第3列第4行：1个图形，占1列1行
                        cell.style.gridColumn = '3';
                        cell.style.gridRow = '4';
                    } else if (i === 5) {
                        // 第4列第1行：1个图形，占1列1行
                        cell.style.gridColumn = '4';
                        cell.style.gridRow = '1';
                    } else if (i === 6) {
                        // 第4列第2行：1个图形，占1列1行
                        cell.style.gridColumn = '4';
                        cell.style.gridRow = '2';
                    } else if (i === 7) {
                        // 第4列第3行：1个图形，占1列1行
                        cell.style.gridColumn = '4';
                        cell.style.gridRow = '3';
                    } else if (i === 8) {
                        // 第4列第4行：1个图形，占1列1行
                        cell.style.gridColumn = '4';
                        cell.style.gridRow = '4';
                    }
                } else if (currentLayout === '9-6') {
                    // 9图布局第6方案：4×4网格
                    if (i === 0) {
                        // 第1-2行第1-4列：1个图形，占4列2行
                        cell.style.gridColumn = '1 / 5';
                        cell.style.gridRow = '1 / 3';
                    } else if (i === 1) {
                        // 第3行第1列：1个图形，占1列1行
                        cell.style.gridColumn = '1';
                        cell.style.gridRow = '3';
                    } else if (i === 2) {
                        // 第3行第2列：1个图形，占1列1行
                        cell.style.gridColumn = '2';
                        cell.style.gridRow = '3';
                    } else if (i === 3) {
                        // 第3行第3列：1个图形，占1列1行
                        cell.style.gridColumn = '3';
                        cell.style.gridRow = '3';
                    } else if (i === 4) {
                        // 第3行第4列：1个图形，占1列1行
                        cell.style.gridColumn = '4';
                        cell.style.gridRow = '3';
                    } else if (i === 5) {
                        // 第4行第1列：1个图形，占1列1行
                        cell.style.gridColumn = '1';
                        cell.style.gridRow = '4';
                    } else if (i === 6) {
                        // 第4行第2列：1个图形，占1列1行
                        cell.style.gridColumn = '2';
                        cell.style.gridRow = '4';
                    } else if (i === 7) {
                        // 第4行第3列：1个图形，占1列1行
                        cell.style.gridColumn = '3';
                        cell.style.gridRow = '4';
                    } else if (i === 8) {
                        // 第4行第4列：1个图形，占1列1行
                        cell.style.gridColumn = '4';
                        cell.style.gridRow = '4';
                    }
                } else if (currentLayout === '9-7') {
                    // 9图布局第7方案：4×5网格
                    if (i === 0) {
                        // 第1行第1-2列：1个图形，占2列1行
                        cell.style.gridColumn = '1 / 3';
                        cell.style.gridRow = '1';
                    } else if (i === 1) {
                        // 第1行第3-4列：1个图形，占2列1行
                        cell.style.gridColumn = '3 / 5';
                        cell.style.gridRow = '1';
                    } else if (i === 2) {
                        // 第2-4行第1列：1个图形，占1列3行
                        cell.style.gridColumn = '1';
                        cell.style.gridRow = '2 / 5';
                    } else if (i === 3) {
                        // 第2-4行第2-3列：1个图形，占2列3行
                        cell.style.gridColumn = '2 / 4';
                        cell.style.gridRow = '2 / 5';
                    } else if (i === 4) {
                        // 第2-4行第4列：1个图形，占1列3行
                        cell.style.gridColumn = '4';
                        cell.style.gridRow = '2 / 5';
                    } else if (i === 5) {
                        // 第5行第1列：1个图形，占1列1行
                        cell.style.gridColumn = '1';
                        cell.style.gridRow = '5';
                    } else if (i === 6) {
                        // 第5行第2列：1个图形，占1列1行
                        cell.style.gridColumn = '2';
                        cell.style.gridRow = '5';
                    } else if (i === 7) {
                        // 第5行第3列：1个图形，占1列1行
                        cell.style.gridColumn = '3';
                        cell.style.gridRow = '5';
                    } else if (i === 8) {
                        // 第5行第4列：1个图形，占1列1行
                        cell.style.gridColumn = '4';
                        cell.style.gridRow = '5';
                    }
                } else if (currentLayout === '9-8') {
                    // 9图布局第8方案：6×6网格
                    if (i === 0) {
                        // 第1行第1列：1个图形，占2列2行
                        cell.style.gridColumn = '1 / 3';
                        cell.style.gridRow = '1 / 3';
                    } else if (i === 1) {
                        // 第1行第3列：1个图形，占1列1行
                        cell.style.gridColumn = '3';
                        cell.style.gridRow = '1';
                    } else if (i === 2) {
                        // 第1行第4-6列：1个图形，占3列3行
                        cell.style.gridColumn = '4 / 7';
                        cell.style.gridRow = '1 / 4';
                    } else if (i === 3) {
                        // 第2行第3列：1个图形，占1列1行
                        cell.style.gridColumn = '3';
                        cell.style.gridRow = '2';
                    } else if (i === 4) {
                        // 第3行第1列：1个图形，占1列1行
                        cell.style.gridColumn = '1';
                        cell.style.gridRow = '3';
                    } else if (i === 5) {
                        // 第3行第2列：1个图形，占1列1行
                        cell.style.gridColumn = '2';
                        cell.style.gridRow = '3';
                    } else if (i === 6) {
                        // 第3行第3列：1个图形，占1列1行
                        cell.style.gridColumn = '3';
                        cell.style.gridRow = '3';
                    } else if (i === 7) {
                        // 第4行第1-3列：1个图形，占3列3行
                        cell.style.gridColumn = '1 / 4';
                        cell.style.gridRow = '4 / 7';
                    } else if (i === 8) {
                        // 第4行第4-6列：1个图形，占3列3行
                        cell.style.gridColumn = '4 / 7';
                        cell.style.gridRow = '4 / 7';
                    }
                } else if (currentLayout === '9-9') {
                    // 9图布局第9方案：12×12网格
                    if (i === 0) {
                        // 第1行第1列：1个图形，占3列4行
                        cell.style.gridColumn = '1 / 4';
                        cell.style.gridRow = '1 / 5';
                    } else if (i === 1) {
                        // 第1行第4列：1个图形，占3列4行
                        cell.style.gridColumn = '4 / 7';
                        cell.style.gridRow = '1 / 5';
                    } else if (i === 2) {
                        // 第1行第7列：1个图形，占3列4行
                        cell.style.gridColumn = '7 / 10';
                        cell.style.gridRow = '1 / 5';
                    } else if (i === 3) {
                        // 第1行第10列：1个图形，占3列4行
                        cell.style.gridColumn = '10 / 13';
                        cell.style.gridRow = '1 / 5';
                    } else if (i === 4) {
                        // 第5行第1列：1个图形，占3列4行
                        cell.style.gridColumn = '1 / 4';
                        cell.style.gridRow = '5 / 9';
                    } else if (i === 5) {
                        // 第5行第4列：1个图形，占3列4行
                        cell.style.gridColumn = '4 / 7';
                        cell.style.gridRow = '5 / 9';
                    } else if (i === 6) {
                        // 第5行第7列：1个图形，占3列4行
                        cell.style.gridColumn = '7 / 10';
                        cell.style.gridRow = '5 / 9';
                    } else if (i === 7) {
                        // 第5行第10列：1个图形，占3列4行
                        cell.style.gridColumn = '10 / 13';
                        cell.style.gridRow = '5 / 9';
                    } else if (i === 8) {
                        // 第9行第1列：1个图形，占12列4行
                        cell.style.gridColumn = '1 / 13';
                        cell.style.gridRow = '9 / 13';
                    }
                } else if (currentLayout === '9-10') {
                    // 9图布局第10方案：12×12网格
                    if (i === 0) {
                        // 第1行第1列：1个图形，占6列8行
                        cell.style.gridColumn = '1 / 7';
                        cell.style.gridRow = '1 / 9';
                    } else if (i === 1) {
                        // 第1行第7列：1个图形，占3列4行
                        cell.style.gridColumn = '7 / 10';
                        cell.style.gridRow = '1 / 5';
                    } else if (i === 2) {
                        // 第1行第10列：1个图形，占3列4行
                        cell.style.gridColumn = '10 / 13';
                        cell.style.gridRow = '1 / 5';
                    } else if (i === 3) {
                        // 第5行第7列：1个图形，占3列4行
                        cell.style.gridColumn = '7 / 10';
                        cell.style.gridRow = '5 / 9';
                    } else if (i === 4) {
                        // 第5行第10列：1个图形，占3列4行
                        cell.style.gridColumn = '10 / 13';
                        cell.style.gridRow = '5 / 9';
                    } else if (i === 5) {
                        // 第9行第1列：1个图形，占3列4行
                        cell.style.gridColumn = '1 / 4';
                        cell.style.gridRow = '9 / 13';
                    } else if (i === 6) {
                        // 第9行第4列：1个图形，占3列4行
                        cell.style.gridColumn = '4 / 7';
                        cell.style.gridRow = '9 / 13';
                    } else if (i === 7) {
                        // 第9行第7列：1个图形，占3列4行
                        cell.style.gridColumn = '7 / 10';
                        cell.style.gridRow = '9 / 13';
                    } else if (i === 8) {
                        // 第9行第10列：1个图形，占3列4行
                        cell.style.gridColumn = '10 / 13';
                        cell.style.gridRow = '9 / 13';
                    }
                } else if (currentLayout === '9-11') {
                    // 9图布局第11方案：12×12网格
                    if (i === 0) {
                        // 第1行第1列：1个图形，占3列4行
                        cell.style.gridColumn = '1 / 4';
                        cell.style.gridRow = '1 / 5';
                    } else if (i === 1) {
                        // 第1行第4列：1个图形，占3列4行
                        cell.style.gridColumn = '4 / 7';
                        cell.style.gridRow = '1 / 5';
                    } else if (i === 2) {
                        // 第1行第7列：1个图形，占3列4行
                        cell.style.gridColumn = '7 / 10';
                        cell.style.gridRow = '1 / 5';
                    } else if (i === 3) {
                        // 第1行第10列：1个图形，占3列4行
                        cell.style.gridColumn = '10 / 13';
                        cell.style.gridRow = '1 / 5';
                    } else if (i === 4) {
                        // 第5行第1列：1个图形，占3列4行
                        cell.style.gridColumn = '1 / 4';
                        cell.style.gridRow = '5 / 9';
                    } else if (i === 5) {
                        // 第5行第4列：1个图形，占3列4行
                        cell.style.gridColumn = '4 / 7';
                        cell.style.gridRow = '5 / 9';
                    } else if (i === 6) {
                        // 第5行第7列：1个图形，占6列8行
                        cell.style.gridColumn = '7 / 13';
                        cell.style.gridRow = '5 / 13';
                    } else if (i === 7) {
                        // 第9行第1列：1个图形，占3列4行
                        cell.style.gridColumn = '1 / 4';
                        cell.style.gridRow = '9 / 13';
                    } else if (i === 8) {
                        // 第9行第4列：1个图形，占3列4行
                        cell.style.gridColumn = '4 / 7';
                        cell.style.gridRow = '9 / 13';
                    }
                } else if (currentLayout === '9-12') {
                    // 9图布局第12方案：4×4网格
                    if (i === 0) {
                        // 第1行第1列：1个图形，占1列1行
                        cell.style.gridColumn = '1';
                        cell.style.gridRow = '1';
                    } else if (i === 1) {
                        // 第1行第2列：1个图形，占1列1行
                        cell.style.gridColumn = '2';
                        cell.style.gridRow = '1';
                    } else if (i === 2) {
                        // 第1行第3列：1个图形，占1列1行
                        cell.style.gridColumn = '3';
                        cell.style.gridRow = '1';
                    } else if (i === 3) {
                        // 第1行第4列：1个图形，占1列1行
                        cell.style.gridColumn = '4';
                        cell.style.gridRow = '1';
                    } else if (i === 4) {
                        // 第2-3行第1-4列：1个图形，占4列2行
                        cell.style.gridColumn = '1 / 5';
                        cell.style.gridRow = '2 / 4';
                    } else if (i === 5) {
                        // 第4行第1列：1个图形，占1列1行
                        cell.style.gridColumn = '1';
                        cell.style.gridRow = '4';
                    } else if (i === 6) {
                        // 第4行第2列：1个图形，占1列1行
                        cell.style.gridColumn = '2';
                        cell.style.gridRow = '4';
                    } else if (i === 7) {
                        // 第4行第3列：1个图形，占1列1行
                        cell.style.gridColumn = '3';
                        cell.style.gridRow = '4';
                    } else if (i === 8) {
                        // 第4行第4列：1个图形，占1列1行
                        cell.style.gridColumn = '4';
                        cell.style.gridRow = '4';
                    }
                } else if (currentLayout === '9-13') {
                    // 9图布局第13方案：6×6网格
                    if (i === 0) {
                        // 第1行第1列：1个图形，占3列3行
                        cell.style.gridColumn = '1 / 4';
                        cell.style.gridRow = '1 / 4';
                    } else if (i === 1) {
                        // 第1行第4列：1个图形，占3列3行
                        cell.style.gridColumn = '4 / 7';
                        cell.style.gridRow = '1 / 4';
                    } else if (i === 2) {
                        // 第4行第1列：1个图形，占3列3行
                        cell.style.gridColumn = '1 / 4';
                        cell.style.gridRow = '4 / 7';
                    } else if (i === 3) {
                        // 第4行第4列：1个图形，占2列2行
                        cell.style.gridColumn = '4 / 6';
                        cell.style.gridRow = '4 / 6';
                    } else if (i === 4) {
                        // 第4行第6列：1个图形，占1列1行
                        cell.style.gridColumn = '6';
                        cell.style.gridRow = '4';
                    } else if (i === 5) {
                        // 第5行第6列：1个图形，占1列1行
                        cell.style.gridColumn = '6';
                        cell.style.gridRow = '5';
                    } else if (i === 6) {
                        // 第6行第6列：1个图形，占1列1行
                        cell.style.gridColumn = '6';
                        cell.style.gridRow = '6';
                    } else if (i === 7) {
                        // 第6行第4列：1个图形，占1列1行
                        cell.style.gridColumn = '4';
                        cell.style.gridRow = '6';
                    } else if (i === 8) {
                        // 第6行第5列：1个图形，占1列1行
                        cell.style.gridColumn = '5';
                        cell.style.gridRow = '6';
                    }
                } else if (currentLayout === '9-14') {
                    // 9图布局第14方案：6×6网格
                    if (i === 0) {
                        // 第1列第1行：1个图形，占3列3行
                        cell.style.gridColumn = '1 / 4';
                        cell.style.gridRow = '1 / 4';
                    } else if (i === 1) {
                        // 第1列第4行：1个图形，占3列3行
                        cell.style.gridColumn = '1 / 4';
                        cell.style.gridRow = '4 / 7';
                    } else if (i === 2) {
                        // 第1行第4列：1个图形，占2列2行
                        cell.style.gridColumn = '4 / 6';
                        cell.style.gridRow = '1 / 3';
                    } else if (i === 3) {
                        // 第3行第4列：1个图形，占1列1行
                        cell.style.gridColumn = '4';
                        cell.style.gridRow = '3';
                    } else if (i === 4) {
                        // 第3行第5列：1个图形，占1列1行
                        cell.style.gridColumn = '5';
                        cell.style.gridRow = '3';
                    } else if (i === 5) {
                        // 第3行第6列：1个图形，占1列1行
                        cell.style.gridColumn = '6';
                        cell.style.gridRow = '3';
                    } else if (i === 6) {
                        // 第6列第1行：1个图形，占1列1行
                        cell.style.gridColumn = '6';
                        cell.style.gridRow = '1';
                    } else if (i === 7) {
                        // 第6列第2行：1个图形，占1列1行
                        cell.style.gridColumn = '6';
                        cell.style.gridRow = '2';
                    } else if (i === 8) {
                        // 第4行第4列：1个图形，占3列3行
                        cell.style.gridColumn = '4 / 7';
                        cell.style.gridRow = '4 / 7';
                    }
                } else if (currentLayout === '9-15') {
                    // 9图布局第15方案：6×6网格
                    if (i === 0) {
                        // 第1行第1列：1个图形，占3列3行
                        cell.style.gridColumn = '1 / 4';
                        cell.style.gridRow = '1 / 4';
                    } else if (i === 1) {
                        // 第1行第4列：1个图形，占3列3行
                        cell.style.gridColumn = '4 / 7';
                        cell.style.gridRow = '1 / 4';
                    } else if (i === 2) {
                        // 第4行第1列：1个图形，占2列2行
                        cell.style.gridColumn = '1 / 3';
                        cell.style.gridRow = '4 / 6';
                    } else if (i === 3) {
                        // 第4行第3列：1个图形，占1列1行
                        cell.style.gridColumn = '3';
                        cell.style.gridRow = '4';
                    } else if (i === 4) {
                        // 第5行第3列：1个图形，占1列1行
                        cell.style.gridColumn = '3';
                        cell.style.gridRow = '5';
                    } else if (i === 5) {
                        // 第6行第3列：1个图形，占1列1行
                        cell.style.gridColumn = '3';
                        cell.style.gridRow = '6';
                    } else if (i === 6) {
                        // 第6行第1列：1个图形，占1列1行
                        cell.style.gridColumn = '1';
                        cell.style.gridRow = '6';
                    } else if (i === 7) {
                        // 第6行第2列：1个图形，占1列1行
                        cell.style.gridColumn = '2';
                        cell.style.gridRow = '6';
                    } else if (i === 8) {
                        // 第4行第4列：1个图形，占3列3行
                        cell.style.gridColumn = '4 / 7';
                        cell.style.gridRow = '4 / 7';
                    }
                } else if (currentLayout === '10-1') {
                    // 10图布局第1方案：5×5网格
                    if (i === 0) {
                        // 图1：占4列4行
                        cell.style.gridColumn = '1 / 5';
                        cell.style.gridRow = '1 / 5';
                    } else if (i === 1) {
                        // 图2：第5列第1行
                        cell.style.gridColumn = '5';
                        cell.style.gridRow = '1';
                    } else if (i === 2) {
                        // 图3：第5列第2行
                        cell.style.gridColumn = '5';
                        cell.style.gridRow = '2';
                    } else if (i === 3) {
                        // 图4：第5列第3行
                        cell.style.gridColumn = '5';
                        cell.style.gridRow = '3';
                    } else if (i === 4) {
                        // 图5：第5列第4行
                        cell.style.gridColumn = '5';
                        cell.style.gridRow = '4';
                    } else if (i === 5) {
                        // 图6：第5行第1列
                        cell.style.gridColumn = '1';
                        cell.style.gridRow = '5';
                    } else if (i === 6) {
                        // 图7：第5行第2列
                        cell.style.gridColumn = '2';
                        cell.style.gridRow = '5';
                    } else if (i === 7) {
                        // 图8：第5行第3列
                        cell.style.gridColumn = '3';
                        cell.style.gridRow = '5';
                    } else if (i === 8) {
                        // 图9：第5行第4列
                        cell.style.gridColumn = '4';
                        cell.style.gridRow = '5';
                    } else if (i === 9) {
                        // 图10：第5行第5列
                        cell.style.gridColumn = '5';
                        cell.style.gridRow = '5';
                    }
                } else if (currentLayout === '10-2') {
                    // 10图布局第2方案：12×12网格
                    if (i === 0) {
                        // 图1：第1行，占3行12列
                        cell.style.gridColumn = '1 / 13';
                        cell.style.gridRow = '1 / 4';
                    } else if (i === 1) {
                        // 图2：第4行第1列，占3行4列
                        cell.style.gridColumn = '1 / 5';
                        cell.style.gridRow = '4 / 7';
                    } else if (i === 2) {
                        // 图3：第4行第5列，占3行4列
                        cell.style.gridColumn = '5 / 9';
                        cell.style.gridRow = '4 / 7';
                    } else if (i === 3) {
                        // 图4：第4行第9列，占3行4列
                        cell.style.gridColumn = '9 / 13';
                        cell.style.gridRow = '4 / 7';
                    } else if (i === 4) {
                        // 图5：第7行第1列，占3行4列
                        cell.style.gridColumn = '1 / 5';
                        cell.style.gridRow = '7 / 10';
                    } else if (i === 5) {
                        // 图6：第7行第5列，占3行4列
                        cell.style.gridColumn = '5 / 9';
                        cell.style.gridRow = '7 / 10';
                    } else if (i === 6) {
                        // 图7：第7行第9列，占3行4列
                        cell.style.gridColumn = '9 / 13';
                        cell.style.gridRow = '7 / 10';
                    } else if (i === 7) {
                        // 图8：第10行第1列，占3行4列
                        cell.style.gridColumn = '1 / 5';
                        cell.style.gridRow = '10 / 13';
                    } else if (i === 8) {
                        // 图9：第10行第5列，占3行4列
                        cell.style.gridColumn = '5 / 9';
                        cell.style.gridRow = '10 / 13';
                    } else if (i === 9) {
                        // 图10：第10行第9列，占3行4列
                        cell.style.gridColumn = '9 / 13';
                        cell.style.gridRow = '10 / 13';
                    }
                } else if (currentLayout === '10-3') {
                    // 10图布局第3方案：12×12网格
                    if (i === 0) {
                        // 图1：第1列，占3列12行
                        cell.style.gridColumn = '1 / 4';
                        cell.style.gridRow = '1 / 13';
                    } else if (i === 1) {
                        // 图2：第4列，占3列4行
                        cell.style.gridColumn = '4 / 7';
                        cell.style.gridRow = '1 / 5';
                    } else if (i === 2) {
                        // 图3：第4列，占3列4行
                        cell.style.gridColumn = '4 / 7';
                        cell.style.gridRow = '5 / 9';
                    } else if (i === 3) {
                        // 图4：第4列，占3列4行
                        cell.style.gridColumn = '4 / 7';
                        cell.style.gridRow = '9 / 13';
                    } else if (i === 4) {
                        // 图5：第7列，占3列4行
                        cell.style.gridColumn = '7 / 10';
                        cell.style.gridRow = '1 / 5';
                    } else if (i === 5) {
                        // 图6：第7列，占3列4行
                        cell.style.gridColumn = '7 / 10';
                        cell.style.gridRow = '5 / 9';
                    } else if (i === 6) {
                        // 图7：第7列，占3列4行
                        cell.style.gridColumn = '7 / 10';
                        cell.style.gridRow = '9 / 13';
                    } else if (i === 7) {
                        // 图8：第10列，占3列4行
                        cell.style.gridColumn = '10 / 13';
                        cell.style.gridRow = '1 / 5';
                    } else if (i === 8) {
                        // 图9：第10列，占3列4行
                        cell.style.gridColumn = '10 / 13';
                        cell.style.gridRow = '5 / 9';
                    } else if (i === 9) {
                        // 图10：第10列，占3列4行
                        cell.style.gridColumn = '10 / 13';
                        cell.style.gridRow = '9 / 13';
                    }
                } else if (currentLayout === '10-4') {
                    // 10图布局第4方案：4×4网格
                    if (i === 0) {
                        // 图1：第1行第1列，占2列2行
                        cell.style.gridColumn = '1 / 3';
                        cell.style.gridRow = '1 / 3';
                    } else if (i === 1) {
                        // 图2：第1行第3列，占1列1行
                        cell.style.gridColumn = '3';
                        cell.style.gridRow = '1';
                    } else if (i === 2) {
                        // 图3：第1行第4列，占1列1行
                        cell.style.gridColumn = '4';
                        cell.style.gridRow = '1';
                    } else if (i === 3) {
                        // 图4：第2行第3列，占1列1行
                        cell.style.gridColumn = '3';
                        cell.style.gridRow = '2';
                    } else if (i === 4) {
                        // 图5：第2行第4列，占1列1行
                        cell.style.gridColumn = '4';
                        cell.style.gridRow = '2';
                    } else if (i === 5) {
                        // 图6：第3行第1列，占1列1行
                        cell.style.gridColumn = '1';
                        cell.style.gridRow = '3';
                    } else if (i === 6) {
                        // 图7：第3行第2列，占1列1行
                        cell.style.gridColumn = '2';
                        cell.style.gridRow = '3';
                    } else if (i === 7) {
                        // 图8：第3行第3列，占2列2行
                        cell.style.gridColumn = '3 / 5';
                        cell.style.gridRow = '3 / 5';
                    } else if (i === 8) {
                        // 图9：第4行第1列，占1列1行
                        cell.style.gridColumn = '1';
                        cell.style.gridRow = '4';
                    } else if (i === 9) {
                        // 图10：第4行第2列，占1列1行
                        cell.style.gridColumn = '2';
                        cell.style.gridRow = '4';
                    }
                } else if (currentLayout === '10-5') {
                    // 10图布局第5方案：8×8网格
                    if (i === 0) {
                        // 第1列第1行：1个图形，占4列4行
                        cell.style.gridColumn = '1 / 5';
                        cell.style.gridRow = '1 / 5';
                    } else if (i === 1) {
                        // 第1列第5行：1个图形，占4列4行
                        cell.style.gridColumn = '1 / 5';
                        cell.style.gridRow = '5 / 9';
                    } else if (i === 2) {
                        // 第1行第5列：1个图形，占2列2行
                        cell.style.gridColumn = '5 / 7';
                        cell.style.gridRow = '1 / 3';
                    } else if (i === 3) {
                        // 第1行第7列：1个图形，占2列2行
                        cell.style.gridColumn = '7 / 9';
                        cell.style.gridRow = '1 / 3';
                    } else if (i === 4) {
                        // 第5列第3行：1个图形，占4列4行
                        cell.style.gridColumn = '5 / 9';
                        cell.style.gridRow = '3 / 7';
                    } else if (i === 5) {
                        // 第5列第7行：1个图形，占1列1行
                        cell.style.gridColumn = '5';
                        cell.style.gridRow = '7';
                    } else if (i === 6) {
                        // 第6列第7行：1个图形，占1列1行
                        cell.style.gridColumn = '6';
                        cell.style.gridRow = '7';
                    } else if (i === 7) {
                        // 第7列第7行：1个图形，占1列1行
                        cell.style.gridColumn = '7';
                        cell.style.gridRow = '7';
                    } else if (i === 8) {
                        // 第8列第7行：1个图形，占1列1行
                        cell.style.gridColumn = '8';
                        cell.style.gridRow = '7';
                    } else if (i === 9) {
                        // 第5列第8行：1个图形，占4列1行
                        cell.style.gridColumn = '5 / 9';
                        cell.style.gridRow = '8';
                    }
                } else if (currentLayout === '10-6') {
                    // 10图布局第6方案：4×4网格
                    if (i === 0) {
                        // 第1行第1列：1个图形，占1列1行
                        cell.style.gridColumn = '1';
                        cell.style.gridRow = '1';
                    } else if (i === 1) {
                        // 第1行第2列：1个图形，占1列1行
                        cell.style.gridColumn = '2';
                        cell.style.gridRow = '1';
                    } else if (i === 2) {
                        // 第1行第3列：1个图形，占1列1行
                        cell.style.gridColumn = '3';
                        cell.style.gridRow = '1';
                    } else if (i === 3) {
                        // 第1行第4列：1个图形，占1列1行
                        cell.style.gridColumn = '4';
                        cell.style.gridRow = '1';
                    } else if (i === 4) {
                        // 第2行第1列：1个图形，占2列2行
                        cell.style.gridColumn = '1 / 3';
                        cell.style.gridRow = '2 / 4';
                    } else if (i === 5) {
                        // 第2行第3列：1个图形，占2列2行
                        cell.style.gridColumn = '3 / 5';
                        cell.style.gridRow = '2 / 4';
                    } else if (i === 6) {
                        // 第4行第1列：1个图形，占1列1行
                        cell.style.gridColumn = '1';
                        cell.style.gridRow = '4';
                    } else if (i === 7) {
                        // 第4行第2列：1个图形，占1列1行
                        cell.style.gridColumn = '2';
                        cell.style.gridRow = '4';
                    } else if (i === 8) {
                        // 第4行第3列：1个图形，占1列1行
                        cell.style.gridColumn = '3';
                        cell.style.gridRow = '4';
                    } else if (i === 9) {
                        // 第4行第4列：1个图形，占1列1行
                        cell.style.gridColumn = '4';
                        cell.style.gridRow = '4';
                    }
                } else if (currentLayout === '10-7') {
                    // 10图布局第7方案：6×6网格
                    if (i === 0) {
                        // 图1：第1行第1列，占2列2行
                        cell.style.gridColumn = '1 / 3';
                        cell.style.gridRow = '1 / 3';
                    } else if (i === 1) {
                        // 图2：第1行第3列，占2列2行
                        cell.style.gridColumn = '3 / 5';
                        cell.style.gridRow = '1 / 3';
                    } else if (i === 2) {
                        // 图3：第1行第5列，占2列2行
                        cell.style.gridColumn = '5 / 7';
                        cell.style.gridRow = '1 / 3';
                    } else if (i === 3) {
                        // 图4：第3行第1列，占2列2行
                        cell.style.gridColumn = '1 / 3';
                        cell.style.gridRow = '3 / 5';
                    } else if (i === 4) {
                        // 图5：第3行第3列，占2列1行
                        cell.style.gridColumn = '3 / 5';
                        cell.style.gridRow = '3';
                    } else if (i === 5) {
                        // 图6：第3行第5列，占2列2行
                        cell.style.gridColumn = '5 / 7';
                        cell.style.gridRow = '3 / 5';
                    } else if (i === 6) {
                        // 图7：第4行第3列，占2列1行
                        cell.style.gridColumn = '3 / 5';
                        cell.style.gridRow = '4';
                    } else if (i === 7) {
                        // 图8：第5行第1列，占2列2行
                        cell.style.gridColumn = '1 / 3';
                        cell.style.gridRow = '5 / 7';
                    } else if (i === 8) {
                        // 图9：第5行第3列，占2列2行
                        cell.style.gridColumn = '3 / 5';
                        cell.style.gridRow = '5 / 7';
                    } else if (i === 9) {
                        // 图10：第5行第5列，占2列2行
                        cell.style.gridColumn = '5 / 7';
                        cell.style.gridRow = '5 / 7';
                    }
                } else if (currentLayout === '10-8') {
                    // 10图布局第8方案：12×12网格
                    if (i === 0) {
                        // 图1：第1行第1列，占3行4列
                        cell.style.gridColumn = '1 / 5';
                        cell.style.gridRow = '1 / 4';
                    } else if (i === 1) {
                        // 图2：第1行第5列，占3行4列
                        cell.style.gridColumn = '5 / 9';
                        cell.style.gridRow = '1 / 4';
                    } else if (i === 2) {
                        // 图3：第1行第9列，占3行4列
                        cell.style.gridColumn = '9 / 13';
                        cell.style.gridRow = '1 / 4';
                    } else if (i === 3) {
                        // 图4：第4行第1列，占6行3列
                        cell.style.gridColumn = '1 / 4';
                        cell.style.gridRow = '4 / 10';
                    } else if (i === 4) {
                        // 图5：第4行第4列，占6行3列
                        cell.style.gridColumn = '4 / 7';
                        cell.style.gridRow = '4 / 10';
                    } else if (i === 5) {
                        // 图6：第4行第7列，占6行3列
                        cell.style.gridColumn = '7 / 10';
                        cell.style.gridRow = '4 / 10';
                    } else if (i === 6) {
                        // 图7：第4行第10列，占6行3列
                        cell.style.gridColumn = '10 / 13';
                        cell.style.gridRow = '4 / 10';
                    } else if (i === 7) {
                        // 图8：第10行第1列，占3行4列
                        cell.style.gridColumn = '1 / 5';
                        cell.style.gridRow = '10 / 13';
                    } else if (i === 8) {
                        // 图9：第10行第5列，占3行4列
                        cell.style.gridColumn = '5 / 9';
                        cell.style.gridRow = '10 / 13';
                    } else if (i === 9) {
                        // 图10：第10行第9列，占3行4列
                        cell.style.gridColumn = '9 / 13';
                        cell.style.gridRow = '10 / 13';
                    }
                } else if (currentLayout === '10-9') {
                    // 10图布局第9方案：4×4网格
                    if (i === 0) {
                        // 图1：第1行第1列，占1列1行
                        cell.style.gridColumn = '1';
                        cell.style.gridRow = '1';
                    } else if (i === 1) {
                        // 图2：第1行第2列，占1列1行
                        cell.style.gridColumn = '2';
                        cell.style.gridRow = '1';
                    } else if (i === 2) {
                        // 图3：第1行第3列，占1列1行
                        cell.style.gridColumn = '3';
                        cell.style.gridRow = '1';
                    } else if (i === 3) {
                        // 图4：第1行第4列，占2行1列
                        cell.style.gridColumn = '4';
                        cell.style.gridRow = '1 / 3';
                    } else if (i === 4) {
                        // 图5：第2行第1列，占1列1行
                        cell.style.gridColumn = '1';
                        cell.style.gridRow = '2';
                    } else if (i === 5) {
                        // 图6：第2行第2列，占1列1行
                        cell.style.gridColumn = '2';
                        cell.style.gridRow = '2';
                    } else if (i === 6) {
                        // 图7：第2行第3列，占1列1行
                        cell.style.gridColumn = '3';
                        cell.style.gridRow = '2';
                    } else if (i === 7) {
                        // 图8：第3行第1列，占2行2列
                        cell.style.gridColumn = '1 / 3';
                        cell.style.gridRow = '3 / 5';
                    } else if (i === 8) {
                        // 图9：第3行第3列，占1行2列
                        cell.style.gridColumn = '3 / 5';
                        cell.style.gridRow = '3';
                    } else if (i === 9) {
                        // 图10：第4行第3列，占1行2列
                        cell.style.gridColumn = '3 / 5';
                        cell.style.gridRow = '4';
                    }
                } else if (currentLayout === '10-10') {
                    // 10图布局第10方案：12×12网格
                    if (i === 0) {
                        // 图1：第1行第1列，占4行6列
                        cell.style.gridColumn = '1 / 7';
                        cell.style.gridRow = '1 / 5';
                    } else if (i === 1) {
                        // 图2：第1行第7列，占4行6列
                        cell.style.gridColumn = '7 / 13';
                        cell.style.gridRow = '1 / 5';
                    } else if (i === 2) {
                        // 图3：第5行第1列，占4行3列
                        cell.style.gridColumn = '1 / 4';
                        cell.style.gridRow = '5 / 9';
                    } else if (i === 3) {
                        // 图4：第5行第4列，占4行3列
                        cell.style.gridColumn = '4 / 7';
                        cell.style.gridRow = '5 / 9';
                    } else if (i === 4) {
                        // 图5：第5行第7列，占4行3列
                        cell.style.gridColumn = '7 / 10';
                        cell.style.gridRow = '5 / 9';
                    } else if (i === 5) {
                        // 图6：第5行第10列，占4行3列
                        cell.style.gridColumn = '10 / 13';
                        cell.style.gridRow = '5 / 9';
                    } else if (i === 6) {
                        // 图7：第9行第1列，占4行3列
                        cell.style.gridColumn = '1 / 4';
                        cell.style.gridRow = '9 / 13';
                    } else if (i === 7) {
                        // 图8：第9行第4列，占4行3列
                        cell.style.gridColumn = '4 / 7';
                        cell.style.gridRow = '9 / 13';
                    } else if (i === 8) {
                        // 图9：第9行第7列，占4行3列
                        cell.style.gridColumn = '7 / 10';
                        cell.style.gridRow = '9 / 13';
                    } else if (i === 9) {
                        // 图10：第9行第10列，占4行3列
                        cell.style.gridColumn = '10 / 13';
                        cell.style.gridRow = '9 / 13';
                    }
                } else if (currentLayout === '10-11') {
                    // 10图布局第11方案：8×8网格
                    if (i === 0) {
                        // 图1：第1行第1列，占4行4列
                        cell.style.gridColumn = '1 / 5';
                        cell.style.gridRow = '1 / 5';
                    } else if (i === 1) {
                        // 图2：第1行第5列，占4行4列
                        cell.style.gridColumn = '5 / 9';
                        cell.style.gridRow = '1 / 5';
                    } else if (i === 2) {
                        // 图3：第5行第1列，占4行4列
                        cell.style.gridColumn = '1 / 5';
                        cell.style.gridRow = '5 / 9';
                    } else if (i === 3) {
                        // 图4：第5行第5列，占2行2列
                        cell.style.gridColumn = '5 / 7';
                        cell.style.gridRow = '5 / 7';
                    } else if (i === 4) {
                        // 图5：第5行第7列，占2行2列
                        cell.style.gridColumn = '7 / 9';
                        cell.style.gridRow = '5 / 7';
                    } else if (i === 5) {
                        // 图6：第7行第5列，占2行2列
                        cell.style.gridColumn = '5 / 7';
                        cell.style.gridRow = '7 / 9';
                    } else if (i === 6) {
                        // 图7：第7行第7列，占1行1列
                        cell.style.gridColumn = '7';
                        cell.style.gridRow = '7';
                    } else if (i === 7) {
                        // 图8：第7行第8列，占1行1列
                        cell.style.gridColumn = '8';
                        cell.style.gridRow = '7';
                    } else if (i === 8) {
                        // 图9：第8行第7列，占1行1列
                        cell.style.gridColumn = '7';
                        cell.style.gridRow = '8';
                    } else if (i === 9) {
                        // 图10：第8行第8列，占1行1列
                        cell.style.gridColumn = '8';
                        cell.style.gridRow = '8';
                    }
                } else if (currentLayout === '11-1') {
                    // 11图布局第1方案：4×4网格，左中右对称布局
                    if (i === 0) {
                        // 图1：第1列第1行，占1行1列
                        cell.style.gridColumn = '1';
                        cell.style.gridRow = '1';
                    } else if (i === 1) {
                        // 图2：第1列第2行，占1行1列
                        cell.style.gridColumn = '1';
                        cell.style.gridRow = '2';
                    } else if (i === 2) {
                        // 图3：第1列第3行，占1行1列
                        cell.style.gridColumn = '1';
                        cell.style.gridRow = '3';
                    } else if (i === 3) {
                        // 图4：第1列第4行，占1行1列
                        cell.style.gridColumn = '1';
                        cell.style.gridRow = '4';
                    } else if (i === 4) {
                        // 图5：第2-3列第1行，占1行2列
                        cell.style.gridColumn = '2 / 4';
                        cell.style.gridRow = '1';
                    } else if (i === 5) {
                        // 图6：第2-3列第2-3行，占2行2列
                        cell.style.gridColumn = '2 / 4';
                        cell.style.gridRow = '2 / 4';
                    } else if (i === 6) {
                        // 图7：第2-3列第4行，占1行2列
                        cell.style.gridColumn = '2 / 4';
                        cell.style.gridRow = '4';
                    } else if (i === 7) {
                        // 图8：第4列第1行，占1行1列
                        cell.style.gridColumn = '4';
                        cell.style.gridRow = '1';
                    } else if (i === 8) {
                        // 图9：第4列第2行，占1行1列
                        cell.style.gridColumn = '4';
                        cell.style.gridRow = '2';
                    } else if (i === 9) {
                        // 图10：第4列第3行，占1行1列
                        cell.style.gridColumn = '4';
                        cell.style.gridRow = '3';
                    } else if (i === 10) {
                        // 图11：第4列第4行，占1行1列
                        cell.style.gridColumn = '4';
                        cell.style.gridRow = '4';
                    }
                } else if (currentLayout === '11-2') {
                    // 11图布局第2方案：12×12网格，上下分层递减布局
                    if (i === 0) {
                        // 图1：第1行第1-6列，占3行6列
                        cell.style.gridColumn = '1 / 7';
                        cell.style.gridRow = '1 / 4';
                    } else if (i === 1) {
                        // 图2：第1行第7-12列，占3行6列
                        cell.style.gridColumn = '7 / 13';
                        cell.style.gridRow = '1 / 4';
                    } else if (i === 2) {
                        // 图3：第4行第1-4列，占3行4列
                        cell.style.gridColumn = '1 / 5';
                        cell.style.gridRow = '4 / 7';
                    } else if (i === 3) {
                        // 图4：第4行第5-8列，占3行4列
                        cell.style.gridColumn = '5 / 9';
                        cell.style.gridRow = '4 / 7';
                    } else if (i === 4) {
                        // 图5：第4行第9-12列，占3行4列
                        cell.style.gridColumn = '9 / 13';
                        cell.style.gridRow = '4 / 7';
                    } else if (i === 5) {
                        // 图6：第7行第1-4列，占3行4列
                        cell.style.gridColumn = '1 / 5';
                        cell.style.gridRow = '7 / 10';
                    } else if (i === 6) {
                        // 图7：第7行第5-8列，占3行4列
                        cell.style.gridColumn = '5 / 9';
                        cell.style.gridRow = '7 / 10';
                    } else if (i === 7) {
                        // 图8：第7行第9-12列，占3行4列
                        cell.style.gridColumn = '9 / 13';
                        cell.style.gridRow = '7 / 10';
                    } else if (i === 8) {
                        // 图9：第10行第1-4列，占3行4列
                        cell.style.gridColumn = '1 / 5';
                        cell.style.gridRow = '10 / 13';
                    } else if (i === 9) {
                        // 图10：第10行第5-8列，占3行4列
                        cell.style.gridColumn = '5 / 9';
                        cell.style.gridRow = '10 / 13';
                    } else if (i === 10) {
                        // 图11：第10行第9-12列，占3行4列
                        cell.style.gridColumn = '9 / 13';
                        cell.style.gridRow = '10 / 13';
                    }
                } else if (currentLayout === '11-3') {
                    // 11图布局第3方案：4×4网格，上下规整中间突出布局
                    if (i === 0) {
                        // 图1：第1行第1列，占1行1列
                        cell.style.gridColumn = '1';
                        cell.style.gridRow = '1';
                    } else if (i === 1) {
                        // 图2：第1行第2列，占1行1列
                        cell.style.gridColumn = '2';
                        cell.style.gridRow = '1';
                    } else if (i === 2) {
                        // 图3：第1行第3列，占1行1列
                        cell.style.gridColumn = '3';
                        cell.style.gridRow = '1';
                    } else if (i === 3) {
                        // 图4：第1行第4列，占1行1列
                        cell.style.gridColumn = '4';
                        cell.style.gridRow = '1';
                    } else if (i === 4) {
                        // 图5：第2-3行第1列，占2行1列
                        cell.style.gridColumn = '1';
                        cell.style.gridRow = '2 / 4';
                    } else if (i === 5) {
                        // 图6：第2-3行第2-3列，占2行2列
                        cell.style.gridColumn = '2 / 4';
                        cell.style.gridRow = '2 / 4';
                    } else if (i === 6) {
                        // 图7：第2-3行第4列，占2行1列
                        cell.style.gridColumn = '4';
                        cell.style.gridRow = '2 / 4';
                    } else if (i === 7) {
                        // 图8：第4行第1列，占1行1列
                        cell.style.gridColumn = '1';
                        cell.style.gridRow = '4';
                    } else if (i === 8) {
                        // 图9：第4行第2列，占1行1列
                        cell.style.gridColumn = '2';
                        cell.style.gridRow = '4';
                    } else if (i === 9) {
                        // 图10：第4行第3列，占1行1列
                        cell.style.gridColumn = '3';
                        cell.style.gridRow = '4';
                    } else if (i === 10) {
                        // 图11：第4行第4列，占1行1列
                        cell.style.gridColumn = '4';
                        cell.style.gridRow = '4';
                    }
                } else if (currentLayout === '11-4') {
                    // 11图布局第4方案：15×15网格，上大下小布局
                    if (i === 0) {
                        // 图1：第1行第1-15列，占5行15列
                        cell.style.gridColumn = '1 / 16';
                        cell.style.gridRow = '1 / 6';
                    } else if (i === 1) {
                        // 图2：第6行第1-3列，占5行3列
                        cell.style.gridColumn = '1 / 4';
                        cell.style.gridRow = '6 / 11';
                    } else if (i === 2) {
                        // 图3：第6行第4-6列，占5行3列
                        cell.style.gridColumn = '4 / 7';
                        cell.style.gridRow = '6 / 11';
                    } else if (i === 3) {
                        // 图4：第6行第7-9列，占5行3列
                        cell.style.gridColumn = '7 / 10';
                        cell.style.gridRow = '6 / 11';
                    } else if (i === 4) {
                        // 图5：第6行第10-12列，占5行3列
                        cell.style.gridColumn = '10 / 13';
                        cell.style.gridRow = '6 / 11';
                    } else if (i === 5) {
                        // 图6：第6行第13-15列，占5行3列
                        cell.style.gridColumn = '13 / 16';
                        cell.style.gridRow = '6 / 11';
                    } else if (i === 6) {
                        // 图7：第11行第1-3列，占5行3列
                        cell.style.gridColumn = '1 / 4';
                        cell.style.gridRow = '11 / 16';
                    } else if (i === 7) {
                        // 图8：第11行第4-6列，占5行3列
                        cell.style.gridColumn = '4 / 7';
                        cell.style.gridRow = '11 / 16';
                    } else if (i === 8) {
                        // 图9：第11行第7-9列，占5行3列
                        cell.style.gridColumn = '7 / 10';
                        cell.style.gridRow = '11 / 16';
                    } else if (i === 9) {
                        // 图10：第11行第10-12列，占5行3列
                        cell.style.gridColumn = '10 / 13';
                        cell.style.gridRow = '11 / 16';
                    } else if (i === 10) {
                        // 图11：第11行第13-15列，占5行3列
                        cell.style.gridColumn = '13 / 16';
                        cell.style.gridRow = '11 / 16';
                    }
                } else if (currentLayout === '11-5') {
                    // 11图布局第5方案：15×15网格，上小中大下小布局
                    if (i === 0) {
                        // 图1：第1行第1-3列，占5行3列
                        cell.style.gridColumn = '1 / 4';
                        cell.style.gridRow = '1 / 6';
                    } else if (i === 1) {
                        // 图2：第1行第4-6列，占5行3列
                        cell.style.gridColumn = '4 / 7';
                        cell.style.gridRow = '1 / 6';
                    } else if (i === 2) {
                        // 图3：第1行第7-9列，占5行3列
                        cell.style.gridColumn = '7 / 10';
                        cell.style.gridRow = '1 / 6';
                    } else if (i === 3) {
                        // 图4：第1行第10-12列，占5行3列
                        cell.style.gridColumn = '10 / 13';
                        cell.style.gridRow = '1 / 6';
                    } else if (i === 4) {
                        // 图5：第1行第13-15列，占5行3列
                        cell.style.gridColumn = '13 / 16';
                        cell.style.gridRow = '1 / 6';
                    } else if (i === 5) {
                        // 图6：第6行第1-15列，占5行15列
                        cell.style.gridColumn = '1 / 16';
                        cell.style.gridRow = '6 / 11';
                    } else if (i === 6) {
                        // 图7：第11行第1-3列，占5行3列
                        cell.style.gridColumn = '1 / 4';
                        cell.style.gridRow = '11 / 16';
                    } else if (i === 7) {
                        // 图8：第11行第4-6列，占5行3列
                        cell.style.gridColumn = '4 / 7';
                        cell.style.gridRow = '11 / 16';
                    } else if (i === 8) {
                        // 图9：第11行第7-9列，占5行3列
                        cell.style.gridColumn = '7 / 10';
                        cell.style.gridRow = '11 / 16';
                    } else if (i === 9) {
                        // 图10：第11行第10-12列，占5行3列
                        cell.style.gridColumn = '10 / 13';
                        cell.style.gridRow = '11 / 16';
                    } else if (i === 10) {
                        // 图11：第11行第13-15列，占5行3列
                        cell.style.gridColumn = '13 / 16';
                        cell.style.gridRow = '11 / 16';
                    }
                } else if (currentLayout === '11-6') {
                    // 11图布局第6方案：15×15网格，上中小下大布局
                    if (i === 0) {
                        // 图1：第1行第1-3列，占5行3列
                        cell.style.gridColumn = '1 / 4';
                        cell.style.gridRow = '1 / 6';
                    } else if (i === 1) {
                        // 图2：第1行第4-6列，占5行3列
                        cell.style.gridColumn = '4 / 7';
                        cell.style.gridRow = '1 / 6';
                    } else if (i === 2) {
                        // 图3：第1行第7-9列，占5行3列
                        cell.style.gridColumn = '7 / 10';
                        cell.style.gridRow = '1 / 6';
                    } else if (i === 3) {
                        // 图4：第1行第10-12列，占5行3列
                        cell.style.gridColumn = '10 / 13';
                        cell.style.gridRow = '1 / 6';
                    } else if (i === 4) {
                        // 图5：第1行第13-15列，占5行3列
                        cell.style.gridColumn = '13 / 16';
                        cell.style.gridRow = '1 / 6';
                    } else if (i === 5) {
                        // 图6：第6行第1-3列，占5行3列
                        cell.style.gridColumn = '1 / 4';
                        cell.style.gridRow = '6 / 11';
                    } else if (i === 6) {
                        // 图7：第6行第4-6列，占5行3列
                        cell.style.gridColumn = '4 / 7';
                        cell.style.gridRow = '6 / 11';
                    } else if (i === 7) {
                        // 图8：第6行第7-9列，占5行3列
                        cell.style.gridColumn = '7 / 10';
                        cell.style.gridRow = '6 / 11';
                    } else if (i === 8) {
                        // 图9：第6行第10-12列，占5行3列
                        cell.style.gridColumn = '10 / 13';
                        cell.style.gridRow = '6 / 11';
                    } else if (i === 9) {
                        // 图10：第6行第13-15列，占5行3列
                        cell.style.gridColumn = '13 / 16';
                        cell.style.gridRow = '6 / 11';
                    } else if (i === 10) {
                        // 图11：第11行第1-15列，占5行15列
                        cell.style.gridColumn = '1 / 16';
                        cell.style.gridRow = '11 / 16';
                    }
                } else if (currentLayout === '12-1') {
                    // 12图布局第1方案：6×6网格，左右对称布局
                    if (i === 0) {
                        // 图1：第1行第1-3列，占1行3列
                        cell.style.gridColumn = '1 / 4';
                        cell.style.gridRow = '1';
                    } else if (i === 1) {
                        // 图2：第2行第1-3列，占1行3列
                        cell.style.gridColumn = '1 / 4';
                        cell.style.gridRow = '2';
                    } else if (i === 2) {
                        // 图3：第3行第1-3列，占1行3列
                        cell.style.gridColumn = '1 / 4';
                        cell.style.gridRow = '3';
                    } else if (i === 3) {
                        // 图4：第4行第1-3列，占1行3列
                        cell.style.gridColumn = '1 / 4';
                        cell.style.gridRow = '4';
                    } else if (i === 4) {
                        // 图5：第5行第1-3列，占1行3列
                        cell.style.gridColumn = '1 / 4';
                        cell.style.gridRow = '5';
                    } else if (i === 5) {
                        // 图6：第6行第1-3列，占1行3列
                        cell.style.gridColumn = '1 / 4';
                        cell.style.gridRow = '6';
                    } else if (i === 6) {
                        // 图7：第1行第4-6列，占1行3列
                        cell.style.gridColumn = '4 / 7';
                        cell.style.gridRow = '1';
                    } else if (i === 7) {
                        // 图8：第2行第4-6列，占1行3列
                        cell.style.gridColumn = '4 / 7';
                        cell.style.gridRow = '2';
                    } else if (i === 8) {
                        // 图9：第3行第4-6列，占1行3列
                        cell.style.gridColumn = '4 / 7';
                        cell.style.gridRow = '3';
                    } else if (i === 9) {
                        // 图10：第4行第4-6列，占1行3列
                        cell.style.gridColumn = '4 / 7';
                        cell.style.gridRow = '4';
                    } else if (i === 10) {
                        // 图11：第5行第4-6列，占1行3列
                        cell.style.gridColumn = '4 / 7';
                        cell.style.gridRow = '5';
                    } else if (i === 11) {
                        // 图12：第6行第4-6列，占1行3列
                        cell.style.gridColumn = '4 / 7';
                        cell.style.gridRow = '6';
                    }
                } else if (currentLayout === '12-2') {
                    // 12图布局第2方案：6×6网格，大图+边框布局
                    if (i === 0) {
                        // 图1：第1-5行第1-5列，占5行5列
                        cell.style.gridColumn = '1 / 6';
                        cell.style.gridRow = '1 / 6';
                    } else if (i === 1) {
                        // 图2：第1行第6列，占1行1列
                        cell.style.gridColumn = '6';
                        cell.style.gridRow = '1';
                    } else if (i === 2) {
                        // 图3：第2行第6列，占1行1列
                        cell.style.gridColumn = '6';
                        cell.style.gridRow = '2';
                    } else if (i === 3) {
                        // 图4：第3行第6列，占1行1列
                        cell.style.gridColumn = '6';
                        cell.style.gridRow = '3';
                    } else if (i === 4) {
                        // 图5：第4行第6列，占1行1列
                        cell.style.gridColumn = '6';
                        cell.style.gridRow = '4';
                    } else if (i === 5) {
                        // 图6：第5行第6列，占1行1列
                        cell.style.gridColumn = '6';
                        cell.style.gridRow = '5';
                    } else if (i === 6) {
                        // 图7：第6行第6列，占1行1列
                        cell.style.gridColumn = '6';
                        cell.style.gridRow = '6';
                    } else if (i === 7) {
                        // 图8：第6行第1列，占1行1列
                        cell.style.gridColumn = '1';
                        cell.style.gridRow = '6';
                    } else if (i === 8) {
                        // 图9：第6行第2列，占1行1列
                        cell.style.gridColumn = '2';
                        cell.style.gridRow = '6';
                    } else if (i === 9) {
                        // 图10：第6行第3列，占1行1列
                        cell.style.gridColumn = '3';
                        cell.style.gridRow = '6';
                    } else if (i === 10) {
                        // 图11：第6行第4列，占1行1列
                        cell.style.gridColumn = '4';
                        cell.style.gridRow = '6';
                    } else if (i === 11) {
                        // 图12：第6行第5列，占1行1列
                        cell.style.gridColumn = '5';
                        cell.style.gridRow = '6';
                    }
                } else if (currentLayout === '12-3') {
                    // 12图布局第3方案：12×12网格，复杂组合布局
                    if (i === 0) {
                        // 图1：第1-4行第1-3列，占4行3列
                        cell.style.gridColumn = '1 / 4';
                        cell.style.gridRow = '1 / 5';
                    } else if (i === 1) {
                        // 图2：第5-8行第1-3列，占4行3列
                        cell.style.gridColumn = '1 / 4';
                        cell.style.gridRow = '5 / 9';
                    } else if (i === 2) {
                        // 图3：第9-12行第1-3列，占4行3列
                        cell.style.gridColumn = '1 / 4';
                        cell.style.gridRow = '9 / 13';
                    } else if (i === 3) {
                        // 图4：第1-3行第4-6列，占3行3列
                        cell.style.gridColumn = '4 / 7';
                        cell.style.gridRow = '1 / 4';
                    } else if (i === 4) {
                        // 图5：第1-3行第7-9列，占3行3列
                        cell.style.gridColumn = '7 / 10';
                        cell.style.gridRow = '1 / 4';
                    } else if (i === 5) {
                        // 图6：第1-3行第10-12列，占3行3列
                        cell.style.gridColumn = '10 / 13';
                        cell.style.gridRow = '1 / 4';
                    } else if (i === 6) {
                        // 图7：第4-6行第4-6列，占3行3列
                        cell.style.gridColumn = '4 / 7';
                        cell.style.gridRow = '4 / 7';
                    } else if (i === 7) {
                        // 图8：第4-6行第7-9列，占3行3列
                        cell.style.gridColumn = '7 / 10';
                        cell.style.gridRow = '4 / 7';
                    } else if (i === 8) {
                        // 图9：第4-6行第10-12列，占3行3列
                        cell.style.gridColumn = '10 / 13';
                        cell.style.gridRow = '4 / 7';
                    } else if (i === 9) {
                        // 图10：第7-12行第4-9列，占6行6列
                        cell.style.gridColumn = '4 / 10';
                        cell.style.gridRow = '7 / 13';
                    } else if (i === 10) {
                        // 图11：第7-9行第10-12列，占3行3列
                        cell.style.gridColumn = '10 / 13';
                        cell.style.gridRow = '7 / 10';
                    } else if (i === 11) {
                        // 图12：第10-12行第10-12列，占3行3列
                        cell.style.gridColumn = '10 / 13';
                        cell.style.gridRow = '10 / 13';
                    }
                } else if (currentLayout === '12-4') {
                    // 12图布局第4方案：3行4列，简单网格
                    if (i === 0) {
                        // 图1：第1行第1列，占1行1列
                        cell.style.gridColumn = '1';
                        cell.style.gridRow = '1';
                    } else if (i === 1) {
                        // 图2：第1行第2列，占1行1列
                        cell.style.gridColumn = '2';
                        cell.style.gridRow = '1';
                    } else if (i === 2) {
                        // 图3：第1行第3列，占1行1列
                        cell.style.gridColumn = '3';
                        cell.style.gridRow = '1';
                    } else if (i === 3) {
                        // 图4：第1行第4列，占1行1列
                        cell.style.gridColumn = '4';
                        cell.style.gridRow = '1';
                    } else if (i === 4) {
                        // 图5：第2行第1列，占1行1列
                        cell.style.gridColumn = '1';
                        cell.style.gridRow = '2';
                    } else if (i === 5) {
                        // 图6：第2行第2列，占1行1列
                        cell.style.gridColumn = '2';
                        cell.style.gridRow = '2';
                    } else if (i === 6) {
                        // 图7：第2行第3列，占1行1列
                        cell.style.gridColumn = '3';
                        cell.style.gridRow = '2';
                    } else if (i === 7) {
                        // 图8：第2行第4列，占1行1列
                        cell.style.gridColumn = '4';
                        cell.style.gridRow = '2';
                    } else if (i === 8) {
                        // 图9：第3行第1列，占1行1列
                        cell.style.gridColumn = '1';
                        cell.style.gridRow = '3';
                    } else if (i === 9) {
                        // 图10：第3行第2列，占1行1列
                        cell.style.gridColumn = '2';
                        cell.style.gridRow = '3';
                    } else if (i === 10) {
                        // 图11：第3行第3列，占1行1列
                        cell.style.gridColumn = '3';
                        cell.style.gridRow = '3';
                    } else if (i === 11) {
                        // 图12：第3行第4列，占1行1列
                        cell.style.gridColumn = '4';
                        cell.style.gridRow = '3';
                    }
                } else if (currentLayout === '12-5') {
                    // 12图布局第5方案：4行3列，简单网格
                    if (i === 0) {
                        // 图1：第1行第1列，占1行1列
                        cell.style.gridColumn = '1';
                        cell.style.gridRow = '1';
                    } else if (i === 1) {
                        // 图2：第1行第2列，占1行1列
                        cell.style.gridColumn = '2';
                        cell.style.gridRow = '1';
                    } else if (i === 2) {
                        // 图3：第1行第3列，占1行1列
                        cell.style.gridColumn = '3';
                        cell.style.gridRow = '1';
                    } else if (i === 3) {
                        // 图4：第2行第1列，占1行1列
                        cell.style.gridColumn = '1';
                        cell.style.gridRow = '2';
                    } else if (i === 4) {
                        // 图5：第2行第2列，占1行1列
                        cell.style.gridColumn = '2';
                        cell.style.gridRow = '2';
                    } else if (i === 5) {
                        // 图6：第2行第3列，占1行1列
                        cell.style.gridColumn = '3';
                        cell.style.gridRow = '2';
                    } else if (i === 6) {
                        // 图7：第3行第1列，占1行1列
                        cell.style.gridColumn = '1';
                        cell.style.gridRow = '3';
                    } else if (i === 7) {
                        // 图8：第3行第2列，占1行1列
                        cell.style.gridColumn = '2';
                        cell.style.gridRow = '3';
                    } else if (i === 8) {
                        // 图9：第3行第3列，占1行1列
                        cell.style.gridColumn = '3';
                        cell.style.gridRow = '3';
                    } else if (i === 9) {
                        // 图10：第4行第1列，占1行1列
                        cell.style.gridColumn = '1';
                        cell.style.gridRow = '4';
                    } else if (i === 10) {
                        // 图11：第4行第2列，占1行1列
                        cell.style.gridColumn = '2';
                        cell.style.gridRow = '4';
                    } else if (i === 11) {
                        // 图12：第4行第3列，占1行1列
                        cell.style.gridColumn = '3';
                        cell.style.gridRow = '4';
                    }
                } else if (currentLayout === '13-1') {
                    // 13图布局第1方案：4×4网格，左右对称+中间组合
                    if (i === 0) {
                        // 图1：第1列第1行，占1行1列
                        cell.style.gridColumn = '1';
                        cell.style.gridRow = '1';
                    } else if (i === 1) {
                        // 图2：第1列第2行，占1行1列
                        cell.style.gridColumn = '1';
                        cell.style.gridRow = '2';
                    } else if (i === 2) {
                        // 图3：第1列第3行，占1行1列
                        cell.style.gridColumn = '1';
                        cell.style.gridRow = '3';
                    } else if (i === 3) {
                        // 图4：第1列第4行，占1行1列
                        cell.style.gridColumn = '1';
                        cell.style.gridRow = '4';
                    } else if (i === 4) {
                        // 图5：第4列第1行，占1行1列
                        cell.style.gridColumn = '4';
                        cell.style.gridRow = '1';
                    } else if (i === 5) {
                        // 图6：第4列第2行，占1行1列
                        cell.style.gridColumn = '4';
                        cell.style.gridRow = '2';
                    } else if (i === 6) {
                        // 图7：第4列第3行，占1行1列
                        cell.style.gridColumn = '4';
                        cell.style.gridRow = '3';
                    } else if (i === 7) {
                        // 图8：第4列第4行，占1行1列
                        cell.style.gridColumn = '4';
                        cell.style.gridRow = '4';
                    } else if (i === 8) {
                        // 图9：第1行第2列，占1行1列
                        cell.style.gridColumn = '2';
                        cell.style.gridRow = '1';
                    } else if (i === 9) {
                        // 图10：第1行第3列，占1行1列
                        cell.style.gridColumn = '3';
                        cell.style.gridRow = '1';
                    } else if (i === 10) {
                        // 图11：第2-3行第2-3列，占2行2列
                        cell.style.gridColumn = '2 / 4';
                        cell.style.gridRow = '2 / 4';
                    } else if (i === 11) {
                        // 图12：第4行第2列，占1行1列
                        cell.style.gridColumn = '2';
                        cell.style.gridRow = '4';
                    } else if (i === 12) {
                        // 图13：第4行第3列，占1行1列
                        cell.style.gridColumn = '3';
                        cell.style.gridRow = '4';
                    }
                } else if (currentLayout === '13-2') {
                    // 13图布局第2方案：4×4网格，左上大图+右侧双列
                    if (i === 0) {
                        // 图1：第1-2行第1-2列，占2行2列
                        cell.style.gridColumn = '1 / 3';
                        cell.style.gridRow = '1 / 3';
                    } else if (i === 1) {
                        // 图2：第3行第1列，占1行1列
                        cell.style.gridColumn = '1';
                        cell.style.gridRow = '3';
                    } else if (i === 2) {
                        // 图3：第4行第1列，占1行1列
                        cell.style.gridColumn = '1';
                        cell.style.gridRow = '4';
                    } else if (i === 3) {
                        // 图4：第1行第3列，占1行1列
                        cell.style.gridColumn = '3';
                        cell.style.gridRow = '1';
                    } else if (i === 4) {
                        // 图5：第2行第3列，占1行1列
                        cell.style.gridColumn = '3';
                        cell.style.gridRow = '2';
                    } else if (i === 5) {
                        // 图6：第3行第3列，占1行1列
                        cell.style.gridColumn = '3';
                        cell.style.gridRow = '3';
                    } else if (i === 6) {
                        // 图7：第4行第3列，占1行1列
                        cell.style.gridColumn = '3';
                        cell.style.gridRow = '4';
                    } else if (i === 7) {
                        // 图8：第1行第4列，占1行1列
                        cell.style.gridColumn = '4';
                        cell.style.gridRow = '1';
                    } else if (i === 8) {
                        // 图9：第2行第4列，占1行1列
                        cell.style.gridColumn = '4';
                        cell.style.gridRow = '2';
                    } else if (i === 9) {
                        // 图10：第3行第4列，占1行1列
                        cell.style.gridColumn = '4';
                        cell.style.gridRow = '3';
                    } else if (i === 10) {
                        // 图11：第4行第4列，占1行1列
                        cell.style.gridColumn = '4';
                        cell.style.gridRow = '4';
                    } else if (i === 11) {
                        // 图12：第3行第2列，占1行1列
                        cell.style.gridColumn = '2';
                        cell.style.gridRow = '3';
                    } else if (i === 12) {
                        // 图13：第4行第2列，占1行1列
                        cell.style.gridColumn = '2';
                        cell.style.gridRow = '4';
                    }
                } else if (currentLayout === '13-3') {
                    // 13图布局第3方案：4×4网格，上中下逐渐减少+右下大图
                    if (i === 0) {
                        // 图1：第1行第1列，占1行1列
                        cell.style.gridColumn = '1';
                        cell.style.gridRow = '1';
                    } else if (i === 1) {
                        // 图2：第1行第2列，占1行1列
                        cell.style.gridColumn = '2';
                        cell.style.gridRow = '1';
                    } else if (i === 2) {
                        // 图3：第1行第3列，占1行1列
                        cell.style.gridColumn = '3';
                        cell.style.gridRow = '1';
                    } else if (i === 3) {
                        // 图4：第1行第4列，占1行1列
                        cell.style.gridColumn = '4';
                        cell.style.gridRow = '1';
                    } else if (i === 4) {
                        // 图5：第2行第1列，占1行1列
                        cell.style.gridColumn = '1';
                        cell.style.gridRow = '2';
                    } else if (i === 5) {
                        // 图6：第2行第2列，占1行1列
                        cell.style.gridColumn = '2';
                        cell.style.gridRow = '2';
                    } else if (i === 6) {
                        // 图7：第2行第3列，占1行1列
                        cell.style.gridColumn = '3';
                        cell.style.gridRow = '2';
                    } else if (i === 7) {
                        // 图8：第2行第4列，占1行1列
                        cell.style.gridColumn = '4';
                        cell.style.gridRow = '2';
                    } else if (i === 8) {
                        // 图9：第3行第1列，占1行1列
                        cell.style.gridColumn = '1';
                        cell.style.gridRow = '3';
                    } else if (i === 9) {
                        // 图10：第3行第2列，占1行1列
                        cell.style.gridColumn = '2';
                        cell.style.gridRow = '3';
                    } else if (i === 10) {
                        // 图11：第3-4行第3-4列，占2行2列
                        cell.style.gridColumn = '3 / 5';
                        cell.style.gridRow = '3 / 5';
                    } else if (i === 11) {
                        // 图12：第4行第1列，占1行1列
                        cell.style.gridColumn = '1';
                        cell.style.gridRow = '4';
                    } else if (i === 12) {
                        // 图13：第4行第2列，占1行1列
                        cell.style.gridColumn = '2';
                        cell.style.gridRow = '4';
                    }
                } else if (currentLayout === '13-4') {
                    // 13图布局第4方案：4×4网格，左下大图+右下4小图
                    if (i === 0) {
                        // 图1：第1行第1列，占1行1列
                        cell.style.gridColumn = '1';
                        cell.style.gridRow = '1';
                    } else if (i === 1) {
                        // 图2：第1行第2列，占1行1列
                        cell.style.gridColumn = '2';
                        cell.style.gridRow = '1';
                    } else if (i === 2) {
                        // 图3：第1行第3列，占1行1列
                        cell.style.gridColumn = '3';
                        cell.style.gridRow = '1';
                    } else if (i === 3) {
                        // 图4：第1行第4列，占1行1列
                        cell.style.gridColumn = '4';
                        cell.style.gridRow = '1';
                    } else if (i === 4) {
                        // 图5：第2行第1列，占1行1列
                        cell.style.gridColumn = '1';
                        cell.style.gridRow = '2';
                    } else if (i === 5) {
                        // 图6：第2行第2列，占1行1列
                        cell.style.gridColumn = '2';
                        cell.style.gridRow = '2';
                    } else if (i === 6) {
                        // 图7：第2行第3列，占1行1列
                        cell.style.gridColumn = '3';
                        cell.style.gridRow = '2';
                    } else if (i === 7) {
                        // 图8：第2行第4列，占1行1列
                        cell.style.gridColumn = '4';
                        cell.style.gridRow = '2';
                    } else if (i === 8) {
                        // 图9：第3-4行第1-2列，占2行2列
                        cell.style.gridColumn = '1 / 3';
                        cell.style.gridRow = '3 / 5';
                    } else if (i === 9) {
                        // 图10：第3行第3列，占1行1列
                        cell.style.gridColumn = '3';
                        cell.style.gridRow = '3';
                    } else if (i === 10) {
                        // 图11：第3行第4列，占1行1列
                        cell.style.gridColumn = '4';
                        cell.style.gridRow = '3';
                    } else if (i === 11) {
                        // 图12：第4行第3列，占1行1列
                        cell.style.gridColumn = '3';
                        cell.style.gridRow = '4';
                    } else if (i === 12) {
                        // 图13：第4行第4列，占1行1列
                        cell.style.gridColumn = '4';
                        cell.style.gridRow = '4';
                    }
                } else if (currentLayout === '13-5') {
                    // 13图布局第5方案：4×4网格，右上大图+左侧4小图+下方8图
                    if (i === 0) {
                        // 图1：第1-2行第3-4列，占2行2列
                        cell.style.gridColumn = '3 / 5';
                        cell.style.gridRow = '1 / 3';
                    } else if (i === 1) {
                        // 图2：第1行第1列，占1行1列
                        cell.style.gridColumn = '1';
                        cell.style.gridRow = '1';
                    } else if (i === 2) {
                        // 图3：第1行第2列，占1行1列
                        cell.style.gridColumn = '2';
                        cell.style.gridRow = '1';
                    } else if (i === 3) {
                        // 图4：第2行第1列，占1行1列
                        cell.style.gridColumn = '1';
                        cell.style.gridRow = '2';
                    } else if (i === 4) {
                        // 图5：第2行第2列，占1行1列
                        cell.style.gridColumn = '2';
                        cell.style.gridRow = '2';
                    } else if (i === 5) {
                        // 图6：第3行第1列，占1行1列
                        cell.style.gridColumn = '1';
                        cell.style.gridRow = '3';
                    } else if (i === 6) {
                        // 图7：第3行第2列，占1行1列
                        cell.style.gridColumn = '2';
                        cell.style.gridRow = '3';
                    } else if (i === 7) {
                        // 图8：第3行第3列，占1行1列
                        cell.style.gridColumn = '3';
                        cell.style.gridRow = '3';
                    } else if (i === 8) {
                        // 图9：第3行第4列，占1行1列
                        cell.style.gridColumn = '4';
                        cell.style.gridRow = '3';
                    } else if (i === 9) {
                        // 图10：第4行第1列，占1行1列
                        cell.style.gridColumn = '1';
                        cell.style.gridRow = '4';
                    } else if (i === 10) {
                        // 图11：第4行第2列，占1行1列
                        cell.style.gridColumn = '2';
                        cell.style.gridRow = '4';
                    } else if (i === 11) {
                        // 图12：第4行第3列，占1行1列
                        cell.style.gridColumn = '3';
                        cell.style.gridRow = '4';
                    } else if (i === 12) {
                        // 图13：第4行第4列，占1行1列
                        cell.style.gridColumn = '4';
                        cell.style.gridRow = '4';
                    }
                } else if (currentLayout === '15-1') {
                    // 15图布局第1方案：4×4网格，第1行中间2列大图
                    if (i === 0) {
                        // 图1：第1行第1列，占1行1列
                        cell.style.gridColumn = '1';
                        cell.style.gridRow = '1';
                    } else if (i === 1) {
                        // 图2：第1行第2-3列，占1行2列
                        cell.style.gridColumn = '2 / 4';
                        cell.style.gridRow = '1';
                    } else if (i === 2) {
                        // 图3：第1行第4列，占1行1列
                        cell.style.gridColumn = '4';
                        cell.style.gridRow = '1';
                    } else if (i === 3) {
                        // 图4：第2行第1列，占1行1列
                        cell.style.gridColumn = '1';
                        cell.style.gridRow = '2';
                    } else if (i === 4) {
                        // 图5：第2行第2列，占1行1列
                        cell.style.gridColumn = '2';
                        cell.style.gridRow = '2';
                    } else if (i === 5) {
                        // 图6：第2行第3列，占1行1列
                        cell.style.gridColumn = '3';
                        cell.style.gridRow = '2';
                    } else if (i === 6) {
                        // 图7：第2行第4列，占1行1列
                        cell.style.gridColumn = '4';
                        cell.style.gridRow = '2';
                    } else if (i === 7) {
                        // 图8：第3行第1列，占1行1列
                        cell.style.gridColumn = '1';
                        cell.style.gridRow = '3';
                    } else if (i === 8) {
                        // 图9：第3行第2列，占1行1列
                        cell.style.gridColumn = '2';
                        cell.style.gridRow = '3';
                    } else if (i === 9) {
                        // 图10：第3行第3列，占1行1列
                        cell.style.gridColumn = '3';
                        cell.style.gridRow = '3';
                    } else if (i === 10) {
                        // 图11：第3行第4列，占1行1列
                        cell.style.gridColumn = '4';
                        cell.style.gridRow = '3';
                    } else if (i === 11) {
                        // 图12：第4行第1列，占1行1列
                        cell.style.gridColumn = '1';
                        cell.style.gridRow = '4';
                    } else if (i === 12) {
                        // 图13：第4行第2列，占1行1列
                        cell.style.gridColumn = '2';
                        cell.style.gridRow = '4';
                    } else if (i === 13) {
                        // 图14：第4行第3列，占1行1列
                        cell.style.gridColumn = '3';
                        cell.style.gridRow = '4';
                    } else if (i === 14) {
                        // 图15：第4行第4列，占1行1列
                        cell.style.gridColumn = '4';
                        cell.style.gridRow = '4';
                    }
                } else if (currentLayout === '15-2') {
                    // 15图布局第2方案：4×4网格，第2行中间2列大图
                    if (i === 0) {
                        // 图1：第1行第1列，占1行1列
                        cell.style.gridColumn = '1';
                        cell.style.gridRow = '1';
                    } else if (i === 1) {
                        // 图2：第1行第2列，占1行1列
                        cell.style.gridColumn = '2';
                        cell.style.gridRow = '1';
                    } else if (i === 2) {
                        // 图3：第1行第3列，占1行1列
                        cell.style.gridColumn = '3';
                        cell.style.gridRow = '1';
                    } else if (i === 3) {
                        // 图4：第1行第4列，占1行1列
                        cell.style.gridColumn = '4';
                        cell.style.gridRow = '1';
                    } else if (i === 4) {
                        // 图5：第2行第1列，占1行1列
                        cell.style.gridColumn = '1';
                        cell.style.gridRow = '2';
                    } else if (i === 5) {
                        // 图6：第2行第2-3列，占1行2列
                        cell.style.gridColumn = '2 / 4';
                        cell.style.gridRow = '2';
                    } else if (i === 6) {
                        // 图7：第2行第4列，占1行1列
                        cell.style.gridColumn = '4';
                        cell.style.gridRow = '2';
                    } else if (i === 7) {
                        // 图8：第3行第1列，占1行1列
                        cell.style.gridColumn = '1';
                        cell.style.gridRow = '3';
                    } else if (i === 8) {
                        // 图9：第3行第2列，占1行1列
                        cell.style.gridColumn = '2';
                        cell.style.gridRow = '3';
                    } else if (i === 9) {
                        // 图10：第3行第3列，占1行1列
                        cell.style.gridColumn = '3';
                        cell.style.gridRow = '3';
                    } else if (i === 10) {
                        // 图11：第3行第4列，占1行1列
                        cell.style.gridColumn = '4';
                        cell.style.gridRow = '3';
                    } else if (i === 11) {
                        // 图12：第4行第1列，占1行1列
                        cell.style.gridColumn = '1';
                        cell.style.gridRow = '4';
                    } else if (i === 12) {
                        // 图13：第4行第2列，占1行1列
                        cell.style.gridColumn = '2';
                        cell.style.gridRow = '4';
                    } else if (i === 13) {
                        // 图14：第4行第3列，占1行1列
                        cell.style.gridColumn = '3';
                        cell.style.gridRow = '4';
                    } else if (i === 14) {
                        // 图15：第4行第4列，占1行1列
                        cell.style.gridColumn = '4';
                        cell.style.gridRow = '4';
                    }
                } else if (currentLayout === '15-3') {
                    // 15图布局第3方案：4×4网格，第3行中间2列大图
                    if (i === 0) {
                        // 图1：第1行第1列，占1行1列
                        cell.style.gridColumn = '1';
                        cell.style.gridRow = '1';
                    } else if (i === 1) {
                        // 图2：第1行第2列，占1行1列
                        cell.style.gridColumn = '2';
                        cell.style.gridRow = '1';
                    } else if (i === 2) {
                        // 图3：第1行第3列，占1行1列
                        cell.style.gridColumn = '3';
                        cell.style.gridRow = '1';
                    } else if (i === 3) {
                        // 图4：第1行第4列，占1行1列
                        cell.style.gridColumn = '4';
                        cell.style.gridRow = '1';
                    } else if (i === 4) {
                        // 图5：第2行第1列，占1行1列
                        cell.style.gridColumn = '1';
                        cell.style.gridRow = '2';
                    } else if (i === 5) {
                        // 图6：第2行第2列，占1行1列
                        cell.style.gridColumn = '2';
                        cell.style.gridRow = '2';
                    } else if (i === 6) {
                        // 图7：第2行第3列，占1行1列
                        cell.style.gridColumn = '3';
                        cell.style.gridRow = '2';
                    } else if (i === 7) {
                        // 图8：第2行第4列，占1行1列
                        cell.style.gridColumn = '4';
                        cell.style.gridRow = '2';
                    } else if (i === 8) {
                        // 图9：第3行第1列，占1行1列
                        cell.style.gridColumn = '1';
                        cell.style.gridRow = '3';
                    } else if (i === 9) {
                        // 图10：第3行第2-3列，占1行2列
                        cell.style.gridColumn = '2 / 4';
                        cell.style.gridRow = '3';
                    } else if (i === 10) {
                        // 图11：第3行第4列，占1行1列
                        cell.style.gridColumn = '4';
                        cell.style.gridRow = '3';
                    } else if (i === 11) {
                        // 图12：第4行第1列，占1行1列
                        cell.style.gridColumn = '1';
                        cell.style.gridRow = '4';
                    } else if (i === 12) {
                        // 图13：第4行第2列，占1行1列
                        cell.style.gridColumn = '2';
                        cell.style.gridRow = '4';
                    } else if (i === 13) {
                        // 图14：第4行第3列，占1行1列
                        cell.style.gridColumn = '3';
                        cell.style.gridRow = '4';
                    } else if (i === 14) {
                        // 图15：第4行第4列，占1行1列
                        cell.style.gridColumn = '4';
                        cell.style.gridRow = '4';
                    }
                } else if (currentLayout === '15-4') {
                    // 15图布局第4方案：4×4网格，第4行中间2列大图
                    if (i === 0) {
                        // 图1：第1行第1列，占1行1列
                        cell.style.gridColumn = '1';
                        cell.style.gridRow = '1';
                    } else if (i === 1) {
                        // 图2：第1行第2列，占1行1列
                        cell.style.gridColumn = '2';
                        cell.style.gridRow = '1';
                    } else if (i === 2) {
                        // 图3：第1行第3列，占1行1列
                        cell.style.gridColumn = '3';
                        cell.style.gridRow = '1';
                    } else if (i === 3) {
                        // 图4：第1行第4列，占1行1列
                        cell.style.gridColumn = '4';
                        cell.style.gridRow = '1';
                    } else if (i === 4) {
                        // 图5：第2行第1列，占1行1列
                        cell.style.gridColumn = '1';
                        cell.style.gridRow = '2';
                    } else if (i === 5) {
                        // 图6：第2行第2列，占1行1列
                        cell.style.gridColumn = '2';
                        cell.style.gridRow = '2';
                    } else if (i === 6) {
                        // 图7：第2行第3列，占1行1列
                        cell.style.gridColumn = '3';
                        cell.style.gridRow = '2';
                    } else if (i === 7) {
                        // 图8：第2行第4列，占1行1列
                        cell.style.gridColumn = '4';
                        cell.style.gridRow = '2';
                    } else if (i === 8) {
                        // 图9：第3行第1列，占1行1列
                        cell.style.gridColumn = '1';
                        cell.style.gridRow = '3';
                    } else if (i === 9) {
                        // 图10：第3行第2列，占1行1列
                        cell.style.gridColumn = '2';
                        cell.style.gridRow = '3';
                    } else if (i === 10) {
                        // 图11：第3行第3列，占1行1列
                        cell.style.gridColumn = '3';
                        cell.style.gridRow = '3';
                    } else if (i === 11) {
                        // 图12：第3行第4列，占1行1列
                        cell.style.gridColumn = '4';
                        cell.style.gridRow = '3';
                    } else if (i === 12) {
                        // 图13：第4行第1列，占1行1列
                        cell.style.gridColumn = '1';
                        cell.style.gridRow = '4';
                    } else if (i === 13) {
                        // 图14：第4行第2-3列，占1行2列
                        cell.style.gridColumn = '2 / 4';
                        cell.style.gridRow = '4';
                    } else if (i === 14) {
                        // 图15：第4行第4列，占1行1列
                        cell.style.gridColumn = '4';
                        cell.style.gridRow = '4';
                    }
                } else if (currentLayout === '15-5') {
                    // 15图布局第5方案：3×5网格，简单竖向网格
                    if (i === 0) {
                        // 图1：第1行第1列，占1行1列
                        cell.style.gridColumn = '1';
                        cell.style.gridRow = '1';
                    } else if (i === 1) {
                        // 图2：第2行第1列，占1行1列
                        cell.style.gridColumn = '1';
                        cell.style.gridRow = '2';
                    } else if (i === 2) {
                        // 图3：第3行第1列，占1行1列
                        cell.style.gridColumn = '1';
                        cell.style.gridRow = '3';
                    } else if (i === 3) {
                        // 图4：第4行第1列，占1行1列
                        cell.style.gridColumn = '1';
                        cell.style.gridRow = '4';
                    } else if (i === 4) {
                        // 图5：第5行第1列，占1行1列
                        cell.style.gridColumn = '1';
                        cell.style.gridRow = '5';
                    } else if (i === 5) {
                        // 图6：第1行第2列，占1行1列
                        cell.style.gridColumn = '2';
                        cell.style.gridRow = '1';
                    } else if (i === 6) {
                        // 图7：第2行第2列，占1行1列
                        cell.style.gridColumn = '2';
                        cell.style.gridRow = '2';
                    } else if (i === 7) {
                        // 图8：第3行第2列，占1行1列
                        cell.style.gridColumn = '2';
                        cell.style.gridRow = '3';
                    } else if (i === 8) {
                        // 图9：第4行第2列，占1行1列
                        cell.style.gridColumn = '2';
                        cell.style.gridRow = '4';
                    } else if (i === 9) {
                        // 图10：第5行第2列，占1行1列
                        cell.style.gridColumn = '2';
                        cell.style.gridRow = '5';
                    } else if (i === 10) {
                        // 图11：第1行第3列，占1行1列
                        cell.style.gridColumn = '3';
                        cell.style.gridRow = '1';
                    } else if (i === 11) {
                        // 图12：第2行第3列，占1行1列
                        cell.style.gridColumn = '3';
                        cell.style.gridRow = '2';
                    } else if (i === 12) {
                        // 图13：第3行第3列，占1行1列
                        cell.style.gridColumn = '3';
                        cell.style.gridRow = '3';
                    } else if (i === 13) {
                        // 图14：第4行第3列，占1行1列
                        cell.style.gridColumn = '3';
                        cell.style.gridRow = '4';
                    } else if (i === 14) {
                        // 图15：第5行第3列，占1行1列
                        cell.style.gridColumn = '3';
                        cell.style.gridRow = '5';
                    }
                } else if (currentLayout === '15-6') {
                    // 15图布局第6方案：5×3网格，简单横向网格
                    if (i === 0) {
                        // 图1：第1行第1列，占1行1列
                        cell.style.gridColumn = '1';
                        cell.style.gridRow = '1';
                    } else if (i === 1) {
                        // 图2：第1行第2列，占1行1列
                        cell.style.gridColumn = '2';
                        cell.style.gridRow = '1';
                    } else if (i === 2) {
                        // 图3：第1行第3列，占1行1列
                        cell.style.gridColumn = '3';
                        cell.style.gridRow = '1';
                    } else if (i === 3) {
                        // 图4：第1行第4列，占1行1列
                        cell.style.gridColumn = '4';
                        cell.style.gridRow = '1';
                    } else if (i === 4) {
                        // 图5：第1行第5列，占1行1列
                        cell.style.gridColumn = '5';
                        cell.style.gridRow = '1';
                    } else if (i === 5) {
                        // 图6：第2行第1列，占1行1列
                        cell.style.gridColumn = '1';
                        cell.style.gridRow = '2';
                    } else if (i === 6) {
                        // 图7：第2行第2列，占1行1列
                        cell.style.gridColumn = '2';
                        cell.style.gridRow = '2';
                    } else if (i === 7) {
                        // 图8：第2行第3列，占1行1列
                        cell.style.gridColumn = '3';
                        cell.style.gridRow = '2';
                    } else if (i === 8) {
                        // 图9：第2行第4列，占1行1列
                        cell.style.gridColumn = '4';
                        cell.style.gridRow = '2';
                    } else if (i === 9) {
                        // 图10：第2行第5列，占1行1列
                        cell.style.gridColumn = '5';
                        cell.style.gridRow = '2';
                    } else if (i === 10) {
                        // 图11：第3行第1列，占1行1列
                        cell.style.gridColumn = '1';
                        cell.style.gridRow = '3';
                    } else if (i === 11) {
                        // 图12：第3行第2列，占1行1列
                        cell.style.gridColumn = '2';
                        cell.style.gridRow = '3';
                    } else if (i === 12) {
                        // 图13：第3行第3列，占1行1列
                        cell.style.gridColumn = '3';
                        cell.style.gridRow = '3';
                    } else if (i === 13) {
                        // 图14：第3行第4列，占1行1列
                        cell.style.gridColumn = '4';
                        cell.style.gridRow = '3';
                    } else if (i === 14) {
                        // 图15：第3行第5列，占1行1列
                        cell.style.gridColumn = '5';
                        cell.style.gridRow = '3';
                    }
                } else if (currentLayout === '15-7') {
                    // 15图布局第7方案：4×4网格，第2行右侧2列大图
                    if (i === 0) {
                        // 图1：第1行第1列，占1行1列
                        cell.style.gridColumn = '1';
                        cell.style.gridRow = '1';
                    } else if (i === 1) {
                        // 图2：第1行第2列，占1行1列
                        cell.style.gridColumn = '2';
                        cell.style.gridRow = '1';
                    } else if (i === 2) {
                        // 图3：第1行第3列，占1行1列
                        cell.style.gridColumn = '3';
                        cell.style.gridRow = '1';
                    } else if (i === 3) {
                        // 图4：第1行第4列，占1行1列
                        cell.style.gridColumn = '4';
                        cell.style.gridRow = '1';
                    } else if (i === 4) {
                        // 图5：第2行第1列，占1行1列
                        cell.style.gridColumn = '1';
                        cell.style.gridRow = '2';
                    } else if (i === 5) {
                        // 图6：第2行第2列，占1行1列
                        cell.style.gridColumn = '2';
                        cell.style.gridRow = '2';
                    } else if (i === 6) {
                        // 图7：第2行第3-4列，占1行2列
                        cell.style.gridColumn = '3 / 5';
                        cell.style.gridRow = '2';
                    } else if (i === 7) {
                        // 图8：第3行第1列，占1行1列
                        cell.style.gridColumn = '1';
                        cell.style.gridRow = '3';
                    } else if (i === 8) {
                        // 图9：第3行第2列，占1行1列
                        cell.style.gridColumn = '2';
                        cell.style.gridRow = '3';
                    } else if (i === 9) {
                        // 图10：第3行第3列，占1行1列
                        cell.style.gridColumn = '3';
                        cell.style.gridRow = '3';
                    } else if (i === 10) {
                        // 图11：第3行第4列，占1行1列
                        cell.style.gridColumn = '4';
                        cell.style.gridRow = '3';
                    } else if (i === 11) {
                        // 图12：第4行第1列，占1行1列
                        cell.style.gridColumn = '1';
                        cell.style.gridRow = '4';
                    } else if (i === 12) {
                        // 图13：第4行第2列，占1行1列
                        cell.style.gridColumn = '2';
                        cell.style.gridRow = '4';
                    } else if (i === 13) {
                        // 图14：第4行第3列，占1行1列
                        cell.style.gridColumn = '3';
                        cell.style.gridRow = '4';
                    } else if (i === 14) {
                        // 图15：第4行第4列，占1行1列
                        cell.style.gridColumn = '4';
                        cell.style.gridRow = '4';
                    }
                } else if (currentLayout === '15-8') {
                    // 15图布局第8方案：4×4网格，第3行右侧2列大图
                    if (i === 0) {
                        // 图1：第1行第1列，占1行1列
                        cell.style.gridColumn = '1';
                        cell.style.gridRow = '1';
                    } else if (i === 1) {
                        // 图2：第1行第2列，占1行1列
                        cell.style.gridColumn = '2';
                        cell.style.gridRow = '1';
                    } else if (i === 2) {
                        // 图3：第1行第3列，占1行1列
                        cell.style.gridColumn = '3';
                        cell.style.gridRow = '1';
                    } else if (i === 3) {
                        // 图4：第1行第4列，占1行1列
                        cell.style.gridColumn = '4';
                        cell.style.gridRow = '1';
                    } else if (i === 4) {
                        // 图5：第2行第1列，占1行1列
                        cell.style.gridColumn = '1';
                        cell.style.gridRow = '2';
                    } else if (i === 5) {
                        // 图6：第2行第2列，占1行1列
                        cell.style.gridColumn = '2';
                        cell.style.gridRow = '2';
                    } else if (i === 6) {
                        // 图7：第2行第3列，占1行1列
                        cell.style.gridColumn = '3';
                        cell.style.gridRow = '2';
                    } else if (i === 7) {
                        // 图8：第2行第4列，占1行1列
                        cell.style.gridColumn = '4';
                        cell.style.gridRow = '2';
                    } else if (i === 8) {
                        // 图9：第3行第1列，占1行1列
                        cell.style.gridColumn = '1';
                        cell.style.gridRow = '3';
                    } else if (i === 9) {
                        // 图10：第3行第2列，占1行1列
                        cell.style.gridColumn = '2';
                        cell.style.gridRow = '3';
                    } else if (i === 10) {
                        // 图11：第3行第3-4列，占1行2列
                        cell.style.gridColumn = '3 / 5';
                        cell.style.gridRow = '3';
                    } else if (i === 11) {
                        // 图12：第4行第1列，占1行1列
                        cell.style.gridColumn = '1';
                        cell.style.gridRow = '4';
                    } else if (i === 12) {
                        // 图13：第4行第2列，占1行1列
                        cell.style.gridColumn = '2';
                        cell.style.gridRow = '4';
                    } else if (i === 13) {
                        // 图14：第4行第3列，占1行1列
                        cell.style.gridColumn = '3';
                        cell.style.gridRow = '4';
                    } else if (i === 14) {
                        // 图15：第4行第4列，占1行1列
                        cell.style.gridColumn = '4';
                        cell.style.gridRow = '4';
                    }
                } else if (currentLayout === '14-1') {
                    // 14图布局第1方案：4×4网格，上下满中间宽窄
                    if (i === 0) {
                        // 图1：第1行第1列，占1行1列
                        cell.style.gridColumn = '1';
                        cell.style.gridRow = '1';
                    } else if (i === 1) {
                        // 图2：第1行第2列，占1行1列
                        cell.style.gridColumn = '2';
                        cell.style.gridRow = '1';
                    } else if (i === 2) {
                        // 图3：第1行第3列，占1行1列
                        cell.style.gridColumn = '3';
                        cell.style.gridRow = '1';
                    } else if (i === 3) {
                        // 图4：第1行第4列，占1行1列
                        cell.style.gridColumn = '4';
                        cell.style.gridRow = '1';
                    } else if (i === 4) {
                        // 图5：第2行第1列，占1行1列
                        cell.style.gridColumn = '1';
                        cell.style.gridRow = '2';
                    } else if (i === 5) {
                        // 图6：第2行第2-3列，占1行2列
                        cell.style.gridColumn = '2 / 4';
                        cell.style.gridRow = '2';
                    } else if (i === 6) {
                        // 图7：第2行第4列，占1行1列
                        cell.style.gridColumn = '4';
                        cell.style.gridRow = '2';
                    } else if (i === 7) {
                        // 图8：第3行第1列，占1行1列
                        cell.style.gridColumn = '1';
                        cell.style.gridRow = '3';
                    } else if (i === 8) {
                        // 图9：第3行第2-3列，占1行2列
                        cell.style.gridColumn = '2 / 4';
                        cell.style.gridRow = '3';
                    } else if (i === 9) {
                        // 图10：第3行第4列，占1行1列
                        cell.style.gridColumn = '4';
                        cell.style.gridRow = '3';
                    } else if (i === 10) {
                        // 图11：第4行第1列，占1行1列
                        cell.style.gridColumn = '1';
                        cell.style.gridRow = '4';
                    } else if (i === 11) {
                        // 图12：第4行第2列，占1行1列
                        cell.style.gridColumn = '2';
                        cell.style.gridRow = '4';
                    } else if (i === 12) {
                        // 图13：第4行第3列，占1行1列
                        cell.style.gridColumn = '3';
                        cell.style.gridRow = '4';
                    } else if (i === 13) {
                        // 图14：第4行第4列，占1行1列
                        cell.style.gridColumn = '4';
                        cell.style.gridRow = '4';
                    }
                } else if (currentLayout === '14-2') {
                    // 14图布局第2方案：2×7网格，左右对称简单网格
                    if (i === 0) {
                        // 图1：第1行第1列，占1行1列
                        cell.style.gridColumn = '1';
                        cell.style.gridRow = '1';
                    } else if (i === 1) {
                        // 图2：第2行第1列，占1行1列
                        cell.style.gridColumn = '1';
                        cell.style.gridRow = '2';
                    } else if (i === 2) {
                        // 图3：第3行第1列，占1行1列
                        cell.style.gridColumn = '1';
                        cell.style.gridRow = '3';
                    } else if (i === 3) {
                        // 图4：第4行第1列，占1行1列
                        cell.style.gridColumn = '1';
                        cell.style.gridRow = '4';
                    } else if (i === 4) {
                        // 图5：第5行第1列，占1行1列
                        cell.style.gridColumn = '1';
                        cell.style.gridRow = '5';
                    } else if (i === 5) {
                        // 图6：第6行第1列，占1行1列
                        cell.style.gridColumn = '1';
                        cell.style.gridRow = '6';
                    } else if (i === 6) {
                        // 图7：第7行第1列，占1行1列
                        cell.style.gridColumn = '1';
                        cell.style.gridRow = '7';
                    } else if (i === 7) {
                        // 图8：第1行第2列，占1行1列
                        cell.style.gridColumn = '2';
                        cell.style.gridRow = '1';
                    } else if (i === 8) {
                        // 图9：第2行第2列，占1行1列
                        cell.style.gridColumn = '2';
                        cell.style.gridRow = '2';
                    } else if (i === 9) {
                        // 图10：第3行第2列，占1行1列
                        cell.style.gridColumn = '2';
                        cell.style.gridRow = '3';
                    } else if (i === 10) {
                        // 图11：第4行第2列，占1行1列
                        cell.style.gridColumn = '2';
                        cell.style.gridRow = '4';
                    } else if (i === 11) {
                        // 图12：第5行第2列，占1行1列
                        cell.style.gridColumn = '2';
                        cell.style.gridRow = '5';
                    } else if (i === 12) {
                        // 图13：第6行第2列，占1行1列
                        cell.style.gridColumn = '2';
                        cell.style.gridRow = '6';
                    } else if (i === 13) {
                        // 图14：第7行第2列，占1行1列
                        cell.style.gridColumn = '2';
                        cell.style.gridRow = '7';
                    }
                } else if (currentLayout === '14-3') {
                    // 14图布局第3方案：4×4网格，中间两列高图+角落填充
                    if (i === 0) {
                        // 图1：第1行第1列，占1行1列
                        cell.style.gridColumn = '1';
                        cell.style.gridRow = '1';
                    } else if (i === 1) {
                        // 图2：第1行第2列，占1行1列
                        cell.style.gridColumn = '2';
                        cell.style.gridRow = '1';
                    } else if (i === 2) {
                        // 图3：第1行第3列，占1行1列
                        cell.style.gridColumn = '3';
                        cell.style.gridRow = '1';
                    } else if (i === 3) {
                        // 图4：第1行第4列，占1行1列
                        cell.style.gridColumn = '4';
                        cell.style.gridRow = '1';
                    } else if (i === 4) {
                        // 图5：第2行第1列，占1行1列
                        cell.style.gridColumn = '1';
                        cell.style.gridRow = '2';
                    } else if (i === 5) {
                        // 图6：第2-3行第2列，占2行1列
                        cell.style.gridColumn = '2';
                        cell.style.gridRow = '2 / 4';
                    } else if (i === 6) {
                        // 图7：第2-3行第3列，占2行1列
                        cell.style.gridColumn = '3';
                        cell.style.gridRow = '2 / 4';
                    } else if (i === 7) {
                        // 图8：第2行第4列，占1行1列
                        cell.style.gridColumn = '4';
                        cell.style.gridRow = '2';
                    } else if (i === 8) {
                        // 图9：第3行第1列，占1行1列
                        cell.style.gridColumn = '1';
                        cell.style.gridRow = '3';
                    } else if (i === 9) {
                        // 图10：第3行第4列，占1行1列
                        cell.style.gridColumn = '4';
                        cell.style.gridRow = '3';
                    } else if (i === 10) {
                        // 图11：第4行第1列，占1行1列
                        cell.style.gridColumn = '1';
                        cell.style.gridRow = '4';
                    } else if (i === 11) {
                        // 图12：第4行第2列，占1行1列
                        cell.style.gridColumn = '2';
                        cell.style.gridRow = '4';
                    } else if (i === 12) {
                        // 图13：第4行第3列，占1行1列
                        cell.style.gridColumn = '3';
                        cell.style.gridRow = '4';
                    } else if (i === 13) {
                        // 图14：第4行第4列，占1行1列
                        cell.style.gridColumn = '4';
                        cell.style.gridRow = '4';
                    }
                } else if (currentLayout === '15-9') {
                    // 15图布局第9方案：4×4网格，第4行右侧2列大图
                    if (i === 0) {
                        // 图1：第1行第1列，占1行1列
                        cell.style.gridColumn = '1';
                        cell.style.gridRow = '1';
                    } else if (i === 1) {
                        // 图2：第1行第2列，占1行1列
                        cell.style.gridColumn = '2';
                        cell.style.gridRow = '1';
                    } else if (i === 2) {
                        // 图3：第1行第3列，占1行1列
                        cell.style.gridColumn = '3';
                        cell.style.gridRow = '1';
                    } else if (i === 3) {
                        // 图4：第1行第4列，占1行1列
                        cell.style.gridColumn = '4';
                        cell.style.gridRow = '1';
                    } else if (i === 4) {
                        // 图5：第2行第1列，占1行1列
                        cell.style.gridColumn = '1';
                        cell.style.gridRow = '2';
                    } else if (i === 5) {
                        // 图6：第2行第2列，占1行1列
                        cell.style.gridColumn = '2';
                        cell.style.gridRow = '2';
                    } else if (i === 6) {
                        // 图7：第2行第3列，占1行1列
                        cell.style.gridColumn = '3';
                        cell.style.gridRow = '2';
                    } else if (i === 7) {
                        // 图8：第2行第4列，占1行1列
                        cell.style.gridColumn = '4';
                        cell.style.gridRow = '2';
                    } else if (i === 8) {
                        // 图9：第3行第1列，占1行1列
                        cell.style.gridColumn = '1';
                        cell.style.gridRow = '3';
                    } else if (i === 9) {
                        // 图10：第3行第2列，占1行1列
                        cell.style.gridColumn = '2';
                        cell.style.gridRow = '3';
                    } else if (i === 10) {
                        // 图11：第3行第3列，占1行1列
                        cell.style.gridColumn = '3';
                        cell.style.gridRow = '3';
                    } else if (i === 11) {
                        // 图12：第3行第4列，占1行1列
                        cell.style.gridColumn = '4';
                        cell.style.gridRow = '3';
                    } else if (i === 12) {
                        // 图13：第4行第1列，占1行1列
                        cell.style.gridColumn = '1';
                        cell.style.gridRow = '4';
                    } else if (i === 13) {
                        // 图14：第4行第2列，占1行1列
                        cell.style.gridColumn = '2';
                        cell.style.gridRow = '4';
                    } else if (i === 14) {
                        // 图15：第4行第3-4列，占1行2列
                        cell.style.gridColumn = '3 / 5';
                        cell.style.gridRow = '4';
                    }
                }

                grid.appendChild(cell);
            }

            applySpacingToPreview();
            updateImageCounter();
            
            // 如果有手动调整，恢复网格状态
            if (hasManualAdjustment) {
                restoreGridState();
            } else {
                // 重新初始化网格信息（用于虚线定位）
                refreshGridInfo();
                
                // 默认显示调整手柄和虚线
                setTimeout(() => {
                    // 显示所有调整手柄
                    document.querySelectorAll('.cell-resize-handles').forEach(handles => {
                        handles.style.opacity = '1';
                        handles.style.pointerEvents = 'auto';
                    });
                    // 生成虚线
                    if (cellResizeEnabled) {
                        addGridDividers();
                    }
                }, 100);
            }
            
            // 更新预览尺寸
            setTimeout(updatePreviewSize, 50);
        }

        function createGridCell(index) {
            const cell = document.createElement('div');
            cell.className = 'grid-cell';
            cell.dataset.index = index;

            const existingImage = uploadedImages[index];

            if (existingImage) {
                cell.classList.add('has-image');
                cell.innerHTML = `
                    <img src="${existingImage.src}" alt="图片 ${index + 1}">
                    <div class="image-tools">
                        <button class="tool-btn" onclick="event.stopPropagation(); zoomImageInCell(${index}, 1.2)" title="放大">
                            <i class="fas fa-search-plus"></i>
                        </button>
                        <button class="tool-btn" onclick="event.stopPropagation(); zoomImageInCell(${index}, 0.8)" title="缩小">
                            <i class="fas fa-search-minus"></i>
                        </button>
                        <button class="tool-btn" onclick="event.stopPropagation(); resetImageInCell(${index})" title="还原">
                            <i class="fas fa-expand-arrows-alt"></i>
                        </button>
                        <button class="tool-btn" onclick="event.stopPropagation(); replaceImage(${index})" title="替换">
                            <i class="fas fa-sync"></i>
                        </button>
                        <button class="tool-btn danger" onclick="event.stopPropagation(); removeImage(${index})" title="删除">
                            <i class="fas fa-times"></i>
                        </button>
                    </div>
                    <div class="cell-index">${index + 1}</div>
                `;
            } else {
                cell.innerHTML = `
                    <div class="upload-hint">
                        <i class="fas fa-cloud-upload-alt"></i>
                        <div>点击上传图片</div>
                        <div style="font-size: 11px; margin-top: 4px;">或拖拽到此处</div>
                    </div>
                    <div class="cell-index">${index + 1}</div>
                `;
            }

            // 添加调整手柄
            const resizeHandles = document.createElement('div');
            resizeHandles.className = 'cell-resize-handles';
            resizeHandles.innerHTML = `
                <div class="cell-resize-handle right" data-direction="right" data-cell-index="${index}"></div>
                <div class="cell-resize-handle bottom" data-direction="bottom" data-cell-index="${index}"></div>
                <div class="cell-resize-handle corner" data-direction="corner" data-cell-index="${index}"></div>
            `;
            cell.appendChild(resizeHandles);

            // 点击上传
            cell.addEventListener('click', function (e) {
                if (!e.target.closest('.tool-btn')) {
                    uploadToCell(index);
                }
            });

            // 拖拽处理
            cell.addEventListener('dragover', function (e) {
                e.preventDefault();
                this.style.borderColor = 'var(--primary)';
            });

            cell.addEventListener('dragleave', function (e) {
                this.style.borderColor = '';
            });

            cell.addEventListener('drop', function (e) {
                e.preventDefault();
                this.style.borderColor = '';
                handleCellDrop(e, index);
            });

            return cell;
        }

        function zoomImageInCell(index, factor) {
            console.log(`缩放图片: index=${index}, factor=${factor}`); // 调试信息
            const cell = document.querySelector(`[data-index="${index}"]`);
            const img = cell.querySelector('img');
            if (img) {
                const currentScale = img.style.transform ?
                    parseFloat(img.style.transform.match(/scale\(([^)]+)\)/)?.[1] || 1) : 1;
                const newScale = Math.max(0.5, Math.min(3, currentScale * factor));
                img.style.transform = `scale(${newScale})`;
                img.style.transformOrigin = 'center';

                // 保存缩放值到数据中
                if (uploadedImages[index]) {
                    uploadedImages[index].scale = newScale;
                }
                console.log(`缩放完成: newScale=${newScale}`); // 调试信息
            } else {
                console.log(`找不到图片元素: index=${index}`); // 调试信息
            }
        }

        function resetImageInCell(index) {
            console.log(`还原图片: index=${index}`); // 调试信息
            const cell = document.querySelector(`[data-index="${index}"]`);
            const img = cell.querySelector('img');
            if (img) {
                img.style.transform = 'scale(1)';
                if (uploadedImages[index]) {
                    uploadedImages[index].scale = 1;
                }
                console.log(`还原完成: index=${index}`); // 调试信息
            } else {
                console.log(`找不到图片元素: index=${index}`); // 调试信息
            }
        }

        function uploadToCell(index) {
            console.log(`上传文件到单元格: index=${index}`); // 调试信息
            const input = document.getElementById('fileInput');
            if (input) {
                input.dataset.targetIndex = index;
                input.click();
                console.log(`文件选择器已打开: index=${index}`); // 调试信息
            } else {
                console.log(`找不到文件输入元素: fileInput`); // 调试信息
            }
        }

        function handleFileSelect(e) {
            const files = Array.from(e.target.files);
            const targetIndex = parseInt(e.target.dataset.targetIndex || 0);

            if (files.length > 0) {
                processImageFile(files[0], targetIndex);
            }
        }

        function handleDragOver(e) {
            e.preventDefault();
        }

        function handleDrop(e) {
            e.preventDefault();
        }

        function handleCellDrop(e, index) {
            const files = Array.from(e.dataTransfer.files);
            if (files.length > 0 && files[0].type.startsWith('image/')) {
                processImageFile(files[0], index);
            }
        }

        function processImageFile(file, index) {
            if (!file.type.startsWith('image/')) {
                layer.msg('请选择图片文件', { icon: 5 });
                return;
            }

            const reader = new FileReader();
            reader.onload = function (e) {
                const img = new Image();
                img.onload = function () {
                    uploadedImages[index] = {
                        src: e.target.result,
                        width: img.width,
                        height: img.height,
                        file: file,
                        scale: 1
                    };

                    updatePreviewGrid();
                };
                img.src = e.target.result;
            };
            reader.readAsDataURL(file);
        }

        function replaceImage(index) {
            console.log(`替换图片: index=${index}`); // 调试信息
            uploadToCell(index);
        }

        function removeImage(index) {
            console.log(`删除图片: index=${index}`); // 调试信息
            uploadedImages[index] = null;
            updatePreviewGrid();
            console.log(`删除完成: index=${index}`); // 调试信息
        }

        function updateImageCounter() {
            const count = uploadedImages.filter(img => img !== null && img !== undefined).length;
            document.getElementById('imageCount').textContent = count;
        }

        async function mergeImages() {
            const validImages = uploadedImages.filter(img => img !== null && img !== undefined);

            if (validImages.length === 0) {
                layer.msg('请至少上传一张图片', { icon: 5 });
                return;
            }

            const loadingOverlay = document.getElementById('loadingOverlay');
            loadingOverlay.classList.add('show');

            try {
                const canvas = document.createElement('canvas');
                const ctx = canvas.getContext('2d');

                // 从预览画布获取已经同步的输出尺寸
                const previewCanvas = document.getElementById('previewCanvas');
                const canvasWidth = previewCanvas ?
                    parseInt(previewCanvas.dataset.outputWidth) :
                    parseInt(document.getElementById('canvasWidth').value) || 1200;
                const canvasHeight = previewCanvas ?
                    parseInt(previewCanvas.dataset.outputHeight) :
                    parseInt(document.getElementById('canvasHeight').value) || 800;

                const spacing = parseInt(document.getElementById('imageSpacing').value) || 10;
                const bgColor = document.getElementById('bgColor').value;
                const quality = parseFloat(document.getElementById('imageQuality').value) || 0.9;
                const format = document.getElementById('outputFormat').value;

                // 确保使用与预览完全相同的尺寸
                canvas.width = canvasWidth;
                canvas.height = canvasHeight;

                ctx.fillStyle = bgColor;
                ctx.fillRect(0, 0, canvasWidth, canvasHeight);

                // 使用当前实际的网格状态计算布局
                console.log('合并时的状态检查:', {
                    hasManualAdjustment,
                    currentLayout,
                    gridColumnsInfo: gridColumnsInfo.length > 0 ? gridColumnsInfo : '空',
                    gridRowsInfo: gridRowsInfo.length > 0 ? gridRowsInfo : '空',
                    savedGridState: savedGridState ? '存在' : '不存在'
                });
                
                        // 🔑 关键修复：确保DOM状态完全更新后再读取位置
                if (hasManualAdjustment) {
                    console.log('🔍 手动调整模式，准备使用DOM直接读取方案...');
                    
                    // 强制浏览器重新计算布局
                    const grid = document.getElementById('previewGrid');
                    if (grid) {
                        grid.offsetHeight; // 触发reflow
                    }
                    
                    // 验证DOM方案的可用性
                    const domValid = validateDOMBasedLayout();
                    if (!domValid) {
                        console.warn('⚠️ DOM方案验证失败，将回退到数学计算方法');
                    }
                    
                    // 调试：对比实际位置与计算位置
                    const debugResult = debugGridPositions();
                    
                    // 分析差异原因
                    if (debugResult) {
                        const { actualPositions, calculatedLayout, gridRect } = debugResult;
                        console.log('🔍 深度分析差异原因:', {
                            预览容器实际尺寸: { width: gridRect.width, height: gridRect.height },
                            输出尺寸设置: { width: canvasWidth, height: canvasHeight },
                            缩放比例: { 
                                width: canvasWidth / gridRect.width,
                                height: canvasHeight / gridRect.height 
                            },
                            网格信息状态: {
                                columnsInfo: gridColumnsInfo,
                                rowsInfo: gridRowsInfo
                            },
                            CSS_Grid实际gap: window.getComputedStyle(document.getElementById('previewGrid')).gap,
                            计算使用的spacing: spacing,
                            DOM方案状态: domValid ? '✅ 可用' : '❌ 不可用'
                        });
                    }
                }
                
                // 如果有手动调整但网格信息丢失，尝试恢复
                if (hasManualAdjustment && (!gridColumnsInfo.length || !gridRowsInfo.length) && savedGridState) {
                    console.warn('网格信息丢失，正在恢复...');
                    gridColumnsInfo = [...savedGridState.columnsInfo];
                    gridRowsInfo = [...savedGridState.rowsInfo];
                }
                
                const layout = hasManualAdjustment ? 
                    calculateLayoutFromCurrentGrid(canvasWidth, canvasHeight, spacing) :
                    calculateLayout(currentLayout, canvasWidth, canvasHeight, spacing);
                    
                console.log('使用的布局计算方法:', hasManualAdjustment ? '手动调整的网格' : '默认布局');
                
                // 验证布局计算结果
                if (!layout || !layout.positions || layout.positions.length === 0) {
                    console.error('布局计算失败，无法继续合成');
                    throw new Error('布局计算失败');
                }

                // 使用标准的图片数量，不再特殊处理4-8布局
                const actualCount = currentCount;

                const imagePromises = [];
                for (let i = 0; i < actualCount; i++) {
                    if (uploadedImages[i]) {
                        const promise = new Promise((resolve) => {
                            const img = new Image();
                            img.onload = function () {
                                const pos = layout.positions[i];
                                if (pos) {
                                    const scale = uploadedImages[i].scale || 1;
                                    drawImageToCell(ctx, img, pos, scale);
                                }
                                resolve();
                            };
                            img.src = uploadedImages[i].src;
                        });
                        imagePromises.push(promise);
                    }
                }

                await Promise.all(imagePromises);

                const dataURL = canvas.toDataURL(format, quality);
                mergedImageData = dataURL;

                // 验证输出尺寸与预览尺寸的一致性
                console.log(`输出验证: ${canvasWidth}×${canvasHeight}px`);

                showFullscreenPreview(dataURL);

            } catch (error) {
                console.error('合并失败:', error);
                layer.msg('合并失败: ' + error.message, { icon: 5 });
            } finally {
                loadingOverlay.classList.remove('show');
            }
        }

        // 保存网格状态（改进版）
        function saveGridState() {
            const grid = document.getElementById('previewGrid');
            if (!grid) return;
            
            const gridStyle = window.getComputedStyle(grid);
            
            // 保存更完整的网格状态
            savedGridState = {
                // 优先使用内联样式，再使用计算样式
                gridTemplateColumns: grid.style.gridTemplateColumns || gridStyle.gridTemplateColumns,
                gridTemplateRows: grid.style.gridTemplateRows || gridStyle.gridTemplateRows,
                
                // 保存网格信息数组
                columnsInfo: [...gridColumnsInfo],
                rowsInfo: [...gridRowsInfo],
                
                // 保存当前布局信息
                currentLayout: currentLayout,
                currentCount: currentCount,
                
                // 保存时间戳
                timestamp: Date.now(),
                
                // 标记
                hasManualAdjustment: hasManualAdjustment
            };
            
            console.log('保存网格状态:', {
                columns: savedGridState.gridTemplateColumns,
                rows: savedGridState.gridTemplateRows,
                columnsInfo: savedGridState.columnsInfo,
                rowsInfo: savedGridState.rowsInfo,
                layout: savedGridState.currentLayout
            });
        }
        
        // 恢复网格状态
        function restoreGridState() {
            if (!savedGridState || !hasManualAdjustment) return;
            
            const grid = document.getElementById('previewGrid');
            if (!grid) return;
            
            // 恢复网格样式
            grid.style.gridTemplateColumns = savedGridState.gridTemplateColumns;
            grid.style.gridTemplateRows = savedGridState.gridTemplateRows;
            
            // 恢复网格信息
            gridColumnsInfo = [...savedGridState.columnsInfo];
            gridRowsInfo = [...savedGridState.rowsInfo];
            
            console.log('恢复网格状态:', {
                columns: savedGridState.gridTemplateColumns,
                rows: savedGridState.gridTemplateRows,
                columnsInfo: gridColumnsInfo,
                rowsInfo: gridRowsInfo
            });
            
            // 立即清除旧的拖拽线
            document.querySelectorAll('.grid-divider, .grid-divider-line').forEach(divider => divider.remove());
            
            // 重新添加拖拽线，使用恢复的网格信息
            setTimeout(() => {
                if (cellResizeEnabled) {
                    addGridDividersWithCurrentInfo();
                }
                
                // 显示所有调整手柄
                document.querySelectorAll('.cell-resize-handles').forEach(handles => {
                    handles.style.opacity = '1';
                    handles.style.pointerEvents = 'auto';
                });
            }, 100);
        }
        
        // 清除保存的网格状态
        function clearGridState() {
            savedGridState = null;
            hasManualAdjustment = false;
            gridColumnsInfo = [];
            gridRowsInfo = [];
            console.log('清除网格状态');
        }
        
        // 改进的网格位置解析函数
        function parseGridPosition(element) {
            const style = element.style;
            const computedStyle = window.getComputedStyle(element);
            
            // 尝试解析各种grid定位格式
            let columnStart = 1, columnEnd = 2, rowStart = 1, rowEnd = 2;
            
            // 方法1：从内联样式读取
            if (style.gridArea) {
                const parts = style.gridArea.split('/').map(s => s.trim());
                if (parts.length >= 4) {
                    rowStart = parseInt(parts[0]) || 1;
                    columnStart = parseInt(parts[1]) || 1;
                    rowEnd = parseInt(parts[2]) || rowStart + 1;
                    columnEnd = parseInt(parts[3]) || columnStart + 1;
                }
            } else {
                // 解析gridColumn和gridRow
                if (style.gridColumn) {
                    const colMatch = style.gridColumn.match(/(\d+)\s*\/\s*(\d+|span\s+\d+)/);
                    if (colMatch) {
                        columnStart = parseInt(colMatch[1]) || 1;
                        if (colMatch[2].includes('span')) {
                            const span = parseInt(colMatch[2].replace('span', '').trim()) || 1;
                            columnEnd = columnStart + span;
                        } else {
                            columnEnd = parseInt(colMatch[2]) || columnStart + 1;
                        }
                    } else if (style.gridColumn.includes('span')) {
                        const spanMatch = style.gridColumn.match(/span\s+(\d+)/);
                        if (spanMatch) {
                            const span = parseInt(spanMatch[1]) || 1;
                            columnEnd = columnStart + span;
                        }
                    }
                }
                
                if (style.gridRow) {
                    const rowMatch = style.gridRow.match(/(\d+)\s*\/\s*(\d+|span\s+\d+)/);
                    if (rowMatch) {
                        rowStart = parseInt(rowMatch[1]) || 1;
                        if (rowMatch[2].includes('span')) {
                            const span = parseInt(rowMatch[2].replace('span', '').trim()) || 1;
                            rowEnd = rowStart + span;
                        } else {
                            rowEnd = parseInt(rowMatch[2]) || rowStart + 1;
                        }
                    } else if (style.gridRow.includes('span')) {
                        const spanMatch = style.gridRow.match(/span\s+(\d+)/);
                        if (spanMatch) {
                            const span = parseInt(spanMatch[1]) || 1;
                            rowEnd = rowStart + span;
                        }
                    }
                }
                
                // 单独读取gridColumnStart等属性
                if (style.gridColumnStart) columnStart = parseInt(style.gridColumnStart) || columnStart;
                if (style.gridColumnEnd) columnEnd = parseInt(style.gridColumnEnd) || columnEnd;
                if (style.gridRowStart) rowStart = parseInt(style.gridRowStart) || rowStart;
                if (style.gridRowEnd) rowEnd = parseInt(style.gridRowEnd) || rowEnd;
            }
            
            // 方法2：从computed样式读取（作为备选）
            if (columnStart === 1 && columnEnd === 2 && rowStart === 1 && rowEnd === 2) {
                columnStart = parseInt(computedStyle.gridColumnStart) || 1;
                columnEnd = parseInt(computedStyle.gridColumnEnd) || columnStart + 1;
                rowStart = parseInt(computedStyle.gridRowStart) || 1;
                rowEnd = parseInt(computedStyle.gridRowEnd) || rowStart + 1;
            }
            
            return { columnStart, columnEnd, rowStart, rowEnd };
        }

        // 调试工具：对比CSS Grid实际渲染位置与计算位置
        function debugGridPositions() {
            const grid = document.getElementById('previewGrid');
            if (!grid) return;
            
            const cells = grid.querySelectorAll('.grid-cell');
            const gridRect = grid.getBoundingClientRect();
            
            console.log('=== CSS Grid 实际渲染位置调试 ===');
            console.log('网格容器尺寸:', {
                width: gridRect.width,
                height: gridRect.height,
                left: gridRect.left,
                top: gridRect.top
            });
            
            const actualPositions = [];
            cells.forEach((cell, index) => {
                const cellRect = cell.getBoundingClientRect();
                const relativePos = {
                    x: cellRect.left - gridRect.left,
                    y: cellRect.top - gridRect.top,
                    width: cellRect.width,
                    height: cellRect.height
                };
                actualPositions.push(relativePos);
                console.log(`实际位置 ${index}:`, relativePos);
            });
            
            // 获取当前输出尺寸设置
            const outputWidth = parseInt(document.getElementById('canvasWidth').value) || 1200;
            const outputHeight = parseInt(document.getElementById('canvasHeight').value) || 800;
            const spacing = parseInt(document.getElementById('imageSpacing').value) || 10;
            
            // 计算理论位置
            const calculatedLayout = calculateLayoutFromCurrentGrid(outputWidth, outputHeight, spacing);
            
            console.log('=== 计算位置与实际位置对比 ===');
            console.log('输出尺寸设置:', { outputWidth, outputHeight, spacing });
            console.log('尺寸比例:', {
                widthRatio: outputWidth / gridRect.width,
                heightRatio: outputHeight / gridRect.height
            });
            
            actualPositions.forEach((actual, index) => {
                const calculated = calculatedLayout.positions[index];
                if (calculated) {
                    const scaledActual = {
                        x: actual.x * (outputWidth / gridRect.width),
                        y: actual.y * (outputHeight / gridRect.height),
                        width: actual.width * (outputWidth / gridRect.width),
                        height: actual.height * (outputHeight / gridRect.height)
                    };
                    
                    const diff = {
                        x: Math.abs(calculated.x - scaledActual.x),
                        y: Math.abs(calculated.y - scaledActual.y),
                        width: Math.abs(calculated.width - scaledActual.width),
                        height: Math.abs(calculated.height - scaledActual.height)
                    };
                    
                    console.log(`位置对比 ${index}:`, {
                        实际位置: actual,
                        缩放后实际: scaledActual,
                        计算位置: calculated,
                        差异: diff,
                        是否匹配: diff.x < 2 && diff.y < 2 && diff.width < 2 && diff.height < 2
                    });
                }
            });
            
            return { actualPositions, calculatedLayout, gridRect };
        }
        
        // 🔧 终极调试：验证DOM读取方案的准确性
        function validateDOMBasedLayout() {
            console.log('🔧 验证DOM读取方案...');
            
            const grid = document.getElementById('previewGrid');
            if (!grid) {
                console.error('无法找到预览网格');
                return false;
            }
            
            const gridRect = grid.getBoundingClientRect();
            const cells = grid.querySelectorAll('.grid-cell');
            
            console.log('验证参数:', {
                网格是否可见: gridRect.width > 0 && gridRect.height > 0,
                网格尺寸: { width: gridRect.width, height: gridRect.height },
                单元格数量: cells.length,
                网格样式: {
                    display: window.getComputedStyle(grid).display,
                    gridTemplateColumns: window.getComputedStyle(grid).gridTemplateColumns,
                    gridTemplateRows: window.getComputedStyle(grid).gridTemplateRows,
                    gap: window.getComputedStyle(grid).gap
                }
            });
            
            // 检查每个单元格
            let allCellsValid = true;
            cells.forEach((cell, index) => {
                const cellRect = cell.getBoundingClientRect();
                const isValid = cellRect.width > 0 && cellRect.height > 0;
                
                if (!isValid) {
                    console.warn(`单元格 ${index} 无效:`, cellRect);
                    allCellsValid = false;
                }
            });
            
            const isValid = gridRect.width > 0 && gridRect.height > 0 && allCellsValid;
            console.log('DOM方案验证结果:', isValid ? '✅ 有效' : '❌ 无效');
            
            return isValid;
        }

        // 🔥 革命性解决方案：直接从DOM读取真实渲染位置，100%精确
        function calculateLayoutFromCurrentGrid(width, height, spacing) {
            const positions = [];
            const grid = document.getElementById('previewGrid');
            
            if (!grid) {
                console.error('找不到预览网格');
                return { positions: [] };
            }
            
            console.log('🔥 使用DOM直接读取方案，彻底避免数学计算误差');
            
            // 🔑 核心突破：直接读取浏览器实际渲染的位置
            const gridRect = grid.getBoundingClientRect();
            const cells = grid.querySelectorAll('.grid-cell');
            
            if (cells.length === 0) {
                console.error('找不到网格单元格');
                return { positions: [] };
            }
            
            // 验证网格是否可见和有效
            if (gridRect.width === 0 || gridRect.height === 0) {
                console.error('网格不可见或尺寸为0:', gridRect);
                // 回退到数学计算方法
                return calculateLayoutFromCurrentGridMath(width, height, spacing);
            }
            
            // 计算缩放比例：从预览尺寸到目标输出尺寸
            const scaleX = width / gridRect.width;
            const scaleY = height / gridRect.height;
            
            console.log('DOM读取参数:', {
                预览网格尺寸: { width: gridRect.width, height: gridRect.height },
                目标输出尺寸: { width, height },
                缩放比例: { scaleX, scaleY },
                单元格数量: cells.length
            });
            
            // 验证缩放比例是否合理
            if (scaleX <= 0 || scaleY <= 0 || !isFinite(scaleX) || !isFinite(scaleY)) {
                console.error('缩放比例异常:', { scaleX, scaleY });
                return calculateLayoutFromCurrentGridMath(width, height, spacing);
            }
            
            cells.forEach((cell, index) => {
                // 读取每个cell的真实渲染位置
                const cellRect = cell.getBoundingClientRect();
                
                // 验证单元格是否有效
                if (cellRect.width === 0 || cellRect.height === 0) {
                    console.warn(`单元格 ${index} 尺寸为0:`, cellRect);
                }
                
                // 计算相对于网格容器的位置
                const relativeX = cellRect.left - gridRect.left;
                const relativeY = cellRect.top - gridRect.top;
                
                // 缩放到目标尺寸
                const scaledPosition = {
                    x: relativeX * scaleX,
                    y: relativeY * scaleY,
                    width: cellRect.width * scaleX,
                    height: cellRect.height * scaleY
                };
                
                positions[index] = {
                    x: Math.round(scaledPosition.x),
                    y: Math.round(scaledPosition.y),
                    width: Math.round(scaledPosition.width),
                    height: Math.round(scaledPosition.height)
                };
                
                console.log(`🎯 DOM读取 ${index}:`, {
                    原始相对位置: { x: Math.round(relativeX), y: Math.round(relativeY), width: Math.round(cellRect.width), height: Math.round(cellRect.height) },
                    缩放后位置: positions[index]
                });
            });
            
            console.log('🎉 DOM直接读取布局完成，与预览100%一致:', positions);
            return { positions };
        }
        
        // 保留原来的数学计算方法作为备用（调试用）
        function calculateLayoutFromCurrentGridMath(width, height, spacing) {
            const positions = [];
            const grid = document.getElementById('previewGrid');
            
            if (!grid) {
                console.error('找不到预览网格');
                return { positions: [] };
            }
            
            // 优先使用保存的网格信息，如果没有则从 DOM 读取
            let columnSizes, rowSizes;
            
            if (hasManualAdjustment && gridColumnsInfo.length > 0 && gridRowsInfo.length > 0) {
                // 使用保存的网格信息
                columnSizes = [...gridColumnsInfo];
                rowSizes = [...gridRowsInfo];
                console.log('使用保存的网格信息计算布局');
            } else {
                // 从 DOM 读取当前网格样式
                const gridStyle = window.getComputedStyle(grid);
                const gridTemplateColumns = grid.style.gridTemplateColumns || gridStyle.gridTemplateColumns;
                const gridTemplateRows = grid.style.gridTemplateRows || gridStyle.gridTemplateRows;
                
                console.log('从 DOM 读取网格模板 - 列:', gridTemplateColumns, '行:', gridTemplateRows);
                
                columnSizes = parseGridTemplate(gridTemplateColumns);
                rowSizes = parseGridTemplate(gridTemplateRows);
            }
            
            // 验证网格信息的有效性
            if (!columnSizes.length || !rowSizes.length) {
                console.error('网格信息无效:', { columnSizes, rowSizes });
                return { positions: [] };
            }
            
            const totalColumnWeight = columnSizes.reduce((sum, val) => sum + val, 0);
            const totalRowWeight = rowSizes.reduce((sum, val) => sum + val, 0);
            
            // 重新计算间距策略：匹配CSS Grid的gap行为
            const columnCount = columnSizes.length;
            const rowCount = rowSizes.length;
            
            // CSS Grid gap只在单元格之间存在，不在边缘
            const totalGapWidth = spacing * Math.max(0, columnCount - 1);
            const totalGapHeight = spacing * Math.max(0, rowCount - 1);
            const availableWidth = width - totalGapWidth;
            const availableHeight = height - totalGapHeight;
            
            // 确保有效尺寸
            if (availableWidth <= 0 || availableHeight <= 0) {
                console.error('有效尺寸不足:', { width, height, spacing, availableWidth, availableHeight });
                return { positions: [] };
            }
            
            // 计算每个单位fr的实际像素值
            const frWidthUnit = availableWidth / totalColumnWeight;
            const frHeightUnit = availableHeight / totalRowWeight;
            
            // 预计算所有列的累积宽度和行的累积高度
            const columnStartPositions = [0];
            for (let i = 0; i < columnCount; i++) {
                const columnWidth = columnSizes[i] * frWidthUnit;
                const nextPosition = columnStartPositions[i] + columnWidth + (i < columnCount - 1 ? spacing : 0);
                columnStartPositions.push(nextPosition);
            }
            
            const rowStartPositions = [0];
            for (let i = 0; i < rowCount; i++) {
                const rowHeight = rowSizes[i] * frHeightUnit;
                const nextPosition = rowStartPositions[i] + rowHeight + (i < rowCount - 1 ? spacing : 0);
                rowStartPositions.push(nextPosition);
            }
            
            console.log('网格尺寸计算:', {
                totalColumnWeight,
                totalRowWeight,
                frWidthUnit,
                frHeightUnit,
                columnStartPositions,
                rowStartPositions,
                availableWidth,
                availableHeight
            });
            
            // 遍历所有网格单元格，计算它们的位置
            const cells = grid.querySelectorAll('.grid-cell');
            cells.forEach((cell, index) => {
                // 使用改进的位置解析函数
                const { columnStart, columnEnd, rowStart, rowEnd } = parseGridPosition(cell);
                
                // 确保索引在有效范围内
                const safeColumnStart = Math.max(1, Math.min(columnStart, columnCount));
                const safeColumnEnd = Math.max(safeColumnStart + 1, Math.min(columnEnd, columnCount + 1));
                const safeRowStart = Math.max(1, Math.min(rowStart, rowCount));
                const safeRowEnd = Math.max(safeRowStart + 1, Math.min(rowEnd, rowCount + 1));
                
                // 直接从预计算的位置获取坐标
                const x = columnStartPositions[safeColumnStart - 1];
                const y = rowStartPositions[safeRowStart - 1];
                
                // 计算宽度和高度
                const endX = safeColumnEnd <= columnCount ? 
                    columnStartPositions[safeColumnEnd - 1] - spacing : 
                    columnStartPositions[columnCount];
                const endY = safeRowEnd <= rowCount ? 
                    rowStartPositions[safeRowEnd - 1] - spacing : 
                    rowStartPositions[rowCount];
                
                const cellWidth = endX - x;
                const cellHeight = endY - y;
                
                positions[index] = {
                    x: Math.round(x),
                    y: Math.round(y),
                    width: Math.round(cellWidth),
                    height: Math.round(cellHeight)
                };
                
                console.log(`单元格 ${index}: 网格(${safeColumnStart}-${safeColumnEnd}, ${safeRowStart}-${safeRowEnd}) -> 位置(${positions[index].x}, ${positions[index].y}, ${positions[index].width}, ${positions[index].height})`);
            });
            
            console.log('网格布局计算完成:', positions);
            return { positions };
        }
        
        function calculateLayout(layoutType, width, height, spacing) {
            const positions = [];

            switch (layoutType) {
                case '2-1':
                    const w2h = (width - spacing) / 2;
                    positions.push({ x: 0, y: 0, width: w2h, height: height });
                    positions.push({ x: w2h + spacing, y: 0, width: w2h, height: height });
                    break;
                case '2-2':
                    const h2v = (height - spacing) / 2;
                    positions.push({ x: 0, y: 0, width: width, height: h2v });
                    positions.push({ x: 0, y: h2v + spacing, width: width, height: h2v });
                    break;
                case '3-1':
                    const w3 = (width - spacing * 2) / 3;
                    for (let i = 0; i < 3; i++) {
                        positions.push({ x: i * (w3 + spacing), y: 0, width: w3, height: height });
                    }
                    break;
                case '3-2':
                    const h3 = (height - spacing * 2) / 3;
                    for (let i = 0; i < 3; i++) {
                        positions.push({ x: 0, y: i * (h3 + spacing), width: width, height: h3 });
                    }
                    break;
                case '3-3':
                    // 左大右小布局：左侧占2/3宽度整个高度，右侧分成上下两个1/3宽度各1/2高度
                    const w3_3_left = (width - spacing) * 2 / 3;
                    const w3_3_right = (width - spacing) / 3;
                    const h3_3 = (height - spacing) / 2;
                    // 第一个图片：左侧大图，占整个高度
                    positions.push({ x: 0, y: 0, width: w3_3_left, height: height });
                    // 第二个图片：右上小图
                    positions.push({ x: w3_3_left + spacing, y: 0, width: w3_3_right, height: h3_3 });
                    // 第三个图片：右下小图
                    positions.push({ x: w3_3_left + spacing, y: h3_3 + spacing, width: w3_3_right, height: h3_3 });
                    break;
                case '3-4':
                    // 左小右大布局：左侧分成上下两个1/3宽度各1/2高度，右侧占2/3宽度整个高度
                    const w3_4_left = (width - spacing) / 3;
                    const w3_4_right = (width - spacing) * 2 / 3;
                    const h3_4 = (height - spacing) / 2;
                    // 第一个图片：左上小图
                    positions.push({ x: 0, y: 0, width: w3_4_left, height: h3_4 });
                    // 第二个图片：右侧大图，占整个高度
                    positions.push({ x: w3_4_left + spacing, y: 0, width: w3_4_right, height: height });
                    // 第三个图片：左下小图
                    positions.push({ x: 0, y: h3_4 + spacing, width: w3_4_left, height: h3_4 });
                    break;
                case '3-5':
                    // 上大下小布局：上侧占2/3高度整个宽度，下侧分成左右两个1/2宽度各1/3高度
                    const h3_5_top = (height - spacing) * 2 / 3;
                    const h3_5_bottom = (height - spacing) / 3;
                    const w3_5 = (width - spacing) / 2;
                    // 第一个图片：上侧大图，占整个宽度
                    positions.push({ x: 0, y: 0, width: width, height: h3_5_top });
                    // 第二个图片：左下小图
                    positions.push({ x: 0, y: h3_5_top + spacing, width: w3_5, height: h3_5_bottom });
                    // 第三个图片：右下小图
                    positions.push({ x: w3_5 + spacing, y: h3_5_top + spacing, width: w3_5, height: h3_5_bottom });
                    break;
                case '3-6':
                    // 上小下大布局：上侧分成左右两个1/2宽度各1/3高度，下侧占2/3高度整个宽度
                    const h3_6_top = (height - spacing) / 3;
                    const h3_6_bottom = (height - spacing) * 2 / 3;
                    const w3_6 = (width - spacing) / 2;
                    // 第一个图片：左上小图
                    positions.push({ x: 0, y: 0, width: w3_6, height: h3_6_top });
                    // 第二个图片：右上小图
                    positions.push({ x: w3_6 + spacing, y: 0, width: w3_6, height: h3_6_top });
                    // 第三个图片：下侧大图，占整个宽度
                    positions.push({ x: 0, y: h3_6_top + spacing, width: width, height: h3_6_bottom });
                    break;
                case '3-7':
                    // 上一下二布局：上侧占整个宽度1/2高度，下侧分成左右两个1/2宽度各1/2高度
                    const h3_7 = (height - spacing) / 2;
                    const w3_7 = (width - spacing) / 2;
                    // 第一个图片：上侧大图，占整个宽度
                    positions.push({ x: 0, y: 0, width: width, height: h3_7 });
                    // 第二个图片：左下小图
                    positions.push({ x: 0, y: h3_7 + spacing, width: w3_7, height: h3_7 });
                    // 第三个图片：右下小图
                    positions.push({ x: w3_7 + spacing, y: h3_7 + spacing, width: w3_7, height: h3_7 });
                    break;
                case '3-8':
                    // 上二下一布局：上侧分成左右两个1/2宽度各1/2高度，下侧占整个宽度1/2高度
                    const h3_8 = (height - spacing) / 2;
                    const w3_8 = (width - spacing) / 2;
                    // 第一个图片：左上小图
                    positions.push({ x: 0, y: 0, width: w3_8, height: h3_8 });
                    // 第二个图片：右上小图
                    positions.push({ x: w3_8 + spacing, y: 0, width: w3_8, height: h3_8 });
                    // 第三个图片：下侧大图，占整个宽度
                    positions.push({ x: 0, y: h3_8 + spacing, width: width, height: h3_8 });
                    break;
                case '3-9':
                    // 左一右二布局：左侧占整个高度1/2宽度，右侧分成上下两个1/2宽度各1/2高度
                    const w3_9 = (width - spacing) / 2;
                    const h3_9 = (height - spacing) / 2;
                    // 第一个图片：左侧大图，占整个高度
                    positions.push({ x: 0, y: 0, width: w3_9, height: height });
                    // 第二个图片：右上小图
                    positions.push({ x: w3_9 + spacing, y: 0, width: w3_9, height: h3_9 });
                    // 第三个图片：右下小图
                    positions.push({ x: w3_9 + spacing, y: h3_9 + spacing, width: w3_9, height: h3_9 });
                    break;
                case '3-10':
                    // 左二右一布局：左侧分成上下两个1/3宽度各1/2高度，右侧占2/3宽度整个高度
                    const w3_10_left = (width - spacing) / 3;
                    const w3_10_right = (width - spacing) * 2 / 3;
                    const h3_10 = (height - spacing) / 2;
                    // 第一个图片：左上小图
                    positions.push({ x: 0, y: 0, width: w3_10_left, height: h3_10 });
                    // 第二个图片：右侧大图，占整个高度
                    positions.push({ x: w3_10_left + spacing, y: 0, width: w3_10_right, height: height });
                    // 第三个图片：左下小图
                    positions.push({ x: 0, y: h3_10 + spacing, width: w3_10_left, height: h3_10 });
                    break;
                case '3-11':
                    // T型布局：上方一个大图占整个宽度2/3高度，下方两个小图各占1/2宽度1/3高度
                    const h3_11_top = (height - spacing) * 2 / 3;
                    const h3_11_bottom = (height - spacing) / 3;
                    const w3_11_bottom = (width - spacing) / 2;
                    // 第一个图片：上方大图，占整个宽度
                    positions.push({ x: 0, y: 0, width: width, height: h3_11_top });
                    // 第二个图片：左下小图
                    positions.push({ x: 0, y: h3_11_top + spacing, width: w3_11_bottom, height: h3_11_bottom });
                    // 第三个图片：右下小图
                    positions.push({ x: w3_11_bottom + spacing, y: h3_11_top + spacing, width: w3_11_bottom, height: h3_11_bottom });
                    break;
                case '3-12':
                    // L型布局：左上一个大图占2/3宽度2/3高度，右下两个小图
                    const w3_12_big = (width - spacing) * 2 / 3;
                    const w3_12_small = (width - spacing) / 3;
                    const h3_12_big = (height - spacing) * 2 / 3;
                    const h3_12_small = (height - spacing) / 3;
                    // 第一个图片：左上大图
                    positions.push({ x: 0, y: 0, width: w3_12_big, height: h3_12_big });
                    // 第二个图片：右上小图
                    positions.push({ x: w3_12_big + spacing, y: 0, width: w3_12_small, height: h3_12_small });
                    // 第三个图片：右下小图
                    positions.push({ x: w3_12_big + spacing, y: h3_12_small + spacing, width: w3_12_small, height: h3_12_small });
                    break;
                case '4-1':
                    const w4 = (width - spacing) / 2;
                    const h4 = (height - spacing) / 2;
                    positions.push({ x: 0, y: 0, width: w4, height: h4 });
                    positions.push({ x: w4 + spacing, y: 0, width: w4, height: h4 });
                    positions.push({ x: 0, y: h4 + spacing, width: w4, height: h4 });
                    positions.push({ x: w4 + spacing, y: h4 + spacing, width: w4, height: h4 });
                    break;
                case '4-2':
                    const w4h = (width - spacing * 3) / 4;
                    for (let i = 0; i < 4; i++) {
                        positions.push({ x: i * (w4h + spacing), y: 0, width: w4h, height: height });
                    }
                    break;
                case '4-3':
                    const h4v = (height - spacing * 3) / 4;
                    for (let i = 0; i < 4; i++) {
                        positions.push({ x: 0, y: i * (h4v + spacing), width: width, height: h4v });
                    }
                    break;
                case '4-4':
                    // 上一下三布局：上方一个大图占整个宽度1/2高度，下方三个小图各占1/3宽度1/2高度
                    const h4_4_top = (height - spacing) / 2;
                    const h4_4_bottom = (height - spacing) / 2;
                    const w4_4_bottom = (width - spacing * 2) / 3;
                    // 第一个图片：上方大图
                    positions.push({ x: 0, y: 0, width: width, height: h4_4_top });
                    // 第二、三、四个图片：下方三个小图
                    for (let i = 1; i < 4; i++) {
                        positions.push({
                            x: (i - 1) * (w4_4_bottom + spacing),
                            y: h4_4_top + spacing,
                            width: w4_4_bottom,
                            height: h4_4_bottom
                        });
                    }
                    break;
                case '4-5':
                    // 上三下一布局：上方三个小图各占1/3宽度1/2高度，下方一个大图占整个宽度1/2高度
                    const h4_5_top = (height - spacing) / 2;
                    const h4_5_bottom = (height - spacing) / 2;
                    const w4_5_top = (width - spacing * 2) / 3;
                    // 第一、二、三个图片：上方三个小图
                    for (let i = 0; i < 3; i++) {
                        positions.push({
                            x: i * (w4_5_top + spacing),
                            y: 0,
                            width: w4_5_top,
                            height: h4_5_top
                        });
                    }
                    // 第四个图片：下方大图
                    positions.push({ x: 0, y: h4_5_top + spacing, width: width, height: h4_5_bottom });
                    break;
                case '4-6':
                    // 左一右三布局：左侧一个大图占1/2宽度整个高度，右侧三个小图各占1/2宽度1/3高度
                    const w4_6_left = (width - spacing) / 2;
                    const w4_6_right = (width - spacing) / 2;
                    const h4_6_right = (height - spacing * 2) / 3;
                    // 第一个图片：左侧大图
                    positions.push({ x: 0, y: 0, width: w4_6_left, height: height });
                    // 第二、三、四个图片：右侧三个小图
                    for (let i = 1; i < 4; i++) {
                        positions.push({
                            x: w4_6_left + spacing,
                            y: (i - 1) * (h4_6_right + spacing),
                            width: w4_6_right,
                            height: h4_6_right
                        });
                    }
                    break;
                case '4-7':
                    // 左三右一布局：左侧三个小图各占1/2宽度1/3高度，右侧一个大图占1/2宽度整个高度
                    const w4_7_left = (width - spacing) / 2;
                    const w4_7_right = (width - spacing) / 2;
                    const h4_7_left = (height - spacing * 2) / 3;
                    // 第一个图片：左上小图
                    positions.push({ x: 0, y: 0, width: w4_7_left, height: h4_7_left });
                    // 第二个图片：右侧大图，占整个高度
                    positions.push({ x: w4_7_left + spacing, y: 0, width: w4_7_right, height: height });
                    // 第三个图片：左中小图
                    positions.push({ x: 0, y: h4_7_left + spacing, width: w4_7_left, height: h4_7_left });
                    // 第四个图片：左下小图
                    positions.push({ x: 0, y: (h4_7_left + spacing) * 2, width: w4_7_left, height: h4_7_left });
                    break;
                case '4-8':
                    // 左上大布局：修复为真正的4图布局 - 3×3网格布局
                    const w4_8_unit = (width - spacing * 2) / 3;
                    const h4_8_unit = (height - spacing * 2) / 3;
                    // 第一个图片：左上大图，占据2×2格子
                    positions.push({ x: 0, y: 0, width: w4_8_unit * 2 + spacing, height: h4_8_unit * 2 + spacing });
                    // 第二个图片：右上图片，占据1×2格子（右侧上半部分）
                    positions.push({ x: w4_8_unit * 2 + spacing * 2, y: 0, width: w4_8_unit, height: h4_8_unit * 2 + spacing });
                    // 第三个图片：左下图片，占据2×1格子（第1-2列，第3行）
                    positions.push({ x: 0, y: h4_8_unit * 2 + spacing * 2, width: w4_8_unit * 2 + spacing, height: h4_8_unit });
                    // 第四个图片：右下图片，占据1×1格子（第3列第3行）
                    positions.push({ x: w4_8_unit * 2 + spacing * 2, y: h4_8_unit * 2 + spacing * 2, width: w4_8_unit, height: h4_8_unit });
                    break;
                case '4-9':
                    // 右上大布局：修复为正确的4图布局 - 3×3网格布局
                    const w4_9_unit = (width - spacing * 2) / 3;
                    const h4_9_unit = (height - spacing * 2) / 3;
                    // 第一个图片：左上图片，占据1×2格子（第1列，第1-2行）
                    positions.push({ x: 0, y: 0, width: w4_9_unit, height: h4_9_unit * 2 + spacing });
                    // 第二个图片：右上大图，占据2×2格子（第2-3列，第1-2行）
                    positions.push({ x: w4_9_unit + spacing, y: 0, width: w4_9_unit * 2 + spacing, height: h4_9_unit * 2 + spacing });
                    // 第三个图片：左下图片，占据1×1格子（第1列，第3行）
                    positions.push({ x: 0, y: h4_9_unit * 2 + spacing * 2, width: w4_9_unit, height: h4_9_unit });
                    // 第四个图片：右下图片，占据2×1格子（第2-3列，第3行）
                    positions.push({ x: w4_9_unit + spacing, y: h4_9_unit * 2 + spacing * 2, width: w4_9_unit * 2 + spacing, height: h4_9_unit });
                    break;
                case '4-10':
                    // 三行布局：第一行一个图片，第二行两个图片，第三行一个图片
                    const w4_10_half = (width - spacing) / 2;
                    const h4_10_third = (height - spacing * 2) / 3;
                    // 第一个图片：第一行，占据整行
                    positions.push({ x: 0, y: 0, width: width, height: h4_10_third });
                    // 第二个图片：第二行左半部
                    positions.push({ x: 0, y: h4_10_third + spacing, width: w4_10_half, height: h4_10_third });
                    // 第三个图片：第二行右半部
                    positions.push({ x: w4_10_half + spacing, y: h4_10_third + spacing, width: w4_10_half, height: h4_10_third });
                    // 第四个图片：第三行，占据整行
                    positions.push({ x: 0, y: h4_10_third * 2 + spacing * 2, width: width, height: h4_10_third });
                    break;
                case '4-11':
                    // 三列布局：左列一个图片从上到下，中间两个图片，右列一个图片从上到下
                    const w4_11_col = (width - spacing * 2) / 3;
                    const h4_11_half = (height - spacing) / 2;
                    // 第一个图片：左列，从上到下
                    positions.push({ x: 0, y: 0, width: w4_11_col, height: height });
                    // 第二个图片：中间上半部
                    positions.push({ x: w4_11_col + spacing, y: 0, width: w4_11_col, height: h4_11_half });
                    // 第三个图片：右列，从上到下
                    positions.push({ x: w4_11_col * 2 + spacing * 2, y: 0, width: w4_11_col, height: height });
                    // 第四个图片：中间下半部
                    positions.push({ x: w4_11_col + spacing, y: h4_11_half + spacing, width: w4_11_col, height: h4_11_half });
                    break;
                case '4-12':
                    // 左右对称布局：左右两列，左列上小下大，右列上大下小
                    const w4_12_col = (width - spacing) / 2;
                    const h4_12_small = (height - spacing) / 3;
                    const h4_12_large = (height - spacing) * 2 / 3;
                    // 第一个图片：左上小图
                    positions.push({ x: 0, y: 0, width: w4_12_col, height: h4_12_small });
                    // 第二个图片：右上大图
                    positions.push({ x: w4_12_col + spacing, y: 0, width: w4_12_col, height: h4_12_large });
                    // 第三个图片：左下大图
                    positions.push({ x: 0, y: h4_12_small + spacing, width: w4_12_col, height: h4_12_large });
                    // 第四个图片：右下小图
                    positions.push({ x: w4_12_col + spacing, y: h4_12_large + spacing, width: w4_12_col, height: h4_12_small });
                    break;
                case '5-1':
                    const w5 = (width - spacing * 4) / 5;
                    for (let i = 0; i < 5; i++) {
                        positions.push({ x: i * (w5 + spacing), y: 0, width: w5, height: height });
                    }
                    break;
                case '5-2':
                    const h5 = (height - spacing * 4) / 5;
                    for (let i = 0; i < 5; i++) {
                        positions.push({ x: 0, y: i * (h5 + spacing), width: width, height: h5 });
                    }
                    break;
                case '5-3':
                    const w5_3 = (width - spacing) / 2;
                    const h5_3_top = (height - spacing * 2) * 2 / 3;
                    const h5_3_bottom = (height - spacing * 2) / 3;
                    positions.push({ x: 0, y: 0, width: width, height: h5_3_top });
                    for (let i = 0; i < 4; i++) {
                        const col = i % 2;
                        const row = Math.floor(i / 2);
                        positions.push({
                            x: col * (w5_3 + spacing),
                            y: h5_3_top + spacing + row * (h5_3_bottom / 2),
                            width: w5_3,
                            height: h5_3_bottom / 2
                        });
                    }
                    break;
                case '5-4':
                    // 上一下四布局：上方一个大图占整个宽度1/3高度，下方四个小图各占1/4宽度2/3高度
                    const h5_4_top = (height - spacing * 2) / 3;
                    const h5_4_bottom = (height - spacing * 2) * 2 / 3;
                    const w5_4_bottom = (width - spacing * 3) / 4;
                    // 第一个图片：上方大图
                    positions.push({ x: 0, y: 0, width: width, height: h5_4_top });
                    // 第二、三、四、五个图片：下方四个小图
                    for (let i = 1; i < 5; i++) {
                        positions.push({
                            x: (i - 1) * (w5_4_bottom + spacing),
                            y: h5_4_top + spacing,
                            width: w5_4_bottom,
                            height: h5_4_bottom
                        });
                    }
                    break;
                case '5-5':
                    // 上四下一布局：上方四个小图各占1/4宽度2/3高度，下方一个大图占整个宽度1/3高度
                    const h5_5_top = (height - spacing * 2) * 2 / 3;
                    const h5_5_bottom = (height - spacing * 2) / 3;
                    const w5_5_top = (width - spacing * 3) / 4;
                    // 第一、二、三、四个图片：上方四个小图
                    for (let i = 0; i < 4; i++) {
                        positions.push({
                            x: i * (w5_5_top + spacing),
                            y: 0,
                            width: w5_5_top,
                            height: h5_5_top
                        });
                    }
                    // 第五个图片：下方大图
                    positions.push({ x: 0, y: h5_5_top + spacing, width: width, height: h5_5_bottom });
                    break;
                case '5-6':
                    // 左一右四布局：左侧一个大图占1/3宽度整个高度，右侧四个小图各占2/3宽度1/4高度
                    const w5_6_left = (width - spacing * 2) / 3;
                    const w5_6_right = (width - spacing * 2) * 2 / 3;
                    const h5_6_right = (height - spacing * 3) / 4;
                    // 第一个图片：左侧大图
                    positions.push({ x: 0, y: 0, width: w5_6_left, height: height });
                    // 第二、三、四、五个图片：右侧四个小图
                    for (let i = 1; i < 5; i++) {
                        positions.push({
                            x: w5_6_left + spacing,
                            y: (i - 1) * (h5_6_right + spacing),
                            width: w5_6_right,
                            height: h5_6_right
                        });
                    }
                    break;
                case '5-7':
                    // 四图一中：标准九宫格布局
                    // 将整个画布按3x3网格划分，每个网格单元大小相等
                    const gridUnit = {
                        width: (width - spacing * 2) / 3,
                        height: (height - spacing * 2) / 3
                    };

                    // 第一个图片：上图 - 第1行，第1-2列 (66.666%宽×33.333%高)
                    positions.push({
                        x: 0,
                        y: 0,
                        width: gridUnit.width * 2 + spacing,
                        height: gridUnit.height
                    });

                    // 第二个图片：右图 - 第1-2行，第3列 (33.333%宽×66.666%高)  
                    positions.push({
                        x: gridUnit.width * 2 + spacing * 2,
                        y: 0,
                        width: gridUnit.width,
                        height: gridUnit.height * 2 + spacing
                    });

                    // 第三个图片：中心 - 第2行，第2列 (33.333%×33.333%)
                    positions.push({
                        x: gridUnit.width + spacing,
                        y: gridUnit.height + spacing,
                        width: gridUnit.width,
                        height: gridUnit.height
                    });

                    // 第四个图片：左图 - 第2-3行，第1列 (33.333%宽×66.666%高)
                    positions.push({
                        x: 0,
                        y: gridUnit.height + spacing,
                        width: gridUnit.width,
                        height: gridUnit.height * 2 + spacing
                    });

                    // 第五个图片：下图 - 第3行，第2-3列 (66.666%宽×33.333%高)
                    positions.push({
                        x: gridUnit.width + spacing,
                        y: gridUnit.height * 2 + spacing * 2,
                        width: gridUnit.width * 2 + spacing,
                        height: gridUnit.height
                    });
                    break;
                case '5-8':
                    // 大图加四：九宫格布局
                    // 将整个画布按3x3网格划分，第一列为小图，第二、三列为大图
                    const gridUnit58 = {
                        width: (width - spacing * 2) / 3,
                        height: (height - spacing * 2) / 3
                    };

                    // 第一个图片：左上小图 - 第1行第1列
                    positions.push({
                        x: 0,
                        y: 0,
                        width: gridUnit58.width,
                        height: gridUnit58.height
                    });

                    // 第二个图片：左中小图 - 第2行第1列
                    positions.push({
                        x: 0,
                        y: gridUnit58.height + spacing,
                        width: gridUnit58.width,
                        height: gridUnit58.height
                    });

                    // 第三个图片：左下小图 - 第3行第1列
                    positions.push({
                        x: 0,
                        y: gridUnit58.height * 2 + spacing * 2,
                        width: gridUnit58.width,
                        height: gridUnit58.height
                    });

                    // 第四个图片：上大图 - 第1行，第2-3列
                    positions.push({
                        x: gridUnit58.width + spacing,
                        y: 0,
                        width: gridUnit58.width * 2 + spacing,
                        height: gridUnit58.height
                    });

                    // 第五个图片：下大图 - 第2-3行，第2-3列
                    positions.push({
                        x: gridUnit58.width + spacing,
                        y: gridUnit58.height + spacing,
                        width: gridUnit58.width * 2 + spacing,
                        height: gridUnit58.height * 2 + spacing
                    });
                    break;
                case '5-9':
                    // 左右长条：第一列一个图形，第二列三个图形，第三列一个图形
                    // 将整个画布按3x3网格划分
                    const gridUnit59 = {
                        width: (width - spacing * 2) / 3,
                        height: (height - spacing * 2) / 3
                    };

                    // 第一个图片：左图 - 跨第1-3行，第1列
                    positions.push({
                        x: 0,
                        y: 0,
                        width: gridUnit59.width,
                        height: gridUnit59.height * 3 + spacing * 2
                    });

                    // 第二个图片：中上图 - 第1行第2列
                    positions.push({
                        x: gridUnit59.width + spacing,
                        y: 0,
                        width: gridUnit59.width,
                        height: gridUnit59.height
                    });

                    // 第三个图片：中中图 - 第2行第2列
                    positions.push({
                        x: gridUnit59.width + spacing,
                        y: gridUnit59.height + spacing,
                        width: gridUnit59.width,
                        height: gridUnit59.height
                    });

                    // 第四个图片：中下图 - 第3行第2列
                    positions.push({
                        x: gridUnit59.width + spacing,
                        y: gridUnit59.height * 2 + spacing * 2,
                        width: gridUnit59.width,
                        height: gridUnit59.height
                    });

                    // 第五个图片：右图 - 跨第1-3行，第3列
                    positions.push({
                        x: gridUnit59.width * 2 + spacing * 2,
                        y: 0,
                        width: gridUnit59.width,
                        height: gridUnit59.height * 3 + spacing * 2
                    });
                    break;
                case '5-10':
                    // 上下长条：第一行一个图形，第二行三个图形，第三行一个图形
                    const gridUnit510 = {
                        width: (width - spacing * 2) / 3,
                        height: (height - spacing * 2) / 3
                    };

                    // 第一个图片：上图 - 跨第1-3列，第1行
                    positions.push({
                        x: 0,
                        y: 0,
                        width: gridUnit510.width * 3 + spacing * 2,
                        height: gridUnit510.height
                    });

                    // 第二个图片：中左图 - 第1列第2行
                    positions.push({
                        x: 0,
                        y: gridUnit510.height + spacing,
                        width: gridUnit510.width,
                        height: gridUnit510.height
                    });

                    // 第三个图片：中中图 - 第2列第2行
                    positions.push({
                        x: gridUnit510.width + spacing,
                        y: gridUnit510.height + spacing,
                        width: gridUnit510.width,
                        height: gridUnit510.height
                    });

                    // 第四个图片：中右图 - 第3列第2行
                    positions.push({
                        x: gridUnit510.width * 2 + spacing * 2,
                        y: gridUnit510.height + spacing,
                        width: gridUnit510.width,
                        height: gridUnit510.height
                    });

                    // 第五个图片：下图 - 跨第1-3列，第3行
                    positions.push({
                        x: 0,
                        y: gridUnit510.height * 2 + spacing * 2,
                        width: gridUnit510.width * 3 + spacing * 2,
                        height: gridUnit510.height
                    });
                    break;
                case '5-11':
                    // 上二下三：第一、二行各跨3列，第三行分3个小图
                    const gridUnit511 = {
                        width: (width - spacing * 2) / 3,
                        height: (height - spacing * 2) / 3
                    };

                    // 第一个图片：上图1 - 跨第1-3列，第1行
                    positions.push({
                        x: 0,
                        y: 0,
                        width: gridUnit511.width * 3 + spacing * 2,
                        height: gridUnit511.height
                    });

                    // 第二个图片：上图2 - 跨第1-3列，第2行
                    positions.push({
                        x: 0,
                        y: gridUnit511.height + spacing,
                        width: gridUnit511.width * 3 + spacing * 2,
                        height: gridUnit511.height
                    });

                    // 第三个图片：下左图 - 第1列第3行
                    positions.push({
                        x: 0,
                        y: gridUnit511.height * 2 + spacing * 2,
                        width: gridUnit511.width,
                        height: gridUnit511.height
                    });

                    // 第四个图片：下中图 - 第2列第3行
                    positions.push({
                        x: gridUnit511.width + spacing,
                        y: gridUnit511.height * 2 + spacing * 2,
                        width: gridUnit511.width,
                        height: gridUnit511.height
                    });

                    // 第五个图片：下右图 - 第3列第3行
                    positions.push({
                        x: gridUnit511.width * 2 + spacing * 2,
                        y: gridUnit511.height * 2 + spacing * 2,
                        width: gridUnit511.width,
                        height: gridUnit511.height
                    });
                    break;
                case '5-12':
                    // 左上大块：左上2×2大图，右上2个小图，下面2个小图
                    const gridUnit512 = {
                        width: (width - spacing * 2) / 3,
                        height: (height - spacing * 2) / 3
                    };

                    // 第一个图片：大图 - 跨第1-2列，第1-2行
                    positions.push({
                        x: 0,
                        y: 0,
                        width: gridUnit512.width * 2 + spacing,
                        height: gridUnit512.height * 2 + spacing
                    });

                    // 第二个图片：右上图 - 第3列第1行
                    positions.push({
                        x: gridUnit512.width * 2 + spacing * 2,
                        y: 0,
                        width: gridUnit512.width,
                        height: gridUnit512.height
                    });

                    // 第三个图片：右中图 - 第3列第2行
                    positions.push({
                        x: gridUnit512.width * 2 + spacing * 2,
                        y: gridUnit512.height + spacing,
                        width: gridUnit512.width,
                        height: gridUnit512.height
                    });

                    // 第四个图片：下左图 - 第1列第3行
                    positions.push({
                        x: 0,
                        y: gridUnit512.height * 2 + spacing * 2,
                        width: gridUnit512.width,
                        height: gridUnit512.height
                    });

                    // 第五个图片：下右图 - 跨第2-3列，第3行
                    positions.push({
                        x: gridUnit512.width + spacing,
                        y: gridUnit512.height * 2 + spacing * 2,
                        width: gridUnit512.width * 2 + spacing,
                        height: gridUnit512.height
                    });
                    break;
                case '5-13':
                    // 右上大块：左上小图，右上2×2大图，左中、左下、下中小图
                    const gridUnit513 = {
                        width: (width - spacing * 2) / 3,
                        height: (height - spacing * 2) / 3
                    };

                    // 第一个图片：左上图 - 第1列第1行
                    positions.push({
                        x: 0,
                        y: 0,
                        width: gridUnit513.width,
                        height: gridUnit513.height
                    });

                    // 第二个图片：大图 - 跨第2-3列，第1-2行
                    positions.push({
                        x: gridUnit513.width + spacing,
                        y: 0,
                        width: gridUnit513.width * 2 + spacing,
                        height: gridUnit513.height * 2 + spacing
                    });

                    // 第三个图片：左中图 - 第1列第2行
                    positions.push({
                        x: 0,
                        y: gridUnit513.height + spacing,
                        width: gridUnit513.width,
                        height: gridUnit513.height
                    });

                    // 第四个图片：左下图 - 第1列第3行
                    positions.push({
                        x: 0,
                        y: gridUnit513.height * 2 + spacing * 2,
                        width: gridUnit513.width,
                        height: gridUnit513.height
                    });

                    // 第五个图片：下中图 - 跨第2-3列，第3行
                    positions.push({
                        x: gridUnit513.width + spacing,
                        y: gridUnit513.height * 2 + spacing * 2,
                        width: gridUnit513.width * 2 + spacing,
                        height: gridUnit513.height
                    });
                    break;
                case '5-14':
                    // 左下大块：上面3个小图，左下2×2大图，右中小图
                    const gridUnit514 = {
                        width: (width - spacing * 2) / 3,
                        height: (height - spacing * 2) / 3
                    };

                    // 第一个图片：上左图 - 第1列第1行
                    positions.push({
                        x: 0,
                        y: 0,
                        width: gridUnit514.width,
                        height: gridUnit514.height
                    });

                    // 第二个图片：上中图 - 第2列第1行
                    positions.push({
                        x: gridUnit514.width + spacing,
                        y: 0,
                        width: gridUnit514.width,
                        height: gridUnit514.height
                    });

                    // 第三个图片：上右图 - 第3列第1行
                    positions.push({
                        x: gridUnit514.width * 2 + spacing * 2,
                        y: 0,
                        width: gridUnit514.width,
                        height: gridUnit514.height
                    });

                    // 第四个图片：大图 - 跨第1-2列，第2-3行
                    positions.push({
                        x: 0,
                        y: gridUnit514.height + spacing,
                        width: gridUnit514.width * 2 + spacing,
                        height: gridUnit514.height * 2 + spacing
                    });

                    // 第五个图片：右中图 - 第3列第2-3行
                    positions.push({
                        x: gridUnit514.width * 2 + spacing * 2,
                        y: gridUnit514.height + spacing,
                        width: gridUnit514.width,
                        height: gridUnit514.height * 2 + spacing
                    });
                    break;
                case '5-15':
                    // 右下大块：上面3个小图，左中小图，右下2×2大图
                    const gridUnit515 = {
                        width: (width - spacing * 2) / 3,
                        height: (height - spacing * 2) / 3
                    };

                    // 第一个图片：上左图 - 第1列第1行
                    positions.push({
                        x: 0,
                        y: 0,
                        width: gridUnit515.width,
                        height: gridUnit515.height
                    });

                    // 第二个图片：上中图 - 第2列第1行
                    positions.push({
                        x: gridUnit515.width + spacing,
                        y: 0,
                        width: gridUnit515.width,
                        height: gridUnit515.height
                    });

                    // 第三个图片：上右图 - 第3列第1行
                    positions.push({
                        x: gridUnit515.width * 2 + spacing * 2,
                        y: 0,
                        width: gridUnit515.width,
                        height: gridUnit515.height
                    });

                    // 第四个图片：左中图 - 第1列第2-3行
                    positions.push({
                        x: 0,
                        y: gridUnit515.height + spacing,
                        width: gridUnit515.width,
                        height: gridUnit515.height * 2 + spacing
                    });

                    // 第五个图片：大图 - 跨第2-3列，第2-3行
                    positions.push({
                        x: gridUnit515.width + spacing,
                        y: gridUnit515.height + spacing,
                        width: gridUnit515.width * 2 + spacing,
                        height: gridUnit515.height * 2 + spacing
                    });
                    break;
                case '6-1':
                    // 布局1：两侧整列中间分三行 (5个区域)
                    const gridUnit61 = {
                        width: (width - spacing * 2) / 3,
                        height: (height - spacing * 2) / 3
                    };

                    // 第一个图片：左整列 - 第1列跨1-3行
                    positions.push({
                        x: 0,
                        y: 0,
                        width: gridUnit61.width,
                        height: gridUnit61.height * 3 + spacing * 2
                    });

                    // 第二个图片：中上 - 第2列第1行
                    positions.push({
                        x: gridUnit61.width + spacing,
                        y: 0,
                        width: gridUnit61.width,
                        height: gridUnit61.height
                    });

                    // 第三个图片：中中 - 第2列第2行
                    positions.push({
                        x: gridUnit61.width + spacing,
                        y: gridUnit61.height + spacing,
                        width: gridUnit61.width,
                        height: gridUnit61.height
                    });

                    // 第四个图片：中下 - 第2列第3行
                    positions.push({
                        x: gridUnit61.width + spacing,
                        y: gridUnit61.height * 2 + spacing * 2,
                        width: gridUnit61.width,
                        height: gridUnit61.height
                    });

                    // 第五个图片：右整列 - 第3列跨1-3行
                    positions.push({
                        x: gridUnit61.width * 2 + spacing * 2,
                        y: 0,
                        width: gridUnit61.width,
                        height: gridUnit61.height * 3 + spacing * 2
                    });
                    break;
                case '6-2':
                    // 布局2：左竖右错 (6个区域，3×3网格)
                    // 左竖图 + 右侧错落布局：上行两小图，中行一横图，下行两小图
                    const gridUnit62 = {
                        width: (width - spacing * 2) / 3,
                        height: (height - spacing * 2) / 3
                    };

                    // 第一个图片：左竖图 - 第1列跨1-3行
                    positions.push({
                        x: 0,
                        y: 0,
                        width: gridUnit62.width,
                        height: gridUnit62.height * 3 + spacing * 2
                    });

                    // 第二个图片：右上左图 - 第2列第1行
                    positions.push({
                        x: gridUnit62.width + spacing,
                        y: 0,
                        width: gridUnit62.width,
                        height: gridUnit62.height
                    });

                    // 第三个图片：右上右图 - 第3列第1行
                    positions.push({
                        x: gridUnit62.width * 2 + spacing * 2,
                        y: 0,
                        width: gridUnit62.width,
                        height: gridUnit62.height
                    });

                    // 第四个图片：右中横图 - 跨第2-3列，第2行
                    positions.push({
                        x: gridUnit62.width + spacing,
                        y: gridUnit62.height + spacing,
                        width: gridUnit62.width * 2 + spacing,
                        height: gridUnit62.height
                    });

                    // 第五个图片：右下左图 - 第2列第3行
                    positions.push({
                        x: gridUnit62.width + spacing,
                        y: gridUnit62.height * 2 + spacing * 2,
                        width: gridUnit62.width,
                        height: gridUnit62.height
                    });

                    // 第六个图片：右下右图 - 第3列第3行
                    positions.push({
                        x: gridUnit62.width * 2 + spacing * 2,
                        y: gridUnit62.height * 2 + spacing * 2,
                        width: gridUnit62.width,
                        height: gridUnit62.height
                    });
                    break;
                case '6-3':
                    // 布局3：左整列中上单下双右三行 (6个区域)
                    const gridUnit63 = {
                        width: (width - spacing * 2) / 3,
                        height: (height - spacing * 2) / 3
                    };

                    // 第一个图片：左整列 - 第1列跨1-3行
                    positions.push({
                        x: 0,
                        y: 0,
                        width: gridUnit63.width,
                        height: gridUnit63.height * 3 + spacing * 2
                    });

                    // 第二个图片：中上 - 第2列第1行
                    positions.push({
                        x: gridUnit63.width + spacing,
                        y: 0,
                        width: gridUnit63.width,
                        height: gridUnit63.height
                    });

                    // 第三个图片：中下双 - 第2列第2-3行
                    positions.push({
                        x: gridUnit63.width + spacing,
                        y: gridUnit63.height + spacing,
                        width: gridUnit63.width,
                        height: gridUnit63.height * 2 + spacing
                    });

                    // 第四个图片：右上 - 第3列第1行
                    positions.push({
                        x: gridUnit63.width * 2 + spacing * 2,
                        y: 0,
                        width: gridUnit63.width,
                        height: gridUnit63.height
                    });

                    // 第五个图片：右中 - 第3列第2行
                    positions.push({
                        x: gridUnit63.width * 2 + spacing * 2,
                        y: gridUnit63.height + spacing,
                        width: gridUnit63.width,
                        height: gridUnit63.height
                    });

                    // 第六个图片：右下 - 第3列第3行
                    positions.push({
                        x: gridUnit63.width * 2 + spacing * 2,
                        y: gridUnit63.height * 2 + spacing * 2,
                        width: gridUnit63.width,
                        height: gridUnit63.height
                    });
                    break;
                case '6-4':
                    // 布局4：两竖夹心 (6个区域，3×3网格)
                    // 左上长条2×1，左下1×1，中上1×1，中中1×1，中下1×1，右整列1×3
                    const gridUnit64 = {
                        width: (width - spacing * 2) / 3,
                        height: (height - spacing * 2) / 3
                    };

                    // 第一个图片：左上长条 2×1 - 第1列第1-2行
                    positions.push({
                        x: 0,
                        y: 0,
                        width: gridUnit64.width,
                        height: gridUnit64.height * 2 + spacing
                    });

                    // 第二个图片：左下 1×1 - 第1列第3行
                    positions.push({
                        x: 0,
                        y: gridUnit64.height * 2 + spacing * 2,
                        width: gridUnit64.width,
                        height: gridUnit64.height
                    });

                    // 第三个图片：中上 1×1 - 第2列第1行
                    positions.push({
                        x: gridUnit64.width + spacing,
                        y: 0,
                        width: gridUnit64.width,
                        height: gridUnit64.height
                    });

                    // 第四个图片：中中 1×1 - 第2列第2行
                    positions.push({
                        x: gridUnit64.width + spacing,
                        y: gridUnit64.height + spacing,
                        width: gridUnit64.width,
                        height: gridUnit64.height
                    });

                    // 第五个图片：中下 1×1 - 第2列第3行
                    positions.push({
                        x: gridUnit64.width + spacing,
                        y: gridUnit64.height * 2 + spacing * 2,
                        width: gridUnit64.width,
                        height: gridUnit64.height
                    });

                    // 第六个图片：右整列 1×3 - 第3列跨1-3行
                    positions.push({
                        x: gridUnit64.width * 2 + spacing * 2,
                        y: 0,
                        width: gridUnit64.width,
                        height: gridUnit64.height * 3 + spacing * 2
                    });
                    break;
                case '6-5':
                    // 布局5：左上单下双中三行右整列 (6个区域)
                    const gridUnit65 = {
                        width: (width - spacing * 2) / 3,
                        height: (height - spacing * 2) / 3
                    };

                    // 第一个图片：左上 - 第1列第1行
                    positions.push({
                        x: 0,
                        y: 0,
                        width: gridUnit65.width,
                        height: gridUnit65.height
                    });

                    // 第二个图片：左下双 - 第1列第2-3行
                    positions.push({
                        x: 0,
                        y: gridUnit65.height + spacing,
                        width: gridUnit65.width,
                        height: gridUnit65.height * 2 + spacing
                    });

                    // 第三个图片：中上 - 第2列第1行
                    positions.push({
                        x: gridUnit65.width + spacing,
                        y: 0,
                        width: gridUnit65.width,
                        height: gridUnit65.height
                    });

                    // 第四个图片：中中 - 第2列第2行
                    positions.push({
                        x: gridUnit65.width + spacing,
                        y: gridUnit65.height + spacing,
                        width: gridUnit65.width,
                        height: gridUnit65.height
                    });

                    // 第五个图片：中下 - 第2列第3行
                    positions.push({
                        x: gridUnit65.width + spacing,
                        y: gridUnit65.height * 2 + spacing * 2,
                        width: gridUnit65.width,
                        height: gridUnit65.height
                    });

                    // 第六个图片：右整列 - 第3列跨1-3行
                    positions.push({
                        x: gridUnit65.width * 2 + spacing * 2,
                        y: 0,
                        width: gridUnit65.width,
                        height: gridUnit65.height * 3 + spacing * 2
                    });
                    break;
                case '6-6':
                    // 布局6：左三行中上双下单右整列 (6个区域)
                    const gridUnit66 = {
                        width: (width - spacing * 2) / 3,
                        height: (height - spacing * 2) / 3
                    };

                    // 第一个图片：左上 - 第1列第1行
                    positions.push({
                        x: 0,
                        y: 0,
                        width: gridUnit66.width,
                        height: gridUnit66.height
                    });

                    // 第二个图片：左中 - 第1列第2行
                    positions.push({
                        x: 0,
                        y: gridUnit66.height + spacing,
                        width: gridUnit66.width,
                        height: gridUnit66.height
                    });

                    // 第三个图片：左下 - 第1列第3行
                    positions.push({
                        x: 0,
                        y: gridUnit66.height * 2 + spacing * 2,
                        width: gridUnit66.width,
                        height: gridUnit66.height
                    });

                    // 第四个图片：中上双 - 第2列第1-2行
                    positions.push({
                        x: gridUnit66.width + spacing,
                        y: 0,
                        width: gridUnit66.width,
                        height: gridUnit66.height * 2 + spacing
                    });

                    // 第五个图片：中下 - 第2列第3行
                    positions.push({
                        x: gridUnit66.width + spacing,
                        y: gridUnit66.height * 2 + spacing * 2,
                        width: gridUnit66.width,
                        height: gridUnit66.height
                    });

                    // 第六个图片：右整列 - 第3列跨1-3行
                    positions.push({
                        x: gridUnit66.width * 2 + spacing * 2,
                        y: 0,
                        width: gridUnit66.width,
                        height: gridUnit66.height * 3 + spacing * 2
                    });
                    break;
                case '6-7':
                    // 布局7：左竖中错 (6个区域，3×3网格)
                    // 左整列1×3，中上1×1，中下2×1，右上1×1，右中1×1，右下1×1
                    const gridUnit67 = {
                        width: (width - spacing * 2) / 3,
                        height: (height - spacing * 2) / 3
                    };

                    // 第一个图片：左整列 1×3 - 第1列跨1-3行
                    positions.push({
                        x: 0,
                        y: 0,
                        width: gridUnit67.width,
                        height: gridUnit67.height * 3 + spacing * 2
                    });

                    // 第二个图片：中上 1×1 - 第2列第1行
                    positions.push({
                        x: gridUnit67.width + spacing,
                        y: 0,
                        width: gridUnit67.width,
                        height: gridUnit67.height
                    });

                    // 第三个图片：中下 2×1 - 第2列第2-3行
                    positions.push({
                        x: gridUnit67.width + spacing,
                        y: gridUnit67.height + spacing,
                        width: gridUnit67.width,
                        height: gridUnit67.height * 2 + spacing
                    });

                    // 第四个图片：右上 1×1 - 第3列第1行
                    positions.push({
                        x: gridUnit67.width * 2 + spacing * 2,
                        y: 0,
                        width: gridUnit67.width,
                        height: gridUnit67.height
                    });

                    // 第五个图片：右中 1×1 - 第3列第2行
                    positions.push({
                        x: gridUnit67.width * 2 + spacing * 2,
                        y: gridUnit67.height + spacing,
                        width: gridUnit67.width,
                        height: gridUnit67.height
                    });

                    // 第六个图片：右下 1×1 - 第3列第3行
                    positions.push({
                        x: gridUnit67.width * 2 + spacing * 2,
                        y: gridUnit67.height * 2 + spacing * 2,
                        width: gridUnit67.width,
                        height: gridUnit67.height
                    });
                    break;
                case '6-8':
                    // 布局8：三竖分段 (6个区域，3×3网格)
                    // 左上1×1，左下2×1，中上2×1，中下1×1，右上1×1，右下2×1
                    const gridUnit68 = {
                        width: (width - spacing * 2) / 3,
                        height: (height - spacing * 2) / 3
                    };

                    // 第一个图片：左上 1×1 - 第1列第1行
                    positions.push({
                        x: 0,
                        y: 0,
                        width: gridUnit68.width,
                        height: gridUnit68.height
                    });

                    // 第二个图片：左下 2×1 - 第1列第2-3行
                    positions.push({
                        x: 0,
                        y: gridUnit68.height + spacing,
                        width: gridUnit68.width,
                        height: gridUnit68.height * 2 + spacing
                    });

                    // 第三个图片：中上 2×1 - 第2列第1-2行
                    positions.push({
                        x: gridUnit68.width + spacing,
                        y: 0,
                        width: gridUnit68.width,
                        height: gridUnit68.height * 2 + spacing
                    });

                    // 第四个图片：中下 1×1 - 第2列第3行
                    positions.push({
                        x: gridUnit68.width + spacing,
                        y: gridUnit68.height * 2 + spacing * 2,
                        width: gridUnit68.width,
                        height: gridUnit68.height
                    });

                    // 第五个图片：右上 1×1 - 第3列第1行
                    positions.push({
                        x: gridUnit68.width * 2 + spacing * 2,
                        y: 0,
                        width: gridUnit68.width,
                        height: gridUnit68.height
                    });

                    // 第六个图片：右下 2×1 - 第3列第2-3行
                    positions.push({
                        x: gridUnit68.width * 2 + spacing * 2,
                        y: gridUnit68.height + spacing,
                        width: gridUnit68.width,
                        height: gridUnit68.height * 2 + spacing
                    });
                    break;
                case '6-9':
                    // 布局9：两横四竖 (6个区域，3×3网格)
                    // 上方横块跨两列，右上，左中，中中，右中，下方横块跨三列
                    const gridUnit69 = {
                        width: (width - spacing * 2) / 3,
                        height: (height - spacing * 2) / 3
                    };

                    // 第一个图片：上方横块（跨两列）- 第1-2列第1行
                    positions.push({
                        x: 0,
                        y: 0,
                        width: gridUnit69.width * 2 + spacing,
                        height: gridUnit69.height
                    });

                    // 第二个图片：右上 1×1 - 第3列第1行
                    positions.push({
                        x: gridUnit69.width * 2 + spacing * 2,
                        y: 0,
                        width: gridUnit69.width,
                        height: gridUnit69.height
                    });

                    // 第三个图片：左中 1×1 - 第1列第2行
                    positions.push({
                        x: 0,
                        y: gridUnit69.height + spacing,
                        width: gridUnit69.width,
                        height: gridUnit69.height
                    });

                    // 第四个图片：中中 1×1 - 第2列第2行
                    positions.push({
                        x: gridUnit69.width + spacing,
                        y: gridUnit69.height + spacing,
                        width: gridUnit69.width,
                        height: gridUnit69.height
                    });

                    // 第五个图片：右中 1×1 - 第3列第2行
                    positions.push({
                        x: gridUnit69.width * 2 + spacing * 2,
                        y: gridUnit69.height + spacing,
                        width: gridUnit69.width,
                        height: gridUnit69.height
                    });

                    // 第六个图片：下方横块（跨三列）- 第1-3列第3行
                    positions.push({
                        x: 0,
                        y: gridUnit69.height * 2 + spacing * 2,
                        width: gridUnit69.width * 3 + spacing * 2,
                        height: gridUnit69.height
                    });
                    break;
                case '6-10':
                    // 布局10：镜像结构 (6个区域，3×3网格)
                    // 左整列1×3，中上2×1，中下1×1，右上1×1，右中1×1，右下1×1
                    const gridUnit610 = {
                        width: (width - spacing * 2) / 3,
                        height: (height - spacing * 2) / 3
                    };

                    // 第一个图片：左整列 1×3 - 第1列跨1-3行
                    positions.push({
                        x: 0,
                        y: 0,
                        width: gridUnit610.width,
                        height: gridUnit610.height * 3 + spacing * 2
                    });

                    // 第二个图片：中上 2×1 - 第2列第1-2行
                    positions.push({
                        x: gridUnit610.width + spacing,
                        y: 0,
                        width: gridUnit610.width,
                        height: gridUnit610.height * 2 + spacing
                    });

                    // 第三个图片：中下 1×1 - 第2列第3行
                    positions.push({
                        x: gridUnit610.width + spacing,
                        y: gridUnit610.height * 2 + spacing * 2,
                        width: gridUnit610.width,
                        height: gridUnit610.height
                    });

                    // 第四个图片：右上 1×1 - 第3列第1行
                    positions.push({
                        x: gridUnit610.width * 2 + spacing * 2,
                        y: 0,
                        width: gridUnit610.width,
                        height: gridUnit610.height
                    });

                    // 第五个图片：右中 1×1 - 第3列第2行
                    positions.push({
                        x: gridUnit610.width * 2 + spacing * 2,
                        y: gridUnit610.height + spacing,
                        width: gridUnit610.width,
                        height: gridUnit610.height
                    });

                    // 第六个图片：右下 1×1 - 第3列第3行
                    positions.push({
                        x: gridUnit610.width * 2 + spacing * 2,
                        y: gridUnit610.height * 2 + spacing * 2,
                        width: gridUnit610.width,
                        height: gridUnit610.height
                    });
                    break;
                case '6-11':
                    // 布局11：三行两列 (6个区域，2×3网格)
                    // 第1行：左上1×1，右上1×1，第2行：左中1×1，右中1×1，第3行：左下1×1，右下1×1
                    const gridUnit611 = {
                        width: (width - spacing) / 2,
                        height: (height - spacing * 2) / 3
                    };

                    // 第一个图片：左上 1×1 - 第1列第1行
                    positions.push({
                        x: 0,
                        y: 0,
                        width: gridUnit611.width,
                        height: gridUnit611.height
                    });

                    // 第二个图片：右上 1×1 - 第2列第1行
                    positions.push({
                        x: gridUnit611.width + spacing,
                        y: 0,
                        width: gridUnit611.width,
                        height: gridUnit611.height
                    });

                    // 第三个图片：左中 1×1 - 第1列第2行
                    positions.push({
                        x: 0,
                        y: gridUnit611.height + spacing,
                        width: gridUnit611.width,
                        height: gridUnit611.height
                    });

                    // 第四个图片：右中 1×1 - 第2列第2行
                    positions.push({
                        x: gridUnit611.width + spacing,
                        y: gridUnit611.height + spacing,
                        width: gridUnit611.width,
                        height: gridUnit611.height
                    });

                    // 第五个图片：左下 1×1 - 第1列第3行
                    positions.push({
                        x: 0,
                        y: gridUnit611.height * 2 + spacing * 2,
                        width: gridUnit611.width,
                        height: gridUnit611.height
                    });

                    // 第六个图片：右下 1×1 - 第2列第3行
                    positions.push({
                        x: gridUnit611.width + spacing,
                        y: gridUnit611.height * 2 + spacing * 2,
                        width: gridUnit611.width,
                        height: gridUnit611.height
                    });
                    break;
                case '6-12':
                    // 布局12：分层组合 (6个区域，3×3网格)
                    // 左上2×1，左下1×1，中上1×1，中中1×1，中下1×1，右整列1×3
                    const gridUnit612 = {
                        width: (width - spacing * 2) / 3,
                        height: (height - spacing * 2) / 3
                    };

                    // 第一个图片：左上 2×1 - 第1列第1-2行
                    positions.push({
                        x: 0,
                        y: 0,
                        width: gridUnit612.width,
                        height: gridUnit612.height * 2 + spacing
                    });

                    // 第二个图片：左下 1×1 - 第1列第3行
                    positions.push({
                        x: 0,
                        y: gridUnit612.height * 2 + spacing * 2,
                        width: gridUnit612.width,
                        height: gridUnit612.height
                    });

                    // 第三个图片：中上 1×1 - 第2列第1行
                    positions.push({
                        x: gridUnit612.width + spacing,
                        y: 0,
                        width: gridUnit612.width,
                        height: gridUnit612.height
                    });

                    // 第四个图片：中中 1×1 - 第2列第2行
                    positions.push({
                        x: gridUnit612.width + spacing,
                        y: gridUnit612.height + spacing,
                        width: gridUnit612.width,
                        height: gridUnit612.height
                    });

                    // 第五个图片：中下 1×1 - 第2列第3行
                    positions.push({
                        x: gridUnit612.width + spacing,
                        y: gridUnit612.height * 2 + spacing * 2,
                        width: gridUnit612.width,
                        height: gridUnit612.height
                    });

                    // 第六个图片：右整列 1×3 - 第3列跨1-3行
                    positions.push({
                        x: gridUnit612.width * 2 + spacing * 2,
                        y: 0,
                        width: gridUnit612.width,
                        height: gridUnit612.height * 3 + spacing * 2
                    });
                    break;
                case '7-1':
                    // 两行布局：第一行12列中4个图形均分（各占3列），第二行12列中3个图形均分（各占4列）
                    const h71_row = (height - spacing) / 2;
                    const total_width = width - spacing * 3; // 第一行4个图形需要3个间距
                    const w71_first = total_width / 4; // 第一行每个图形宽度
                    const w71_second = (width - spacing * 2) / 3; // 第二行每个图形宽度

                    // 第一行：四个图形，各占3/12宽度
                    for (let i = 0; i < 4; i++) {
                        positions.push({
                            x: i * (w71_first + spacing),
                            y: 0,
                            width: w71_first,
                            height: h71_row
                        });
                    }

                    // 第二行：三个图形，各占4/12宽度
                    for (let i = 0; i < 3; i++) {
                        positions.push({
                            x: i * (w71_second + spacing),
                            y: h71_row + spacing,
                            width: w71_second,
                            height: h71_row
                        });
                    }
                    break;
                case '7-2':
                    // 4×3网格，顶部大图跨4列，第2、3行第1个图占2列
                    const gridUnit72 = {
                        width: (width - spacing * 3) / 4,
                        height: (height - spacing * 2) / 3
                    };

                    // 第一个图片：顶部大图 - 跨第1-4列，第1行
                    positions.push({
                        x: 0,
                        y: 0,
                        width: gridUnit72.width * 4 + spacing * 3,
                        height: gridUnit72.height
                    });

                    // 第二个图片：第二行第1个图，占2列
                    positions.push({
                        x: 0,
                        y: gridUnit72.height + spacing,
                        width: gridUnit72.width * 2 + spacing,
                        height: gridUnit72.height
                    });

                    // 第三个图片：第二行第2个图
                    positions.push({
                        x: gridUnit72.width * 2 + spacing * 2,
                        y: gridUnit72.height + spacing,
                        width: gridUnit72.width,
                        height: gridUnit72.height
                    });

                    // 第四个图片：第二行第3个图
                    positions.push({
                        x: gridUnit72.width * 3 + spacing * 3,
                        y: gridUnit72.height + spacing,
                        width: gridUnit72.width,
                        height: gridUnit72.height
                    });

                    // 第五个图片：第三行第1个图，占2列
                    positions.push({
                        x: 0,
                        y: gridUnit72.height * 2 + spacing * 2,
                        width: gridUnit72.width * 2 + spacing,
                        height: gridUnit72.height
                    });

                    // 第六个图片：第三行第2个图
                    positions.push({
                        x: gridUnit72.width * 2 + spacing * 2,
                        y: gridUnit72.height * 2 + spacing * 2,
                        width: gridUnit72.width,
                        height: gridUnit72.height
                    });

                    // 第七个图片：第三行第3个图
                    positions.push({
                        x: gridUnit72.width * 3 + spacing * 3,
                        y: gridUnit72.height * 2 + spacing * 2,
                        width: gridUnit72.width,
                        height: gridUnit72.height
                    });
                    break;
                case '7-3':
                    // 4×3网格，第一行占四列，第二、三行第一、二个图占单列，第三个图占两列
                    const gridUnit73 = {
                        width: (width - spacing * 3) / 4,
                        height: (height - spacing * 2) / 3
                    };

                    // 第一个图片：第一行大图 - 跨第1-4列，第1行
                    positions.push({
                        x: 0,
                        y: 0,
                        width: gridUnit73.width * 4 + spacing * 3,
                        height: gridUnit73.height
                    });

                    // 第二个图片：第二行第1个图，占1列
                    positions.push({
                        x: 0,
                        y: gridUnit73.height + spacing,
                        width: gridUnit73.width,
                        height: gridUnit73.height
                    });

                    // 第三个图片：第二行第2个图，占1列
                    positions.push({
                        x: gridUnit73.width + spacing,
                        y: gridUnit73.height + spacing,
                        width: gridUnit73.width,
                        height: gridUnit73.height
                    });

                    // 第四个图片：第二行第3个图，占2列
                    positions.push({
                        x: gridUnit73.width * 2 + spacing * 2,
                        y: gridUnit73.height + spacing,
                        width: gridUnit73.width * 2 + spacing,
                        height: gridUnit73.height
                    });

                    // 第五个图片：第三行第1个图，占1列
                    positions.push({
                        x: 0,
                        y: gridUnit73.height * 2 + spacing * 2,
                        width: gridUnit73.width,
                        height: gridUnit73.height
                    });

                    // 第六个图片：第三行第2个图，占1列
                    positions.push({
                        x: gridUnit73.width + spacing,
                        y: gridUnit73.height * 2 + spacing * 2,
                        width: gridUnit73.width,
                        height: gridUnit73.height
                    });

                    // 第七个图片：第三行第3个图，占2列
                    positions.push({
                        x: gridUnit73.width * 2 + spacing * 2,
                        y: gridUnit73.height * 2 + spacing * 2,
                        width: gridUnit73.width * 2 + spacing,
                        height: gridUnit73.height
                    });
                    break;
                case '7-4':
                    // 3×3网格，第1列占3行，第2、3列各3个图各占1行
                    const gridUnit74 = {
                        width: (width - spacing * 2) / 3,
                        height: (height - spacing * 2) / 3
                    };

                    // 第一个图片：第1列大图 - 占整个第1列
                    positions.push({
                        x: 0,
                        y: 0,
                        width: gridUnit74.width,
                        height: gridUnit74.height * 3 + spacing * 2
                    });

                    // 第二个图片：第2列第1个图 - 第2列第1行
                    positions.push({
                        x: gridUnit74.width + spacing,
                        y: 0,
                        width: gridUnit74.width,
                        height: gridUnit74.height
                    });

                    // 第三个图片：第2列第2个图 - 第2列第2行
                    positions.push({
                        x: gridUnit74.width + spacing,
                        y: gridUnit74.height + spacing,
                        width: gridUnit74.width,
                        height: gridUnit74.height
                    });

                    // 第四个图片：第2列第3个图 - 第2列第3行
                    positions.push({
                        x: gridUnit74.width + spacing,
                        y: gridUnit74.height * 2 + spacing * 2,
                        width: gridUnit74.width,
                        height: gridUnit74.height
                    });

                    // 第五个图片：第3列第1个图 - 第3列第1行
                    positions.push({
                        x: gridUnit74.width * 2 + spacing * 2,
                        y: 0,
                        width: gridUnit74.width,
                        height: gridUnit74.height
                    });

                    // 第六个图片：第3列第2个图 - 第3列第2行
                    positions.push({
                        x: gridUnit74.width * 2 + spacing * 2,
                        y: gridUnit74.height + spacing,
                        width: gridUnit74.width,
                        height: gridUnit74.height
                    });

                    // 第七个图片：第3列第3个图 - 第3列第3行
                    positions.push({
                        x: gridUnit74.width * 2 + spacing * 2,
                        y: gridUnit74.height * 2 + spacing * 2,
                        width: gridUnit74.width,
                        height: gridUnit74.height
                    });
                    break;
                case '7-5':
                    // 故事版布局：顶部大图，下方6图分2行
                    const gridUnit75 = {
                        width: (width - spacing * 2) / 3,
                        height: (height - spacing * 2) / 3
                    };

                    // 第一个图片：顶部大图 - 跨第1-3列，第1行
                    positions.push({
                        x: 0,
                        y: 0,
                        width: gridUnit75.width * 3 + spacing * 2,
                        height: gridUnit75.height
                    });

                    // 第二、三、四个图片：第二行三个小图
                    for (let i = 1; i <= 3; i++) {
                        positions.push({
                            x: (i - 1) * (gridUnit75.width + spacing),
                            y: gridUnit75.height + spacing,
                            width: gridUnit75.width,
                            height: gridUnit75.height
                        });
                    }

                    // 第五、六、七个图片：第三行三个小图
                    for (let i = 4; i <= 6; i++) {
                        positions.push({
                            x: (i - 4) * (gridUnit75.width + spacing),
                            y: gridUnit75.height * 2 + spacing * 2,
                            width: gridUnit75.width,
                            height: gridUnit75.height
                        });
                    }
                    break;
                case '7-6':
                    // 对称分层布局：第一行两个图形各占一半，第二行三个图形各占1/3，第三行两个图形各占一半
                    const h76_row = (height - spacing * 2) / 3;
                    const w76_half = (width - spacing) / 2;
                    const w76_third = (width - spacing * 2) / 3;

                    // 第一行：两个图形，各占一半宽度
                    positions.push({
                        x: 0,
                        y: 0,
                        width: w76_half,
                        height: h76_row
                    });
                    positions.push({
                        x: w76_half + spacing,
                        y: 0,
                        width: w76_half,
                        height: h76_row
                    });

                    // 第二行：三个图形，各占1/3宽度
                    for (let i = 0; i < 3; i++) {
                        positions.push({
                            x: i * (w76_third + spacing),
                            y: h76_row + spacing,
                            width: w76_third,
                            height: h76_row
                        });
                    }

                    // 第三行：两个图形，各占一半宽度
                    positions.push({
                        x: 0,
                        y: h76_row * 2 + spacing * 2,
                        width: w76_half,
                        height: h76_row
                    });
                    positions.push({
                        x: w76_half + spacing,
                        y: h76_row * 2 + spacing * 2,
                        width: w76_half,
                        height: h76_row
                    });
                    break;
                case '7-7':
                    // 3×3网格布局：上1中3下3
                    const gridUnit77 = {
                        width: (width - spacing * 2) / 3,
                        height: (height - spacing * 2) / 3
                    };

                    // 第1个图片：第1行，占3列
                    positions.push({
                        x: 0,
                        y: 0,
                        width: gridUnit77.width * 3 + spacing * 2,
                        height: gridUnit77.height
                    });

                    // 第2个图片：第2行第1列
                    positions.push({
                        x: 0,
                        y: gridUnit77.height + spacing,
                        width: gridUnit77.width,
                        height: gridUnit77.height
                    });

                    // 第3个图片：第2行第2列
                    positions.push({
                        x: gridUnit77.width + spacing,
                        y: gridUnit77.height + spacing,
                        width: gridUnit77.width,
                        height: gridUnit77.height
                    });

                    // 第4个图片：第2行第3列
                    positions.push({
                        x: gridUnit77.width * 2 + spacing * 2,
                        y: gridUnit77.height + spacing,
                        width: gridUnit77.width,
                        height: gridUnit77.height
                    });

                    // 第5个图片：第3行第1列
                    positions.push({
                        x: 0,
                        y: gridUnit77.height * 2 + spacing * 2,
                        width: gridUnit77.width,
                        height: gridUnit77.height
                    });

                    // 第6个图片：第3行第2列
                    positions.push({
                        x: gridUnit77.width + spacing,
                        y: gridUnit77.height * 2 + spacing * 2,
                        width: gridUnit77.width,
                        height: gridUnit77.height
                    });

                    // 第7个图片：第3行第3列
                    positions.push({
                        x: gridUnit77.width * 2 + spacing * 2,
                        y: gridUnit77.height * 2 + spacing * 2,
                        width: gridUnit77.width,
                        height: gridUnit77.height
                    });
                    break;
                case '7-8':
                    // 4行3列网格布局
                    const gridUnit78 = {
                        width: (width - spacing * 2) / 3,
                        height: (height - spacing * 3) / 4
                    };

                    // 第1个图片：第1行第1列
                    positions.push({
                        x: 0,
                        y: 0,
                        width: gridUnit78.width,
                        height: gridUnit78.height
                    });

                    // 第2个图片：第1行第2列
                    positions.push({
                        x: gridUnit78.width + spacing,
                        y: 0,
                        width: gridUnit78.width,
                        height: gridUnit78.height
                    });

                    // 第3个图片：第1行第3列
                    positions.push({
                        x: gridUnit78.width * 2 + spacing * 2,
                        y: 0,
                        width: gridUnit78.width,
                        height: gridUnit78.height
                    });

                    // 第4个图片：第2行第1-2列，占2列3行
                    positions.push({
                        x: 0,
                        y: gridUnit78.height + spacing,
                        width: gridUnit78.width * 2 + spacing,
                        height: gridUnit78.height * 3 + spacing * 2
                    });

                    // 第5个图片：第2行第3列
                    positions.push({
                        x: gridUnit78.width * 2 + spacing * 2,
                        y: gridUnit78.height + spacing,
                        width: gridUnit78.width,
                        height: gridUnit78.height
                    });

                    // 第6个图片：第3行第3列
                    positions.push({
                        x: gridUnit78.width * 2 + spacing * 2,
                        y: gridUnit78.height * 2 + spacing * 2,
                        width: gridUnit78.width,
                        height: gridUnit78.height
                    });

                    // 第7个图片：第4行第3列
                    positions.push({
                        x: gridUnit78.width * 2 + spacing * 2,
                        y: gridUnit78.height * 3 + spacing * 3,
                        width: gridUnit78.width,
                        height: gridUnit78.height
                    });
                    break;
                case '7-9':
                    // 3行4列网格布局
                    const gridUnit79 = {
                        width: (width - spacing * 3) / 4,
                        height: (height - spacing * 2) / 3
                    };

                    // 第1个图片：第1行第1列
                    positions.push({
                        x: 0,
                        y: 0,
                        width: gridUnit79.width,
                        height: gridUnit79.height
                    });

                    // 第2个图片：第1行第2列
                    positions.push({
                        x: gridUnit79.width + spacing,
                        y: 0,
                        width: gridUnit79.width,
                        height: gridUnit79.height
                    });

                    // 第3个图片：第1行第3列
                    positions.push({
                        x: gridUnit79.width * 2 + spacing * 2,
                        y: 0,
                        width: gridUnit79.width,
                        height: gridUnit79.height
                    });

                    // 第4个图片：第1行第4列
                    positions.push({
                        x: gridUnit79.width * 3 + spacing * 3,
                        y: 0,
                        width: gridUnit79.width,
                        height: gridUnit79.height
                    });

                    // 第5个图片：第2行第1列
                    positions.push({
                        x: 0,
                        y: gridUnit79.height + spacing,
                        width: gridUnit79.width,
                        height: gridUnit79.height
                    });

                    // 第6个图片：第2行第2-4列，占3列2行
                    positions.push({
                        x: gridUnit79.width + spacing,
                        y: gridUnit79.height + spacing,
                        width: gridUnit79.width * 3 + spacing * 2,
                        height: gridUnit79.height * 2 + spacing
                    });

                    // 第7个图片：第3行第1列
                    positions.push({
                        x: 0,
                        y: gridUnit79.height * 2 + spacing * 2,
                        width: gridUnit79.width,
                        height: gridUnit79.height
                    });
                    break;
                case '7-10':
                    // 4行5列网格布局
                    const gridUnit710 = {
                        width: (width - spacing * 4) / 5,
                        height: (height - spacing * 3) / 4
                    };

                    // 第1个图片：第1行第1列，占4列2行（第5列留给其他图片）
                    positions.push({
                        x: 0,
                        y: 0,
                        width: gridUnit710.width * 4 + spacing * 3,
                        height: gridUnit710.height * 2 + spacing
                    });

                    // 第2个图片：第1行第5列
                    positions.push({
                        x: gridUnit710.width * 4 + spacing * 4,
                        y: 0,
                        width: gridUnit710.width,
                        height: gridUnit710.height
                    });

                    // 第3个图片：第2行第5列
                    positions.push({
                        x: gridUnit710.width * 4 + spacing * 4,
                        y: gridUnit710.height + spacing,
                        width: gridUnit710.width,
                        height: gridUnit710.height
                    });

                    // 第4个图片：第3行第5列
                    positions.push({
                        x: gridUnit710.width * 4 + spacing * 4,
                        y: gridUnit710.height * 2 + spacing * 2,
                        width: gridUnit710.width,
                        height: gridUnit710.height
                    });

                    // 第5个图片：第4行第5列
                    positions.push({
                        x: gridUnit710.width * 4 + spacing * 4,
                        y: gridUnit710.height * 3 + spacing * 3,
                        width: gridUnit710.width,
                        height: gridUnit710.height
                    });

                    // 第6个图片：第3行第1列，占2列2行
                    positions.push({
                        x: 0,
                        y: gridUnit710.height * 2 + spacing * 2,
                        width: gridUnit710.width * 2 + spacing,
                        height: gridUnit710.height * 2 + spacing
                    });

                    // 第7个图片：第3行第3列，占2列2行
                    positions.push({
                        x: gridUnit710.width * 2 + spacing * 2,
                        y: gridUnit710.height * 2 + spacing * 2,
                        width: gridUnit710.width * 2 + spacing,
                        height: gridUnit710.height * 2 + spacing
                    });
                    break;
                case '7-11':
                    // 4行4列网格布局
                    const gridUnit711 = {
                        width: (width - spacing * 3) / 4,
                        height: (height - spacing * 3) / 4
                    };

                    // 第1个图片：第1行第1列，占2列2行
                    positions.push({
                        x: 0,
                        y: 0,
                        width: gridUnit711.width * 2 + spacing,
                        height: gridUnit711.height * 2 + spacing
                    });

                    // 第2个图片：第1行第3列，占2列2行
                    positions.push({
                        x: gridUnit711.width * 2 + spacing * 2,
                        y: 0,
                        width: gridUnit711.width * 2 + spacing,
                        height: gridUnit711.height * 2 + spacing
                    });

                    // 第3个图片：第3行第1列，占2列2行
                    positions.push({
                        x: 0,
                        y: gridUnit711.height * 2 + spacing * 2,
                        width: gridUnit711.width * 2 + spacing,
                        height: gridUnit711.height * 2 + spacing
                    });

                    // 第4个图片：第3行第3列，占1列1行
                    positions.push({
                        x: gridUnit711.width * 2 + spacing * 2,
                        y: gridUnit711.height * 2 + spacing * 2,
                        width: gridUnit711.width,
                        height: gridUnit711.height
                    });

                    // 第5个图片：第3行第4列，占1列1行
                    positions.push({
                        x: gridUnit711.width * 3 + spacing * 3,
                        y: gridUnit711.height * 2 + spacing * 2,
                        width: gridUnit711.width,
                        height: gridUnit711.height
                    });

                    // 第6个图片：第4行第3列，占1列1行
                    positions.push({
                        x: gridUnit711.width * 2 + spacing * 2,
                        y: gridUnit711.height * 3 + spacing * 3,
                        width: gridUnit711.width,
                        height: gridUnit711.height
                    });

                    // 第7个图片：第4行第4列，占1列1行
                    positions.push({
                        x: gridUnit711.width * 3 + spacing * 3,
                        y: gridUnit711.height * 3 + spacing * 3,
                        width: gridUnit711.width,
                        height: gridUnit711.height
                    });
                    break;
                case '7-12':
                    // 4行4列网格布局
                    const gridUnit712 = {
                        width: (width - spacing * 3) / 4,
                        height: (height - spacing * 3) / 4
                    };

                    // 第1个图片：第1行第1列，占2列2行
                    positions.push({
                        x: 0,
                        y: 0,
                        width: gridUnit712.width * 2 + spacing,
                        height: gridUnit712.height * 2 + spacing
                    });

                    // 第2个图片：第1行第3列，占2列1行
                    positions.push({
                        x: gridUnit712.width * 2 + spacing * 2,
                        y: 0,
                        width: gridUnit712.width * 2 + spacing,
                        height: gridUnit712.height
                    });

                    // 第3个图片：第2行第3列，占2列1行
                    positions.push({
                        x: gridUnit712.width * 2 + spacing * 2,
                        y: gridUnit712.height + spacing,
                        width: gridUnit712.width * 2 + spacing,
                        height: gridUnit712.height
                    });

                    // 第4个图片：第3行第3列，占2列1行
                    positions.push({
                        x: gridUnit712.width * 2 + spacing * 2,
                        y: gridUnit712.height * 2 + spacing * 2,
                        width: gridUnit712.width * 2 + spacing,
                        height: gridUnit712.height
                    });

                    // 第5个图片：第4行第3列，占1列1行
                    positions.push({
                        x: gridUnit712.width * 2 + spacing * 2,
                        y: gridUnit712.height * 3 + spacing * 3,
                        width: gridUnit712.width,
                        height: gridUnit712.height
                    });

                    // 第6个图片：第4行第4列，占1列1行
                    positions.push({
                        x: gridUnit712.width * 3 + spacing * 3,
                        y: gridUnit712.height * 3 + spacing * 3,
                        width: gridUnit712.width,
                        height: gridUnit712.height
                    });

                    // 第7个图片：第3行第1列，占2列2行
                    positions.push({
                        x: 0,
                        y: gridUnit712.height * 2 + spacing * 2,
                        width: gridUnit712.width * 2 + spacing,
                        height: gridUnit712.height * 2 + spacing
                    });
                    break;
                case '7-13':
                    // 4行6列网格布局
                    const gridUnit713 = {
                        width: (width - spacing * 5) / 6,
                        height: (height - spacing * 3) / 4
                    };

                    // 第1个图片：第1行第1列，占3列2行
                    positions.push({
                        x: 0,
                        y: 0,
                        width: gridUnit713.width * 3 + spacing * 2,
                        height: gridUnit713.height * 2 + spacing
                    });

                    // 第2个图片：第1行第4列，占3列2行
                    positions.push({
                        x: gridUnit713.width * 3 + spacing * 3,
                        y: 0,
                        width: gridUnit713.width * 3 + spacing * 2,
                        height: gridUnit713.height * 2 + spacing
                    });

                    // 第3个图片：第3行第1列，占2列1行
                    positions.push({
                        x: 0,
                        y: gridUnit713.height * 2 + spacing * 2,
                        width: gridUnit713.width * 2 + spacing,
                        height: gridUnit713.height
                    });

                    // 第4个图片：第3行第5列，占2列1行
                    positions.push({
                        x: gridUnit713.width * 4 + spacing * 4,
                        y: gridUnit713.height * 2 + spacing * 2,
                        width: gridUnit713.width * 2 + spacing,
                        height: gridUnit713.height
                    });

                    // 第5个图片：第3行第3列，占2列2行
                    positions.push({
                        x: gridUnit713.width * 2 + spacing * 2,
                        y: gridUnit713.height * 2 + spacing * 2,
                        width: gridUnit713.width * 2 + spacing,
                        height: gridUnit713.height * 2 + spacing
                    });

                    // 第6个图片：第4行第1列，占2列1行
                    positions.push({
                        x: 0,
                        y: gridUnit713.height * 3 + spacing * 3,
                        width: gridUnit713.width * 2 + spacing,
                        height: gridUnit713.height
                    });

                    // 第7个图片：第4行第5列，占2列1行
                    positions.push({
                        x: gridUnit713.width * 4 + spacing * 4,
                        y: gridUnit713.height * 3 + spacing * 3,
                        width: gridUnit713.width * 2 + spacing,
                        height: gridUnit713.height
                    });
                    break;
                case '7-14':
                    // 3行3列网格布局
                    const gridUnit714 = {
                        width: (width - spacing * 2) / 3,
                        height: (height - spacing * 2) / 3
                    };

                    // 第1个图片：第1行第1列，占1列1行
                    positions.push({
                        x: 0,
                        y: 0,
                        width: gridUnit714.width,
                        height: gridUnit714.height
                    });

                    // 第2个图片：第1行第2列，占1列1行
                    positions.push({
                        x: gridUnit714.width + spacing,
                        y: 0,
                        width: gridUnit714.width,
                        height: gridUnit714.height
                    });

                    // 第3个图片：第1行第3列，占1列1行
                    positions.push({
                        x: gridUnit714.width * 2 + spacing * 2,
                        y: 0,
                        width: gridUnit714.width,
                        height: gridUnit714.height
                    });

                    // 第4个图片：第2行第1个图形，占2列1行
                    positions.push({
                        x: 0,
                        y: gridUnit714.height + spacing,
                        width: gridUnit714.width * 2 + spacing,
                        height: gridUnit714.height
                    });

                    // 第5个图片：第2行第2个图形，占1列1行
                    positions.push({
                        x: gridUnit714.width * 2 + spacing * 2,
                        y: gridUnit714.height + spacing,
                        width: gridUnit714.width,
                        height: gridUnit714.height
                    });

                    // 第6个图片：第3行第1个图形，占2列1行
                    positions.push({
                        x: 0,
                        y: gridUnit714.height * 2 + spacing * 2,
                        width: gridUnit714.width * 2 + spacing,
                        height: gridUnit714.height
                    });

                    // 第7个图片：第3行第2个图形，占1列1行
                    positions.push({
                        x: gridUnit714.width * 2 + spacing * 2,
                        y: gridUnit714.height * 2 + spacing * 2,
                        width: gridUnit714.width,
                        height: gridUnit714.height
                    });
                    break;
                case '7-15':
                    // 3行3列网格布局
                    const gridUnit715 = {
                        width: (width - spacing * 2) / 3,
                        height: (height - spacing * 2) / 3
                    };

                    // 第1个图片：第1列第1行
                    positions.push({
                        x: 0,
                        y: 0,
                        width: gridUnit715.width,
                        height: gridUnit715.height
                    });

                    // 第2个图片：第1列第2行
                    positions.push({
                        x: 0,
                        y: gridUnit715.height + spacing,
                        width: gridUnit715.width,
                        height: gridUnit715.height
                    });

                    // 第3个图片：第1列第3行
                    positions.push({
                        x: 0,
                        y: gridUnit715.height * 2 + spacing * 2,
                        width: gridUnit715.width,
                        height: gridUnit715.height
                    });

                    // 第4个图片：第2列第1行
                    positions.push({
                        x: gridUnit715.width + spacing,
                        y: 0,
                        width: gridUnit715.width,
                        height: gridUnit715.height
                    });

                    // 第5个图片：第2列第2行
                    positions.push({
                        x: gridUnit715.width + spacing,
                        y: gridUnit715.height + spacing,
                        width: gridUnit715.width,
                        height: gridUnit715.height
                    });

                    // 第6个图片：第2列第3行
                    positions.push({
                        x: gridUnit715.width + spacing,
                        y: gridUnit715.height * 2 + spacing * 2,
                        width: gridUnit715.width,
                        height: gridUnit715.height
                    });

                    // 第7个图片：第3列，占3行
                    positions.push({
                        x: gridUnit715.width * 2 + spacing * 2,
                        y: 0,
                        width: gridUnit715.width,
                        height: gridUnit715.height * 3 + spacing * 2
                    });
                    break;
                case '7-16':
                    // 12行12列网格布局
                    const gridUnit716 = {
                        width: (width - spacing * 11) / 12,
                        height: (height - spacing * 11) / 12
                    };

                    // 第1个图片：第1行第1列，占6列4行
                    positions.push({
                        x: 0,
                        y: 0,
                        width: gridUnit716.width * 6 + spacing * 5,
                        height: gridUnit716.height * 4 + spacing * 3
                    });

                    // 第2个图片：第5行第1列，占6列4行
                    positions.push({
                        x: 0,
                        y: gridUnit716.height * 4 + spacing * 4,
                        width: gridUnit716.width * 6 + spacing * 5,
                        height: gridUnit716.height * 4 + spacing * 3
                    });

                    // 第3个图片：第9行第1列，占6列4行
                    positions.push({
                        x: 0,
                        y: gridUnit716.height * 8 + spacing * 8,
                        width: gridUnit716.width * 6 + spacing * 5,
                        height: gridUnit716.height * 4 + spacing * 3
                    });

                    // 第4个图片：第7列第1行，占3列3行
                    positions.push({
                        x: gridUnit716.width * 6 + spacing * 6,
                        y: 0,
                        width: gridUnit716.width * 3 + spacing * 2,
                        height: gridUnit716.height * 3 + spacing * 2
                    });

                    // 第5个图片：第7列第4行，占3列3行
                    positions.push({
                        x: gridUnit716.width * 6 + spacing * 6,
                        y: gridUnit716.height * 3 + spacing * 3,
                        width: gridUnit716.width * 3 + spacing * 2,
                        height: gridUnit716.height * 3 + spacing * 2
                    });

                    // 第6个图片：第10列第1行，占3列6行
                    positions.push({
                        x: gridUnit716.width * 9 + spacing * 9,
                        y: 0,
                        width: gridUnit716.width * 3 + spacing * 2,
                        height: gridUnit716.height * 6 + spacing * 5
                    });

                    // 第7个图片：第7列第7行，占6列6行
                    positions.push({
                        x: gridUnit716.width * 6 + spacing * 6,
                        y: gridUnit716.height * 6 + spacing * 6,
                        width: gridUnit716.width * 6 + spacing * 5,
                        height: gridUnit716.height * 6 + spacing * 5
                    });
                    break;
                case '7-17':
                    // 12行12列网格布局
                    const gridUnit717 = {
                        width: (width - spacing * 11) / 12,
                        height: (height - spacing * 11) / 12
                    };

                    // 第1个图片：第1行第1列，占6列4行
                    positions.push({
                        x: 0,
                        y: 0,
                        width: gridUnit717.width * 6 + spacing * 5,
                        height: gridUnit717.height * 4 + spacing * 3
                    });

                    // 第2个图片：第1行第7列，占6列6行
                    positions.push({
                        x: gridUnit717.width * 6 + spacing * 6,
                        y: 0,
                        width: gridUnit717.width * 6 + spacing * 5,
                        height: gridUnit717.height * 6 + spacing * 5
                    });

                    // 第3个图片：第5行第1列，占3列4行
                    positions.push({
                        x: 0,
                        y: gridUnit717.height * 4 + spacing * 4,
                        width: gridUnit717.width * 3 + spacing * 2,
                        height: gridUnit717.height * 4 + spacing * 3
                    });

                    // 第4个图片：第5行第4列，占3列4行
                    positions.push({
                        x: gridUnit717.width * 3 + spacing * 3,
                        y: gridUnit717.height * 4 + spacing * 4,
                        width: gridUnit717.width * 3 + spacing * 2,
                        height: gridUnit717.height * 4 + spacing * 3
                    });

                    // 第5个图片：第9行第1列，占3列4行
                    positions.push({
                        x: 0,
                        y: gridUnit717.height * 8 + spacing * 8,
                        width: gridUnit717.width * 3 + spacing * 2,
                        height: gridUnit717.height * 4 + spacing * 3
                    });

                    // 第6个图片：第9行第4列，占3列4行
                    positions.push({
                        x: gridUnit717.width * 3 + spacing * 3,
                        y: gridUnit717.height * 8 + spacing * 8,
                        width: gridUnit717.width * 3 + spacing * 2,
                        height: gridUnit717.height * 4 + spacing * 3
                    });

                    // 第7个图片：第7行第7列，占6列6行
                    positions.push({
                        x: gridUnit717.width * 6 + spacing * 6,
                        y: gridUnit717.height * 6 + spacing * 6,
                        width: gridUnit717.width * 6 + spacing * 5,
                        height: gridUnit717.height * 6 + spacing * 5
                    });
                    break;
                case '7-18':
                    // 12行12列网格布局
                    const gridUnit718 = {
                        width: (width - spacing * 11) / 12,
                        height: (height - spacing * 11) / 12
                    };
                    // 第1个图片：第1行第1列，占4列3行
                    positions.push({
                        x: 0,
                        y: 0,
                        width: gridUnit718.width * 4 + spacing * 3,
                        height: gridUnit718.height * 3 + spacing * 2
                    });
                    // 第2个图片：第4行第1列，占4列3行
                    positions.push({
                        x: 0,
                        y: gridUnit718.height * 3 + spacing * 3,
                        width: gridUnit718.width * 4 + spacing * 3,
                        height: gridUnit718.height * 3 + spacing * 2
                    });
                    // 第3个图片：第1行第5列，占4列6行
                    positions.push({
                        x: gridUnit718.width * 4 + spacing * 4,
                        y: 0,
                        width: gridUnit718.width * 4 + spacing * 3,
                        height: gridUnit718.height * 6 + spacing * 5
                    });
                    // 第4个图片：第1行第9列，占4列6行
                    positions.push({
                        x: gridUnit718.width * 8 + spacing * 8,
                        y: 0,
                        width: gridUnit718.width * 4 + spacing * 3,
                        height: gridUnit718.height * 6 + spacing * 5
                    });
                    // 第5个图片：第7行第1列，占6列6行
                    positions.push({
                        x: 0,
                        y: gridUnit718.height * 6 + spacing * 6,
                        width: gridUnit718.width * 6 + spacing * 5,
                        height: gridUnit718.height * 6 + spacing * 5
                    });
                    // 第6个图片：第7行第7列，占6列3行
                    positions.push({
                        x: gridUnit718.width * 6 + spacing * 6,
                        y: gridUnit718.height * 6 + spacing * 6,
                        width: gridUnit718.width * 6 + spacing * 5,
                        height: gridUnit718.height * 3 + spacing * 2
                    });
                    // 第7个图片：第10行第7列，占6列3行
                    positions.push({
                        x: gridUnit718.width * 6 + spacing * 6,
                        y: gridUnit718.height * 9 + spacing * 9,
                        width: gridUnit718.width * 6 + spacing * 5,
                        height: gridUnit718.height * 3 + spacing * 2
                    });
                    break;
                case '7-19':
                    // 1字形布局：12×12网格系统
                    const gridUnit71 = {
                        width: (width - spacing * 11) / 12,  // 分成12列
                        height: (height - spacing * 11) / 12  // 分成12行
                    };

                    // 第一个图片：主图 - 第1-9列，第1-9行（9×9）
                    positions.push({
                        x: 0,
                        y: 0,
                        width: gridUnit71.width * 9 + spacing * 8,
                        height: gridUnit71.height * 9 + spacing * 8
                    });

                    // 第二个图片：右上图 - 第10-12列，第1-4行（3×4）
                    positions.push({
                        x: gridUnit71.width * 9 + spacing * 9,
                        y: 0,
                        width: gridUnit71.width * 3 + spacing * 2,
                        height: gridUnit71.height * 4 + spacing * 3
                    });

                    // 第三个图片：右中图 - 第10-12列，第5-8行（3×4）
                    positions.push({
                        x: gridUnit71.width * 9 + spacing * 9,
                        y: gridUnit71.height * 4 + spacing * 4,
                        width: gridUnit71.width * 3 + spacing * 2,
                        height: gridUnit71.height * 4 + spacing * 3
                    });

                    // 第四个图片：右下图 - 第10-12列，第9-12行（3×4）
                    positions.push({
                        x: gridUnit71.width * 9 + spacing * 9,
                        y: gridUnit71.height * 8 + spacing * 8,
                        width: gridUnit71.width * 3 + spacing * 2,
                        height: gridUnit71.height * 4 + spacing * 3
                    });

                    // 第五个图片：底左图 - 第1-3列，第10-12行（3×4实际是4×3）
                    positions.push({
                        x: 0,
                        y: gridUnit71.height * 9 + spacing * 9,
                        width: gridUnit71.width * 3 + spacing * 2,
                        height: gridUnit71.height * 3 + spacing * 2
                    });

                    // 第六个图片：底中图 - 第4-6列，第10-12行（3×4实际是4×3）
                    positions.push({
                        x: gridUnit71.width * 3 + spacing * 3,
                        y: gridUnit71.height * 9 + spacing * 9,
                        width: gridUnit71.width * 3 + spacing * 2,
                        height: gridUnit71.height * 3 + spacing * 2
                    });

                    // 第七个图片：底右图 - 第7-9列，第10-12行（3×4实际是4×3）
                    positions.push({
                        x: gridUnit71.width * 6 + spacing * 6,
                        y: gridUnit71.height * 9 + spacing * 9,
                        width: gridUnit71.width * 3 + spacing * 2,
                        height: gridUnit71.height * 3 + spacing * 2
                    });
                    break;
                case '8-4':
                    // 8图布局第4方案：4×4网格，每行第1个图占3列，第2个图占1列
                    const gridUnit8_4 = {
                        width: (width - spacing * 3) / 4,
                        height: (height - spacing * 3) / 4
                    };
                    for (let row = 0; row < 4; row++) {
                        // 第1个图：占3列 (grid-column: 1/4)
                        positions.push({
                            x: 0,
                            y: row * (gridUnit8_4.height + spacing),
                            width: gridUnit8_4.width * 3 + spacing * 2,
                            height: gridUnit8_4.height
                        });
                        // 第2个图：占1列 (grid-column: 4)
                        positions.push({
                            x: gridUnit8_4.width * 3 + spacing * 3,
                            y: row * (gridUnit8_4.height + spacing),
                            width: gridUnit8_4.width,
                            height: gridUnit8_4.height
                        });
                    }
                    break;
                case '8-5':
                case '8-6':
                case '8-7':
                case '8-8':
                case '8-9':
                case '8-10':
                case '8-11':
                case '8-12':
                case '8-13':
                case '8-14':
                case '8-15':
                case '8-16':
                case '8-17':
                case '8-18':
                case '8-19':
                case '8-20':
                case '8-21':
                case '8-22':
                    // 8图布局第5-22方案：根据HTML预览定义精确实现
                    const gridMap = {
                        '8-5': {
                            cols: 4, rows: 4, layout: [
                                { x: 0, y: 0, w: 2, h: 1 }, { x: 2, y: 0, w: 1, h: 2 }, { x: 3, y: 0, w: 1, h: 2 }, { x: 0, y: 1, w: 2, h: 1 },
                                { x: 0, y: 2, w: 1, h: 2 }, { x: 1, y: 2, w: 1, h: 2 }, { x: 2, y: 2, w: 2, h: 1 }, { x: 2, y: 3, w: 2, h: 1 }
                            ]
                        },
                        '8-6': {
                            cols: 4, rows: 4, layout: [
                                { x: 0, y: 0, w: 3, h: 3 }, { x: 3, y: 0, w: 1, h: 1 }, { x: 3, y: 1, w: 1, h: 1 }, { x: 3, y: 2, w: 1, h: 1 },
                                { x: 3, y: 3, w: 1, h: 1 }, { x: 0, y: 3, w: 1, h: 1 }, { x: 1, y: 3, w: 1, h: 1 }, { x: 2, y: 3, w: 1, h: 1 }
                            ]
                        },
                        '8-7': {
                            cols: 4, rows: 4, layout: [
                                { x: 0, y: 0, w: 1, h: 1 }, { x: 0, y: 1, w: 1, h: 1 }, { x: 0, y: 2, w: 1, h: 1 }, { x: 0, y: 3, w: 1, h: 1 },
                                { x: 1, y: 0, w: 3, h: 3 }, { x: 1, y: 3, w: 1, h: 1 }, { x: 2, y: 3, w: 1, h: 1 }, { x: 3, y: 3, w: 1, h: 1 }
                            ]
                        },
                        '8-8': {
                            cols: 4, rows: 4, layout: [
                                { x: 0, y: 0, w: 1, h: 1 }, { x: 1, y: 0, w: 1, h: 1 }, { x: 2, y: 0, w: 1, h: 1 }, { x: 3, y: 0, w: 1, h: 1 },
                                { x: 0, y: 1, w: 1, h: 1 }, { x: 0, y: 2, w: 1, h: 1 }, { x: 0, y: 3, w: 1, h: 1 }, { x: 1, y: 1, w: 3, h: 3 }
                            ]
                        },
                        '8-9': {
                            cols: 4, rows: 4, layout: [
                                { x: 0, y: 0, w: 1, h: 1 }, { x: 1, y: 0, w: 3, h: 1 }, { x: 0, y: 1, w: 3, h: 1 }, { x: 3, y: 1, w: 1, h: 1 },
                                { x: 0, y: 2, w: 1, h: 1 }, { x: 1, y: 2, w: 3, h: 1 }, { x: 0, y: 3, w: 3, h: 1 }, { x: 3, y: 3, w: 1, h: 1 }
                            ]
                        },
                        '8-10': {
                            cols: 12, rows: 12, layout: [
                                { x: 0, y: 0, w: 6, h: 4 }, { x: 6, y: 0, w: 6, h: 4 }, { x: 0, y: 4, w: 3, h: 4 }, { x: 3, y: 4, w: 3, h: 4 },
                                { x: 6, y: 4, w: 3, h: 4 }, { x: 9, y: 4, w: 3, h: 4 }, { x: 0, y: 8, w: 6, h: 4 }, { x: 6, y: 8, w: 6, h: 4 }
                            ]
                        },
                        '8-11': {
                            cols: 6, rows: 6, layout: [
                                { x: 0, y: 0, w: 2, h: 2 }, { x: 2, y: 0, w: 2, h: 2 }, { x: 4, y: 0, w: 2, h: 2 }, { x: 0, y: 2, w: 3, h: 2 },
                                { x: 3, y: 2, w: 3, h: 2 }, { x: 0, y: 4, w: 2, h: 2 }, { x: 2, y: 4, w: 2, h: 2 }, { x: 4, y: 4, w: 2, h: 2 }
                            ]
                        },
                        '8-12': {
                            cols: 6, rows: 6, layout: [
                                { x: 0, y: 0, w: 2, h: 2 }, { x: 0, y: 2, w: 2, h: 2 }, { x: 0, y: 4, w: 2, h: 2 }, { x: 2, y: 0, w: 2, h: 3 },
                                { x: 2, y: 3, w: 2, h: 3 }, { x: 4, y: 0, w: 2, h: 2 }, { x: 4, y: 2, w: 2, h: 2 }, { x: 4, y: 4, w: 2, h: 2 }
                            ]
                        },
                        '8-13': {
                            cols: 4, rows: 4, layout: [
                                { x: 0, y: 0, w: 1, h: 1 }, { x: 1, y: 0, w: 1, h: 2 }, { x: 2, y: 0, w: 2, h: 2 }, { x: 0, y: 1, w: 1, h: 1 },
                                { x: 0, y: 2, w: 2, h: 2 }, { x: 2, y: 2, w: 1, h: 2 }, { x: 3, y: 2, w: 1, h: 1 }, { x: 3, y: 3, w: 1, h: 1 }
                            ]
                        },
                        '8-14': {
                            cols: 4, rows: 4, layout: [
                                { x: 0, y: 0, w: 1, h: 2 }, { x: 0, y: 2, w: 1, h: 2 }, { x: 1, y: 0, w: 1, h: 2 }, { x: 1, y: 2, w: 1, h: 2 },
                                { x: 2, y: 0, w: 2, h: 1 }, { x: 2, y: 1, w: 2, h: 1 }, { x: 2, y: 2, w: 2, h: 1 }, { x: 2, y: 3, w: 2, h: 1 }
                            ]
                        },
                        '8-15': {
                            cols: 12, rows: 14, layout: [
                                { x: 0, y: 0, w: 6, h: 3 }, { x: 6, y: 0, w: 6, h: 3 }, { x: 0, y: 3, w: 4, h: 3 }, { x: 4, y: 3, w: 4, h: 3 },
                                { x: 8, y: 3, w: 4, h: 3 }, { x: 0, y: 6, w: 6, h: 3 }, { x: 6, y: 6, w: 6, h: 3 }, { x: 0, y: 9, w: 12, h: 5 }
                            ]
                        },
                        '8-16': {
                            cols: 6, rows: 6, layout: [
                                { x: 0, y: 0, w: 2, h: 3 }, { x: 0, y: 3, w: 2, h: 3 }, { x: 2, y: 0, w: 2, h: 2 }, { x: 2, y: 2, w: 2, h: 2 },
                                { x: 2, y: 4, w: 2, h: 2 }, { x: 4, y: 0, w: 2, h: 2 }, { x: 4, y: 2, w: 2, h: 2 }, { x: 4, y: 4, w: 2, h: 2 }
                            ]
                        },
                        '8-17': {
                            cols: 4, rows: 6, layout: [
                                { x: 0, y: 0, w: 2, h: 2 }, { x: 2, y: 0, w: 2, h: 2 }, { x: 0, y: 2, w: 2, h: 2 }, { x: 2, y: 2, w: 2, h: 2 },
                                { x: 0, y: 4, w: 1, h: 2 }, { x: 1, y: 4, w: 1, h: 2 }, { x: 2, y: 4, w: 1, h: 2 }, { x: 3, y: 4, w: 1, h: 2 }
                            ]
                        },
                        '8-18': {
                            cols: 4, rows: 4, layout: [
                                { x: 0, y: 0, w: 2, h: 1 }, { x: 2, y: 0, w: 1, h: 2 }, { x: 3, y: 0, w: 1, h: 2 }, { x: 0, y: 1, w: 2, h: 1 },
                                { x: 0, y: 2, w: 1, h: 2 }, { x: 1, y: 2, w: 1, h: 2 }, { x: 2, y: 2, w: 2, h: 1 }, { x: 2, y: 3, w: 2, h: 1 }
                            ]
                        },
                        '8-19': {
                            cols: 4, rows: 3, layout: [
                                { x: 0, y: 0, w: 1, h: 3 }, { x: 1, y: 0, w: 1, h: 1 }, { x: 1, y: 1, w: 1, h: 1 }, { x: 1, y: 2, w: 1, h: 1 },
                                { x: 2, y: 0, w: 1, h: 1 }, { x: 2, y: 1, w: 1, h: 1 }, { x: 2, y: 2, w: 1, h: 1 }, { x: 3, y: 0, w: 1, h: 3 }
                            ]
                        },
                        '8-20': {
                            cols: 3, rows: 4, layout: [
                                { x: 0, y: 0, w: 3, h: 1 }, { x: 0, y: 1, w: 1, h: 1 }, { x: 1, y: 1, w: 1, h: 1 }, { x: 2, y: 1, w: 1, h: 1 },
                                { x: 0, y: 2, w: 1, h: 1 }, { x: 1, y: 2, w: 1, h: 1 }, { x: 2, y: 2, w: 1, h: 1 }, { x: 0, y: 3, w: 3, h: 1 }
                            ]
                        },
                        '8-21': {
                            cols: 4, rows: 5, layout: [
                                { x: 0, y: 0, w: 2, h: 2 }, { x: 2, y: 0, w: 2, h: 2 }, { x: 0, y: 2, w: 1, h: 1 }, { x: 1, y: 2, w: 1, h: 1 },
                                { x: 2, y: 2, w: 1, h: 1 }, { x: 3, y: 2, w: 1, h: 1 }, { x: 0, y: 3, w: 2, h: 2 }, { x: 2, y: 3, w: 2, h: 2 }
                            ]
                        },
                        '8-22': {
                            cols: 5, rows: 4, layout: [
                                { x: 0, y: 0, w: 2, h: 2 }, { x: 0, y: 2, w: 2, h: 2 }, { x: 2, y: 0, w: 1, h: 1 }, { x: 2, y: 1, w: 1, h: 1 },
                                { x: 2, y: 2, w: 1, h: 1 }, { x: 2, y: 3, w: 1, h: 1 }, { x: 3, y: 0, w: 2, h: 2 }, { x: 3, y: 2, w: 2, h: 2 }
                            ]
                        }
                    };
                    const config = gridMap[layoutType];
                    if (config) {
                        const gridUnit = {
                            width: (width - spacing * (config.cols - 1)) / config.cols,
                            height: (height - spacing * (config.rows - 1)) / config.rows
                        };
                        config.layout.forEach(pos => {
                            positions.push({
                                x: pos.x * (gridUnit.width + spacing),
                                y: pos.y * (gridUnit.height + spacing),
                                width: gridUnit.width * pos.w + spacing * (pos.w - 1),
                                height: gridUnit.height * pos.h + spacing * (pos.h - 1)
                            });
                        });
                    }
                    break;
                case '9-1':
                    const w9 = (width - spacing * 2) / 3;
                    const h9 = (height - spacing * 2) / 3;
                    for (let row = 0; row < 3; row++) {
                        for (let col = 0; col < 3; col++) {
                            positions.push({
                                x: col * (w9 + spacing),
                                y: row * (h9 + spacing),
                                width: w9,
                                height: h9
                            });
                        }
                    }
                    break;
                case '9-2':
                    // 9图布局第2方案：4×4网格
                    const gridUnit9_2 = {
                        width: (width - spacing * 3) / 4,
                        height: (height - spacing * 3) / 4
                    };
                    // 图1: 第1列第1行，占1列1行
                    positions.push({
                        x: 0,
                        y: 0,
                        width: gridUnit9_2.width,
                        height: gridUnit9_2.height
                    });
                    // 图2: 第1列第2行，占1列1行
                    positions.push({
                        x: 0,
                        y: gridUnit9_2.height + spacing,
                        width: gridUnit9_2.width,
                        height: gridUnit9_2.height
                    });
                    // 图3: 第1列第3行，占1列1行
                    positions.push({
                        x: 0,
                        y: (gridUnit9_2.height + spacing) * 2,
                        width: gridUnit9_2.width,
                        height: gridUnit9_2.height
                    });
                    // 图4: 第1列第4行，占1列1行
                    positions.push({
                        x: 0,
                        y: (gridUnit9_2.height + spacing) * 3,
                        width: gridUnit9_2.width,
                        height: gridUnit9_2.height
                    });
                    // 图5: 第2-3列第1-4行，占2列4行
                    positions.push({
                        x: gridUnit9_2.width + spacing,
                        y: 0,
                        width: gridUnit9_2.width * 2 + spacing,
                        height: gridUnit9_2.height * 4 + spacing * 3
                    });
                    // 图6: 第4列第1行，占1列1行
                    positions.push({
                        x: (gridUnit9_2.width + spacing) * 3,
                        y: 0,
                        width: gridUnit9_2.width,
                        height: gridUnit9_2.height
                    });
                    // 图7: 第4列第2行，占1列1行
                    positions.push({
                        x: (gridUnit9_2.width + spacing) * 3,
                        y: gridUnit9_2.height + spacing,
                        width: gridUnit9_2.width,
                        height: gridUnit9_2.height
                    });
                    // 图8: 第4列第3行，占1列1行
                    positions.push({
                        x: (gridUnit9_2.width + spacing) * 3,
                        y: (gridUnit9_2.height + spacing) * 2,
                        width: gridUnit9_2.width,
                        height: gridUnit9_2.height
                    });
                    // 图9: 第4列第4行，占1列1行
                    positions.push({
                        x: (gridUnit9_2.width + spacing) * 3,
                        y: (gridUnit9_2.height + spacing) * 3,
                        width: gridUnit9_2.width,
                        height: gridUnit9_2.height
                    });
                    break;
                case '9-3':
                    // 9图布局第3方案：4×4网格
                    const gridUnit9_3 = {
                        width: (width - spacing * 3) / 4,
                        height: (height - spacing * 3) / 4
                    };
                    // 图1: 第1行第1列，占1列1行
                    positions.push({
                        x: 0,
                        y: 0,
                        width: gridUnit9_3.width,
                        height: gridUnit9_3.height
                    });
                    // 图2: 第1行第2列，占1列1行
                    positions.push({
                        x: gridUnit9_3.width + spacing,
                        y: 0,
                        width: gridUnit9_3.width,
                        height: gridUnit9_3.height
                    });
                    // 图3: 第1行第3列，占1列1行
                    positions.push({
                        x: (gridUnit9_3.width + spacing) * 2,
                        y: 0,
                        width: gridUnit9_3.width,
                        height: gridUnit9_3.height
                    });
                    // 图4: 第1行第4列，占1列1行
                    positions.push({
                        x: (gridUnit9_3.width + spacing) * 3,
                        y: 0,
                        width: gridUnit9_3.width,
                        height: gridUnit9_3.height
                    });
                    // 图5: 第2-3行第1-4列，占4列2行
                    positions.push({
                        x: 0,
                        y: gridUnit9_3.height + spacing,
                        width: gridUnit9_3.width * 4 + spacing * 3,
                        height: gridUnit9_3.height * 2 + spacing
                    });
                    // 图6: 第4行第1列，占1列1行
                    positions.push({
                        x: 0,
                        y: (gridUnit9_3.height + spacing) * 3,
                        width: gridUnit9_3.width,
                        height: gridUnit9_3.height
                    });
                    // 图7: 第4行第2列，占1列1行
                    positions.push({
                        x: gridUnit9_3.width + spacing,
                        y: (gridUnit9_3.height + spacing) * 3,
                        width: gridUnit9_3.width,
                        height: gridUnit9_3.height
                    });
                    // 图8: 第4行第3列，占1列1行
                    positions.push({
                        x: (gridUnit9_3.width + spacing) * 2,
                        y: (gridUnit9_3.height + spacing) * 3,
                        width: gridUnit9_3.width,
                        height: gridUnit9_3.height
                    });
                    // 图9: 第4行第4列，占1列1行
                    positions.push({
                        x: (gridUnit9_3.width + spacing) * 3,
                        y: (gridUnit9_3.height + spacing) * 3,
                        width: gridUnit9_3.width,
                        height: gridUnit9_3.height
                    });
                    break;
                case '9-4':
                    // 9图布局第4方案：4×4网格
                    const gridUnit9_4 = {
                        width: (width - spacing * 3) / 4,
                        height: (height - spacing * 3) / 4
                    };
                    // 图1: 第1行第1列，占2列2行
                    positions.push({
                        x: 0,
                        y: 0,
                        width: gridUnit9_4.width * 2 + spacing,
                        height: gridUnit9_4.height * 2 + spacing
                    });
                    // 图2: 第1行第3列，占1列2行
                    positions.push({
                        x: (gridUnit9_4.width + spacing) * 2,
                        y: 0,
                        width: gridUnit9_4.width,
                        height: gridUnit9_4.height * 2 + spacing
                    });
                    // 图3: 第1行第4列，占1列2行
                    positions.push({
                        x: (gridUnit9_4.width + spacing) * 3,
                        y: 0,
                        width: gridUnit9_4.width,
                        height: gridUnit9_4.height * 2 + spacing
                    });
                    // 图4: 第3行第1列，占1列2行
                    positions.push({
                        x: 0,
                        y: (gridUnit9_4.height + spacing) * 2,
                        width: gridUnit9_4.width,
                        height: gridUnit9_4.height * 2 + spacing
                    });
                    // 图5: 第3行第2列，占1列1行
                    positions.push({
                        x: gridUnit9_4.width + spacing,
                        y: (gridUnit9_4.height + spacing) * 2,
                        width: gridUnit9_4.width,
                        height: gridUnit9_4.height
                    });
                    // 图6: 第3行第3列，占1列1行
                    positions.push({
                        x: (gridUnit9_4.width + spacing) * 2,
                        y: (gridUnit9_4.height + spacing) * 2,
                        width: gridUnit9_4.width,
                        height: gridUnit9_4.height
                    });
                    // 图7: 第4行第2列，占2列1行
                    positions.push({
                        x: gridUnit9_4.width + spacing,
                        y: (gridUnit9_4.height + spacing) * 3,
                        width: gridUnit9_4.width * 2 + spacing,
                        height: gridUnit9_4.height
                    });
                    // 图8: 第3行第4列，占1列1行
                    positions.push({
                        x: (gridUnit9_4.width + spacing) * 3,
                        y: (gridUnit9_4.height + spacing) * 2,
                        width: gridUnit9_4.width,
                        height: gridUnit9_4.height
                    });
                    // 图9: 第4行第4列，占1列1行
                    positions.push({
                        x: (gridUnit9_4.width + spacing) * 3,
                        y: (gridUnit9_4.height + spacing) * 3,
                        width: gridUnit9_4.width,
                        height: gridUnit9_4.height
                    });
                    break;
                case '9-5':
                    // 9图布局第5方案：4×4网格
                    const gridUnit9_5 = {
                        width: (width - spacing * 3) / 4,
                        height: (height - spacing * 3) / 4
                    };
                    // 图1: 第1-2列第1-4行，占2列4行
                    positions.push({
                        x: 0,
                        y: 0,
                        width: gridUnit9_5.width * 2 + spacing,
                        height: gridUnit9_5.height * 4 + spacing * 3
                    });
                    // 图2: 第3列第1行，占1列1行
                    positions.push({
                        x: (gridUnit9_5.width + spacing) * 2,
                        y: 0,
                        width: gridUnit9_5.width,
                        height: gridUnit9_5.height
                    });
                    // 图3: 第3列第2行，占1列1行
                    positions.push({
                        x: (gridUnit9_5.width + spacing) * 2,
                        y: gridUnit9_5.height + spacing,
                        width: gridUnit9_5.width,
                        height: gridUnit9_5.height
                    });
                    // 图4: 第3列第3行，占1列1行
                    positions.push({
                        x: (gridUnit9_5.width + spacing) * 2,
                        y: (gridUnit9_5.height + spacing) * 2,
                        width: gridUnit9_5.width,
                        height: gridUnit9_5.height
                    });
                    // 图5: 第3列第4行，占1列1行
                    positions.push({
                        x: (gridUnit9_5.width + spacing) * 2,
                        y: (gridUnit9_5.height + spacing) * 3,
                        width: gridUnit9_5.width,
                        height: gridUnit9_5.height
                    });
                    // 图6: 第4列第1行，占1列1行
                    positions.push({
                        x: (gridUnit9_5.width + spacing) * 3,
                        y: 0,
                        width: gridUnit9_5.width,
                        height: gridUnit9_5.height
                    });
                    // 图7: 第4列第2行，占1列1行
                    positions.push({
                        x: (gridUnit9_5.width + spacing) * 3,
                        y: gridUnit9_5.height + spacing,
                        width: gridUnit9_5.width,
                        height: gridUnit9_5.height
                    });
                    // 图8: 第4列第3行，占1列1行
                    positions.push({
                        x: (gridUnit9_5.width + spacing) * 3,
                        y: (gridUnit9_5.height + spacing) * 2,
                        width: gridUnit9_5.width,
                        height: gridUnit9_5.height
                    });
                    // 图9: 第4列第4行，占1列1行
                    positions.push({
                        x: (gridUnit9_5.width + spacing) * 3,
                        y: (gridUnit9_5.height + spacing) * 3,
                        width: gridUnit9_5.width,
                        height: gridUnit9_5.height
                    });
                    break;
                case '9-6':
                    // 9图布局第6方案：4×4网格
                    const gridUnit9_6 = {
                        width: (width - spacing * 3) / 4,
                        height: (height - spacing * 3) / 4
                    };
                    // 图1: 第1-2行第1-4列，占4列2行
                    positions.push({
                        x: 0,
                        y: 0,
                        width: gridUnit9_6.width * 4 + spacing * 3,
                        height: gridUnit9_6.height * 2 + spacing
                    });
                    // 图2: 第3行第1列，占1列1行
                    positions.push({
                        x: 0,
                        y: (gridUnit9_6.height + spacing) * 2,
                        width: gridUnit9_6.width,
                        height: gridUnit9_6.height
                    });
                    // 图3: 第3行第2列，占1列1行
                    positions.push({
                        x: gridUnit9_6.width + spacing,
                        y: (gridUnit9_6.height + spacing) * 2,
                        width: gridUnit9_6.width,
                        height: gridUnit9_6.height
                    });
                    // 图4: 第3行第3列，占1列1行
                    positions.push({
                        x: (gridUnit9_6.width + spacing) * 2,
                        y: (gridUnit9_6.height + spacing) * 2,
                        width: gridUnit9_6.width,
                        height: gridUnit9_6.height
                    });
                    // 图5: 第3行第4列，占1列1行
                    positions.push({
                        x: (gridUnit9_6.width + spacing) * 3,
                        y: (gridUnit9_6.height + spacing) * 2,
                        width: gridUnit9_6.width,
                        height: gridUnit9_6.height
                    });
                    // 图6: 第4行第1列，占1列1行
                    positions.push({
                        x: 0,
                        y: (gridUnit9_6.height + spacing) * 3,
                        width: gridUnit9_6.width,
                        height: gridUnit9_6.height
                    });
                    // 图7: 第4行第2列，占1列1行
                    positions.push({
                        x: gridUnit9_6.width + spacing,
                        y: (gridUnit9_6.height + spacing) * 3,
                        width: gridUnit9_6.width,
                        height: gridUnit9_6.height
                    });
                    // 图8: 第4行第3列，占1列1行
                    positions.push({
                        x: (gridUnit9_6.width + spacing) * 2,
                        y: (gridUnit9_6.height + spacing) * 3,
                        width: gridUnit9_6.width,
                        height: gridUnit9_6.height
                    });
                    // 图9: 第4行第4列，占1列1行
                    positions.push({
                        x: (gridUnit9_6.width + spacing) * 3,
                        y: (gridUnit9_6.height + spacing) * 3,
                        width: gridUnit9_6.width,
                        height: gridUnit9_6.height
                    });
                    break;
                case '9-7':
                    // 9图布局第7方案：4×5网格
                    const gridUnit9_7 = {
                        width: (width - spacing * 3) / 4,
                        height: (height - spacing * 4) / 5
                    };
                    // 图1: 第1行第1-2列，占2列1行
                    positions.push({
                        x: 0,
                        y: 0,
                        width: gridUnit9_7.width * 2 + spacing,
                        height: gridUnit9_7.height
                    });
                    // 图2: 第1行第3-4列，占2列1行
                    positions.push({
                        x: (gridUnit9_7.width + spacing) * 2,
                        y: 0,
                        width: gridUnit9_7.width * 2 + spacing,
                        height: gridUnit9_7.height
                    });
                    // 图3: 第2-4行第1列，占1列3行
                    positions.push({
                        x: 0,
                        y: gridUnit9_7.height + spacing,
                        width: gridUnit9_7.width,
                        height: gridUnit9_7.height * 3 + spacing * 2
                    });
                    // 图4: 第2-4行第2-3列，占2列3行
                    positions.push({
                        x: gridUnit9_7.width + spacing,
                        y: gridUnit9_7.height + spacing,
                        width: gridUnit9_7.width * 2 + spacing,
                        height: gridUnit9_7.height * 3 + spacing * 2
                    });
                    // 图5: 第2-4行第4列，占1列3行
                    positions.push({
                        x: (gridUnit9_7.width + spacing) * 3,
                        y: gridUnit9_7.height + spacing,
                        width: gridUnit9_7.width,
                        height: gridUnit9_7.height * 3 + spacing * 2
                    });
                    // 图6: 第5行第1列，占1列1行
                    positions.push({
                        x: 0,
                        y: (gridUnit9_7.height + spacing) * 4,
                        width: gridUnit9_7.width,
                        height: gridUnit9_7.height
                    });
                    // 图7: 第5行第2列，占1列1行
                    positions.push({
                        x: gridUnit9_7.width + spacing,
                        y: (gridUnit9_7.height + spacing) * 4,
                        width: gridUnit9_7.width,
                        height: gridUnit9_7.height
                    });
                    // 图8: 第5行第3列，占1列1行
                    positions.push({
                        x: (gridUnit9_7.width + spacing) * 2,
                        y: (gridUnit9_7.height + spacing) * 4,
                        width: gridUnit9_7.width,
                        height: gridUnit9_7.height
                    });
                    // 图9: 第5行第4列，占1列1行
                    positions.push({
                        x: (gridUnit9_7.width + spacing) * 3,
                        y: (gridUnit9_7.height + spacing) * 4,
                        width: gridUnit9_7.width,
                        height: gridUnit9_7.height
                    });
                    break;
                case '9-8':
                    // 9图布局第8方案：6×6网格
                    const gridUnit9_8 = {
                        width: (width - spacing * 5) / 6,
                        height: (height - spacing * 5) / 6
                    };
                    // 图1: 第1行第1列，占2列2行
                    positions.push({
                        x: 0,
                        y: 0,
                        width: gridUnit9_8.width * 2 + spacing,
                        height: gridUnit9_8.height * 2 + spacing
                    });
                    // 图2: 第1行第3列，占1列1行
                    positions.push({
                        x: (gridUnit9_8.width + spacing) * 2,
                        y: 0,
                        width: gridUnit9_8.width,
                        height: gridUnit9_8.height
                    });
                    // 图3: 第1行第4-6列，占3列3行
                    positions.push({
                        x: (gridUnit9_8.width + spacing) * 3,
                        y: 0,
                        width: gridUnit9_8.width * 3 + spacing * 2,
                        height: gridUnit9_8.height * 3 + spacing * 2
                    });
                    // 图4: 第2行第3列，占1列1行
                    positions.push({
                        x: (gridUnit9_8.width + spacing) * 2,
                        y: gridUnit9_8.height + spacing,
                        width: gridUnit9_8.width,
                        height: gridUnit9_8.height
                    });
                    // 图5: 第3行第1列，占1列1行
                    positions.push({
                        x: 0,
                        y: (gridUnit9_8.height + spacing) * 2,
                        width: gridUnit9_8.width,
                        height: gridUnit9_8.height
                    });
                    // 图6: 第3行第2列，占1列1行
                    positions.push({
                        x: gridUnit9_8.width + spacing,
                        y: (gridUnit9_8.height + spacing) * 2,
                        width: gridUnit9_8.width,
                        height: gridUnit9_8.height
                    });
                    // 图7: 第3行第3列，占1列1行
                    positions.push({
                        x: (gridUnit9_8.width + spacing) * 2,
                        y: (gridUnit9_8.height + spacing) * 2,
                        width: gridUnit9_8.width,
                        height: gridUnit9_8.height
                    });
                    // 图8: 第4行第1-3列，占3列3行
                    positions.push({
                        x: 0,
                        y: (gridUnit9_8.height + spacing) * 3,
                        width: gridUnit9_8.width * 3 + spacing * 2,
                        height: gridUnit9_8.height * 3 + spacing * 2
                    });
                    // 图9: 第4行第4-6列，占3列3行
                    positions.push({
                        x: (gridUnit9_8.width + spacing) * 3,
                        y: (gridUnit9_8.height + spacing) * 3,
                        width: gridUnit9_8.width * 3 + spacing * 2,
                        height: gridUnit9_8.height * 3 + spacing * 2
                    });
                    break;
                case '9-9':
                    // 9图布局第9方案：12×12网格
                    const gridUnit9_9 = {
                        width: (width - spacing * 11) / 12,
                        height: (height - spacing * 11) / 12
                    };
                    // 图1: 第1行第1列，占3列4行
                    positions.push({
                        x: 0,
                        y: 0,
                        width: gridUnit9_9.width * 3 + spacing * 2,
                        height: gridUnit9_9.height * 4 + spacing * 3
                    });
                    // 图2: 第1行第4列，占3列4行
                    positions.push({
                        x: (gridUnit9_9.width + spacing) * 3,
                        y: 0,
                        width: gridUnit9_9.width * 3 + spacing * 2,
                        height: gridUnit9_9.height * 4 + spacing * 3
                    });
                    // 图3: 第1行第7列，占3列4行
                    positions.push({
                        x: (gridUnit9_9.width + spacing) * 6,
                        y: 0,
                        width: gridUnit9_9.width * 3 + spacing * 2,
                        height: gridUnit9_9.height * 4 + spacing * 3
                    });
                    // 图4: 第1行第10列，占3列4行
                    positions.push({
                        x: (gridUnit9_9.width + spacing) * 9,
                        y: 0,
                        width: gridUnit9_9.width * 3 + spacing * 2,
                        height: gridUnit9_9.height * 4 + spacing * 3
                    });
                    // 图5: 第5行第1列，占3列4行
                    positions.push({
                        x: 0,
                        y: (gridUnit9_9.height + spacing) * 4,
                        width: gridUnit9_9.width * 3 + spacing * 2,
                        height: gridUnit9_9.height * 4 + spacing * 3
                    });
                    // 图6: 第5行第4列，占3列4行
                    positions.push({
                        x: (gridUnit9_9.width + spacing) * 3,
                        y: (gridUnit9_9.height + spacing) * 4,
                        width: gridUnit9_9.width * 3 + spacing * 2,
                        height: gridUnit9_9.height * 4 + spacing * 3
                    });
                    // 图7: 第5行第7列，占3列4行
                    positions.push({
                        x: (gridUnit9_9.width + spacing) * 6,
                        y: (gridUnit9_9.height + spacing) * 4,
                        width: gridUnit9_9.width * 3 + spacing * 2,
                        height: gridUnit9_9.height * 4 + spacing * 3
                    });
                    // 图8: 第5行第10列，占3列4行
                    positions.push({
                        x: (gridUnit9_9.width + spacing) * 9,
                        y: (gridUnit9_9.height + spacing) * 4,
                        width: gridUnit9_9.width * 3 + spacing * 2,
                        height: gridUnit9_9.height * 4 + spacing * 3
                    });
                    // 图9: 第9行第1列，占12列4行
                    positions.push({
                        x: 0,
                        y: (gridUnit9_9.height + spacing) * 8,
                        width: gridUnit9_9.width * 12 + spacing * 11,
                        height: gridUnit9_9.height * 4 + spacing * 3
                    });
                    break;
                case '9-10':
                    // 9图布局第10方案：12×12网格
                    const gridUnit9_10 = {
                        width: (width - spacing * 11) / 12,
                        height: (height - spacing * 11) / 12
                    };
                    // 图1: 第1行第1列，占6列8行
                    positions.push({
                        x: 0,
                        y: 0,
                        width: gridUnit9_10.width * 6 + spacing * 5,
                        height: gridUnit9_10.height * 8 + spacing * 7
                    });
                    // 图2: 第1行第7列，占3列4行
                    positions.push({
                        x: (gridUnit9_10.width + spacing) * 6,
                        y: 0,
                        width: gridUnit9_10.width * 3 + spacing * 2,
                        height: gridUnit9_10.height * 4 + spacing * 3
                    });
                    // 图3: 第1行第10列，占3列4行
                    positions.push({
                        x: (gridUnit9_10.width + spacing) * 9,
                        y: 0,
                        width: gridUnit9_10.width * 3 + spacing * 2,
                        height: gridUnit9_10.height * 4 + spacing * 3
                    });
                    // 图4: 第5行第7列，占3列4行
                    positions.push({
                        x: (gridUnit9_10.width + spacing) * 6,
                        y: (gridUnit9_10.height + spacing) * 4,
                        width: gridUnit9_10.width * 3 + spacing * 2,
                        height: gridUnit9_10.height * 4 + spacing * 3
                    });
                    // 图5: 第5行第10列，占3列4行
                    positions.push({
                        x: (gridUnit9_10.width + spacing) * 9,
                        y: (gridUnit9_10.height + spacing) * 4,
                        width: gridUnit9_10.width * 3 + spacing * 2,
                        height: gridUnit9_10.height * 4 + spacing * 3
                    });
                    // 图6: 第9行第1列，占3列4行
                    positions.push({
                        x: 0,
                        y: (gridUnit9_10.height + spacing) * 8,
                        width: gridUnit9_10.width * 3 + spacing * 2,
                        height: gridUnit9_10.height * 4 + spacing * 3
                    });
                    // 图7: 第9行第4列，占3列4行
                    positions.push({
                        x: (gridUnit9_10.width + spacing) * 3,
                        y: (gridUnit9_10.height + spacing) * 8,
                        width: gridUnit9_10.width * 3 + spacing * 2,
                        height: gridUnit9_10.height * 4 + spacing * 3
                    });
                    // 图8: 第9行第7列，占3列4行
                    positions.push({
                        x: (gridUnit9_10.width + spacing) * 6,
                        y: (gridUnit9_10.height + spacing) * 8,
                        width: gridUnit9_10.width * 3 + spacing * 2,
                        height: gridUnit9_10.height * 4 + spacing * 3
                    });
                    // 图9: 第9行第10列，占3列4行
                    positions.push({
                        x: (gridUnit9_10.width + spacing) * 9,
                        y: (gridUnit9_10.height + spacing) * 8,
                        width: gridUnit9_10.width * 3 + spacing * 2,
                        height: gridUnit9_10.height * 4 + spacing * 3
                    });
                    break;
                case '9-11':
                    // 9图布局第11方案：12×12网格
                    const gridUnit9_11 = {
                        width: (width - spacing * 11) / 12,
                        height: (height - spacing * 11) / 12
                    };
                    // 图1: 第1行第1列，占3列4行
                    positions.push({
                        x: 0,
                        y: 0,
                        width: gridUnit9_11.width * 3 + spacing * 2,
                        height: gridUnit9_11.height * 4 + spacing * 3
                    });
                    // 图2: 第1行第4列，占3列4行
                    positions.push({
                        x: (gridUnit9_11.width + spacing) * 3,
                        y: 0,
                        width: gridUnit9_11.width * 3 + spacing * 2,
                        height: gridUnit9_11.height * 4 + spacing * 3
                    });
                    // 图3: 第1行第7列，占3列4行
                    positions.push({
                        x: (gridUnit9_11.width + spacing) * 6,
                        y: 0,
                        width: gridUnit9_11.width * 3 + spacing * 2,
                        height: gridUnit9_11.height * 4 + spacing * 3
                    });
                    // 图4: 第1行第10列，占3列4行
                    positions.push({
                        x: (gridUnit9_11.width + spacing) * 9,
                        y: 0,
                        width: gridUnit9_11.width * 3 + spacing * 2,
                        height: gridUnit9_11.height * 4 + spacing * 3
                    });
                    // 图5: 第5行第1列，占3列4行
                    positions.push({
                        x: 0,
                        y: (gridUnit9_11.height + spacing) * 4,
                        width: gridUnit9_11.width * 3 + spacing * 2,
                        height: gridUnit9_11.height * 4 + spacing * 3
                    });
                    // 图6: 第5行第4列，占3列4行
                    positions.push({
                        x: (gridUnit9_11.width + spacing) * 3,
                        y: (gridUnit9_11.height + spacing) * 4,
                        width: gridUnit9_11.width * 3 + spacing * 2,
                        height: gridUnit9_11.height * 4 + spacing * 3
                    });
                    // 图7: 第5行第7列，占6列8行
                    positions.push({
                        x: (gridUnit9_11.width + spacing) * 6,
                        y: (gridUnit9_11.height + spacing) * 4,
                        width: gridUnit9_11.width * 6 + spacing * 5,
                        height: gridUnit9_11.height * 8 + spacing * 7
                    });
                    // 图8: 第9行第1列，占3列4行
                    positions.push({
                        x: 0,
                        y: (gridUnit9_11.height + spacing) * 8,
                        width: gridUnit9_11.width * 3 + spacing * 2,
                        height: gridUnit9_11.height * 4 + spacing * 3
                    });
                    // 图9: 第9行第4列，占3列4行
                    positions.push({
                        x: (gridUnit9_11.width + spacing) * 3,
                        y: (gridUnit9_11.height + spacing) * 8,
                        width: gridUnit9_11.width * 3 + spacing * 2,
                        height: gridUnit9_11.height * 4 + spacing * 3
                    });
                    break;
                case '9-12':
                    // 9图布局第12方案：4×4网格
                    const gridUnit9_12 = {
                        width: (width - spacing * 3) / 4,
                        height: (height - spacing * 3) / 4
                    };
                    // 图1: 第1行第1列，占1列1行
                    positions.push({
                        x: 0,
                        y: 0,
                        width: gridUnit9_12.width,
                        height: gridUnit9_12.height
                    });
                    // 图2: 第1行第2列，占1列1行
                    positions.push({
                        x: gridUnit9_12.width + spacing,
                        y: 0,
                        width: gridUnit9_12.width,
                        height: gridUnit9_12.height
                    });
                    // 图3: 第1行第3列，占1列1行
                    positions.push({
                        x: (gridUnit9_12.width + spacing) * 2,
                        y: 0,
                        width: gridUnit9_12.width,
                        height: gridUnit9_12.height
                    });
                    // 图4: 第1行第4列，占1列1行
                    positions.push({
                        x: (gridUnit9_12.width + spacing) * 3,
                        y: 0,
                        width: gridUnit9_12.width,
                        height: gridUnit9_12.height
                    });
                    // 图5: 第2-3行第1-4列，占4列2行
                    positions.push({
                        x: 0,
                        y: gridUnit9_12.height + spacing,
                        width: gridUnit9_12.width * 4 + spacing * 3,
                        height: gridUnit9_12.height * 2 + spacing
                    });
                    // 图6: 第4行第1列，占1列1行
                    positions.push({
                        x: 0,
                        y: (gridUnit9_12.height + spacing) * 3,
                        width: gridUnit9_12.width,
                        height: gridUnit9_12.height
                    });
                    // 图7: 第4行第2列，占1列1行
                    positions.push({
                        x: gridUnit9_12.width + spacing,
                        y: (gridUnit9_12.height + spacing) * 3,
                        width: gridUnit9_12.width,
                        height: gridUnit9_12.height
                    });
                    // 图8: 第4行第3列，占1列1行
                    positions.push({
                        x: (gridUnit9_12.width + spacing) * 2,
                        y: (gridUnit9_12.height + spacing) * 3,
                        width: gridUnit9_12.width,
                        height: gridUnit9_12.height
                    });
                    // 图9: 第4行第4列，占1列1行
                    positions.push({
                        x: (gridUnit9_12.width + spacing) * 3,
                        y: (gridUnit9_12.height + spacing) * 3,
                        width: gridUnit9_12.width,
                        height: gridUnit9_12.height
                    });
                    break;
                case '9-13':
                    // 9图布局第13方案：6×6网格
                    const gridUnit9_13 = {
                        width: (width - spacing * 5) / 6,
                        height: (height - spacing * 5) / 6
                    };
                    // 图1: 第1行第1列，占3列3行
                    positions.push({
                        x: 0,
                        y: 0,
                        width: gridUnit9_13.width * 3 + spacing * 2,
                        height: gridUnit9_13.height * 3 + spacing * 2
                    });
                    // 图2: 第1行第4列，占3列3行
                    positions.push({
                        x: (gridUnit9_13.width + spacing) * 3,
                        y: 0,
                        width: gridUnit9_13.width * 3 + spacing * 2,
                        height: gridUnit9_13.height * 3 + spacing * 2
                    });
                    // 图3: 第4行第1列，占3列3行
                    positions.push({
                        x: 0,
                        y: (gridUnit9_13.height + spacing) * 3,
                        width: gridUnit9_13.width * 3 + spacing * 2,
                        height: gridUnit9_13.height * 3 + spacing * 2
                    });
                    // 图4: 第4行第4列，占2列2行
                    positions.push({
                        x: (gridUnit9_13.width + spacing) * 3,
                        y: (gridUnit9_13.height + spacing) * 3,
                        width: gridUnit9_13.width * 2 + spacing,
                        height: gridUnit9_13.height * 2 + spacing
                    });
                    // 图5: 第4行第6列，占1列1行
                    positions.push({
                        x: (gridUnit9_13.width + spacing) * 5,
                        y: (gridUnit9_13.height + spacing) * 3,
                        width: gridUnit9_13.width,
                        height: gridUnit9_13.height
                    });
                    // 图6: 第5行第6列，占1列1行
                    positions.push({
                        x: (gridUnit9_13.width + spacing) * 5,
                        y: (gridUnit9_13.height + spacing) * 4,
                        width: gridUnit9_13.width,
                        height: gridUnit9_13.height
                    });
                    // 图7: 第6行第6列，占1列1行
                    positions.push({
                        x: (gridUnit9_13.width + spacing) * 5,
                        y: (gridUnit9_13.height + spacing) * 5,
                        width: gridUnit9_13.width,
                        height: gridUnit9_13.height
                    });
                    // 图8: 第6行第4列，占1列1行
                    positions.push({
                        x: (gridUnit9_13.width + spacing) * 3,
                        y: (gridUnit9_13.height + spacing) * 5,
                        width: gridUnit9_13.width,
                        height: gridUnit9_13.height
                    });
                    // 图9: 第6行第5列，占1列1行
                    positions.push({
                        x: (gridUnit9_13.width + spacing) * 4,
                        y: (gridUnit9_13.height + spacing) * 5,
                        width: gridUnit9_13.width,
                        height: gridUnit9_13.height
                    });
                    break;
                case '9-14':
                    // 9图布局第14方案：6×6网格
                    const gridUnit9_14 = {
                        width: (width - spacing * 5) / 6,
                        height: (height - spacing * 5) / 6
                    };
                    // 图1: 第1列第1行，占3列3行
                    positions.push({
                        x: 0,
                        y: 0,
                        width: gridUnit9_14.width * 3 + spacing * 2,
                        height: gridUnit9_14.height * 3 + spacing * 2
                    });
                    // 图2: 第1列第4行，占3列3行
                    positions.push({
                        x: 0,
                        y: gridUnit9_14.height * 3 + spacing * 3,
                        width: gridUnit9_14.width * 3 + spacing * 2,
                        height: gridUnit9_14.height * 3 + spacing * 2
                    });
                    // 图3: 第1行第4列，占2列2行
                    positions.push({
                        x: gridUnit9_14.width * 3 + spacing * 3,
                        y: 0,
                        width: gridUnit9_14.width * 2 + spacing,
                        height: gridUnit9_14.height * 2 + spacing
                    });
                    // 图4: 第3行第4列，占1列1行
                    positions.push({
                        x: gridUnit9_14.width * 3 + spacing * 3,
                        y: gridUnit9_14.height * 2 + spacing * 2,
                        width: gridUnit9_14.width,
                        height: gridUnit9_14.height
                    });
                    // 图5: 第3行第5列，占1列1行
                    positions.push({
                        x: gridUnit9_14.width * 4 + spacing * 4,
                        y: gridUnit9_14.height * 2 + spacing * 2,
                        width: gridUnit9_14.width,
                        height: gridUnit9_14.height
                    });
                    // 图6: 第3行第6列，占1列1行
                    positions.push({
                        x: gridUnit9_14.width * 5 + spacing * 5,
                        y: gridUnit9_14.height * 2 + spacing * 2,
                        width: gridUnit9_14.width,
                        height: gridUnit9_14.height
                    });
                    // 图7: 第6列第1行，占1列1行
                    positions.push({
                        x: gridUnit9_14.width * 5 + spacing * 5,
                        y: 0,
                        width: gridUnit9_14.width,
                        height: gridUnit9_14.height
                    });
                    // 图8: 第6列第2行，占1列1行
                    positions.push({
                        x: gridUnit9_14.width * 5 + spacing * 5,
                        y: gridUnit9_14.height + spacing,
                        width: gridUnit9_14.width,
                        height: gridUnit9_14.height
                    });
                    // 图9: 第4行第4列，占3列3行
                    positions.push({
                        x: gridUnit9_14.width * 3 + spacing * 3,
                        y: gridUnit9_14.height * 3 + spacing * 3,
                        width: gridUnit9_14.width * 3 + spacing * 2,
                        height: gridUnit9_14.height * 3 + spacing * 2
                    });
                    break;
                case '9-15':
                    // 9图布局第15方案：6×6网格
                    const gridUnit9_15 = {
                        width: (width - spacing * 5) / 6,
                        height: (height - spacing * 5) / 6
                    };
                    // 图1: 第1行第1列，占3列3行
                    positions.push({
                        x: 0,
                        y: 0,
                        width: gridUnit9_15.width * 3 + spacing * 2,
                        height: gridUnit9_15.height * 3 + spacing * 2
                    });
                    // 图2: 第1行第4列，占3列3行
                    positions.push({
                        x: gridUnit9_15.width * 3 + spacing * 3,
                        y: 0,
                        width: gridUnit9_15.width * 3 + spacing * 2,
                        height: gridUnit9_15.height * 3 + spacing * 2
                    });
                    // 图3: 第4行第1列，占2列2行
                    positions.push({
                        x: 0,
                        y: gridUnit9_15.height * 3 + spacing * 3,
                        width: gridUnit9_15.width * 2 + spacing,
                        height: gridUnit9_15.height * 2 + spacing
                    });
                    // 图4: 第4行第3列，占1列1行
                    positions.push({
                        x: gridUnit9_15.width * 2 + spacing * 2,
                        y: gridUnit9_15.height * 3 + spacing * 3,
                        width: gridUnit9_15.width,
                        height: gridUnit9_15.height
                    });
                    // 图5: 第5行第3列，占1列1行
                    positions.push({
                        x: gridUnit9_15.width * 2 + spacing * 2,
                        y: gridUnit9_15.height * 4 + spacing * 4,
                        width: gridUnit9_15.width,
                        height: gridUnit9_15.height
                    });
                    // 图6: 第6行第3列，占1列1行
                    positions.push({
                        x: gridUnit9_15.width * 2 + spacing * 2,
                        y: gridUnit9_15.height * 5 + spacing * 5,
                        width: gridUnit9_15.width,
                        height: gridUnit9_15.height
                    });
                    // 图7: 第6行第1列，占1列1行
                    positions.push({
                        x: 0,
                        y: gridUnit9_15.height * 5 + spacing * 5,
                        width: gridUnit9_15.width,
                        height: gridUnit9_15.height
                    });
                    // 图8: 第6行第2列，占1列1行
                    positions.push({
                        x: gridUnit9_15.width + spacing,
                        y: gridUnit9_15.height * 5 + spacing * 5,
                        width: gridUnit9_15.width,
                        height: gridUnit9_15.height
                    });
                    // 图9: 第4行第4列，占3列3行
                    positions.push({
                        x: gridUnit9_15.width * 3 + spacing * 3,
                        y: gridUnit9_15.height * 3 + spacing * 3,
                        width: gridUnit9_15.width * 3 + spacing * 2,
                        height: gridUnit9_15.height * 3 + spacing * 2
                    });
                    break;
                case '10-1':
                    // 10图布局第1方案：5×5网格
                    const gridUnit10_1 = {
                        width: (width - spacing * 4) / 5,
                        height: (height - spacing * 4) / 5
                    };
                    // 图1: 第1个图形，占4列4行
                    positions.push({
                        x: 0,
                        y: 0,
                        width: gridUnit10_1.width * 4 + spacing * 3,
                        height: gridUnit10_1.height * 4 + spacing * 3
                    });
                    // 图2-5: 第5列前4行，4个图形各占1行
                    for (let i = 0; i < 4; i++) {
                        positions.push({
                            x: gridUnit10_1.width * 4 + spacing * 4,
                            y: gridUnit10_1.height * i + spacing * i,
                            width: gridUnit10_1.width,
                            height: gridUnit10_1.height
                        });
                    }
                    // 图6-10: 第5行，5个图形各占1列
                    for (let i = 0; i < 5; i++) {
                        positions.push({
                            x: gridUnit10_1.width * i + spacing * i,
                            y: gridUnit10_1.height * 4 + spacing * 4,
                            width: gridUnit10_1.width,
                            height: gridUnit10_1.height
                        });
                    }
                    break;
                case '10-2':
                    // 10图布局第2方案：12×12网格
                    const gridUnit10_2 = {
                        width: (width - spacing * 11) / 12,
                        height: (height - spacing * 11) / 12
                    };
                    // 图1: 第1行，占12列3行
                    positions.push({
                        x: 0,
                        y: 0,
                        width: width,
                        height: gridUnit10_2.height * 3 + spacing * 2
                    });
                    // 图2-4: 第4行，3个图形各占4列3行
                    for (let col = 0; col < 3; col++) {
                        positions.push({
                            x: gridUnit10_2.width * col * 4 + spacing * col * 4,
                            y: gridUnit10_2.height * 3 + spacing * 3,
                            width: gridUnit10_2.width * 4 + spacing * 3,
                            height: gridUnit10_2.height * 3 + spacing * 2
                        });
                    }
                    // 图5-7: 第7行，3个图形各占4列3行
                    for (let col = 0; col < 3; col++) {
                        positions.push({
                            x: gridUnit10_2.width * col * 4 + spacing * col * 4,
                            y: gridUnit10_2.height * 6 + spacing * 6,
                            width: gridUnit10_2.width * 4 + spacing * 3,
                            height: gridUnit10_2.height * 3 + spacing * 2
                        });
                    }
                    // 图8-10: 第10行，3个图形各占4列3行
                    for (let col = 0; col < 3; col++) {
                        positions.push({
                            x: gridUnit10_2.width * col * 4 + spacing * col * 4,
                            y: gridUnit10_2.height * 9 + spacing * 9,
                            width: gridUnit10_2.width * 4 + spacing * 3,
                            height: gridUnit10_2.height * 3 + spacing * 2
                        });
                    }
                    break;
                case '10-3':
                    // 10图布局第3方案：12×12网格
                    const gridUnit10_3 = {
                        width: (width - spacing * 11) / 12,
                        height: (height - spacing * 11) / 12
                    };
                    // 图1: 第1列，占3列12行
                    positions.push({
                        x: 0,
                        y: 0,
                        width: gridUnit10_3.width * 3 + spacing * 2,
                        height: height
                    });
                    // 图2-4: 第4列，3个图形各占3列4行
                    for (let row = 0; row < 3; row++) {
                        positions.push({
                            x: gridUnit10_3.width * 3 + spacing * 3,
                            y: gridUnit10_3.height * row * 4 + spacing * row * 4,
                            width: gridUnit10_3.width * 3 + spacing * 2,
                            height: gridUnit10_3.height * 4 + spacing * 3
                        });
                    }
                    // 图5-7: 第7列，3个图形各占3列4行
                    for (let row = 0; row < 3; row++) {
                        positions.push({
                            x: gridUnit10_3.width * 6 + spacing * 6,
                            y: gridUnit10_3.height * row * 4 + spacing * row * 4,
                            width: gridUnit10_3.width * 3 + spacing * 2,
                            height: gridUnit10_3.height * 4 + spacing * 3
                        });
                    }
                    // 图8-10: 第10列，3个图形各占3列4行
                    for (let row = 0; row < 3; row++) {
                        positions.push({
                            x: gridUnit10_3.width * 9 + spacing * 9,
                            y: gridUnit10_3.height * row * 4 + spacing * row * 4,
                            width: gridUnit10_3.width * 3 + spacing * 2,
                            height: gridUnit10_3.height * 4 + spacing * 3
                        });
                    }
                    break;
                case '10-4':
                    // 10图布局第4方案：4×4网格
                    const gridUnit10_4 = {
                        width: (width - spacing * 3) / 4,
                        height: (height - spacing * 3) / 4
                    };
                    // 图1: 第1行第1列，占2列2行
                    positions.push({
                        x: 0,
                        y: 0,
                        width: gridUnit10_4.width * 2 + spacing,
                        height: gridUnit10_4.height * 2 + spacing
                    });
                    // 图2: 第1行第3列，占1列1行
                    positions.push({
                        x: gridUnit10_4.width * 2 + spacing * 2,
                        y: 0,
                        width: gridUnit10_4.width,
                        height: gridUnit10_4.height
                    });
                    // 图3: 第1行第4列，占1列1行
                    positions.push({
                        x: gridUnit10_4.width * 3 + spacing * 3,
                        y: 0,
                        width: gridUnit10_4.width,
                        height: gridUnit10_4.height
                    });
                    // 图4: 第2行第3列，占1列1行
                    positions.push({
                        x: gridUnit10_4.width * 2 + spacing * 2,
                        y: gridUnit10_4.height + spacing,
                        width: gridUnit10_4.width,
                        height: gridUnit10_4.height
                    });
                    // 图5: 第2行第4列，占1列1行
                    positions.push({
                        x: gridUnit10_4.width * 3 + spacing * 3,
                        y: gridUnit10_4.height + spacing,
                        width: gridUnit10_4.width,
                        height: gridUnit10_4.height
                    });
                    // 图6: 第3行第1列，占1列1行
                    positions.push({
                        x: 0,
                        y: gridUnit10_4.height * 2 + spacing * 2,
                        width: gridUnit10_4.width,
                        height: gridUnit10_4.height
                    });
                    // 图7: 第3行第2列，占1列1行
                    positions.push({
                        x: gridUnit10_4.width + spacing,
                        y: gridUnit10_4.height * 2 + spacing * 2,
                        width: gridUnit10_4.width,
                        height: gridUnit10_4.height
                    });
                    // 图8: 第3行第3列，占2列2行
                    positions.push({
                        x: gridUnit10_4.width * 2 + spacing * 2,
                        y: gridUnit10_4.height * 2 + spacing * 2,
                        width: gridUnit10_4.width * 2 + spacing,
                        height: gridUnit10_4.height * 2 + spacing
                    });
                    // 图9: 第4行第1列，占1列1行
                    positions.push({
                        x: 0,
                        y: gridUnit10_4.height * 3 + spacing * 3,
                        width: gridUnit10_4.width,
                        height: gridUnit10_4.height
                    });
                    // 图10: 第4行第2列，占1列1行
                    positions.push({
                        x: gridUnit10_4.width + spacing,
                        y: gridUnit10_4.height * 3 + spacing * 3,
                        width: gridUnit10_4.width,
                        height: gridUnit10_4.height
                    });
                    break;
                case '10-5':
                    // 10图布局第5方案：8×8网格
                    const gridUnit10_5 = {
                        width: (width - spacing * 7) / 8,
                        height: (height - spacing * 7) / 8
                    };
                    // 图1: 第1列第1行，占4列4行
                    positions.push({
                        x: 0,
                        y: 0,
                        width: gridUnit10_5.width * 4 + spacing * 3,
                        height: gridUnit10_5.height * 4 + spacing * 3
                    });
                    // 图2: 第1列第5行，占4列4行
                    positions.push({
                        x: 0,
                        y: gridUnit10_5.height * 4 + spacing * 4,
                        width: gridUnit10_5.width * 4 + spacing * 3,
                        height: gridUnit10_5.height * 4 + spacing * 3
                    });
                    // 图3: 第1行第5列，占2列2行
                    positions.push({
                        x: gridUnit10_5.width * 4 + spacing * 4,
                        y: 0,
                        width: gridUnit10_5.width * 2 + spacing,
                        height: gridUnit10_5.height * 2 + spacing
                    });
                    // 图4: 第1行第7列，占2列2行
                    positions.push({
                        x: gridUnit10_5.width * 6 + spacing * 6,
                        y: 0,
                        width: gridUnit10_5.width * 2 + spacing,
                        height: gridUnit10_5.height * 2 + spacing
                    });
                    // 图5: 第5列第3行，占4列4行
                    positions.push({
                        x: gridUnit10_5.width * 4 + spacing * 4,
                        y: gridUnit10_5.height * 2 + spacing * 2,
                        width: gridUnit10_5.width * 4 + spacing * 3,
                        height: gridUnit10_5.height * 4 + spacing * 3
                    });
                    // 图6: 第5列第7行，占1列1行
                    positions.push({
                        x: gridUnit10_5.width * 4 + spacing * 4,
                        y: gridUnit10_5.height * 6 + spacing * 6,
                        width: gridUnit10_5.width,
                        height: gridUnit10_5.height
                    });
                    // 图7: 第6列第7行，占1列1行
                    positions.push({
                        x: gridUnit10_5.width * 5 + spacing * 5,
                        y: gridUnit10_5.height * 6 + spacing * 6,
                        width: gridUnit10_5.width,
                        height: gridUnit10_5.height
                    });
                    // 图8: 第7列第7行，占1列1行
                    positions.push({
                        x: gridUnit10_5.width * 6 + spacing * 6,
                        y: gridUnit10_5.height * 6 + spacing * 6,
                        width: gridUnit10_5.width,
                        height: gridUnit10_5.height
                    });
                    // 图9: 第8列第7行，占1列1行
                    positions.push({
                        x: gridUnit10_5.width * 7 + spacing * 7,
                        y: gridUnit10_5.height * 6 + spacing * 6,
                        width: gridUnit10_5.width,
                        height: gridUnit10_5.height
                    });
                    // 图10: 第5列第8行，占4列1行
                    positions.push({
                        x: gridUnit10_5.width * 4 + spacing * 4,
                        y: gridUnit10_5.height * 7 + spacing * 7,
                        width: gridUnit10_5.width * 4 + spacing * 3,
                        height: gridUnit10_5.height
                    });
                    break;
                case '10-7':
                    // 10图布局第7方案：6×6网格
                    const gridUnit10_7 = {
                        width: (width - spacing * 5) / 6,
                        height: (height - spacing * 5) / 6
                    };
                    // 图1: 第1行第1列，占2列2行
                    positions.push({
                        x: 0,
                        y: 0,
                        width: gridUnit10_7.width * 2 + spacing,
                        height: gridUnit10_7.height * 2 + spacing
                    });
                    // 图2: 第1行第3列，占2列2行
                    positions.push({
                        x: gridUnit10_7.width * 2 + spacing * 2,
                        y: 0,
                        width: gridUnit10_7.width * 2 + spacing,
                        height: gridUnit10_7.height * 2 + spacing
                    });
                    // 图3: 第1行第5列，占2列2行
                    positions.push({
                        x: gridUnit10_7.width * 4 + spacing * 4,
                        y: 0,
                        width: gridUnit10_7.width * 2 + spacing,
                        height: gridUnit10_7.height * 2 + spacing
                    });
                    // 图4: 第3行第1列，占2列2行
                    positions.push({
                        x: 0,
                        y: gridUnit10_7.height * 2 + spacing * 2,
                        width: gridUnit10_7.width * 2 + spacing,
                        height: gridUnit10_7.height * 2 + spacing
                    });
                    // 图5: 第3行第3列，占2列1行
                    positions.push({
                        x: gridUnit10_7.width * 2 + spacing * 2,
                        y: gridUnit10_7.height * 2 + spacing * 2,
                        width: gridUnit10_7.width * 2 + spacing,
                        height: gridUnit10_7.height
                    });
                    // 图6: 第3行第5列，占2列2行
                    positions.push({
                        x: gridUnit10_7.width * 4 + spacing * 4,
                        y: gridUnit10_7.height * 2 + spacing * 2,
                        width: gridUnit10_7.width * 2 + spacing,
                        height: gridUnit10_7.height * 2 + spacing
                    });
                    // 图7: 第4行第3列，占2列1行
                    positions.push({
                        x: gridUnit10_7.width * 2 + spacing * 2,
                        y: gridUnit10_7.height * 3 + spacing * 3,
                        width: gridUnit10_7.width * 2 + spacing,
                        height: gridUnit10_7.height
                    });
                    // 图8: 第5行第1列，占2列2行
                    positions.push({
                        x: 0,
                        y: gridUnit10_7.height * 4 + spacing * 4,
                        width: gridUnit10_7.width * 2 + spacing,
                        height: gridUnit10_7.height * 2 + spacing
                    });
                    // 图9: 第5行第3列，占2列2行
                    positions.push({
                        x: gridUnit10_7.width * 2 + spacing * 2,
                        y: gridUnit10_7.height * 4 + spacing * 4,
                        width: gridUnit10_7.width * 2 + spacing,
                        height: gridUnit10_7.height * 2 + spacing
                    });
                    // 图10: 第5行第5列，占2列2行
                    positions.push({
                        x: gridUnit10_7.width * 4 + spacing * 4,
                        y: gridUnit10_7.height * 4 + spacing * 4,
                        width: gridUnit10_7.width * 2 + spacing,
                        height: gridUnit10_7.height * 2 + spacing
                    });
                    break;
                case '10-8':
                    // 10图布局第8方案：12×12网格
                    const gridUnit10_8 = {
                        width: (width - spacing * 11) / 12,
                        height: (height - spacing * 11) / 12
                    };
                    // 图1-3: 第1行，3个图形各占4列3行
                    for (let i = 0; i < 3; i++) {
                        positions.push({
                            x: gridUnit10_8.width * i * 4 + spacing * i * 4,
                            y: 0,
                            width: gridUnit10_8.width * 4 + spacing * 3,
                            height: gridUnit10_8.height * 3 + spacing * 2
                        });
                    }
                    // 图4-7: 第4行，4个图形各占3列6行
                    for (let i = 0; i < 4; i++) {
                        positions.push({
                            x: gridUnit10_8.width * i * 3 + spacing * i * 3,
                            y: gridUnit10_8.height * 3 + spacing * 3,
                            width: gridUnit10_8.width * 3 + spacing * 2,
                            height: gridUnit10_8.height * 6 + spacing * 5
                        });
                    }
                    // 图8-10: 第10行，3个图形各占4列3行
                    for (let i = 0; i < 3; i++) {
                        positions.push({
                            x: gridUnit10_8.width * i * 4 + spacing * i * 4,
                            y: gridUnit10_8.height * 9 + spacing * 9,
                            width: gridUnit10_8.width * 4 + spacing * 3,
                            height: gridUnit10_8.height * 3 + spacing * 2
                        });
                    }
                    break;
                case '10-9':
                    // 10图布局第9方案：4×4网格
                    const gridUnit10_9 = {
                        width: (width - spacing * 3) / 4,
                        height: (height - spacing * 3) / 4
                    };
                    // 图1-3: 第1行前3个，各占1列1行
                    for (let i = 0; i < 3; i++) {
                        positions.push({
                            x: gridUnit10_9.width * i + spacing * i,
                            y: 0,
                            width: gridUnit10_9.width,
                            height: gridUnit10_9.height
                        });
                    }
                    // 图4: 第1行第4列，占1列2行
                    positions.push({
                        x: gridUnit10_9.width * 3 + spacing * 3,
                        y: 0,
                        width: gridUnit10_9.width,
                        height: gridUnit10_9.height * 2 + spacing
                    });
                    // 图5-7: 第2行前3个，各占1列1行
                    for (let i = 0; i < 3; i++) {
                        positions.push({
                            x: gridUnit10_9.width * i + spacing * i,
                            y: gridUnit10_9.height + spacing,
                            width: gridUnit10_9.width,
                            height: gridUnit10_9.height
                        });
                    }
                    // 图8: 第3行第1列，占2列2行
                    positions.push({
                        x: 0,
                        y: gridUnit10_9.height * 2 + spacing * 2,
                        width: gridUnit10_9.width * 2 + spacing,
                        height: gridUnit10_9.height * 2 + spacing
                    });
                    // 图9: 第3行第3列，占2列1行
                    positions.push({
                        x: gridUnit10_9.width * 2 + spacing * 2,
                        y: gridUnit10_9.height * 2 + spacing * 2,
                        width: gridUnit10_9.width * 2 + spacing,
                        height: gridUnit10_9.height
                    });
                    // 图10: 第4行第3列，占2列1行
                    positions.push({
                        x: gridUnit10_9.width * 2 + spacing * 2,
                        y: gridUnit10_9.height * 3 + spacing * 3,
                        width: gridUnit10_9.width * 2 + spacing,
                        height: gridUnit10_9.height
                    });
                    break;
                case '10-10':
                    // 10图布局第10方案：12×12网格
                    const gridUnit10_10 = {
                        width: (width - spacing * 11) / 12,
                        height: (height - spacing * 11) / 12
                    };
                    // 图1-2: 第1行，2个图形各占6列4行
                    for (let i = 0; i < 2; i++) {
                        positions.push({
                            x: gridUnit10_10.width * i * 6 + spacing * i * 6,
                            y: 0,
                            width: gridUnit10_10.width * 6 + spacing * 5,
                            height: gridUnit10_10.height * 4 + spacing * 3
                        });
                    }
                    // 图3-6: 第5行，4个图形各占3列4行
                    for (let i = 0; i < 4; i++) {
                        positions.push({
                            x: gridUnit10_10.width * i * 3 + spacing * i * 3,
                            y: gridUnit10_10.height * 4 + spacing * 4,
                            width: gridUnit10_10.width * 3 + spacing * 2,
                            height: gridUnit10_10.height * 4 + spacing * 3
                        });
                    }
                    // 图7-10: 第9行，4个图形各占3列4行
                    for (let i = 0; i < 4; i++) {
                        positions.push({
                            x: gridUnit10_10.width * i * 3 + spacing * i * 3,
                            y: gridUnit10_10.height * 8 + spacing * 8,
                            width: gridUnit10_10.width * 3 + spacing * 2,
                            height: gridUnit10_10.height * 4 + spacing * 3
                        });
                    }
                    break;
                case '10-11':
                    // 10图布局第11方案：8×8网格
                    const gridUnit10_11 = {
                        width: (width - spacing * 7) / 8,
                        height: (height - spacing * 7) / 8
                    };
                    // 图1: 第1行第1列，占4列4行
                    positions.push({
                        x: 0,
                        y: 0,
                        width: gridUnit10_11.width * 4 + spacing * 3,
                        height: gridUnit10_11.height * 4 + spacing * 3
                    });
                    // 图2: 第1行第5列，占4列4行
                    positions.push({
                        x: gridUnit10_11.width * 4 + spacing * 4,
                        y: 0,
                        width: gridUnit10_11.width * 4 + spacing * 3,
                        height: gridUnit10_11.height * 4 + spacing * 3
                    });
                    // 图3: 第5行第1列，占4列4行
                    positions.push({
                        x: 0,
                        y: gridUnit10_11.height * 4 + spacing * 4,
                        width: gridUnit10_11.width * 4 + spacing * 3,
                        height: gridUnit10_11.height * 4 + spacing * 3
                    });
                    // 图4: 第5行第5列，占2列2行
                    positions.push({
                        x: gridUnit10_11.width * 4 + spacing * 4,
                        y: gridUnit10_11.height * 4 + spacing * 4,
                        width: gridUnit10_11.width * 2 + spacing,
                        height: gridUnit10_11.height * 2 + spacing
                    });
                    // 图5: 第5行第7列，占2列2行
                    positions.push({
                        x: gridUnit10_11.width * 6 + spacing * 6,
                        y: gridUnit10_11.height * 4 + spacing * 4,
                        width: gridUnit10_11.width * 2 + spacing,
                        height: gridUnit10_11.height * 2 + spacing
                    });
                    // 图6: 第7行第5列，占2列2行
                    positions.push({
                        x: gridUnit10_11.width * 4 + spacing * 4,
                        y: gridUnit10_11.height * 6 + spacing * 6,
                        width: gridUnit10_11.width * 2 + spacing,
                        height: gridUnit10_11.height * 2 + spacing
                    });
                    // 图7: 第7行第7列，占1列1行
                    positions.push({
                        x: gridUnit10_11.width * 6 + spacing * 6,
                        y: gridUnit10_11.height * 6 + spacing * 6,
                        width: gridUnit10_11.width,
                        height: gridUnit10_11.height
                    });
                    // 图8: 第7行第8列，占1列1行
                    positions.push({
                        x: gridUnit10_11.width * 7 + spacing * 7,
                        y: gridUnit10_11.height * 6 + spacing * 6,
                        width: gridUnit10_11.width,
                        height: gridUnit10_11.height
                    });
                    // 图9: 第8行第7列，占1列1行
                    positions.push({
                        x: gridUnit10_11.width * 6 + spacing * 6,
                        y: gridUnit10_11.height * 7 + spacing * 7,
                        width: gridUnit10_11.width,
                        height: gridUnit10_11.height
                    });
                    // 图10: 第8行第8列，占1列1行
                    positions.push({
                        x: gridUnit10_11.width * 7 + spacing * 7,
                        y: gridUnit10_11.height * 7 + spacing * 7,
                        width: gridUnit10_11.width,
                        height: gridUnit10_11.height
                    });
                    break;
                case '10-6':
                    // 10图布局第6方案：4×4网格
                    const gridUnit10_6 = {
                        width: (width - spacing * 3) / 4,
                        height: (height - spacing * 3) / 4
                    };
                    // 图1: 第1行第1列，占1列1行
                    positions.push({
                        x: 0,
                        y: 0,
                        width: gridUnit10_6.width,
                        height: gridUnit10_6.height
                    });
                    // 图2: 第1行第2列，占1列1行
                    positions.push({
                        x: gridUnit10_6.width + spacing,
                        y: 0,
                        width: gridUnit10_6.width,
                        height: gridUnit10_6.height
                    });
                    // 图3: 第1行第3列，占1列1行
                    positions.push({
                        x: (gridUnit10_6.width + spacing) * 2,
                        y: 0,
                        width: gridUnit10_6.width,
                        height: gridUnit10_6.height
                    });
                    // 图4: 第1行第4列，占1列1行
                    positions.push({
                        x: (gridUnit10_6.width + spacing) * 3,
                        y: 0,
                        width: gridUnit10_6.width,
                        height: gridUnit10_6.height
                    });
                    // 图5: 第2行第1列，占2列2行
                    positions.push({
                        x: 0,
                        y: gridUnit10_6.height + spacing,
                        width: gridUnit10_6.width * 2 + spacing,
                        height: gridUnit10_6.height * 2 + spacing
                    });
                    // 图6: 第2行第3列，占2列2行
                    positions.push({
                        x: (gridUnit10_6.width + spacing) * 2,
                        y: gridUnit10_6.height + spacing,
                        width: gridUnit10_6.width * 2 + spacing,
                        height: gridUnit10_6.height * 2 + spacing
                    });
                    // 图7: 第4行第1列，占1列1行
                    positions.push({
                        x: 0,
                        y: (gridUnit10_6.height + spacing) * 3,
                        width: gridUnit10_6.width,
                        height: gridUnit10_6.height
                    });
                    // 图8: 第4行第2列，占1列1行
                    positions.push({
                        x: gridUnit10_6.width + spacing,
                        y: (gridUnit10_6.height + spacing) * 3,
                        width: gridUnit10_6.width,
                        height: gridUnit10_6.height
                    });
                    // 图9: 第4行第3列，占1列1行
                    positions.push({
                        x: (gridUnit10_6.width + spacing) * 2,
                        y: (gridUnit10_6.height + spacing) * 3,
                        width: gridUnit10_6.width,
                        height: gridUnit10_6.height
                    });
                    // 图10: 第4行第4列，占1列1行
                    positions.push({
                        x: (gridUnit10_6.width + spacing) * 3,
                        y: (gridUnit10_6.height + spacing) * 3,
                        width: gridUnit10_6.width,
                        height: gridUnit10_6.height
                    });
                    break;
                case '11-1':
                    // 11图布局第1方案：4×4网格，左中右对称布局
                    const gridUnit11_1 = {
                        width: (width - spacing * 3) / 4,
                        height: (height - spacing * 3) / 4
                    };
                    // 第1列：4个图形，各占1行
                    for (let i = 0; i < 4; i++) {
                        positions.push({
                            x: 0,
                            y: gridUnit11_1.height * i + spacing * i,
                            width: gridUnit11_1.width,
                            height: gridUnit11_1.height
                        });
                    }
                    // 第2-3列：第1个占1行2列
                    positions.push({
                        x: gridUnit11_1.width + spacing,
                        y: 0,
                        width: gridUnit11_1.width * 2 + spacing,
                        height: gridUnit11_1.height
                    });
                    // 第2-3列：第2个占2行2列
                    positions.push({
                        x: gridUnit11_1.width + spacing,
                        y: gridUnit11_1.height + spacing,
                        width: gridUnit11_1.width * 2 + spacing,
                        height: gridUnit11_1.height * 2 + spacing
                    });
                    // 第2-3列：第3个占1行2列
                    positions.push({
                        x: gridUnit11_1.width + spacing,
                        y: gridUnit11_1.height * 3 + spacing * 3,
                        width: gridUnit11_1.width * 2 + spacing,
                        height: gridUnit11_1.height
                    });
                    // 第4列：4个图形，各占1行
                    for (let i = 0; i < 4; i++) {
                        positions.push({
                            x: gridUnit11_1.width * 3 + spacing * 3,
                            y: gridUnit11_1.height * i + spacing * i,
                            width: gridUnit11_1.width,
                            height: gridUnit11_1.height
                        });
                    }
                    break;
                case '11-2':
                    // 11图布局第2方案：12×12网格，上下分层递减布局
                    const gridUnit11_2 = {
                        width: (width - spacing * 11) / 12,
                        height: (height - spacing * 11) / 12
                    };
                    // 第1行：2个图形，各占3行6列
                    positions.push({
                        x: 0,
                        y: 0,
                        width: gridUnit11_2.width * 6 + spacing * 5,
                        height: gridUnit11_2.height * 3 + spacing * 2
                    });
                    positions.push({
                        x: gridUnit11_2.width * 6 + spacing * 6,
                        y: 0,
                        width: gridUnit11_2.width * 6 + spacing * 5,
                        height: gridUnit11_2.height * 3 + spacing * 2
                    });
                    // 第4行：3个图形，各占3行4列
                    for (let i = 0; i < 3; i++) {
                        positions.push({
                            x: (gridUnit11_2.width * 4 + spacing * 4) * i,
                            y: gridUnit11_2.height * 3 + spacing * 3,
                            width: gridUnit11_2.width * 4 + spacing * 3,
                            height: gridUnit11_2.height * 3 + spacing * 2
                        });
                    }
                    // 第7行：3个图形，各占3行4列
                    for (let i = 0; i < 3; i++) {
                        positions.push({
                            x: (gridUnit11_2.width * 4 + spacing * 4) * i,
                            y: gridUnit11_2.height * 6 + spacing * 6,
                            width: gridUnit11_2.width * 4 + spacing * 3,
                            height: gridUnit11_2.height * 3 + spacing * 2
                        });
                    }
                    // 第10行：3个图形，各占3行4列
                    for (let i = 0; i < 3; i++) {
                        positions.push({
                            x: (gridUnit11_2.width * 4 + spacing * 4) * i,
                            y: gridUnit11_2.height * 9 + spacing * 9,
                            width: gridUnit11_2.width * 4 + spacing * 3,
                            height: gridUnit11_2.height * 3 + spacing * 2
                        });
                    }
                    break;
                case '11-3':
                    // 11图布局第3方案：4×4网格，上下规整中间突出布局
                    const gridUnit11_3 = {
                        width: (width - spacing * 3) / 4,
                        height: (height - spacing * 3) / 4
                    };
                    // 第1行：4个图形，各占1行1列
                    for (let i = 0; i < 4; i++) {
                        positions.push({
                            x: gridUnit11_3.width * i + spacing * i,
                            y: 0,
                            width: gridUnit11_3.width,
                            height: gridUnit11_3.height
                        });
                    }
                    // 第2-3行：第1个占2行1列
                    positions.push({
                        x: 0,
                        y: gridUnit11_3.height + spacing,
                        width: gridUnit11_3.width,
                        height: gridUnit11_3.height * 2 + spacing
                    });
                    // 第2-3行：第2个占2行2列
                    positions.push({
                        x: gridUnit11_3.width + spacing,
                        y: gridUnit11_3.height + spacing,
                        width: gridUnit11_3.width * 2 + spacing,
                        height: gridUnit11_3.height * 2 + spacing
                    });
                    // 第2-3行：第3个占2行1列
                    positions.push({
                        x: gridUnit11_3.width * 3 + spacing * 3,
                        y: gridUnit11_3.height + spacing,
                        width: gridUnit11_3.width,
                        height: gridUnit11_3.height * 2 + spacing
                    });
                    // 第4行：4个图形，各占1行1列
                    for (let i = 0; i < 4; i++) {
                        positions.push({
                            x: gridUnit11_3.width * i + spacing * i,
                            y: gridUnit11_3.height * 3 + spacing * 3,
                            width: gridUnit11_3.width,
                            height: gridUnit11_3.height
                        });
                    }
                    break;
                case '11-4':
                    // 11图布局第4方案：15×15网格，上大下小布局
                    const gridUnit11_4 = {
                        width: (width - spacing * 14) / 15,
                        height: (height - spacing * 14) / 15
                    };
                    // 第1行：1个图形，占15列5行
                    positions.push({
                        x: 0,
                        y: 0,
                        width: width,
                        height: gridUnit11_4.height * 5 + spacing * 4
                    });
                    // 第6行：5个图形，各占3列5行
                    for (let i = 0; i < 5; i++) {
                        positions.push({
                            x: (gridUnit11_4.width * 3 + spacing * 3) * i,
                            y: gridUnit11_4.height * 5 + spacing * 5,
                            width: gridUnit11_4.width * 3 + spacing * 2,
                            height: gridUnit11_4.height * 5 + spacing * 4
                        });
                    }
                    // 第11行：5个图形，各占3列5行
                    for (let i = 0; i < 5; i++) {
                        positions.push({
                            x: (gridUnit11_4.width * 3 + spacing * 3) * i,
                            y: gridUnit11_4.height * 10 + spacing * 10,
                            width: gridUnit11_4.width * 3 + spacing * 2,
                            height: gridUnit11_4.height * 5 + spacing * 4
                        });
                    }
                    break;
                case '11-5':
                    // 11图布局第5方案：15×15网格，上小中大下小布局
                    const gridUnit11_5 = {
                        width: (width - spacing * 14) / 15,
                        height: (height - spacing * 14) / 15
                    };
                    // 第1行：5个图形，各占3列5行
                    for (let i = 0; i < 5; i++) {
                        positions.push({
                            x: (gridUnit11_5.width * 3 + spacing * 3) * i,
                            y: 0,
                            width: gridUnit11_5.width * 3 + spacing * 2,
                            height: gridUnit11_5.height * 5 + spacing * 4
                        });
                    }
                    // 第6行：1个图形，占15列5行
                    positions.push({
                        x: 0,
                        y: gridUnit11_5.height * 5 + spacing * 5,
                        width: width,
                        height: gridUnit11_5.height * 5 + spacing * 4
                    });
                    // 第11行：5个图形，各占3列5行
                    for (let i = 0; i < 5; i++) {
                        positions.push({
                            x: (gridUnit11_5.width * 3 + spacing * 3) * i,
                            y: gridUnit11_5.height * 10 + spacing * 10,
                            width: gridUnit11_5.width * 3 + spacing * 2,
                            height: gridUnit11_5.height * 5 + spacing * 4
                        });
                    }
                    break;
                case '11-6':
                    // 11图布局第6方案：15×15网格，上中小下大布局
                    const gridUnit11_6 = {
                        width: (width - spacing * 14) / 15,
                        height: (height - spacing * 14) / 15
                    };
                    // 第1行：5个图形，各占3列5行
                    for (let i = 0; i < 5; i++) {
                        positions.push({
                            x: (gridUnit11_6.width * 3 + spacing * 3) * i,
                            y: 0,
                            width: gridUnit11_6.width * 3 + spacing * 2,
                            height: gridUnit11_6.height * 5 + spacing * 4
                        });
                    }
                    // 第6行：5个图形，各占3列5行
                    for (let i = 0; i < 5; i++) {
                        positions.push({
                            x: (gridUnit11_6.width * 3 + spacing * 3) * i,
                            y: gridUnit11_6.height * 5 + spacing * 5,
                            width: gridUnit11_6.width * 3 + spacing * 2,
                            height: gridUnit11_6.height * 5 + spacing * 4
                        });
                    }
                    // 第11行：1个图形，占15列5行
                    positions.push({
                        x: 0,
                        y: gridUnit11_6.height * 10 + spacing * 10,
                        width: width,
                        height: gridUnit11_6.height * 5 + spacing * 4
                    });
                    break;
                case '12-1':
                    // 12图布局第1方案：6×6网格，左右对称布局
                    const gridUnit12_1 = {
                        width: (width - spacing * 5) / 6,
                        height: (height - spacing * 5) / 6
                    };
                    // 第1-3列：6个图形，各占1行3列
                    for (let i = 0; i < 6; i++) {
                        positions.push({
                            x: 0,
                            y: gridUnit12_1.height * i + spacing * i,
                            width: gridUnit12_1.width * 3 + spacing * 2,
                            height: gridUnit12_1.height
                        });
                    }
                    // 第4-6列：6个图形，各占1行3列
                    for (let i = 0; i < 6; i++) {
                        positions.push({
                            x: gridUnit12_1.width * 3 + spacing * 3,
                            y: gridUnit12_1.height * i + spacing * i,
                            width: gridUnit12_1.width * 3 + spacing * 2,
                            height: gridUnit12_1.height
                        });
                    }
                    break;
                case '12-2':
                    // 12图布局第2方案：6×6网格，大图+边框布局
                    const gridUnit12_2 = {
                        width: (width - spacing * 5) / 6,
                        height: (height - spacing * 5) / 6
                    };
                    // 第1-5列第1-5行：1个图形，占5行5列
                    positions.push({
                        x: 0,
                        y: 0,
                        width: gridUnit12_2.width * 5 + spacing * 4,
                        height: gridUnit12_2.height * 5 + spacing * 4
                    });
                    // 第6列：6个图形，各占1行
                    for (let i = 0; i < 6; i++) {
                        positions.push({
                            x: gridUnit12_2.width * 5 + spacing * 5,
                            y: gridUnit12_2.height * i + spacing * i,
                            width: gridUnit12_2.width,
                            height: gridUnit12_2.height
                        });
                    }
                    // 第6行：5个图形，各占1列
                    for (let i = 0; i < 5; i++) {
                        positions.push({
                            x: gridUnit12_2.width * i + spacing * i,
                            y: gridUnit12_2.height * 5 + spacing * 5,
                            width: gridUnit12_2.width,
                            height: gridUnit12_2.height
                        });
                    }
                    break;
                case '12-3':
                    // 12图布局第3方案：12×12网格，复杂组合布局
                    const gridUnit12_3 = {
                        width: (width - spacing * 11) / 12,
                        height: (height - spacing * 11) / 12
                    };
                    // 第1-3列：3个图形，各占4行3列
                    for (let i = 0; i < 3; i++) {
                        positions.push({
                            x: 0,
                            y: (gridUnit12_3.height * 4 + spacing * 4) * i,
                            width: gridUnit12_3.width * 3 + spacing * 2,
                            height: gridUnit12_3.height * 4 + spacing * 3
                        });
                    }
                    // 第1行第4-12列：3个图形，各占3行3列
                    for (let i = 0; i < 3; i++) {
                        positions.push({
                            x: gridUnit12_3.width * 3 + spacing * 3 + (gridUnit12_3.width * 3 + spacing * 3) * i,
                            y: 0,
                            width: gridUnit12_3.width * 3 + spacing * 2,
                            height: gridUnit12_3.height * 3 + spacing * 2
                        });
                    }
                    // 第4行第4-12列：3个图形，各占3行3列
                    for (let i = 0; i < 3; i++) {
                        positions.push({
                            x: gridUnit12_3.width * 3 + spacing * 3 + (gridUnit12_3.width * 3 + spacing * 3) * i,
                            y: gridUnit12_3.height * 3 + spacing * 3,
                            width: gridUnit12_3.width * 3 + spacing * 2,
                            height: gridUnit12_3.height * 3 + spacing * 2
                        });
                    }
                    // 第7行第4-9列：1个图形，占6行6列
                    positions.push({
                        x: gridUnit12_3.width * 3 + spacing * 3,
                        y: gridUnit12_3.height * 6 + spacing * 6,
                        width: gridUnit12_3.width * 6 + spacing * 5,
                        height: gridUnit12_3.height * 6 + spacing * 5
                    });
                    // 第7行第10-12列：1个图形，占3行3列
                    positions.push({
                        x: gridUnit12_3.width * 9 + spacing * 9,
                        y: gridUnit12_3.height * 6 + spacing * 6,
                        width: gridUnit12_3.width * 3 + spacing * 2,
                        height: gridUnit12_3.height * 3 + spacing * 2
                    });
                    // 第10行第10-12列：1个图形，占3行3列
                    positions.push({
                        x: gridUnit12_3.width * 9 + spacing * 9,
                        y: gridUnit12_3.height * 9 + spacing * 9,
                        width: gridUnit12_3.width * 3 + spacing * 2,
                        height: gridUnit12_3.height * 3 + spacing * 2
                    });
                    break;
                case '13-1':
                    // 13图布局第1方案：4×4网格，左右对称+中间组合
                    const gridUnit13_1 = {
                        width: (width - spacing * 3) / 4,
                        height: (height - spacing * 3) / 4
                    };
                    // 第1列：4个图形，各占1行
                    for (let i = 0; i < 4; i++) {
                        positions.push({
                            x: 0,
                            y: gridUnit13_1.height * i + spacing * i,
                            width: gridUnit13_1.width,
                            height: gridUnit13_1.height
                        });
                    }
                    // 第4列：4个图形，各占1行
                    for (let i = 0; i < 4; i++) {
                        positions.push({
                            x: gridUnit13_1.width * 3 + spacing * 3,
                            y: gridUnit13_1.height * i + spacing * i,
                            width: gridUnit13_1.width,
                            height: gridUnit13_1.height
                        });
                    }
                    // 第1行第2列：2个图形，各占1列
                    positions.push({
                        x: gridUnit13_1.width + spacing,
                        y: 0,
                        width: gridUnit13_1.width,
                        height: gridUnit13_1.height
                    });
                    positions.push({
                        x: gridUnit13_1.width * 2 + spacing * 2,
                        y: 0,
                        width: gridUnit13_1.width,
                        height: gridUnit13_1.height
                    });
                    // 第2行第2列：1个图形，占2行2列
                    positions.push({
                        x: gridUnit13_1.width + spacing,
                        y: gridUnit13_1.height + spacing,
                        width: gridUnit13_1.width * 2 + spacing,
                        height: gridUnit13_1.height * 2 + spacing
                    });
                    // 第4行第2列：2个图形，各占1列
                    positions.push({
                        x: gridUnit13_1.width + spacing,
                        y: gridUnit13_1.height * 3 + spacing * 3,
                        width: gridUnit13_1.width,
                        height: gridUnit13_1.height
                    });
                    positions.push({
                        x: gridUnit13_1.width * 2 + spacing * 2,
                        y: gridUnit13_1.height * 3 + spacing * 3,
                        width: gridUnit13_1.width,
                        height: gridUnit13_1.height
                    });
                    break;
                case '13-2':
                    // 13图布局第2方案：4×4网格，左上大图+右侧双列
                    const gridUnit13_2 = {
                        width: (width - spacing * 3) / 4,
                        height: (height - spacing * 3) / 4
                    };
                    // 第1-2列第1-2行：1个图形，占2行2列
                    positions.push({
                        x: 0,
                        y: 0,
                        width: gridUnit13_2.width * 2 + spacing,
                        height: gridUnit13_2.height * 2 + spacing
                    });
                    // 第1列第3-4行：2个图形，各占1行
                    positions.push({
                        x: 0,
                        y: gridUnit13_2.height * 2 + spacing * 2,
                        width: gridUnit13_2.width,
                        height: gridUnit13_2.height
                    });
                    positions.push({
                        x: 0,
                        y: gridUnit13_2.height * 3 + spacing * 3,
                        width: gridUnit13_2.width,
                        height: gridUnit13_2.height
                    });
                    // 第3列：4个图形，各占1行
                    for (let i = 0; i < 4; i++) {
                        positions.push({
                            x: gridUnit13_2.width * 2 + spacing * 2,
                            y: gridUnit13_2.height * i + spacing * i,
                            width: gridUnit13_2.width,
                            height: gridUnit13_2.height
                        });
                    }
                    // 第4列：4个图形，各占1行
                    for (let i = 0; i < 4; i++) {
                        positions.push({
                            x: gridUnit13_2.width * 3 + spacing * 3,
                            y: gridUnit13_2.height * i + spacing * i,
                            width: gridUnit13_2.width,
                            height: gridUnit13_2.height
                        });
                    }
                    // 第2列第3-4行：2个图形，各占1行
                    positions.push({
                        x: gridUnit13_2.width + spacing,
                        y: gridUnit13_2.height * 2 + spacing * 2,
                        width: gridUnit13_2.width,
                        height: gridUnit13_2.height
                    });
                    positions.push({
                        x: gridUnit13_2.width + spacing,
                        y: gridUnit13_2.height * 3 + spacing * 3,
                        width: gridUnit13_2.width,
                        height: gridUnit13_2.height
                    });
                    break;
                case '13-3':
                    // 13图布局第3方案：4×4网格，上中下逐渐减少+右下大图
                    const gridUnit13_3 = {
                        width: (width - spacing * 3) / 4,
                        height: (height - spacing * 3) / 4
                    };
                    // 第1行：4个图形，各占1列
                    for (let i = 0; i < 4; i++) {
                        positions.push({
                            x: gridUnit13_3.width * i + spacing * i,
                            y: 0,
                            width: gridUnit13_3.width,
                            height: gridUnit13_3.height
                        });
                    }
                    // 第2行：4个图形，各占1列
                    for (let i = 0; i < 4; i++) {
                        positions.push({
                            x: gridUnit13_3.width * i + spacing * i,
                            y: gridUnit13_3.height + spacing,
                            width: gridUnit13_3.width,
                            height: gridUnit13_3.height
                        });
                    }
                    // 第3行第1-2列：2个图形，各占1列
                    positions.push({
                        x: 0,
                        y: gridUnit13_3.height * 2 + spacing * 2,
                        width: gridUnit13_3.width,
                        height: gridUnit13_3.height
                    });
                    positions.push({
                        x: gridUnit13_3.width + spacing,
                        y: gridUnit13_3.height * 2 + spacing * 2,
                        width: gridUnit13_3.width,
                        height: gridUnit13_3.height
                    });
                    // 第3-4行第3-4列：1个图形，占2行2列
                    positions.push({
                        x: gridUnit13_3.width * 2 + spacing * 2,
                        y: gridUnit13_3.height * 2 + spacing * 2,
                        width: gridUnit13_3.width * 2 + spacing,
                        height: gridUnit13_3.height * 2 + spacing
                    });
                    // 第4行第1-2列：2个图形，各占1列
                    positions.push({
                        x: 0,
                        y: gridUnit13_3.height * 3 + spacing * 3,
                        width: gridUnit13_3.width,
                        height: gridUnit13_3.height
                    });
                    positions.push({
                        x: gridUnit13_3.width + spacing,
                        y: gridUnit13_3.height * 3 + spacing * 3,
                        width: gridUnit13_3.width,
                        height: gridUnit13_3.height
                    });
                    break;
                case '13-4':
                    // 13图布局第4方案：4×4网格，左下大图+右下4小图
                    const gridUnit13_4 = {
                        width: (width - spacing * 3) / 4,
                        height: (height - spacing * 3) / 4
                    };
                    // 第1行：4个图形，各占1列
                    for (let i = 0; i < 4; i++) {
                        positions.push({
                            x: gridUnit13_4.width * i + spacing * i,
                            y: 0,
                            width: gridUnit13_4.width,
                            height: gridUnit13_4.height
                        });
                    }
                    // 第2行：4个图形，各占1列
                    for (let i = 0; i < 4; i++) {
                        positions.push({
                            x: gridUnit13_4.width * i + spacing * i,
                            y: gridUnit13_4.height + spacing,
                            width: gridUnit13_4.width,
                            height: gridUnit13_4.height
                        });
                    }
                    // 第3-4行第1-2列：1个图形，占2行2列
                    positions.push({
                        x: 0,
                        y: gridUnit13_4.height * 2 + spacing * 2,
                        width: gridUnit13_4.width * 2 + spacing,
                        height: gridUnit13_4.height * 2 + spacing
                    });
                    // 第3行第3-4列：2个图形，各占1列
                    positions.push({
                        x: gridUnit13_4.width * 2 + spacing * 2,
                        y: gridUnit13_4.height * 2 + spacing * 2,
                        width: gridUnit13_4.width,
                        height: gridUnit13_4.height
                    });
                    positions.push({
                        x: gridUnit13_4.width * 3 + spacing * 3,
                        y: gridUnit13_4.height * 2 + spacing * 2,
                        width: gridUnit13_4.width,
                        height: gridUnit13_4.height
                    });
                    // 第4行第3-4列：2个图形，各占1列
                    positions.push({
                        x: gridUnit13_4.width * 2 + spacing * 2,
                        y: gridUnit13_4.height * 3 + spacing * 3,
                        width: gridUnit13_4.width,
                        height: gridUnit13_4.height
                    });
                    positions.push({
                        x: gridUnit13_4.width * 3 + spacing * 3,
                        y: gridUnit13_4.height * 3 + spacing * 3,
                        width: gridUnit13_4.width,
                        height: gridUnit13_4.height
                    });
                    break;
                case '13-5':
                    // 13图布局第5方案：4×4网格，右上大图+左侧4小图+下方8图
                    const gridUnit13_5 = {
                        width: (width - spacing * 3) / 4,
                        height: (height - spacing * 3) / 4
                    };
                    // 第1-2行第3-4列：1个图形，占2行2列
                    positions.push({
                        x: gridUnit13_5.width * 2 + spacing * 2,
                        y: 0,
                        width: gridUnit13_5.width * 2 + spacing,
                        height: gridUnit13_5.height * 2 + spacing
                    });
                    // 第1行第1-2列：2个图形，各占1列
                    positions.push({
                        x: 0,
                        y: 0,
                        width: gridUnit13_5.width,
                        height: gridUnit13_5.height
                    });
                    positions.push({
                        x: gridUnit13_5.width + spacing,
                        y: 0,
                        width: gridUnit13_5.width,
                        height: gridUnit13_5.height
                    });
                    // 第2行第1-2列：2个图形，各占1列
                    positions.push({
                        x: 0,
                        y: gridUnit13_5.height + spacing,
                        width: gridUnit13_5.width,
                        height: gridUnit13_5.height
                    });
                    positions.push({
                        x: gridUnit13_5.width + spacing,
                        y: gridUnit13_5.height + spacing,
                        width: gridUnit13_5.width,
                        height: gridUnit13_5.height
                    });
                    // 第3行：4个图形，各占1列
                    for (let i = 0; i < 4; i++) {
                        positions.push({
                            x: gridUnit13_5.width * i + spacing * i,
                            y: gridUnit13_5.height * 2 + spacing * 2,
                            width: gridUnit13_5.width,
                            height: gridUnit13_5.height
                        });
                    }
                    // 第4行：4个图形，各占1列
                    for (let i = 0; i < 4; i++) {
                        positions.push({
                            x: gridUnit13_5.width * i + spacing * i,
                            y: gridUnit13_5.height * 3 + spacing * 3,
                            width: gridUnit13_5.width,
                            height: gridUnit13_5.height
                        });
                    }
                    break;
                case '14-1':
                    // 14图布局第1方案：4×4网格，上下满中间宽窄
                    const gridUnit14_1 = {
                        width: (width - spacing * 3) / 4,
                        height: (height - spacing * 3) / 4
                    };
                    // 第1行：4个图形，各占1列
                    for (let i = 0; i < 4; i++) {
                        positions.push({
                            x: gridUnit14_1.width * i + spacing * i,
                            y: 0,
                            width: gridUnit14_1.width,
                            height: gridUnit14_1.height
                        });
                    }
                    // 第2行：3个图形，第1个占1列，第2个占2列，第3个占1列
                    positions.push({
                        x: 0,
                        y: gridUnit14_1.height + spacing,
                        width: gridUnit14_1.width,
                        height: gridUnit14_1.height
                    });
                    positions.push({
                        x: gridUnit14_1.width + spacing,
                        y: gridUnit14_1.height + spacing,
                        width: gridUnit14_1.width * 2 + spacing,
                        height: gridUnit14_1.height
                    });
                    positions.push({
                        x: gridUnit14_1.width * 3 + spacing * 3,
                        y: gridUnit14_1.height + spacing,
                        width: gridUnit14_1.width,
                        height: gridUnit14_1.height
                    });
                    // 第3行：3个图形，第1个占1列，第2个占2列，第3个占1列
                    positions.push({
                        x: 0,
                        y: gridUnit14_1.height * 2 + spacing * 2,
                        width: gridUnit14_1.width,
                        height: gridUnit14_1.height
                    });
                    positions.push({
                        x: gridUnit14_1.width + spacing,
                        y: gridUnit14_1.height * 2 + spacing * 2,
                        width: gridUnit14_1.width * 2 + spacing,
                        height: gridUnit14_1.height
                    });
                    positions.push({
                        x: gridUnit14_1.width * 3 + spacing * 3,
                        y: gridUnit14_1.height * 2 + spacing * 2,
                        width: gridUnit14_1.width,
                        height: gridUnit14_1.height
                    });
                    // 第4行：4个图形，各占1列
                    for (let i = 0; i < 4; i++) {
                        positions.push({
                            x: gridUnit14_1.width * i + spacing * i,
                            y: gridUnit14_1.height * 3 + spacing * 3,
                            width: gridUnit14_1.width,
                            height: gridUnit14_1.height
                        });
                    }
                    break;
                case '14-2':
                    // 14图布局第2方案：7×2网格，左右对称简单网格
                    const gridUnit14_2 = {
                        width: (width - spacing) / 2,
                        height: (height - spacing * 6) / 7
                    };
                    // 第1列：7个图形，各占1行
                    for (let i = 0; i < 7; i++) {
                        positions.push({
                            x: 0,
                            y: gridUnit14_2.height * i + spacing * i,
                            width: gridUnit14_2.width,
                            height: gridUnit14_2.height
                        });
                    }
                    // 第2列：7个图形，各占1行
                    for (let i = 0; i < 7; i++) {
                        positions.push({
                            x: gridUnit14_2.width + spacing,
                            y: gridUnit14_2.height * i + spacing * i,
                            width: gridUnit14_2.width,
                            height: gridUnit14_2.height
                        });
                    }
                    break;
                case '14-3':
                    // 14图布局第3方案：4×4网格，中间两列高图+角落填充
                    const gridUnit14_3 = {
                        width: (width - spacing * 3) / 4,
                        height: (height - spacing * 3) / 4
                    };
                    // 第1行：4个图形，各占1列
                    for (let i = 0; i < 4; i++) {
                        positions.push({
                            x: gridUnit14_3.width * i + spacing * i,
                            y: 0,
                            width: gridUnit14_3.width,
                            height: gridUnit14_3.height
                        });
                    }
                    // 第2行：4个图形，第1个图形占1列，第2个图形占1列2行，第3个图形占1列2行，第4个图形占1列
                    positions.push({
                        x: 0,
                        y: gridUnit14_3.height + spacing,
                        width: gridUnit14_3.width,
                        height: gridUnit14_3.height
                    });
                    positions.push({
                        x: gridUnit14_3.width + spacing,
                        y: gridUnit14_3.height + spacing,
                        width: gridUnit14_3.width,
                        height: gridUnit14_3.height * 2 + spacing
                    });
                    positions.push({
                        x: gridUnit14_3.width * 2 + spacing * 2,
                        y: gridUnit14_3.height + spacing,
                        width: gridUnit14_3.width,
                        height: gridUnit14_3.height * 2 + spacing
                    });
                    positions.push({
                        x: gridUnit14_3.width * 3 + spacing * 3,
                        y: gridUnit14_3.height + spacing,
                        width: gridUnit14_3.width,
                        height: gridUnit14_3.height
                    });
                    // 第3行第1列：1个图形，占1行1列
                    positions.push({
                        x: 0,
                        y: gridUnit14_3.height * 2 + spacing * 2,
                        width: gridUnit14_3.width,
                        height: gridUnit14_3.height
                    });
                    // 第3行第4列：1个图形，占1行1列
                    positions.push({
                        x: gridUnit14_3.width * 3 + spacing * 3,
                        y: gridUnit14_3.height * 2 + spacing * 2,
                        width: gridUnit14_3.width,
                        height: gridUnit14_3.height
                    });
                    // 第4行：4个图形，各占1列
                    for (let i = 0; i < 4; i++) {
                        positions.push({
                            x: gridUnit14_3.width * i + spacing * i,
                            y: gridUnit14_3.height * 3 + spacing * 3,
                            width: gridUnit14_3.width,
                            height: gridUnit14_3.height
                        });
                    }
                    break;
                case '15-1':
                    // 15图布局第1方案：4×4网格，第1行中间2列大图
                    const gridUnit15_1 = {
                        width: (width - spacing * 3) / 4,
                        height: (height - spacing * 3) / 4
                    };
                    // 第1行：3个图形，第1个占1行1列，第2个占1行2列，第3个占1行1列
                    positions.push({
                        x: 0,
                        y: 0,
                        width: gridUnit15_1.width,
                        height: gridUnit15_1.height
                    });
                    positions.push({
                        x: gridUnit15_1.width + spacing,
                        y: 0,
                        width: gridUnit15_1.width * 2 + spacing,
                        height: gridUnit15_1.height
                    });
                    positions.push({
                        x: gridUnit15_1.width * 3 + spacing * 3,
                        y: 0,
                        width: gridUnit15_1.width,
                        height: gridUnit15_1.height
                    });
                    // 第2行：4个图形，各占1行1列
                    for (let i = 0; i < 4; i++) {
                        positions.push({
                            x: gridUnit15_1.width * i + spacing * i,
                            y: gridUnit15_1.height + spacing,
                            width: gridUnit15_1.width,
                            height: gridUnit15_1.height
                        });
                    }
                    // 第3行：4个图形，各占1行1列
                    for (let i = 0; i < 4; i++) {
                        positions.push({
                            x: gridUnit15_1.width * i + spacing * i,
                            y: gridUnit15_1.height * 2 + spacing * 2,
                            width: gridUnit15_1.width,
                            height: gridUnit15_1.height
                        });
                    }
                    // 第4行：4个图形，各占1行1列
                    for (let i = 0; i < 4; i++) {
                        positions.push({
                            x: gridUnit15_1.width * i + spacing * i,
                            y: gridUnit15_1.height * 3 + spacing * 3,
                            width: gridUnit15_1.width,
                            height: gridUnit15_1.height
                        });
                    }
                    break;
                case '15-2':
                    // 15图布局第2方案：4×4网格，第2行中间2列大图
                    const gridUnit15_2 = {
                        width: (width - spacing * 3) / 4,
                        height: (height - spacing * 3) / 4
                    };
                    // 第1行：4个图形，各占1行1列
                    for (let i = 0; i < 4; i++) {
                        positions.push({
                            x: gridUnit15_2.width * i + spacing * i,
                            y: 0,
                            width: gridUnit15_2.width,
                            height: gridUnit15_2.height
                        });
                    }
                    // 第2行：3个图形，第1个占1行1列，第2个占1行2列，第3个占1行1列
                    positions.push({
                        x: 0,
                        y: gridUnit15_2.height + spacing,
                        width: gridUnit15_2.width,
                        height: gridUnit15_2.height
                    });
                    positions.push({
                        x: gridUnit15_2.width + spacing,
                        y: gridUnit15_2.height + spacing,
                        width: gridUnit15_2.width * 2 + spacing,
                        height: gridUnit15_2.height
                    });
                    positions.push({
                        x: gridUnit15_2.width * 3 + spacing * 3,
                        y: gridUnit15_2.height + spacing,
                        width: gridUnit15_2.width,
                        height: gridUnit15_2.height
                    });
                    // 第3行：4个图形，各占1行1列
                    for (let i = 0; i < 4; i++) {
                        positions.push({
                            x: gridUnit15_2.width * i + spacing * i,
                            y: gridUnit15_2.height * 2 + spacing * 2,
                            width: gridUnit15_2.width,
                            height: gridUnit15_2.height
                        });
                    }
                    // 第4行：4个图形，各占1行1列
                    for (let i = 0; i < 4; i++) {
                        positions.push({
                            x: gridUnit15_2.width * i + spacing * i,
                            y: gridUnit15_2.height * 3 + spacing * 3,
                            width: gridUnit15_2.width,
                            height: gridUnit15_2.height
                        });
                    }
                    break;
                case '15-3':
                    // 15图布局第3方案：4×4网格，第3行中间2列大图
                    const gridUnit15_3 = {
                        width: (width - spacing * 3) / 4,
                        height: (height - spacing * 3) / 4
                    };
                    // 第1行：4个图形，各占1行1列
                    for (let i = 0; i < 4; i++) {
                        positions.push({
                            x: gridUnit15_3.width * i + spacing * i,
                            y: 0,
                            width: gridUnit15_3.width,
                            height: gridUnit15_3.height
                        });
                    }
                    // 第2行：4个图形，各占1行1列
                    for (let i = 0; i < 4; i++) {
                        positions.push({
                            x: gridUnit15_3.width * i + spacing * i,
                            y: gridUnit15_3.height + spacing,
                            width: gridUnit15_3.width,
                            height: gridUnit15_3.height
                        });
                    }
                    // 第3行：3个图形，第1个占1行1列，第2个占1行2列，第3个占1行1列
                    positions.push({
                        x: 0,
                        y: gridUnit15_3.height * 2 + spacing * 2,
                        width: gridUnit15_3.width,
                        height: gridUnit15_3.height
                    });
                    positions.push({
                        x: gridUnit15_3.width + spacing,
                        y: gridUnit15_3.height * 2 + spacing * 2,
                        width: gridUnit15_3.width * 2 + spacing,
                        height: gridUnit15_3.height
                    });
                    positions.push({
                        x: gridUnit15_3.width * 3 + spacing * 3,
                        y: gridUnit15_3.height * 2 + spacing * 2,
                        width: gridUnit15_3.width,
                        height: gridUnit15_3.height
                    });
                    // 第4行：4个图形，各占1行1列
                    for (let i = 0; i < 4; i++) {
                        positions.push({
                            x: gridUnit15_3.width * i + spacing * i,
                            y: gridUnit15_3.height * 3 + spacing * 3,
                            width: gridUnit15_3.width,
                            height: gridUnit15_3.height
                        });
                    }
                    break;
                case '15-4':
                    // 15图布局第4方案：4×4网格，第4行中间2列大图
                    const gridUnit15_4 = {
                        width: (width - spacing * 3) / 4,
                        height: (height - spacing * 3) / 4
                    };
                    // 第1行：4个图形，各占1行1列
                    for (let i = 0; i < 4; i++) {
                        positions.push({
                            x: gridUnit15_4.width * i + spacing * i,
                            y: 0,
                            width: gridUnit15_4.width,
                            height: gridUnit15_4.height
                        });
                    }
                    // 第2行：4个图形，各占1行1列
                    for (let i = 0; i < 4; i++) {
                        positions.push({
                            x: gridUnit15_4.width * i + spacing * i,
                            y: gridUnit15_4.height + spacing,
                            width: gridUnit15_4.width,
                            height: gridUnit15_4.height
                        });
                    }
                    // 第3行：4个图形，各占1行1列
                    for (let i = 0; i < 4; i++) {
                        positions.push({
                            x: gridUnit15_4.width * i + spacing * i,
                            y: gridUnit15_4.height * 2 + spacing * 2,
                            width: gridUnit15_4.width,
                            height: gridUnit15_4.height
                        });
                    }
                    // 第4行：3个图形，第1个占1行1列，第2个占1行2列，第3个占1行1列
                    positions.push({
                        x: 0,
                        y: gridUnit15_4.height * 3 + spacing * 3,
                        width: gridUnit15_4.width,
                        height: gridUnit15_4.height
                    });
                    positions.push({
                        x: gridUnit15_4.width + spacing,
                        y: gridUnit15_4.height * 3 + spacing * 3,
                        width: gridUnit15_4.width * 2 + spacing,
                        height: gridUnit15_4.height
                    });
                    positions.push({
                        x: gridUnit15_4.width * 3 + spacing * 3,
                        y: gridUnit15_4.height * 3 + spacing * 3,
                        width: gridUnit15_4.width,
                        height: gridUnit15_4.height
                    });
                    break;
                case '15-5':
                    // 15图布局第5方案：5×3网格，简单竖向网格
                    const gridUnit15_5 = {
                        width: (width - spacing * 2) / 3,
                        height: (height - spacing * 4) / 5
                    };
                    // 第1列：5个图形，各占1行1列
                    for (let i = 0; i < 5; i++) {
                        positions.push({
                            x: 0,
                            y: gridUnit15_5.height * i + spacing * i,
                            width: gridUnit15_5.width,
                            height: gridUnit15_5.height
                        });
                    }
                    // 第2列：5个图形，各占1行1列
                    for (let i = 0; i < 5; i++) {
                        positions.push({
                            x: gridUnit15_5.width + spacing,
                            y: gridUnit15_5.height * i + spacing * i,
                            width: gridUnit15_5.width,
                            height: gridUnit15_5.height
                        });
                    }
                    // 第3列：5个图形，各占1行1列
                    for (let i = 0; i < 5; i++) {
                        positions.push({
                            x: gridUnit15_5.width * 2 + spacing * 2,
                            y: gridUnit15_5.height * i + spacing * i,
                            width: gridUnit15_5.width,
                            height: gridUnit15_5.height
                        });
                    }
                    break;
                case '15-6':
                    // 15图布局第6方案：3×5网格，简单横向网格
                    const gridUnit15_6 = {
                        width: (width - spacing * 4) / 5,
                        height: (height - spacing * 2) / 3
                    };
                    // 第1行：5个图形，各占1行1列
                    for (let i = 0; i < 5; i++) {
                        positions.push({
                            x: gridUnit15_6.width * i + spacing * i,
                            y: 0,
                            width: gridUnit15_6.width,
                            height: gridUnit15_6.height
                        });
                    }
                    // 第2行：5个图形，各占1行1列
                    for (let i = 0; i < 5; i++) {
                        positions.push({
                            x: gridUnit15_6.width * i + spacing * i,
                            y: gridUnit15_6.height + spacing,
                            width: gridUnit15_6.width,
                            height: gridUnit15_6.height
                        });
                    }
                    // 第3行：5个图形，各占1行1列
                    for (let i = 0; i < 5; i++) {
                        positions.push({
                            x: gridUnit15_6.width * i + spacing * i,
                            y: gridUnit15_6.height * 2 + spacing * 2,
                            width: gridUnit15_6.width,
                            height: gridUnit15_6.height
                        });
                    }
                    break;
                case '15-7':
                    // 15图布局第7方案：4×4网格，第2行右侧2列大图
                    const gridUnit15_7 = {
                        width: (width - spacing * 3) / 4,
                        height: (height - spacing * 3) / 4
                    };
                    // 第1行：4个图形，各占1行1列
                    for (let i = 0; i < 4; i++) {
                        positions.push({
                            x: gridUnit15_7.width * i + spacing * i,
                            y: 0,
                            width: gridUnit15_7.width,
                            height: gridUnit15_7.height
                        });
                    }
                    // 第2行：3个图形，第1个占1行1列，第2个占1行1列，第3个占1行2列
                    positions.push({
                        x: 0,
                        y: gridUnit15_7.height + spacing,
                        width: gridUnit15_7.width,
                        height: gridUnit15_7.height
                    });
                    positions.push({
                        x: gridUnit15_7.width + spacing,
                        y: gridUnit15_7.height + spacing,
                        width: gridUnit15_7.width,
                        height: gridUnit15_7.height
                    });
                    positions.push({
                        x: gridUnit15_7.width * 2 + spacing * 2,
                        y: gridUnit15_7.height + spacing,
                        width: gridUnit15_7.width * 2 + spacing,
                        height: gridUnit15_7.height
                    });
                    // 第3行：4个图形，各占1行1列
                    for (let i = 0; i < 4; i++) {
                        positions.push({
                            x: gridUnit15_7.width * i + spacing * i,
                            y: gridUnit15_7.height * 2 + spacing * 2,
                            width: gridUnit15_7.width,
                            height: gridUnit15_7.height
                        });
                    }
                    // 第4行：4个图形，各占1行1列
                    for (let i = 0; i < 4; i++) {
                        positions.push({
                            x: gridUnit15_7.width * i + spacing * i,
                            y: gridUnit15_7.height * 3 + spacing * 3,
                            width: gridUnit15_7.width,
                            height: gridUnit15_7.height
                        });
                    }
                    break;
                case '15-8':
                    // 15图布局第8方案：4×4网格，第3行右侧2列大图
                    const gridUnit15_8 = {
                        width: (width - spacing * 3) / 4,
                        height: (height - spacing * 3) / 4
                    };
                    // 第1行：4个图形，各占1行1列
                    for (let i = 0; i < 4; i++) {
                        positions.push({
                            x: gridUnit15_8.width * i + spacing * i,
                            y: 0,
                            width: gridUnit15_8.width,
                            height: gridUnit15_8.height
                        });
                    }
                    // 第2行：4个图形，各占1行1列
                    for (let i = 0; i < 4; i++) {
                        positions.push({
                            x: gridUnit15_8.width * i + spacing * i,
                            y: gridUnit15_8.height + spacing,
                            width: gridUnit15_8.width,
                            height: gridUnit15_8.height
                        });
                    }
                    // 第3行：3个图形，第1个占1行1列，第2个占1行1列，第3个占1行2列
                    positions.push({
                        x: 0,
                        y: gridUnit15_8.height * 2 + spacing * 2,
                        width: gridUnit15_8.width,
                        height: gridUnit15_8.height
                    });
                    positions.push({
                        x: gridUnit15_8.width + spacing,
                        y: gridUnit15_8.height * 2 + spacing * 2,
                        width: gridUnit15_8.width,
                        height: gridUnit15_8.height
                    });
                    positions.push({
                        x: gridUnit15_8.width * 2 + spacing * 2,
                        y: gridUnit15_8.height * 2 + spacing * 2,
                        width: gridUnit15_8.width * 2 + spacing,
                        height: gridUnit15_8.height
                    });
                    // 第4行：4个图形，各占1行1列
                    for (let i = 0; i < 4; i++) {
                        positions.push({
                            x: gridUnit15_8.width * i + spacing * i,
                            y: gridUnit15_8.height * 3 + spacing * 3,
                            width: gridUnit15_8.width,
                            height: gridUnit15_8.height
                        });
                    }
                    break;
                default:
                    const cols = Math.ceil(Math.sqrt(currentCount));
                    const rows = Math.ceil(currentCount / cols);
                    const cellW = (width - spacing * (cols - 1)) / cols;
                    const cellH = (height - spacing * (rows - 1)) / rows;

                    for (let i = 0; i < currentCount; i++) {
                        const row = Math.floor(i / cols);
                        const col = i % cols;
                        positions.push({
                            x: col * (cellW + spacing),
                            y: row * (cellH + spacing),
                            width: cellW,
                            height: cellH
                        });
                    }
            }

            return { positions };
        }

        // 圆角矩形polyfill
        if (!CanvasRenderingContext2D.prototype.roundRect) {
            CanvasRenderingContext2D.prototype.roundRect = function (x, y, w, h, r) {
                if (w < 2 * r) r = w / 2;
                if (h < 2 * r) r = h / 2;
                this.moveTo(x + r, y);
                this.arcTo(x + w, y, x + w, y + h, r);
                this.arcTo(x + w, y + h, x, y + h, r);
                this.arcTo(x, y + h, x, y, r);
                this.arcTo(x, y, x + w, y, r);
                return this;
            };
        }

        function drawImageToCell(ctx, img, pos, scale = 1) {
            ctx.save();

            // 确保位置参数的精确性
            const cellX = Math.round(pos.x);
            const cellY = Math.round(pos.y); 
            const cellWidth = Math.round(pos.width);
            const cellHeight = Math.round(pos.height);

            // 计算覆盖模式的缩放
            const scaleX = cellWidth / img.width;
            const scaleY = cellHeight / img.height;
            const coverScale = Math.max(scaleX, scaleY);
            const finalScale = coverScale * scale;

            const scaledW = img.width * finalScale;
            const scaledH = img.height * finalScale;

            // 精确计算居中位置
            const x = cellX + (cellWidth - scaledW) / 2;
            const y = cellY + (cellHeight - scaledH) / 2;

            // 获取圆角半径
            const radius = parseInt(document.getElementById('imageRadius').value) || 0;

            // 裁剪到单元格区域（支持圆角）
            if (radius > 0) {
                ctx.beginPath();
                ctx.roundRect(cellX, cellY, cellWidth, cellHeight, radius);
                ctx.clip();
            } else {
                ctx.beginPath();
                ctx.rect(cellX, cellY, cellWidth, cellHeight);
                ctx.clip();
            }

            // 使用高质量的图像绘制
            ctx.imageSmoothingEnabled = true;
            ctx.imageSmoothingQuality = 'high';
            ctx.drawImage(img, Math.round(x), Math.round(y), Math.round(scaledW), Math.round(scaledH));
            ctx.restore();
        }

        function showFullscreenPreview(dataURL) {
            document.getElementById('fullscreenImage').src = dataURL;
            document.getElementById('fullscreenModal').style.display = 'flex';
            document.getElementById('downloadBtn').style.display = 'inline-flex';
            resetZoom();
        }

        function closeFullscreen() {
            document.getElementById('fullscreenModal').style.display = 'none';
        }

        function zoomImage(factor) {
            zoomLevel *= factor;
            zoomLevel = Math.max(0.2, Math.min(5, zoomLevel));
            const img = document.getElementById('fullscreenImage');
            img.style.transform = `scale(${zoomLevel})`;
            updateZoomInfo();
        }

        function resetZoom() {
            zoomLevel = 1;
            const img = document.getElementById('fullscreenImage');
            img.style.transform = 'scale(1)';
            updateZoomInfo();
        }

        function updateZoomInfo() {
            const info = document.getElementById('fullscreenInfo');
            info.textContent = `缩放: ${Math.round(zoomLevel * 100)}%`;
        }

        function downloadImage() {
            if (!mergedImageData) {
                layer.msg('请先合并图片', { icon: 5 });
                return;
            }

            const link = document.createElement('a');
            const format = document.getElementById('outputFormat').value;
            const extension = format.split('/')[1];

            link.download = `merged-image-${Date.now()}.${extension}`;
            link.href = mergedImageData;
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
        }

        function resetAll() {
            layer.confirm('确定要重置所有设置吗？', {
                icon: 3,
                btn: ['确定', '关闭'] //按钮
            }, function () {
                uploadedImages = [];
                mergedImageData = null;
                
                // 清除所有手动调整状态
                clearGridState();
                
                document.getElementById('downloadBtn').style.display = 'none';
                updatePreviewGrid();
                closeFullscreen();
                layer.closeAll();
                
                layer.msg('已重置所有设置', { icon: 1 });
            }, function () {

            });
        }
    </script>
</body>

</html>